function jM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var eq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Hv={exports:{}},Ih={},Vv={exports:{}},Z={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ec=Symbol.for("react.element"),zM=Symbol.for("react.portal"),JM=Symbol.for("react.fragment"),XM=Symbol.for("react.strict_mode"),$M=Symbol.for("react.profiler"),WM=Symbol.for("react.provider"),KM=Symbol.for("react.context"),YM=Symbol.for("react.forward_ref"),QM=Symbol.for("react.suspense"),qM=Symbol.for("react.memo"),ZM=Symbol.for("react.lazy"),n_=Symbol.iterator;function eR(t){return t===null||typeof t!="object"?null:(t=n_&&t[n_]||t["@@iterator"],typeof t=="function"?t:null)}var jv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zv=Object.assign,Jv={};function bo(t,e,n){this.props=t,this.context=e,this.refs=Jv,this.updater=n||jv}bo.prototype.isReactComponent={};bo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};bo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Xv(){}Xv.prototype=bo.prototype;function sp(t,e,n){this.props=t,this.context=e,this.refs=Jv,this.updater=n||jv}var ip=sp.prototype=new Xv;ip.constructor=sp;zv(ip,bo.prototype);ip.isPureReactComponent=!0;var r_=Array.isArray,$v=Object.prototype.hasOwnProperty,op={current:null},Wv={key:!0,ref:!0,__self:!0,__source:!0};function Kv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)$v.call(e,r)&&!Wv.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Ec,type:t,key:i,ref:o,props:s,_owner:op.current}}function tR(t,e){return{$$typeof:Ec,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ap(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ec}function nR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var s_=/\/+/g;function Af(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nR(""+t.key):e.toString(36)}function iu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ec:case zM:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Af(o,0):r,r_(s)?(n="",t!=null&&(n=t.replace(s_,"$&/")+"/"),iu(s,e,n,"",function(l){return l})):s!=null&&(ap(s)&&(s=tR(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(s_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",r_(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+Af(i,a);o+=iu(i,e,n,c,s)}else if(c=eR(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+Af(i,a++),o+=iu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Qc(t,e,n){if(t==null)return t;var r=[],s=0;return iu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function rR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var pt={current:null},ou={transition:null},sR={ReactCurrentDispatcher:pt,ReactCurrentBatchConfig:ou,ReactCurrentOwner:op};Z.Children={map:Qc,forEach:function(t,e,n){Qc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Qc(t,function(){e++}),e},toArray:function(t){return Qc(t,function(e){return e})||[]},only:function(t){if(!ap(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Z.Component=bo;Z.Fragment=JM;Z.Profiler=$M;Z.PureComponent=sp;Z.StrictMode=XM;Z.Suspense=QM;Z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sR;Z.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=zv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=op.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)$v.call(e,c)&&!Wv.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:Ec,type:t.type,key:s,ref:i,props:r,_owner:o}};Z.createContext=function(t){return t={$$typeof:KM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:WM,_context:t},t.Consumer=t};Z.createElement=Kv;Z.createFactory=function(t){var e=Kv.bind(null,t);return e.type=t,e};Z.createRef=function(){return{current:null}};Z.forwardRef=function(t){return{$$typeof:YM,render:t}};Z.isValidElement=ap;Z.lazy=function(t){return{$$typeof:ZM,_payload:{_status:-1,_result:t},_init:rR}};Z.memo=function(t,e){return{$$typeof:qM,type:t,compare:e===void 0?null:e}};Z.startTransition=function(t){var e=ou.transition;ou.transition={};try{t()}finally{ou.transition=e}};Z.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Z.useCallback=function(t,e){return pt.current.useCallback(t,e)};Z.useContext=function(t){return pt.current.useContext(t)};Z.useDebugValue=function(){};Z.useDeferredValue=function(t){return pt.current.useDeferredValue(t)};Z.useEffect=function(t,e){return pt.current.useEffect(t,e)};Z.useId=function(){return pt.current.useId()};Z.useImperativeHandle=function(t,e,n){return pt.current.useImperativeHandle(t,e,n)};Z.useInsertionEffect=function(t,e){return pt.current.useInsertionEffect(t,e)};Z.useLayoutEffect=function(t,e){return pt.current.useLayoutEffect(t,e)};Z.useMemo=function(t,e){return pt.current.useMemo(t,e)};Z.useReducer=function(t,e,n){return pt.current.useReducer(t,e,n)};Z.useRef=function(t){return pt.current.useRef(t)};Z.useState=function(t){return pt.current.useState(t)};Z.useSyncExternalStore=function(t,e,n){return pt.current.useSyncExternalStore(t,e,n)};Z.useTransition=function(){return pt.current.useTransition()};Z.version="18.2.0";Vv.exports=Z;var $=Vv.exports;const iR=kv($);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oR=$,aR=Symbol.for("react.element"),cR=Symbol.for("react.fragment"),lR=Object.prototype.hasOwnProperty,uR=oR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hR={key:!0,ref:!0,__self:!0,__source:!0};function Yv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)lR.call(e,r)&&!hR.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:aR,type:t,key:i,ref:o,props:s,_owner:uR.current}}Ih.Fragment=cR;Ih.jsx=Yv;Ih.jsxs=Yv;Hv.exports=Ih;var mr=Hv.exports,ug={},Qv={exports:{}},Wt={},qv={exports:{}},Zv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(G,X){var K=G.length;G.push(X);e:for(;0<K;){var ue=K-1>>>1,le=G[ue];if(0<s(le,X))G[ue]=X,G[K]=le,K=ue;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var X=G[0],K=G.pop();if(K!==X){G[0]=K;e:for(var ue=0,le=G.length,Gn=le>>>1;ue<Gn;){var Qt=2*(ue+1)-1,vs=G[Qt],cr=Qt+1,Pe=G[cr];if(0>s(vs,K))cr<le&&0>s(Pe,vs)?(G[ue]=Pe,G[cr]=K,ue=cr):(G[ue]=vs,G[Qt]=K,ue=Qt);else if(cr<le&&0>s(Pe,K))G[ue]=Pe,G[cr]=K,ue=cr;else break e}}return X}function s(G,X){var K=G.sortIndex-X.sortIndex;return K!==0?K:G.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,h=null,f=3,d=!1,m=!1,_=!1,T=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(G){for(var X=n(l);X!==null;){if(X.callback===null)r(l);else if(X.startTime<=G)r(l),X.sortIndex=X.expirationTime,e(c,X);else break;X=n(l)}}function C(G){if(_=!1,y(G),!m)if(n(c)!==null)m=!0,Yt(b);else{var X=n(l);X!==null&&xt(C,X.startTime-G)}}function b(G,X){m=!1,_&&(_=!1,p(x),x=-1),d=!0;var K=f;try{for(y(X),h=n(c);h!==null&&(!(h.expirationTime>X)||G&&!U());){var ue=h.callback;if(typeof ue=="function"){h.callback=null,f=h.priorityLevel;var le=ue(h.expirationTime<=X);X=t.unstable_now(),typeof le=="function"?h.callback=le:h===n(c)&&r(c),y(X)}else r(c);h=n(c)}if(h!==null)var Gn=!0;else{var Qt=n(l);Qt!==null&&xt(C,Qt.startTime-X),Gn=!1}return Gn}finally{h=null,f=K,d=!1}}var S=!1,I=null,x=-1,O=5,M=-1;function U(){return!(t.unstable_now()-M<O)}function J(){if(I!==null){var G=t.unstable_now();M=G;var X=!0;try{X=I(!0,G)}finally{X?W():(S=!1,I=null)}}else S=!1}var W;if(typeof A=="function")W=function(){A(J)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,Ce=H.port2;H.port1.onmessage=J,W=function(){Ce.postMessage(null)}}else W=function(){T(J,0)};function Yt(G){I=G,S||(S=!0,W())}function xt(G,X){x=T(function(){G(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){m||d||(m=!0,Yt(b))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(G){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var K=f;f=X;try{return G()}finally{f=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,X){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=f;f=G;try{return X()}finally{f=K}},t.unstable_scheduleCallback=function(G,X,K){var ue=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ue+K:ue):K=ue,G){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=K+le,G={id:u++,callback:X,priorityLevel:G,startTime:K,expirationTime:le,sortIndex:-1},K>ue?(G.sortIndex=K,e(l,G),n(c)===null&&G===n(l)&&(_?(p(x),x=-1):_=!0,xt(C,K-ue))):(G.sortIndex=le,e(c,G),m||d||(m=!0,Yt(b))),G},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(G){var X=f;return function(){var K=f;f=X;try{return G.apply(this,arguments)}finally{f=K}}}})(Zv);qv.exports=Zv;var fR=qv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eC=$,Xt=fR;function F(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tC=new Set,za={};function ti(t,e){ro(t,e),ro(t+"Capture",e)}function ro(t,e){for(za[t]=e,t=0;t<e.length;t++)tC.add(e[t])}var Rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hg=Object.prototype.hasOwnProperty,dR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i_={},o_={};function gR(t){return hg.call(o_,t)?!0:hg.call(i_,t)?!1:dR.test(t)?o_[t]=!0:(i_[t]=!0,!1)}function mR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function pR(t,e,n,r){if(e===null||typeof e>"u"||mR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function At(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){et[t]=new At(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];et[e]=new At(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){et[t]=new At(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){et[t]=new At(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){et[t]=new At(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){et[t]=new At(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){et[t]=new At(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){et[t]=new At(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){et[t]=new At(t,5,!1,t.toLowerCase(),null,!1,!1)});var cp=/[\-:]([a-z])/g;function lp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cp,lp);et[e]=new At(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cp,lp);et[e]=new At(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cp,lp);et[e]=new At(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){et[t]=new At(t,1,!1,t.toLowerCase(),null,!1,!1)});et.xlinkHref=new At("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){et[t]=new At(t,1,!1,t.toLowerCase(),null,!0,!0)});function up(t,e,n,r){var s=et.hasOwnProperty(e)?et[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(pR(e,n,s,r)&&(n=null),r||s===null?gR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Nr=eC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qc=Symbol.for("react.element"),Ri=Symbol.for("react.portal"),xi=Symbol.for("react.fragment"),hp=Symbol.for("react.strict_mode"),fg=Symbol.for("react.profiler"),nC=Symbol.for("react.provider"),rC=Symbol.for("react.context"),fp=Symbol.for("react.forward_ref"),dg=Symbol.for("react.suspense"),gg=Symbol.for("react.suspense_list"),dp=Symbol.for("react.memo"),Yr=Symbol.for("react.lazy"),sC=Symbol.for("react.offscreen"),a_=Symbol.iterator;function Go(t){return t===null||typeof t!="object"?null:(t=a_&&t[a_]||t["@@iterator"],typeof t=="function"?t:null)}var we=Object.assign,_f;function da(t){if(_f===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);_f=e&&e[1]||""}return`
`+_f+t}var yf=!1;function Ef(t,e){if(!t||yf)return"";yf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var s=l.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{yf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?da(t):""}function AR(t){switch(t.tag){case 5:return da(t.type);case 16:return da("Lazy");case 13:return da("Suspense");case 19:return da("SuspenseList");case 0:case 2:case 15:return t=Ef(t.type,!1),t;case 11:return t=Ef(t.type.render,!1),t;case 1:return t=Ef(t.type,!0),t;default:return""}}function mg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case xi:return"Fragment";case Ri:return"Portal";case fg:return"Profiler";case hp:return"StrictMode";case dg:return"Suspense";case gg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case rC:return(t.displayName||"Context")+".Consumer";case nC:return(t._context.displayName||"Context")+".Provider";case fp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case dp:return e=t.displayName||null,e!==null?e:mg(t.type)||"Memo";case Yr:e=t._payload,t=t._init;try{return mg(t(e))}catch{}}return null}function _R(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mg(e);case 8:return e===hp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ms(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function iC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yR(t){var e=iC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Zc(t){t._valueTracker||(t._valueTracker=yR(t))}function oC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=iC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function xu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function pg(t,e){var n=e.checked;return we({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function c_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ms(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function aC(t,e){e=e.checked,e!=null&&up(t,"checked",e,!1)}function Ag(t,e){aC(t,e);var n=ms(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_g(t,e.type,n):e.hasOwnProperty("defaultValue")&&_g(t,e.type,ms(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function l_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function _g(t,e,n){(e!=="number"||xu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ga=Array.isArray;function $i(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ms(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function yg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(F(91));return we({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function u_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(F(92));if(ga(n)){if(1<n.length)throw Error(F(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ms(n)}}function cC(t,e){var n=ms(e.value),r=ms(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function h_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function lC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Eg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?lC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var el,uC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(el=el||document.createElement("div"),el.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=el.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ja(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ba={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ER=["Webkit","ms","Moz","O"];Object.keys(Ba).forEach(function(t){ER.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ba[e]=Ba[t]})});function hC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ba.hasOwnProperty(t)&&Ba[t]?(""+e).trim():e+"px"}function fC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=hC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var TR=we({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tg(t,e){if(e){if(TR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(F(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(F(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(F(61))}if(e.style!=null&&typeof e.style!="object")throw Error(F(62))}}function vg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cg=null;function gp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Bg=null,Wi=null,Ki=null;function f_(t){if(t=Cc(t)){if(typeof Bg!="function")throw Error(F(280));var e=t.stateNode;e&&(e=Lh(e),Bg(t.stateNode,t.type,e))}}function dC(t){Wi?Ki?Ki.push(t):Ki=[t]:Wi=t}function gC(){if(Wi){var t=Wi,e=Ki;if(Ki=Wi=null,f_(t),e)for(t=0;t<e.length;t++)f_(e[t])}}function mC(t,e){return t(e)}function pC(){}var Tf=!1;function AC(t,e,n){if(Tf)return t(e,n);Tf=!0;try{return mC(t,e,n)}finally{Tf=!1,(Wi!==null||Ki!==null)&&(pC(),gC())}}function Xa(t,e){var n=t.stateNode;if(n===null)return null;var r=Lh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(F(231,e,typeof n));return n}var bg=!1;if(Rr)try{var ko={};Object.defineProperty(ko,"passive",{get:function(){bg=!0}}),window.addEventListener("test",ko,ko),window.removeEventListener("test",ko,ko)}catch{bg=!1}function vR(t,e,n,r,s,i,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var ba=!1,Ou=null,Lu=!1,Sg=null,CR={onError:function(t){ba=!0,Ou=t}};function BR(t,e,n,r,s,i,o,a,c){ba=!1,Ou=null,vR.apply(CR,arguments)}function bR(t,e,n,r,s,i,o,a,c){if(BR.apply(this,arguments),ba){if(ba){var l=Ou;ba=!1,Ou=null}else throw Error(F(198));Lu||(Lu=!0,Sg=l)}}function ni(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function _C(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function d_(t){if(ni(t)!==t)throw Error(F(188))}function SR(t){var e=t.alternate;if(!e){if(e=ni(t),e===null)throw Error(F(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return d_(s),t;if(i===r)return d_(s),e;i=i.sibling}throw Error(F(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(F(189))}}if(n.alternate!==r)throw Error(F(190))}if(n.tag!==3)throw Error(F(188));return n.stateNode.current===n?t:e}function yC(t){return t=SR(t),t!==null?EC(t):null}function EC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=EC(t);if(e!==null)return e;t=t.sibling}return null}var TC=Xt.unstable_scheduleCallback,g_=Xt.unstable_cancelCallback,wR=Xt.unstable_shouldYield,IR=Xt.unstable_requestPaint,Oe=Xt.unstable_now,MR=Xt.unstable_getCurrentPriorityLevel,mp=Xt.unstable_ImmediatePriority,vC=Xt.unstable_UserBlockingPriority,Pu=Xt.unstable_NormalPriority,RR=Xt.unstable_LowPriority,CC=Xt.unstable_IdlePriority,Mh=null,sr=null;function xR(t){if(sr&&typeof sr.onCommitFiberRoot=="function")try{sr.onCommitFiberRoot(Mh,t,void 0,(t.current.flags&128)===128)}catch{}}var Rn=Math.clz32?Math.clz32:PR,OR=Math.log,LR=Math.LN2;function PR(t){return t>>>=0,t===0?32:31-(OR(t)/LR|0)|0}var tl=64,nl=4194304;function ma(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Fu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=ma(a):(i&=o,i!==0&&(r=ma(i)))}else o=n&~s,o!==0?r=ma(o):i!==0&&(r=ma(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Rn(e),s=1<<n,r|=t[n],e&=~s;return r}function FR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function DR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Rn(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=FR(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function wg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function BC(){var t=tl;return tl<<=1,!(tl&4194240)&&(tl=64),t}function vf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Tc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rn(e),t[e]=n}function NR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Rn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function pp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Rn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var he=0;function bC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var SC,Ap,wC,IC,MC,Ig=!1,rl=[],ss=null,is=null,os=null,$a=new Map,Wa=new Map,qr=[],UR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function m_(t,e){switch(t){case"focusin":case"focusout":ss=null;break;case"dragenter":case"dragleave":is=null;break;case"mouseover":case"mouseout":os=null;break;case"pointerover":case"pointerout":$a.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wa.delete(e.pointerId)}}function Ho(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Cc(e),e!==null&&Ap(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function GR(t,e,n,r,s){switch(e){case"focusin":return ss=Ho(ss,t,e,n,r,s),!0;case"dragenter":return is=Ho(is,t,e,n,r,s),!0;case"mouseover":return os=Ho(os,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return $a.set(i,Ho($a.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Wa.set(i,Ho(Wa.get(i)||null,t,e,n,r,s)),!0}return!1}function RC(t){var e=Ps(t.target);if(e!==null){var n=ni(e);if(n!==null){if(e=n.tag,e===13){if(e=_C(n),e!==null){t.blockedOn=e,MC(t.priority,function(){wC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function au(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Mg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Cg=r,n.target.dispatchEvent(r),Cg=null}else return e=Cc(n),e!==null&&Ap(e),t.blockedOn=n,!1;e.shift()}return!0}function p_(t,e,n){au(t)&&n.delete(e)}function kR(){Ig=!1,ss!==null&&au(ss)&&(ss=null),is!==null&&au(is)&&(is=null),os!==null&&au(os)&&(os=null),$a.forEach(p_),Wa.forEach(p_)}function Vo(t,e){t.blockedOn===e&&(t.blockedOn=null,Ig||(Ig=!0,Xt.unstable_scheduleCallback(Xt.unstable_NormalPriority,kR)))}function Ka(t){function e(s){return Vo(s,t)}if(0<rl.length){Vo(rl[0],t);for(var n=1;n<rl.length;n++){var r=rl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ss!==null&&Vo(ss,t),is!==null&&Vo(is,t),os!==null&&Vo(os,t),$a.forEach(e),Wa.forEach(e),n=0;n<qr.length;n++)r=qr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<qr.length&&(n=qr[0],n.blockedOn===null);)RC(n),n.blockedOn===null&&qr.shift()}var Yi=Nr.ReactCurrentBatchConfig,Du=!0;function HR(t,e,n,r){var s=he,i=Yi.transition;Yi.transition=null;try{he=1,_p(t,e,n,r)}finally{he=s,Yi.transition=i}}function VR(t,e,n,r){var s=he,i=Yi.transition;Yi.transition=null;try{he=4,_p(t,e,n,r)}finally{he=s,Yi.transition=i}}function _p(t,e,n,r){if(Du){var s=Mg(t,e,n,r);if(s===null)Of(t,e,r,Nu,n),m_(t,r);else if(GR(s,t,e,n,r))r.stopPropagation();else if(m_(t,r),e&4&&-1<UR.indexOf(t)){for(;s!==null;){var i=Cc(s);if(i!==null&&SC(i),i=Mg(t,e,n,r),i===null&&Of(t,e,r,Nu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Of(t,e,r,null,n)}}var Nu=null;function Mg(t,e,n,r){if(Nu=null,t=gp(r),t=Ps(t),t!==null)if(e=ni(t),e===null)t=null;else if(n=e.tag,n===13){if(t=_C(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nu=t,null}function xC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(MR()){case mp:return 1;case vC:return 4;case Pu:case RR:return 16;case CC:return 536870912;default:return 16}default:return 16}}var es=null,yp=null,cu=null;function OC(){if(cu)return cu;var t,e=yp,n=e.length,r,s="value"in es?es.value:es.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return cu=s.slice(t,1<r?1-r:void 0)}function lu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function sl(){return!0}function A_(){return!1}function Kt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?sl:A_,this.isPropagationStopped=A_,this}return we(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=sl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=sl)},persist:function(){},isPersistent:sl}),e}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ep=Kt(So),vc=we({},So,{view:0,detail:0}),jR=Kt(vc),Cf,Bf,jo,Rh=we({},vc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==jo&&(jo&&t.type==="mousemove"?(Cf=t.screenX-jo.screenX,Bf=t.screenY-jo.screenY):Bf=Cf=0,jo=t),Cf)},movementY:function(t){return"movementY"in t?t.movementY:Bf}}),__=Kt(Rh),zR=we({},Rh,{dataTransfer:0}),JR=Kt(zR),XR=we({},vc,{relatedTarget:0}),bf=Kt(XR),$R=we({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),WR=Kt($R),KR=we({},So,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YR=Kt(KR),QR=we({},So,{data:0}),y_=Kt(QR),qR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ZR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},e2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function t2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=e2[t])?!!e[t]:!1}function Tp(){return t2}var n2=we({},vc,{key:function(t){if(t.key){var e=qR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=lu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ZR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tp,charCode:function(t){return t.type==="keypress"?lu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?lu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),r2=Kt(n2),s2=we({},Rh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),E_=Kt(s2),i2=we({},vc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tp}),o2=Kt(i2),a2=we({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),c2=Kt(a2),l2=we({},Rh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),u2=Kt(l2),h2=[9,13,27,32],vp=Rr&&"CompositionEvent"in window,Sa=null;Rr&&"documentMode"in document&&(Sa=document.documentMode);var f2=Rr&&"TextEvent"in window&&!Sa,LC=Rr&&(!vp||Sa&&8<Sa&&11>=Sa),T_=" ",v_=!1;function PC(t,e){switch(t){case"keyup":return h2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Oi=!1;function d2(t,e){switch(t){case"compositionend":return FC(e);case"keypress":return e.which!==32?null:(v_=!0,T_);case"textInput":return t=e.data,t===T_&&v_?null:t;default:return null}}function g2(t,e){if(Oi)return t==="compositionend"||!vp&&PC(t,e)?(t=OC(),cu=yp=es=null,Oi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return LC&&e.locale!=="ko"?null:e.data;default:return null}}var m2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function C_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!m2[t.type]:e==="textarea"}function DC(t,e,n,r){dC(r),e=Uu(e,"onChange"),0<e.length&&(n=new Ep("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var wa=null,Ya=null;function p2(t){$C(t,0)}function xh(t){var e=Fi(t);if(oC(e))return t}function A2(t,e){if(t==="change")return e}var NC=!1;if(Rr){var Sf;if(Rr){var wf="oninput"in document;if(!wf){var B_=document.createElement("div");B_.setAttribute("oninput","return;"),wf=typeof B_.oninput=="function"}Sf=wf}else Sf=!1;NC=Sf&&(!document.documentMode||9<document.documentMode)}function b_(){wa&&(wa.detachEvent("onpropertychange",UC),Ya=wa=null)}function UC(t){if(t.propertyName==="value"&&xh(Ya)){var e=[];DC(e,Ya,t,gp(t)),AC(p2,e)}}function _2(t,e,n){t==="focusin"?(b_(),wa=e,Ya=n,wa.attachEvent("onpropertychange",UC)):t==="focusout"&&b_()}function y2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xh(Ya)}function E2(t,e){if(t==="click")return xh(e)}function T2(t,e){if(t==="input"||t==="change")return xh(e)}function v2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Pn=typeof Object.is=="function"?Object.is:v2;function Qa(t,e){if(Pn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!hg.call(e,s)||!Pn(t[s],e[s]))return!1}return!0}function S_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function w_(t,e){var n=S_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=S_(n)}}function GC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?GC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function kC(){for(var t=window,e=xu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=xu(t.document)}return e}function Cp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function C2(t){var e=kC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&GC(n.ownerDocument.documentElement,n)){if(r!==null&&Cp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=w_(n,i);var o=w_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var B2=Rr&&"documentMode"in document&&11>=document.documentMode,Li=null,Rg=null,Ia=null,xg=!1;function I_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xg||Li==null||Li!==xu(r)||(r=Li,"selectionStart"in r&&Cp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ia&&Qa(Ia,r)||(Ia=r,r=Uu(Rg,"onSelect"),0<r.length&&(e=new Ep("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Li)))}function il(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Pi={animationend:il("Animation","AnimationEnd"),animationiteration:il("Animation","AnimationIteration"),animationstart:il("Animation","AnimationStart"),transitionend:il("Transition","TransitionEnd")},If={},HC={};Rr&&(HC=document.createElement("div").style,"AnimationEvent"in window||(delete Pi.animationend.animation,delete Pi.animationiteration.animation,delete Pi.animationstart.animation),"TransitionEvent"in window||delete Pi.transitionend.transition);function Oh(t){if(If[t])return If[t];if(!Pi[t])return t;var e=Pi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in HC)return If[t]=e[n];return t}var VC=Oh("animationend"),jC=Oh("animationiteration"),zC=Oh("animationstart"),JC=Oh("transitionend"),XC=new Map,M_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ys(t,e){XC.set(t,e),ti(e,[t])}for(var Mf=0;Mf<M_.length;Mf++){var Rf=M_[Mf],b2=Rf.toLowerCase(),S2=Rf[0].toUpperCase()+Rf.slice(1);ys(b2,"on"+S2)}ys(VC,"onAnimationEnd");ys(jC,"onAnimationIteration");ys(zC,"onAnimationStart");ys("dblclick","onDoubleClick");ys("focusin","onFocus");ys("focusout","onBlur");ys(JC,"onTransitionEnd");ro("onMouseEnter",["mouseout","mouseover"]);ro("onMouseLeave",["mouseout","mouseover"]);ro("onPointerEnter",["pointerout","pointerover"]);ro("onPointerLeave",["pointerout","pointerover"]);ti("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ti("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ti("onBeforeInput",["compositionend","keypress","textInput","paste"]);ti("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ti("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ti("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w2=new Set("cancel close invalid load scroll toggle".split(" ").concat(pa));function R_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,bR(r,e,void 0,t),t.currentTarget=null}function $C(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;R_(s,a,l),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;R_(s,a,l),i=c}}}if(Lu)throw t=Sg,Lu=!1,Sg=null,t}function Ee(t,e){var n=e[Dg];n===void 0&&(n=e[Dg]=new Set);var r=t+"__bubble";n.has(r)||(WC(e,t,2,!1),n.add(r))}function xf(t,e,n){var r=0;e&&(r|=4),WC(n,t,r,e)}var ol="_reactListening"+Math.random().toString(36).slice(2);function qa(t){if(!t[ol]){t[ol]=!0,tC.forEach(function(n){n!=="selectionchange"&&(w2.has(n)||xf(n,!1,t),xf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ol]||(e[ol]=!0,xf("selectionchange",!1,e))}}function WC(t,e,n,r){switch(xC(e)){case 1:var s=HR;break;case 4:s=VR;break;default:s=_p}n=s.bind(null,e,n,t),s=void 0,!bg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Of(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ps(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}AC(function(){var l=i,u=gp(n),h=[];e:{var f=XC.get(t);if(f!==void 0){var d=Ep,m=t;switch(t){case"keypress":if(lu(n)===0)break e;case"keydown":case"keyup":d=r2;break;case"focusin":m="focus",d=bf;break;case"focusout":m="blur",d=bf;break;case"beforeblur":case"afterblur":d=bf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=__;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=JR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=o2;break;case VC:case jC:case zC:d=WR;break;case JC:d=c2;break;case"scroll":d=jR;break;case"wheel":d=u2;break;case"copy":case"cut":case"paste":d=YR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=E_}var _=(e&4)!==0,T=!_&&t==="scroll",p=_?f!==null?f+"Capture":null:f;_=[];for(var A=l,y;A!==null;){y=A;var C=y.stateNode;if(y.tag===5&&C!==null&&(y=C,p!==null&&(C=Xa(A,p),C!=null&&_.push(Za(A,C,y)))),T)break;A=A.return}0<_.length&&(f=new d(f,m,null,n,u),h.push({event:f,listeners:_}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",f&&n!==Cg&&(m=n.relatedTarget||n.fromElement)&&(Ps(m)||m[xr]))break e;if((d||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,d?(m=n.relatedTarget||n.toElement,d=l,m=m?Ps(m):null,m!==null&&(T=ni(m),m!==T||m.tag!==5&&m.tag!==6)&&(m=null)):(d=null,m=l),d!==m)){if(_=__,C="onMouseLeave",p="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(_=E_,C="onPointerLeave",p="onPointerEnter",A="pointer"),T=d==null?f:Fi(d),y=m==null?f:Fi(m),f=new _(C,A+"leave",d,n,u),f.target=T,f.relatedTarget=y,C=null,Ps(u)===l&&(_=new _(p,A+"enter",m,n,u),_.target=y,_.relatedTarget=T,C=_),T=C,d&&m)t:{for(_=d,p=m,A=0,y=_;y;y=ui(y))A++;for(y=0,C=p;C;C=ui(C))y++;for(;0<A-y;)_=ui(_),A--;for(;0<y-A;)p=ui(p),y--;for(;A--;){if(_===p||p!==null&&_===p.alternate)break t;_=ui(_),p=ui(p)}_=null}else _=null;d!==null&&x_(h,f,d,_,!1),m!==null&&T!==null&&x_(h,T,m,_,!0)}}e:{if(f=l?Fi(l):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var b=A2;else if(C_(f))if(NC)b=T2;else{b=y2;var S=_2}else(d=f.nodeName)&&d.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=E2);if(b&&(b=b(t,l))){DC(h,b,n,u);break e}S&&S(t,f,l),t==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&_g(f,"number",f.value)}switch(S=l?Fi(l):window,t){case"focusin":(C_(S)||S.contentEditable==="true")&&(Li=S,Rg=l,Ia=null);break;case"focusout":Ia=Rg=Li=null;break;case"mousedown":xg=!0;break;case"contextmenu":case"mouseup":case"dragend":xg=!1,I_(h,n,u);break;case"selectionchange":if(B2)break;case"keydown":case"keyup":I_(h,n,u)}var I;if(vp)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Oi?PC(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(LC&&n.locale!=="ko"&&(Oi||x!=="onCompositionStart"?x==="onCompositionEnd"&&Oi&&(I=OC()):(es=u,yp="value"in es?es.value:es.textContent,Oi=!0)),S=Uu(l,x),0<S.length&&(x=new y_(x,t,null,n,u),h.push({event:x,listeners:S}),I?x.data=I:(I=FC(n),I!==null&&(x.data=I)))),(I=f2?d2(t,n):g2(t,n))&&(l=Uu(l,"onBeforeInput"),0<l.length&&(u=new y_("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:l}),u.data=I))}$C(h,e)})}function Za(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Uu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Xa(t,n),i!=null&&r.unshift(Za(t,i,s)),i=Xa(t,e),i!=null&&r.push(Za(t,i,s))),t=t.return}return r}function ui(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function x_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,s?(c=Xa(n,i),c!=null&&o.unshift(Za(n,c,a))):s||(c=Xa(n,i),c!=null&&o.push(Za(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var I2=/\r\n?/g,M2=/\u0000|\uFFFD/g;function O_(t){return(typeof t=="string"?t:""+t).replace(I2,`
`).replace(M2,"")}function al(t,e,n){if(e=O_(e),O_(t)!==e&&n)throw Error(F(425))}function Gu(){}var Og=null,Lg=null;function Pg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Fg=typeof setTimeout=="function"?setTimeout:void 0,R2=typeof clearTimeout=="function"?clearTimeout:void 0,L_=typeof Promise=="function"?Promise:void 0,x2=typeof queueMicrotask=="function"?queueMicrotask:typeof L_<"u"?function(t){return L_.resolve(null).then(t).catch(O2)}:Fg;function O2(t){setTimeout(function(){throw t})}function Lf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ka(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ka(e)}function as(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function P_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var wo=Math.random().toString(36).slice(2),Yn="__reactFiber$"+wo,ec="__reactProps$"+wo,xr="__reactContainer$"+wo,Dg="__reactEvents$"+wo,L2="__reactListeners$"+wo,P2="__reactHandles$"+wo;function Ps(t){var e=t[Yn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[xr]||n[Yn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=P_(t);t!==null;){if(n=t[Yn])return n;t=P_(t)}return e}t=n,n=t.parentNode}return null}function Cc(t){return t=t[Yn]||t[xr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Fi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(F(33))}function Lh(t){return t[ec]||null}var Ng=[],Di=-1;function Es(t){return{current:t}}function Te(t){0>Di||(t.current=Ng[Di],Ng[Di]=null,Di--)}function _e(t,e){Di++,Ng[Di]=t.current,t.current=e}var ps={},at=Es(ps),wt=Es(!1),Xs=ps;function so(t,e){var n=t.type.contextTypes;if(!n)return ps;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function It(t){return t=t.childContextTypes,t!=null}function ku(){Te(wt),Te(at)}function F_(t,e,n){if(at.current!==ps)throw Error(F(168));_e(at,e),_e(wt,n)}function KC(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(F(108,_R(t)||"Unknown",s));return we({},n,r)}function Hu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ps,Xs=at.current,_e(at,t),_e(wt,wt.current),!0}function D_(t,e,n){var r=t.stateNode;if(!r)throw Error(F(169));n?(t=KC(t,e,Xs),r.__reactInternalMemoizedMergedChildContext=t,Te(wt),Te(at),_e(at,t)):Te(wt),_e(wt,n)}var Ar=null,Ph=!1,Pf=!1;function YC(t){Ar===null?Ar=[t]:Ar.push(t)}function F2(t){Ph=!0,YC(t)}function Ts(){if(!Pf&&Ar!==null){Pf=!0;var t=0,e=he;try{var n=Ar;for(he=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ar=null,Ph=!1}catch(s){throw Ar!==null&&(Ar=Ar.slice(t+1)),TC(mp,Ts),s}finally{he=e,Pf=!1}}return null}var Ni=[],Ui=0,Vu=null,ju=0,an=[],cn=0,$s=null,Tr=1,vr="";function xs(t,e){Ni[Ui++]=ju,Ni[Ui++]=Vu,Vu=t,ju=e}function QC(t,e,n){an[cn++]=Tr,an[cn++]=vr,an[cn++]=$s,$s=t;var r=Tr;t=vr;var s=32-Rn(r)-1;r&=~(1<<s),n+=1;var i=32-Rn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Tr=1<<32-Rn(e)+s|n<<s|r,vr=i+t}else Tr=1<<i|n<<s|r,vr=t}function Bp(t){t.return!==null&&(xs(t,1),QC(t,1,0))}function bp(t){for(;t===Vu;)Vu=Ni[--Ui],Ni[Ui]=null,ju=Ni[--Ui],Ni[Ui]=null;for(;t===$s;)$s=an[--cn],an[cn]=null,vr=an[--cn],an[cn]=null,Tr=an[--cn],an[cn]=null}var zt=null,Ht=null,ve=!1,Bn=null;function qC(t,e){var n=ln(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function N_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,zt=t,Ht=as(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,zt=t,Ht=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=$s!==null?{id:Tr,overflow:vr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ln(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,zt=t,Ht=null,!0):!1;default:return!1}}function Ug(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Gg(t){if(ve){var e=Ht;if(e){var n=e;if(!N_(t,e)){if(Ug(t))throw Error(F(418));e=as(n.nextSibling);var r=zt;e&&N_(t,e)?qC(r,n):(t.flags=t.flags&-4097|2,ve=!1,zt=t)}}else{if(Ug(t))throw Error(F(418));t.flags=t.flags&-4097|2,ve=!1,zt=t}}}function U_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;zt=t}function cl(t){if(t!==zt)return!1;if(!ve)return U_(t),ve=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Pg(t.type,t.memoizedProps)),e&&(e=Ht)){if(Ug(t))throw ZC(),Error(F(418));for(;e;)qC(t,e),e=as(e.nextSibling)}if(U_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(F(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ht=as(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ht=null}}else Ht=zt?as(t.stateNode.nextSibling):null;return!0}function ZC(){for(var t=Ht;t;)t=as(t.nextSibling)}function io(){Ht=zt=null,ve=!1}function Sp(t){Bn===null?Bn=[t]:Bn.push(t)}var D2=Nr.ReactCurrentBatchConfig;function vn(t,e){if(t&&t.defaultProps){e=we({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var zu=Es(null),Ju=null,Gi=null,wp=null;function Ip(){wp=Gi=Ju=null}function Mp(t){var e=zu.current;Te(zu),t._currentValue=e}function kg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Qi(t,e){Ju=t,wp=Gi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Bt=!0),t.firstContext=null)}function pn(t){var e=t._currentValue;if(wp!==t)if(t={context:t,memoizedValue:e,next:null},Gi===null){if(Ju===null)throw Error(F(308));Gi=t,Ju.dependencies={lanes:0,firstContext:t}}else Gi=Gi.next=t;return e}var Fs=null;function Rp(t){Fs===null?Fs=[t]:Fs.push(t)}function eB(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Rp(e)):(n.next=s.next,s.next=n),e.interleaved=n,Or(t,r)}function Or(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Qr=!1;function xp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tB(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function wr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function cs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Or(t,n)}return s=r.interleaved,s===null?(e.next=e,Rp(r)):(e.next=s.next,s.next=e),r.interleaved=e,Or(t,n)}function uu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,pp(t,n)}}function G_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Xu(t,e,n,r){var s=t.updateQueue;Qr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?i=l:o.next=l,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,u=l=c=null,a=i;do{var f=a.lane,d=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,_=a;switch(f=e,d=n,_.tag){case 1:if(m=_.payload,typeof m=="function"){h=m.call(d,h,f);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=_.payload,f=typeof m=="function"?m.call(d,h,f):m,f==null)break e;h=we({},h,f);break e;case 2:Qr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else d={eventTime:d,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=d,c=h):u=u.next=d,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(c=h),s.baseState=c,s.firstBaseUpdate=l,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ks|=o,t.lanes=o,t.memoizedState=h}}function k_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(F(191,s));s.call(r)}}}var nB=new eC.Component().refs;function Hg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:we({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Fh={isMounted:function(t){return(t=t._reactInternals)?ni(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=mt(),s=us(t),i=wr(r,s);i.payload=e,n!=null&&(i.callback=n),e=cs(t,i,s),e!==null&&(xn(e,t,s,r),uu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=mt(),s=us(t),i=wr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=cs(t,i,s),e!==null&&(xn(e,t,s,r),uu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=mt(),r=us(t),s=wr(n,r);s.tag=2,e!=null&&(s.callback=e),e=cs(t,s,r),e!==null&&(xn(e,t,r,n),uu(e,t,r))}};function H_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Qa(n,r)||!Qa(s,i):!0}function rB(t,e,n){var r=!1,s=ps,i=e.contextType;return typeof i=="object"&&i!==null?i=pn(i):(s=It(e)?Xs:at.current,r=e.contextTypes,i=(r=r!=null)?so(t,s):ps),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Fh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function V_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Fh.enqueueReplaceState(e,e.state,null)}function Vg(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=nB,xp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=pn(i):(i=It(e)?Xs:at.current,s.context=so(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Hg(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Fh.enqueueReplaceState(s,s.state,null),Xu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function zo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(F(309));var r=n.stateNode}if(!r)throw Error(F(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;a===nB&&(a=s.refs={}),o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(F(284));if(!n._owner)throw Error(F(290,t))}return t}function ll(t,e){throw t=Object.prototype.toString.call(e),Error(F(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function j_(t){var e=t._init;return e(t._payload)}function sB(t){function e(p,A){if(t){var y=p.deletions;y===null?(p.deletions=[A],p.flags|=16):y.push(A)}}function n(p,A){if(!t)return null;for(;A!==null;)e(p,A),A=A.sibling;return null}function r(p,A){for(p=new Map;A!==null;)A.key!==null?p.set(A.key,A):p.set(A.index,A),A=A.sibling;return p}function s(p,A){return p=hs(p,A),p.index=0,p.sibling=null,p}function i(p,A,y){return p.index=y,t?(y=p.alternate,y!==null?(y=y.index,y<A?(p.flags|=2,A):y):(p.flags|=2,A)):(p.flags|=1048576,A)}function o(p){return t&&p.alternate===null&&(p.flags|=2),p}function a(p,A,y,C){return A===null||A.tag!==6?(A=Hf(y,p.mode,C),A.return=p,A):(A=s(A,y),A.return=p,A)}function c(p,A,y,C){var b=y.type;return b===xi?u(p,A,y.props.children,C,y.key):A!==null&&(A.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Yr&&j_(b)===A.type)?(C=s(A,y.props),C.ref=zo(p,A,y),C.return=p,C):(C=pu(y.type,y.key,y.props,null,p.mode,C),C.ref=zo(p,A,y),C.return=p,C)}function l(p,A,y,C){return A===null||A.tag!==4||A.stateNode.containerInfo!==y.containerInfo||A.stateNode.implementation!==y.implementation?(A=Vf(y,p.mode,C),A.return=p,A):(A=s(A,y.children||[]),A.return=p,A)}function u(p,A,y,C,b){return A===null||A.tag!==7?(A=Hs(y,p.mode,C,b),A.return=p,A):(A=s(A,y),A.return=p,A)}function h(p,A,y){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Hf(""+A,p.mode,y),A.return=p,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case qc:return y=pu(A.type,A.key,A.props,null,p.mode,y),y.ref=zo(p,null,A),y.return=p,y;case Ri:return A=Vf(A,p.mode,y),A.return=p,A;case Yr:var C=A._init;return h(p,C(A._payload),y)}if(ga(A)||Go(A))return A=Hs(A,p.mode,y,null),A.return=p,A;ll(p,A)}return null}function f(p,A,y,C){var b=A!==null?A.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:a(p,A,""+y,C);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case qc:return y.key===b?c(p,A,y,C):null;case Ri:return y.key===b?l(p,A,y,C):null;case Yr:return b=y._init,f(p,A,b(y._payload),C)}if(ga(y)||Go(y))return b!==null?null:u(p,A,y,C,null);ll(p,y)}return null}function d(p,A,y,C,b){if(typeof C=="string"&&C!==""||typeof C=="number")return p=p.get(y)||null,a(A,p,""+C,b);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case qc:return p=p.get(C.key===null?y:C.key)||null,c(A,p,C,b);case Ri:return p=p.get(C.key===null?y:C.key)||null,l(A,p,C,b);case Yr:var S=C._init;return d(p,A,y,S(C._payload),b)}if(ga(C)||Go(C))return p=p.get(y)||null,u(A,p,C,b,null);ll(A,C)}return null}function m(p,A,y,C){for(var b=null,S=null,I=A,x=A=0,O=null;I!==null&&x<y.length;x++){I.index>x?(O=I,I=null):O=I.sibling;var M=f(p,I,y[x],C);if(M===null){I===null&&(I=O);break}t&&I&&M.alternate===null&&e(p,I),A=i(M,A,x),S===null?b=M:S.sibling=M,S=M,I=O}if(x===y.length)return n(p,I),ve&&xs(p,x),b;if(I===null){for(;x<y.length;x++)I=h(p,y[x],C),I!==null&&(A=i(I,A,x),S===null?b=I:S.sibling=I,S=I);return ve&&xs(p,x),b}for(I=r(p,I);x<y.length;x++)O=d(I,p,x,y[x],C),O!==null&&(t&&O.alternate!==null&&I.delete(O.key===null?x:O.key),A=i(O,A,x),S===null?b=O:S.sibling=O,S=O);return t&&I.forEach(function(U){return e(p,U)}),ve&&xs(p,x),b}function _(p,A,y,C){var b=Go(y);if(typeof b!="function")throw Error(F(150));if(y=b.call(y),y==null)throw Error(F(151));for(var S=b=null,I=A,x=A=0,O=null,M=y.next();I!==null&&!M.done;x++,M=y.next()){I.index>x?(O=I,I=null):O=I.sibling;var U=f(p,I,M.value,C);if(U===null){I===null&&(I=O);break}t&&I&&U.alternate===null&&e(p,I),A=i(U,A,x),S===null?b=U:S.sibling=U,S=U,I=O}if(M.done)return n(p,I),ve&&xs(p,x),b;if(I===null){for(;!M.done;x++,M=y.next())M=h(p,M.value,C),M!==null&&(A=i(M,A,x),S===null?b=M:S.sibling=M,S=M);return ve&&xs(p,x),b}for(I=r(p,I);!M.done;x++,M=y.next())M=d(I,p,x,M.value,C),M!==null&&(t&&M.alternate!==null&&I.delete(M.key===null?x:M.key),A=i(M,A,x),S===null?b=M:S.sibling=M,S=M);return t&&I.forEach(function(J){return e(p,J)}),ve&&xs(p,x),b}function T(p,A,y,C){if(typeof y=="object"&&y!==null&&y.type===xi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case qc:e:{for(var b=y.key,S=A;S!==null;){if(S.key===b){if(b=y.type,b===xi){if(S.tag===7){n(p,S.sibling),A=s(S,y.props.children),A.return=p,p=A;break e}}else if(S.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Yr&&j_(b)===S.type){n(p,S.sibling),A=s(S,y.props),A.ref=zo(p,S,y),A.return=p,p=A;break e}n(p,S);break}else e(p,S);S=S.sibling}y.type===xi?(A=Hs(y.props.children,p.mode,C,y.key),A.return=p,p=A):(C=pu(y.type,y.key,y.props,null,p.mode,C),C.ref=zo(p,A,y),C.return=p,p=C)}return o(p);case Ri:e:{for(S=y.key;A!==null;){if(A.key===S)if(A.tag===4&&A.stateNode.containerInfo===y.containerInfo&&A.stateNode.implementation===y.implementation){n(p,A.sibling),A=s(A,y.children||[]),A.return=p,p=A;break e}else{n(p,A);break}else e(p,A);A=A.sibling}A=Vf(y,p.mode,C),A.return=p,p=A}return o(p);case Yr:return S=y._init,T(p,A,S(y._payload),C)}if(ga(y))return m(p,A,y,C);if(Go(y))return _(p,A,y,C);ll(p,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,A!==null&&A.tag===6?(n(p,A.sibling),A=s(A,y),A.return=p,p=A):(n(p,A),A=Hf(y,p.mode,C),A.return=p,p=A),o(p)):n(p,A)}return T}var oo=sB(!0),iB=sB(!1),Bc={},ir=Es(Bc),tc=Es(Bc),nc=Es(Bc);function Ds(t){if(t===Bc)throw Error(F(174));return t}function Op(t,e){switch(_e(nc,e),_e(tc,t),_e(ir,Bc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Eg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Eg(e,t)}Te(ir),_e(ir,e)}function ao(){Te(ir),Te(tc),Te(nc)}function oB(t){Ds(nc.current);var e=Ds(ir.current),n=Eg(e,t.type);e!==n&&(_e(tc,t),_e(ir,n))}function Lp(t){tc.current===t&&(Te(ir),Te(tc))}var Be=Es(0);function $u(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ff=[];function Pp(){for(var t=0;t<Ff.length;t++)Ff[t]._workInProgressVersionPrimary=null;Ff.length=0}var hu=Nr.ReactCurrentDispatcher,Df=Nr.ReactCurrentBatchConfig,Ws=0,Se=null,He=null,We=null,Wu=!1,Ma=!1,rc=0,N2=0;function tt(){throw Error(F(321))}function Fp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Pn(t[n],e[n]))return!1;return!0}function Dp(t,e,n,r,s,i){if(Ws=i,Se=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hu.current=t===null||t.memoizedState===null?H2:V2,t=n(r,s),Ma){i=0;do{if(Ma=!1,rc=0,25<=i)throw Error(F(301));i+=1,We=He=null,e.updateQueue=null,hu.current=j2,t=n(r,s)}while(Ma)}if(hu.current=Ku,e=He!==null&&He.next!==null,Ws=0,We=He=Se=null,Wu=!1,e)throw Error(F(300));return t}function Np(){var t=rc!==0;return rc=0,t}function Kn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return We===null?Se.memoizedState=We=t:We=We.next=t,We}function An(){if(He===null){var t=Se.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var e=We===null?Se.memoizedState:We.next;if(e!==null)We=e,He=t;else{if(t===null)throw Error(F(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},We===null?Se.memoizedState=We=t:We=We.next=t}return We}function sc(t,e){return typeof e=="function"?e(t):e}function Nf(t){var e=An(),n=e.queue;if(n===null)throw Error(F(311));n.lastRenderedReducer=t;var r=He,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,l=i;do{var u=l.lane;if((Ws&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var h={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=h,o=r):c=c.next=h,Se.lanes|=u,Ks|=u}l=l.next}while(l!==null&&l!==i);c===null?o=r:c.next=a,Pn(r,e.memoizedState)||(Bt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Se.lanes|=i,Ks|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Uf(t){var e=An(),n=e.queue;if(n===null)throw Error(F(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Pn(i,e.memoizedState)||(Bt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function aB(){}function cB(t,e){var n=Se,r=An(),s=e(),i=!Pn(r.memoizedState,s);if(i&&(r.memoizedState=s,Bt=!0),r=r.queue,Up(hB.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||We!==null&&We.memoizedState.tag&1){if(n.flags|=2048,ic(9,uB.bind(null,n,r,s,e),void 0,null),Ke===null)throw Error(F(349));Ws&30||lB(n,e,s)}return s}function lB(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function uB(t,e,n,r){e.value=n,e.getSnapshot=r,fB(e)&&dB(t)}function hB(t,e,n){return n(function(){fB(e)&&dB(t)})}function fB(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Pn(t,n)}catch{return!0}}function dB(t){var e=Or(t,1);e!==null&&xn(e,t,1,-1)}function z_(t){var e=Kn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:t},e.queue=t,t=t.dispatch=k2.bind(null,Se,t),[e.memoizedState,t]}function ic(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function gB(){return An().memoizedState}function fu(t,e,n,r){var s=Kn();Se.flags|=t,s.memoizedState=ic(1|e,n,void 0,r===void 0?null:r)}function Dh(t,e,n,r){var s=An();r=r===void 0?null:r;var i=void 0;if(He!==null){var o=He.memoizedState;if(i=o.destroy,r!==null&&Fp(r,o.deps)){s.memoizedState=ic(e,n,i,r);return}}Se.flags|=t,s.memoizedState=ic(1|e,n,i,r)}function J_(t,e){return fu(8390656,8,t,e)}function Up(t,e){return Dh(2048,8,t,e)}function mB(t,e){return Dh(4,2,t,e)}function pB(t,e){return Dh(4,4,t,e)}function AB(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function _B(t,e,n){return n=n!=null?n.concat([t]):null,Dh(4,4,AB.bind(null,e,t),n)}function Gp(){}function yB(t,e){var n=An();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function EB(t,e){var n=An();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function TB(t,e,n){return Ws&21?(Pn(n,e)||(n=BC(),Se.lanes|=n,Ks|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Bt=!0),t.memoizedState=n)}function U2(t,e){var n=he;he=n!==0&&4>n?n:4,t(!0);var r=Df.transition;Df.transition={};try{t(!1),e()}finally{he=n,Df.transition=r}}function vB(){return An().memoizedState}function G2(t,e,n){var r=us(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},CB(t))BB(e,n);else if(n=eB(t,e,n,r),n!==null){var s=mt();xn(n,t,r,s),bB(n,e,r)}}function k2(t,e,n){var r=us(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(CB(t))BB(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Pn(a,o)){var c=e.interleaved;c===null?(s.next=s,Rp(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=eB(t,e,s,r),n!==null&&(s=mt(),xn(n,t,r,s),bB(n,e,r))}}function CB(t){var e=t.alternate;return t===Se||e!==null&&e===Se}function BB(t,e){Ma=Wu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function bB(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,pp(t,n)}}var Ku={readContext:pn,useCallback:tt,useContext:tt,useEffect:tt,useImperativeHandle:tt,useInsertionEffect:tt,useLayoutEffect:tt,useMemo:tt,useReducer:tt,useRef:tt,useState:tt,useDebugValue:tt,useDeferredValue:tt,useTransition:tt,useMutableSource:tt,useSyncExternalStore:tt,useId:tt,unstable_isNewReconciler:!1},H2={readContext:pn,useCallback:function(t,e){return Kn().memoizedState=[t,e===void 0?null:e],t},useContext:pn,useEffect:J_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,fu(4194308,4,AB.bind(null,e,t),n)},useLayoutEffect:function(t,e){return fu(4194308,4,t,e)},useInsertionEffect:function(t,e){return fu(4,2,t,e)},useMemo:function(t,e){var n=Kn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Kn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=G2.bind(null,Se,t),[r.memoizedState,t]},useRef:function(t){var e=Kn();return t={current:t},e.memoizedState=t},useState:z_,useDebugValue:Gp,useDeferredValue:function(t){return Kn().memoizedState=t},useTransition:function(){var t=z_(!1),e=t[0];return t=U2.bind(null,t[1]),Kn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Se,s=Kn();if(ve){if(n===void 0)throw Error(F(407));n=n()}else{if(n=e(),Ke===null)throw Error(F(349));Ws&30||lB(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,J_(hB.bind(null,r,i,t),[t]),r.flags|=2048,ic(9,uB.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Kn(),e=Ke.identifierPrefix;if(ve){var n=vr,r=Tr;n=(r&~(1<<32-Rn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=rc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=N2++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},V2={readContext:pn,useCallback:yB,useContext:pn,useEffect:Up,useImperativeHandle:_B,useInsertionEffect:mB,useLayoutEffect:pB,useMemo:EB,useReducer:Nf,useRef:gB,useState:function(){return Nf(sc)},useDebugValue:Gp,useDeferredValue:function(t){var e=An();return TB(e,He.memoizedState,t)},useTransition:function(){var t=Nf(sc)[0],e=An().memoizedState;return[t,e]},useMutableSource:aB,useSyncExternalStore:cB,useId:vB,unstable_isNewReconciler:!1},j2={readContext:pn,useCallback:yB,useContext:pn,useEffect:Up,useImperativeHandle:_B,useInsertionEffect:mB,useLayoutEffect:pB,useMemo:EB,useReducer:Uf,useRef:gB,useState:function(){return Uf(sc)},useDebugValue:Gp,useDeferredValue:function(t){var e=An();return He===null?e.memoizedState=t:TB(e,He.memoizedState,t)},useTransition:function(){var t=Uf(sc)[0],e=An().memoizedState;return[t,e]},useMutableSource:aB,useSyncExternalStore:cB,useId:vB,unstable_isNewReconciler:!1};function co(t,e){try{var n="",r=e;do n+=AR(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Gf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function jg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var z2=typeof WeakMap=="function"?WeakMap:Map;function SB(t,e,n){n=wr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Qu||(Qu=!0,Zg=r),jg(t,e)},n}function wB(t,e,n){n=wr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){jg(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){jg(t,e),typeof r!="function"&&(ls===null?ls=new Set([this]):ls.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function X_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new z2;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=sx.bind(null,t,e,n),e.then(t,t))}function $_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function W_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=wr(-1,1),e.tag=2,cs(n,e,1))),n.lanes|=1),t)}var J2=Nr.ReactCurrentOwner,Bt=!1;function ft(t,e,n,r){e.child=t===null?iB(e,null,n,r):oo(e,t.child,n,r)}function K_(t,e,n,r,s){n=n.render;var i=e.ref;return Qi(e,s),r=Dp(t,e,n,r,i,s),n=Np(),t!==null&&!Bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Lr(t,e,s)):(ve&&n&&Bp(e),e.flags|=1,ft(t,e,r,s),e.child)}function Y_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!$p(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,IB(t,e,i,r,s)):(t=pu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Qa,n(o,r)&&t.ref===e.ref)return Lr(t,e,s)}return e.flags|=1,t=hs(i,r),t.ref=e.ref,t.return=e,e.child=t}function IB(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Qa(i,r)&&t.ref===e.ref)if(Bt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Bt=!0);else return e.lanes=t.lanes,Lr(t,e,s)}return zg(t,e,n,r,s)}function MB(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_e(Hi,Ut),Ut|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_e(Hi,Ut),Ut|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,_e(Hi,Ut),Ut|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,_e(Hi,Ut),Ut|=r;return ft(t,e,s,n),e.child}function RB(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function zg(t,e,n,r,s){var i=It(n)?Xs:at.current;return i=so(e,i),Qi(e,s),n=Dp(t,e,n,r,i,s),r=Np(),t!==null&&!Bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Lr(t,e,s)):(ve&&r&&Bp(e),e.flags|=1,ft(t,e,n,s),e.child)}function Q_(t,e,n,r,s){if(It(n)){var i=!0;Hu(e)}else i=!1;if(Qi(e,s),e.stateNode===null)du(t,e),rB(e,n,r),Vg(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=pn(l):(l=It(n)?Xs:at.current,l=so(e,l));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==l)&&V_(e,o,r,l),Qr=!1;var f=e.memoizedState;o.state=f,Xu(e,r,o,s),c=e.memoizedState,a!==r||f!==c||wt.current||Qr?(typeof u=="function"&&(Hg(e,n,u,r),c=e.memoizedState),(a=Qr||H_(e,n,a,r,f,c,l))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=l,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,tB(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:vn(e.type,a),o.props=l,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=pn(c):(c=It(n)?Xs:at.current,c=so(e,c));var d=n.getDerivedStateFromProps;(u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==c)&&V_(e,o,r,c),Qr=!1,f=e.memoizedState,o.state=f,Xu(e,r,o,s);var m=e.memoizedState;a!==h||f!==m||wt.current||Qr?(typeof d=="function"&&(Hg(e,n,d,r),m=e.memoizedState),(l=Qr||H_(e,n,l,r,f,m,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=c,r=l):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Jg(t,e,n,r,i,s)}function Jg(t,e,n,r,s,i){RB(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&D_(e,n,!1),Lr(t,e,i);r=e.stateNode,J2.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=oo(e,t.child,null,i),e.child=oo(e,null,a,i)):ft(t,e,a,i),e.memoizedState=r.state,s&&D_(e,n,!0),e.child}function xB(t){var e=t.stateNode;e.pendingContext?F_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&F_(t,e.context,!1),Op(t,e.containerInfo)}function q_(t,e,n,r,s){return io(),Sp(s),e.flags|=256,ft(t,e,n,r),e.child}var Xg={dehydrated:null,treeContext:null,retryLane:0};function $g(t){return{baseLanes:t,cachePool:null,transitions:null}}function OB(t,e,n){var r=e.pendingProps,s=Be.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),_e(Be,s&1),t===null)return Gg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Gh(o,r,0,null),t=Hs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=$g(n),e.memoizedState=Xg,t):kp(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return X2(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=hs(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=hs(a,i):(i=Hs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?$g(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Xg,r}return i=t.child,t=i.sibling,r=hs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function kp(t,e){return e=Gh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ul(t,e,n,r){return r!==null&&Sp(r),oo(e,t.child,null,n),t=kp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function X2(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Gf(Error(F(422))),ul(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Gh({mode:"visible",children:r.children},s,0,null),i=Hs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&oo(e,t.child,null,o),e.child.memoizedState=$g(o),e.memoizedState=Xg,i);if(!(e.mode&1))return ul(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(F(419)),r=Gf(i,r,void 0),ul(t,e,o,r)}if(a=(o&t.childLanes)!==0,Bt||a){if(r=Ke,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Or(t,s),xn(r,t,s,-1))}return Xp(),r=Gf(Error(F(421))),ul(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=ix.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ht=as(s.nextSibling),zt=e,ve=!0,Bn=null,t!==null&&(an[cn++]=Tr,an[cn++]=vr,an[cn++]=$s,Tr=t.id,vr=t.overflow,$s=e),e=kp(e,r.children),e.flags|=4096,e)}function Z_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),kg(t.return,e,n)}function kf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function LB(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(ft(t,e,r.children,n),r=Be.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Z_(t,n,e);else if(t.tag===19)Z_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(_e(Be,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&$u(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),kf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&$u(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}kf(e,!0,n,null,i);break;case"together":kf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function du(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Lr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ks|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(F(153));if(e.child!==null){for(t=e.child,n=hs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=hs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function $2(t,e,n){switch(e.tag){case 3:xB(e),io();break;case 5:oB(e);break;case 1:It(e.type)&&Hu(e);break;case 4:Op(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;_e(zu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_e(Be,Be.current&1),e.flags|=128,null):n&e.child.childLanes?OB(t,e,n):(_e(Be,Be.current&1),t=Lr(t,e,n),t!==null?t.sibling:null);_e(Be,Be.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return LB(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),_e(Be,Be.current),r)break;return null;case 22:case 23:return e.lanes=0,MB(t,e,n)}return Lr(t,e,n)}var PB,Wg,FB,DB;PB=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Wg=function(){};FB=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ds(ir.current);var i=null;switch(n){case"input":s=pg(t,s),r=pg(t,r),i=[];break;case"select":s=we({},s,{value:void 0}),r=we({},r,{value:void 0}),i=[];break;case"textarea":s=yg(t,s),r=yg(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Gu)}Tg(n,r);var o;n=null;for(l in s)if(!r.hasOwnProperty(l)&&s.hasOwnProperty(l)&&s[l]!=null)if(l==="style"){var a=s[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(za.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var c=r[l];if(a=s!=null?s[l]:void 0,r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(za.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&Ee("scroll",t),i||a===c||(i=[])):(i=i||[]).push(l,c))}n&&(i=i||[]).push("style",n);var l=i;(e.updateQueue=l)&&(e.flags|=4)}};DB=function(t,e,n,r){n!==r&&(e.flags|=4)};function Jo(t,e){if(!ve)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function nt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function W2(t,e,n){var r=e.pendingProps;switch(bp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nt(e),null;case 1:return It(e.type)&&ku(),nt(e),null;case 3:return r=e.stateNode,ao(),Te(wt),Te(at),Pp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(cl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Bn!==null&&(nm(Bn),Bn=null))),Wg(t,e),nt(e),null;case 5:Lp(e);var s=Ds(nc.current);if(n=e.type,t!==null&&e.stateNode!=null)FB(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(F(166));return nt(e),null}if(t=Ds(ir.current),cl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Yn]=e,r[ec]=i,t=(e.mode&1)!==0,n){case"dialog":Ee("cancel",r),Ee("close",r);break;case"iframe":case"object":case"embed":Ee("load",r);break;case"video":case"audio":for(s=0;s<pa.length;s++)Ee(pa[s],r);break;case"source":Ee("error",r);break;case"img":case"image":case"link":Ee("error",r),Ee("load",r);break;case"details":Ee("toggle",r);break;case"input":c_(r,i),Ee("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ee("invalid",r);break;case"textarea":u_(r,i),Ee("invalid",r)}Tg(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&al(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&al(r.textContent,a,t),s=["children",""+a]):za.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ee("scroll",r)}switch(n){case"input":Zc(r),l_(r,i,!0);break;case"textarea":Zc(r),h_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Gu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=lC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Yn]=e,t[ec]=r,PB(t,e,!1,!1),e.stateNode=t;e:{switch(o=vg(n,r),n){case"dialog":Ee("cancel",t),Ee("close",t),s=r;break;case"iframe":case"object":case"embed":Ee("load",t),s=r;break;case"video":case"audio":for(s=0;s<pa.length;s++)Ee(pa[s],t);s=r;break;case"source":Ee("error",t),s=r;break;case"img":case"image":case"link":Ee("error",t),Ee("load",t),s=r;break;case"details":Ee("toggle",t),s=r;break;case"input":c_(t,r),s=pg(t,r),Ee("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=we({},r,{value:void 0}),Ee("invalid",t);break;case"textarea":u_(t,r),s=yg(t,r),Ee("invalid",t);break;default:s=r}Tg(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?fC(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&uC(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ja(t,c):typeof c=="number"&&Ja(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(za.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ee("scroll",t):c!=null&&up(t,i,c,o))}switch(n){case"input":Zc(t),l_(t,r,!1);break;case"textarea":Zc(t),h_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ms(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?$i(t,!!r.multiple,i,!1):r.defaultValue!=null&&$i(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Gu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nt(e),null;case 6:if(t&&e.stateNode!=null)DB(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(F(166));if(n=Ds(nc.current),Ds(ir.current),cl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Yn]=e,(i=r.nodeValue!==n)&&(t=zt,t!==null))switch(t.tag){case 3:al(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&al(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Yn]=e,e.stateNode=r}return nt(e),null;case 13:if(Te(Be),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ve&&Ht!==null&&e.mode&1&&!(e.flags&128))ZC(),io(),e.flags|=98560,i=!1;else if(i=cl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(F(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(F(317));i[Yn]=e}else io(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nt(e),i=!1}else Bn!==null&&(nm(Bn),Bn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Be.current&1?Ve===0&&(Ve=3):Xp())),e.updateQueue!==null&&(e.flags|=4),nt(e),null);case 4:return ao(),Wg(t,e),t===null&&qa(e.stateNode.containerInfo),nt(e),null;case 10:return Mp(e.type._context),nt(e),null;case 17:return It(e.type)&&ku(),nt(e),null;case 19:if(Te(Be),i=e.memoizedState,i===null)return nt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Jo(i,!1);else{if(Ve!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=$u(t),o!==null){for(e.flags|=128,Jo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _e(Be,Be.current&1|2),e.child}t=t.sibling}i.tail!==null&&Oe()>lo&&(e.flags|=128,r=!0,Jo(i,!1),e.lanes=4194304)}else{if(!r)if(t=$u(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Jo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ve)return nt(e),null}else 2*Oe()-i.renderingStartTime>lo&&n!==1073741824&&(e.flags|=128,r=!0,Jo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Oe(),e.sibling=null,n=Be.current,_e(Be,r?n&1|2:n&1),e):(nt(e),null);case 22:case 23:return Jp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ut&1073741824&&(nt(e),e.subtreeFlags&6&&(e.flags|=8192)):nt(e),null;case 24:return null;case 25:return null}throw Error(F(156,e.tag))}function K2(t,e){switch(bp(e),e.tag){case 1:return It(e.type)&&ku(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ao(),Te(wt),Te(at),Pp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Lp(e),null;case 13:if(Te(Be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(F(340));io()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Te(Be),null;case 4:return ao(),null;case 10:return Mp(e.type._context),null;case 22:case 23:return Jp(),null;case 24:return null;default:return null}}var hl=!1,ot=!1,Y2=typeof WeakSet=="function"?WeakSet:Set,j=null;function ki(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Re(t,e,r)}else n.current=null}function Kg(t,e,n){try{n()}catch(r){Re(t,e,r)}}var e1=!1;function Q2(t,e){if(Og=Du,t=kC(),Cp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,l=0,u=0,h=t,f=null;t:for(;;){for(var d;h!==n||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===t)break t;if(f===n&&++l===s&&(a=o),f===i&&++u===r&&(c=o),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Lg={focusedElem:t,selectionRange:n},Du=!1,j=e;j!==null;)if(e=j,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,j=t;else for(;j!==null;){e=j;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var _=m.memoizedProps,T=m.memoizedState,p=e.stateNode,A=p.getSnapshotBeforeUpdate(e.elementType===e.type?_:vn(e.type,_),T);p.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(F(163))}}catch(C){Re(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,j=t;break}j=e.return}return m=e1,e1=!1,m}function Ra(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Kg(e,n,i)}s=s.next}while(s!==r)}}function Nh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Yg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function NB(t){var e=t.alternate;e!==null&&(t.alternate=null,NB(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Yn],delete e[ec],delete e[Dg],delete e[L2],delete e[P2])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function UB(t){return t.tag===5||t.tag===3||t.tag===4}function t1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||UB(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Qg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Gu));else if(r!==4&&(t=t.child,t!==null))for(Qg(t,e,n),t=t.sibling;t!==null;)Qg(t,e,n),t=t.sibling}function qg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(qg(t,e,n),t=t.sibling;t!==null;)qg(t,e,n),t=t.sibling}var qe=null,Cn=!1;function Hr(t,e,n){for(n=n.child;n!==null;)GB(t,e,n),n=n.sibling}function GB(t,e,n){if(sr&&typeof sr.onCommitFiberUnmount=="function")try{sr.onCommitFiberUnmount(Mh,n)}catch{}switch(n.tag){case 5:ot||ki(n,e);case 6:var r=qe,s=Cn;qe=null,Hr(t,e,n),qe=r,Cn=s,qe!==null&&(Cn?(t=qe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qe.removeChild(n.stateNode));break;case 18:qe!==null&&(Cn?(t=qe,n=n.stateNode,t.nodeType===8?Lf(t.parentNode,n):t.nodeType===1&&Lf(t,n),Ka(t)):Lf(qe,n.stateNode));break;case 4:r=qe,s=Cn,qe=n.stateNode.containerInfo,Cn=!0,Hr(t,e,n),qe=r,Cn=s;break;case 0:case 11:case 14:case 15:if(!ot&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Kg(n,e,o),s=s.next}while(s!==r)}Hr(t,e,n);break;case 1:if(!ot&&(ki(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Re(n,e,a)}Hr(t,e,n);break;case 21:Hr(t,e,n);break;case 22:n.mode&1?(ot=(r=ot)||n.memoizedState!==null,Hr(t,e,n),ot=r):Hr(t,e,n);break;default:Hr(t,e,n)}}function n1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Y2),e.forEach(function(r){var s=ox.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function yn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qe=a.stateNode,Cn=!1;break e;case 3:qe=a.stateNode.containerInfo,Cn=!0;break e;case 4:qe=a.stateNode.containerInfo,Cn=!0;break e}a=a.return}if(qe===null)throw Error(F(160));GB(i,o,s),qe=null,Cn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(l){Re(s,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)kB(e,t),e=e.sibling}function kB(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(yn(e,t),jn(t),r&4){try{Ra(3,t,t.return),Nh(3,t)}catch(_){Re(t,t.return,_)}try{Ra(5,t,t.return)}catch(_){Re(t,t.return,_)}}break;case 1:yn(e,t),jn(t),r&512&&n!==null&&ki(n,n.return);break;case 5:if(yn(e,t),jn(t),r&512&&n!==null&&ki(n,n.return),t.flags&32){var s=t.stateNode;try{Ja(s,"")}catch(_){Re(t,t.return,_)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&aC(s,i),vg(a,o);var l=vg(a,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];u==="style"?fC(s,h):u==="dangerouslySetInnerHTML"?uC(s,h):u==="children"?Ja(s,h):up(s,u,h,l)}switch(a){case"input":Ag(s,i);break;case"textarea":cC(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var d=i.value;d!=null?$i(s,!!i.multiple,d,!1):f!==!!i.multiple&&(i.defaultValue!=null?$i(s,!!i.multiple,i.defaultValue,!0):$i(s,!!i.multiple,i.multiple?[]:"",!1))}s[ec]=i}catch(_){Re(t,t.return,_)}}break;case 6:if(yn(e,t),jn(t),r&4){if(t.stateNode===null)throw Error(F(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(_){Re(t,t.return,_)}}break;case 3:if(yn(e,t),jn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ka(e.containerInfo)}catch(_){Re(t,t.return,_)}break;case 4:yn(e,t),jn(t);break;case 13:yn(e,t),jn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(jp=Oe())),r&4&&n1(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(ot=(l=ot)||u,yn(e,t),ot=l):yn(e,t),jn(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(j=t,u=t.child;u!==null;){for(h=j=u;j!==null;){switch(f=j,d=f.child,f.tag){case 0:case 11:case 14:case 15:Ra(4,f,f.return);break;case 1:ki(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(_){Re(r,n,_)}}break;case 5:ki(f,f.return);break;case 22:if(f.memoizedState!==null){s1(h);continue}}d!==null?(d.return=f,j=d):s1(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,l?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=hC("display",o))}catch(_){Re(t,t.return,_)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(_){Re(t,t.return,_)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yn(e,t),jn(t),r&4&&n1(t);break;case 21:break;default:yn(e,t),jn(t)}}function jn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(UB(n)){var r=n;break e}n=n.return}throw Error(F(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ja(s,""),r.flags&=-33);var i=t1(t);qg(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=t1(t);Qg(t,a,o);break;default:throw Error(F(161))}}catch(c){Re(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function q2(t,e,n){j=t,HB(t)}function HB(t,e,n){for(var r=(t.mode&1)!==0;j!==null;){var s=j,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||hl;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||ot;a=hl;var l=ot;if(hl=o,(ot=c)&&!l)for(j=s;j!==null;)o=j,c=o.child,o.tag===22&&o.memoizedState!==null?i1(s):c!==null?(c.return=o,j=c):i1(s);for(;i!==null;)j=i,HB(i),i=i.sibling;j=s,hl=a,ot=l}r1(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,j=i):r1(t)}}function r1(t){for(;j!==null;){var e=j;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ot||Nh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ot)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:vn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&k_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}k_(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Ka(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(F(163))}ot||e.flags&512&&Yg(e)}catch(f){Re(e,e.return,f)}}if(e===t){j=null;break}if(n=e.sibling,n!==null){n.return=e.return,j=n;break}j=e.return}}function s1(t){for(;j!==null;){var e=j;if(e===t){j=null;break}var n=e.sibling;if(n!==null){n.return=e.return,j=n;break}j=e.return}}function i1(t){for(;j!==null;){var e=j;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Nh(4,e)}catch(c){Re(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Re(e,s,c)}}var i=e.return;try{Yg(e)}catch(c){Re(e,i,c)}break;case 5:var o=e.return;try{Yg(e)}catch(c){Re(e,o,c)}}}catch(c){Re(e,e.return,c)}if(e===t){j=null;break}var a=e.sibling;if(a!==null){a.return=e.return,j=a;break}j=e.return}}var Z2=Math.ceil,Yu=Nr.ReactCurrentDispatcher,Hp=Nr.ReactCurrentOwner,gn=Nr.ReactCurrentBatchConfig,re=0,Ke=null,Ge=null,Ze=0,Ut=0,Hi=Es(0),Ve=0,oc=null,Ks=0,Uh=0,Vp=0,xa=null,vt=null,jp=0,lo=1/0,pr=null,Qu=!1,Zg=null,ls=null,fl=!1,ts=null,qu=0,Oa=0,em=null,gu=-1,mu=0;function mt(){return re&6?Oe():gu!==-1?gu:gu=Oe()}function us(t){return t.mode&1?re&2&&Ze!==0?Ze&-Ze:D2.transition!==null?(mu===0&&(mu=BC()),mu):(t=he,t!==0||(t=window.event,t=t===void 0?16:xC(t.type)),t):1}function xn(t,e,n,r){if(50<Oa)throw Oa=0,em=null,Error(F(185));Tc(t,n,r),(!(re&2)||t!==Ke)&&(t===Ke&&(!(re&2)&&(Uh|=n),Ve===4&&Zr(t,Ze)),Mt(t,r),n===1&&re===0&&!(e.mode&1)&&(lo=Oe()+500,Ph&&Ts()))}function Mt(t,e){var n=t.callbackNode;DR(t,e);var r=Fu(t,t===Ke?Ze:0);if(r===0)n!==null&&g_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&g_(n),e===1)t.tag===0?F2(o1.bind(null,t)):YC(o1.bind(null,t)),x2(function(){!(re&6)&&Ts()}),n=null;else{switch(bC(r)){case 1:n=mp;break;case 4:n=vC;break;case 16:n=Pu;break;case 536870912:n=CC;break;default:n=Pu}n=KB(n,VB.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function VB(t,e){if(gu=-1,mu=0,re&6)throw Error(F(327));var n=t.callbackNode;if(qi()&&t.callbackNode!==n)return null;var r=Fu(t,t===Ke?Ze:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Zu(t,r);else{e=r;var s=re;re|=2;var i=zB();(Ke!==t||Ze!==e)&&(pr=null,lo=Oe()+500,ks(t,e));do try{nx();break}catch(a){jB(t,a)}while(!0);Ip(),Yu.current=i,re=s,Ge!==null?e=0:(Ke=null,Ze=0,e=Ve)}if(e!==0){if(e===2&&(s=wg(t),s!==0&&(r=s,e=tm(t,s))),e===1)throw n=oc,ks(t,0),Zr(t,r),Mt(t,Oe()),n;if(e===6)Zr(t,r);else{if(s=t.current.alternate,!(r&30)&&!ex(s)&&(e=Zu(t,r),e===2&&(i=wg(t),i!==0&&(r=i,e=tm(t,i))),e===1))throw n=oc,ks(t,0),Zr(t,r),Mt(t,Oe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(F(345));case 2:Os(t,vt,pr);break;case 3:if(Zr(t,r),(r&130023424)===r&&(e=jp+500-Oe(),10<e)){if(Fu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){mt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Fg(Os.bind(null,t,vt,pr),e);break}Os(t,vt,pr);break;case 4:if(Zr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Rn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Oe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Z2(r/1960))-r,10<r){t.timeoutHandle=Fg(Os.bind(null,t,vt,pr),r);break}Os(t,vt,pr);break;case 5:Os(t,vt,pr);break;default:throw Error(F(329))}}}return Mt(t,Oe()),t.callbackNode===n?VB.bind(null,t):null}function tm(t,e){var n=xa;return t.current.memoizedState.isDehydrated&&(ks(t,e).flags|=256),t=Zu(t,e),t!==2&&(e=vt,vt=n,e!==null&&nm(e)),t}function nm(t){vt===null?vt=t:vt.push.apply(vt,t)}function ex(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Pn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zr(t,e){for(e&=~Vp,e&=~Uh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Rn(e),r=1<<n;t[n]=-1,e&=~r}}function o1(t){if(re&6)throw Error(F(327));qi();var e=Fu(t,0);if(!(e&1))return Mt(t,Oe()),null;var n=Zu(t,e);if(t.tag!==0&&n===2){var r=wg(t);r!==0&&(e=r,n=tm(t,r))}if(n===1)throw n=oc,ks(t,0),Zr(t,e),Mt(t,Oe()),n;if(n===6)throw Error(F(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Os(t,vt,pr),Mt(t,Oe()),null}function zp(t,e){var n=re;re|=1;try{return t(e)}finally{re=n,re===0&&(lo=Oe()+500,Ph&&Ts())}}function Ys(t){ts!==null&&ts.tag===0&&!(re&6)&&qi();var e=re;re|=1;var n=gn.transition,r=he;try{if(gn.transition=null,he=1,t)return t()}finally{he=r,gn.transition=n,re=e,!(re&6)&&Ts()}}function Jp(){Ut=Hi.current,Te(Hi)}function ks(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,R2(n)),Ge!==null)for(n=Ge.return;n!==null;){var r=n;switch(bp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ku();break;case 3:ao(),Te(wt),Te(at),Pp();break;case 5:Lp(r);break;case 4:ao();break;case 13:Te(Be);break;case 19:Te(Be);break;case 10:Mp(r.type._context);break;case 22:case 23:Jp()}n=n.return}if(Ke=t,Ge=t=hs(t.current,null),Ze=Ut=e,Ve=0,oc=null,Vp=Uh=Ks=0,vt=xa=null,Fs!==null){for(e=0;e<Fs.length;e++)if(n=Fs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Fs=null}return t}function jB(t,e){do{var n=Ge;try{if(Ip(),hu.current=Ku,Wu){for(var r=Se.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Wu=!1}if(Ws=0,We=He=Se=null,Ma=!1,rc=0,Hp.current=null,n===null||n.return===null){Ve=1,oc=e,Ge=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=Ze,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=$_(o);if(d!==null){d.flags&=-257,W_(d,o,a,i,e),d.mode&1&&X_(i,l,e),e=d,c=l;var m=e.updateQueue;if(m===null){var _=new Set;_.add(c),e.updateQueue=_}else m.add(c);break e}else{if(!(e&1)){X_(i,l,e),Xp();break e}c=Error(F(426))}}else if(ve&&a.mode&1){var T=$_(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),W_(T,o,a,i,e),Sp(co(c,a));break e}}i=c=co(c,a),Ve!==4&&(Ve=2),xa===null?xa=[i]:xa.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var p=SB(i,c,e);G_(i,p);break e;case 1:a=c;var A=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof A.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ls===null||!ls.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var C=wB(i,a,e);G_(i,C);break e}}i=i.return}while(i!==null)}XB(n)}catch(b){e=b,Ge===n&&n!==null&&(Ge=n=n.return);continue}break}while(!0)}function zB(){var t=Yu.current;return Yu.current=Ku,t===null?Ku:t}function Xp(){(Ve===0||Ve===3||Ve===2)&&(Ve=4),Ke===null||!(Ks&268435455)&&!(Uh&268435455)||Zr(Ke,Ze)}function Zu(t,e){var n=re;re|=2;var r=zB();(Ke!==t||Ze!==e)&&(pr=null,ks(t,e));do try{tx();break}catch(s){jB(t,s)}while(!0);if(Ip(),re=n,Yu.current=r,Ge!==null)throw Error(F(261));return Ke=null,Ze=0,Ve}function tx(){for(;Ge!==null;)JB(Ge)}function nx(){for(;Ge!==null&&!wR();)JB(Ge)}function JB(t){var e=WB(t.alternate,t,Ut);t.memoizedProps=t.pendingProps,e===null?XB(t):Ge=e,Hp.current=null}function XB(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=K2(n,e),n!==null){n.flags&=32767,Ge=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ve=6,Ge=null;return}}else if(n=W2(n,e,Ut),n!==null){Ge=n;return}if(e=e.sibling,e!==null){Ge=e;return}Ge=e=t}while(e!==null);Ve===0&&(Ve=5)}function Os(t,e,n){var r=he,s=gn.transition;try{gn.transition=null,he=1,rx(t,e,n,r)}finally{gn.transition=s,he=r}return null}function rx(t,e,n,r){do qi();while(ts!==null);if(re&6)throw Error(F(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(F(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(NR(t,i),t===Ke&&(Ge=Ke=null,Ze=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||fl||(fl=!0,KB(Pu,function(){return qi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=gn.transition,gn.transition=null;var o=he;he=1;var a=re;re|=4,Hp.current=null,Q2(t,n),kB(n,t),C2(Lg),Du=!!Og,Lg=Og=null,t.current=n,q2(n),IR(),re=a,he=o,gn.transition=i}else t.current=n;if(fl&&(fl=!1,ts=t,qu=s),i=t.pendingLanes,i===0&&(ls=null),xR(n.stateNode),Mt(t,Oe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Qu)throw Qu=!1,t=Zg,Zg=null,t;return qu&1&&t.tag!==0&&qi(),i=t.pendingLanes,i&1?t===em?Oa++:(Oa=0,em=t):Oa=0,Ts(),null}function qi(){if(ts!==null){var t=bC(qu),e=gn.transition,n=he;try{if(gn.transition=null,he=16>t?16:t,ts===null)var r=!1;else{if(t=ts,ts=null,qu=0,re&6)throw Error(F(331));var s=re;for(re|=4,j=t.current;j!==null;){var i=j,o=i.child;if(j.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(j=l;j!==null;){var u=j;switch(u.tag){case 0:case 11:case 15:Ra(8,u,i)}var h=u.child;if(h!==null)h.return=u,j=h;else for(;j!==null;){u=j;var f=u.sibling,d=u.return;if(NB(u),u===l){j=null;break}if(f!==null){f.return=d,j=f;break}j=d}}}var m=i.alternate;if(m!==null){var _=m.child;if(_!==null){m.child=null;do{var T=_.sibling;_.sibling=null,_=T}while(_!==null)}}j=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,j=o;else e:for(;j!==null;){if(i=j,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ra(9,i,i.return)}var p=i.sibling;if(p!==null){p.return=i.return,j=p;break e}j=i.return}}var A=t.current;for(j=A;j!==null;){o=j;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,j=y;else e:for(o=A;j!==null;){if(a=j,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Nh(9,a)}}catch(b){Re(a,a.return,b)}if(a===o){j=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,j=C;break e}j=a.return}}if(re=s,Ts(),sr&&typeof sr.onPostCommitFiberRoot=="function")try{sr.onPostCommitFiberRoot(Mh,t)}catch{}r=!0}return r}finally{he=n,gn.transition=e}}return!1}function a1(t,e,n){e=co(n,e),e=SB(t,e,1),t=cs(t,e,1),e=mt(),t!==null&&(Tc(t,1,e),Mt(t,e))}function Re(t,e,n){if(t.tag===3)a1(t,t,n);else for(;e!==null;){if(e.tag===3){a1(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ls===null||!ls.has(r))){t=co(n,t),t=wB(e,t,1),e=cs(e,t,1),t=mt(),e!==null&&(Tc(e,1,t),Mt(e,t));break}}e=e.return}}function sx(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=mt(),t.pingedLanes|=t.suspendedLanes&n,Ke===t&&(Ze&n)===n&&(Ve===4||Ve===3&&(Ze&130023424)===Ze&&500>Oe()-jp?ks(t,0):Vp|=n),Mt(t,e)}function $B(t,e){e===0&&(t.mode&1?(e=nl,nl<<=1,!(nl&130023424)&&(nl=4194304)):e=1);var n=mt();t=Or(t,e),t!==null&&(Tc(t,e,n),Mt(t,n))}function ix(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),$B(t,n)}function ox(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(F(314))}r!==null&&r.delete(e),$B(t,n)}var WB;WB=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||wt.current)Bt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Bt=!1,$2(t,e,n);Bt=!!(t.flags&131072)}else Bt=!1,ve&&e.flags&1048576&&QC(e,ju,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;du(t,e),t=e.pendingProps;var s=so(e,at.current);Qi(e,n),s=Dp(null,e,r,t,s,n);var i=Np();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,It(r)?(i=!0,Hu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,xp(e),s.updater=Fh,e.stateNode=s,s._reactInternals=e,Vg(e,r,t,n),e=Jg(null,e,r,!0,i,n)):(e.tag=0,ve&&i&&Bp(e),ft(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(du(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=cx(r),t=vn(r,t),s){case 0:e=zg(null,e,r,t,n);break e;case 1:e=Q_(null,e,r,t,n);break e;case 11:e=K_(null,e,r,t,n);break e;case 14:e=Y_(null,e,r,vn(r.type,t),n);break e}throw Error(F(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),zg(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),Q_(t,e,r,s,n);case 3:e:{if(xB(e),t===null)throw Error(F(387));r=e.pendingProps,i=e.memoizedState,s=i.element,tB(t,e),Xu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=co(Error(F(423)),e),e=q_(t,e,r,n,s);break e}else if(r!==s){s=co(Error(F(424)),e),e=q_(t,e,r,n,s);break e}else for(Ht=as(e.stateNode.containerInfo.firstChild),zt=e,ve=!0,Bn=null,n=iB(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(io(),r===s){e=Lr(t,e,n);break e}ft(t,e,r,n)}e=e.child}return e;case 5:return oB(e),t===null&&Gg(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Pg(r,s)?o=null:i!==null&&Pg(r,i)&&(e.flags|=32),RB(t,e),ft(t,e,o,n),e.child;case 6:return t===null&&Gg(e),null;case 13:return OB(t,e,n);case 4:return Op(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=oo(e,null,r,n):ft(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),K_(t,e,r,s,n);case 7:return ft(t,e,e.pendingProps,n),e.child;case 8:return ft(t,e,e.pendingProps.children,n),e.child;case 12:return ft(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,_e(zu,r._currentValue),r._currentValue=o,i!==null)if(Pn(i.value,o)){if(i.children===s.children&&!wt.current){e=Lr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=wr(-1,n&-n),c.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),kg(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(F(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),kg(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ft(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Qi(e,n),s=pn(s),r=r(s),e.flags|=1,ft(t,e,r,n),e.child;case 14:return r=e.type,s=vn(r,e.pendingProps),s=vn(r.type,s),Y_(t,e,r,s,n);case 15:return IB(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),du(t,e),e.tag=1,It(r)?(t=!0,Hu(e)):t=!1,Qi(e,n),rB(e,r,s),Vg(e,r,s,n),Jg(null,e,r,!0,t,n);case 19:return LB(t,e,n);case 22:return MB(t,e,n)}throw Error(F(156,e.tag))};function KB(t,e){return TC(t,e)}function ax(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ln(t,e,n,r){return new ax(t,e,n,r)}function $p(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cx(t){if(typeof t=="function")return $p(t)?1:0;if(t!=null){if(t=t.$$typeof,t===fp)return 11;if(t===dp)return 14}return 2}function hs(t,e){var n=t.alternate;return n===null?(n=ln(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function pu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")$p(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case xi:return Hs(n.children,s,i,e);case hp:o=8,s|=8;break;case fg:return t=ln(12,n,e,s|2),t.elementType=fg,t.lanes=i,t;case dg:return t=ln(13,n,e,s),t.elementType=dg,t.lanes=i,t;case gg:return t=ln(19,n,e,s),t.elementType=gg,t.lanes=i,t;case sC:return Gh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case nC:o=10;break e;case rC:o=9;break e;case fp:o=11;break e;case dp:o=14;break e;case Yr:o=16,r=null;break e}throw Error(F(130,t==null?t:typeof t,""))}return e=ln(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Hs(t,e,n,r){return t=ln(7,t,r,e),t.lanes=n,t}function Gh(t,e,n,r){return t=ln(22,t,r,e),t.elementType=sC,t.lanes=n,t.stateNode={isHidden:!1},t}function Hf(t,e,n){return t=ln(6,t,null,e),t.lanes=n,t}function Vf(t,e,n){return e=ln(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function lx(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vf(0),this.expirationTimes=vf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wp(t,e,n,r,s,i,o,a,c){return t=new lx(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ln(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},xp(i),t}function ux(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ri,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function YB(t){if(!t)return ps;t=t._reactInternals;e:{if(ni(t)!==t||t.tag!==1)throw Error(F(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(It(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(F(171))}if(t.tag===1){var n=t.type;if(It(n))return KC(t,n,e)}return e}function QB(t,e,n,r,s,i,o,a,c){return t=Wp(n,r,!0,t,s,i,o,a,c),t.context=YB(null),n=t.current,r=mt(),s=us(n),i=wr(r,s),i.callback=e??null,cs(n,i,s),t.current.lanes=s,Tc(t,s,r),Mt(t,r),t}function kh(t,e,n,r){var s=e.current,i=mt(),o=us(s);return n=YB(n),e.context===null?e.context=n:e.pendingContext=n,e=wr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=cs(s,e,o),t!==null&&(xn(t,s,o,i),uu(t,s,o)),o}function eh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function c1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Kp(t,e){c1(t,e),(t=t.alternate)&&c1(t,e)}function hx(){return null}var qB=typeof reportError=="function"?reportError:function(t){console.error(t)};function Yp(t){this._internalRoot=t}Hh.prototype.render=Yp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(F(409));kh(t,e,null,null)};Hh.prototype.unmount=Yp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ys(function(){kh(null,t,null,null)}),e[xr]=null}};function Hh(t){this._internalRoot=t}Hh.prototype.unstable_scheduleHydration=function(t){if(t){var e=IC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<qr.length&&e!==0&&e<qr[n].priority;n++);qr.splice(n,0,t),n===0&&RC(t)}};function Qp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Vh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function l1(){}function fx(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var l=eh(o);i.call(l)}}var o=QB(e,r,t,0,null,!1,!1,"",l1);return t._reactRootContainer=o,t[xr]=o.current,qa(t.nodeType===8?t.parentNode:t),Ys(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var l=eh(c);a.call(l)}}var c=Wp(t,0,!1,null,null,!1,!1,"",l1);return t._reactRootContainer=c,t[xr]=c.current,qa(t.nodeType===8?t.parentNode:t),Ys(function(){kh(e,c,n,r)}),c}function jh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=eh(o);a.call(c)}}kh(e,o,t,s)}else o=fx(n,e,t,s,r);return eh(o)}SC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ma(e.pendingLanes);n!==0&&(pp(e,n|1),Mt(e,Oe()),!(re&6)&&(lo=Oe()+500,Ts()))}break;case 13:Ys(function(){var r=Or(t,1);if(r!==null){var s=mt();xn(r,t,1,s)}}),Kp(t,1)}};Ap=function(t){if(t.tag===13){var e=Or(t,134217728);if(e!==null){var n=mt();xn(e,t,134217728,n)}Kp(t,134217728)}};wC=function(t){if(t.tag===13){var e=us(t),n=Or(t,e);if(n!==null){var r=mt();xn(n,t,e,r)}Kp(t,e)}};IC=function(){return he};MC=function(t,e){var n=he;try{return he=t,e()}finally{he=n}};Bg=function(t,e,n){switch(e){case"input":if(Ag(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Lh(r);if(!s)throw Error(F(90));oC(r),Ag(r,s)}}}break;case"textarea":cC(t,n);break;case"select":e=n.value,e!=null&&$i(t,!!n.multiple,e,!1)}};mC=zp;pC=Ys;var dx={usingClientEntryPoint:!1,Events:[Cc,Fi,Lh,dC,gC,zp]},Xo={findFiberByHostInstance:Ps,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},gx={bundleType:Xo.bundleType,version:Xo.version,rendererPackageName:Xo.rendererPackageName,rendererConfig:Xo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Nr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=yC(t),t===null?null:t.stateNode},findFiberByHostInstance:Xo.findFiberByHostInstance||hx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dl.isDisabled&&dl.supportsFiber)try{Mh=dl.inject(gx),sr=dl}catch{}}Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dx;Wt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qp(e))throw Error(F(200));return ux(t,e,null,n)};Wt.createRoot=function(t,e){if(!Qp(t))throw Error(F(299));var n=!1,r="",s=qB;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Wp(t,1,!1,null,null,n,!1,r,s),t[xr]=e.current,qa(t.nodeType===8?t.parentNode:t),new Yp(e)};Wt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(F(188)):(t=Object.keys(t).join(","),Error(F(268,t)));return t=yC(e),t=t===null?null:t.stateNode,t};Wt.flushSync=function(t){return Ys(t)};Wt.hydrate=function(t,e,n){if(!Vh(e))throw Error(F(200));return jh(null,t,e,!0,n)};Wt.hydrateRoot=function(t,e,n){if(!Qp(t))throw Error(F(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=qB;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=QB(e,null,t,1,n??null,s,!1,i,o),t[xr]=e.current,qa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Hh(e)};Wt.render=function(t,e,n){if(!Vh(e))throw Error(F(200));return jh(null,t,e,!1,n)};Wt.unmountComponentAtNode=function(t){if(!Vh(t))throw Error(F(40));return t._reactRootContainer?(Ys(function(){jh(null,null,t,!1,function(){t._reactRootContainer=null,t[xr]=null})}),!0):!1};Wt.unstable_batchedUpdates=zp;Wt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Vh(n))throw Error(F(200));if(t==null||t._reactInternals===void 0)throw Error(F(38));return jh(t,e,n,!1,r)};Wt.version="18.2.0-next-9e3b772b8-20220608";function ZB(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ZB)}catch(t){console.error(t)}}ZB(),Qv.exports=Wt;var qp=Qv.exports,u1=qp;ug.createRoot=u1.createRoot,ug.hydrateRoot=u1.hydrateRoot;function ac(t){"@babel/helpers - typeof";return ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ac(t)}function mx(t,e){if(ac(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ac(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function px(t){var e=mx(t,"string");return ac(e)=="symbol"?e:String(e)}function g(t,e,n){return e=px(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function me(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const zh=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),h1=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);h1&&parseFloat(h1[1]);const Ax="3.4.14";function or(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const jf={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},_x=jf.global||jf.self||jf.window||{},Ir=typeof process!="object"||String(process)!=="[object process]"||process.browser,Zp=typeof importScripts=="function",yx=typeof window<"u"&&typeof window.orientation<"u",f1=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);f1&&parseFloat(f1[1]);class Ex{constructor(e,n){g(this,"name",void 0),g(this,"workerThread",void 0),g(this,"isRunning",!0),g(this,"result",void 0),g(this,"_resolve",()=>{}),g(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,s)=>{this._resolve=r,this._reject=s})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){or(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){or(this.isRunning),this.isRunning=!1,this._reject(e)}}let zf=class{terminate(){}};const Jf=new Map;function Tx(t){or(t.source&&!t.url||!t.source&&t.url);let e=Jf.get(t.source||t.url);return e||(t.url&&(e=vx(t.url),Jf.set(t.url,e)),t.source&&(e=eb(t.source),Jf.set(t.source,e))),or(e),e}function vx(t){if(!t.startsWith("http"))return t;const e=Cx(t);return eb(e)}function eb(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Cx(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function tb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(d1(t))r.add(t);else if(d1(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const s in t)tb(t[s],e,r)}}return n===void 0?Array.from(r):[]}function d1(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Xf=()=>{};class rm{static isSupported(){return typeof Worker<"u"&&Ir||typeof zf<"u"&&!Ir}constructor(e){g(this,"name",void 0),g(this,"source",void 0),g(this,"url",void 0),g(this,"terminated",!1),g(this,"worker",void 0),g(this,"onMessage",void 0),g(this,"onError",void 0),g(this,"_loadableURL","");const{name:n,source:r,url:s}=e;or(r||s),this.name=n,this.source=r,this.url=s,this.onMessage=Xf,this.onError=i=>console.log(i),this.worker=Ir?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Xf,this.onError=Xf,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||tb(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=Tx({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new zf(r,{eval:!1})}else if(this.source)e=new zf(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class Bx{static isSupported(){return rm.isSupported()}constructor(e){g(this,"name","unnamed"),g(this,"source",void 0),g(this,"url",void 0),g(this,"maxConcurrency",1),g(this,"maxMobileConcurrency",1),g(this,"onDebug",()=>{}),g(this,"reuseWorkers",!0),g(this,"props",{}),g(this,"jobQueue",[]),g(this,"idleQueue",[]),g(this,"count",0),g(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(i,o,a)=>i.done(a),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(i,o)=>i.error(o);const s=new Promise(i=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:i}),this));return this._startQueuedJob(),await s}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new Ex(n.name,e);e.onMessage=s=>n.onMessage(r,s.type,s.payload),e.onError=s=>n.onError(r,s),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new rm({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return yx?this.maxMobileConcurrency:this.maxConcurrency}}const bx={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class yr{static isSupported(){return rm.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yr._workerFarm=yr._workerFarm||new yr({}),yr._workerFarm.setProps(e),yr._workerFarm}constructor(e){g(this,"props",void 0),g(this,"workerPools",new Map),this.props={...bx},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:s}=e;let i=this.workerPools.get(n);return i||(i=new Bx({name:n,source:r,url:s}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}g(yr,"_workerFarm",void 0);const Sx="latest";function wx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let s=n.workerUrl;if(!s&&t.id==="compression"&&(s=e.workerUrl),e._workerType==="test"&&(s="modules/".concat(t.module,"/dist/").concat(r)),!s){let i=t.version;i==="latest"&&(i=Sx);const o=i?"@".concat(i):"";s="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return or(s),s}function Ix(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ax;or(t,"no worker provided");const n=t.version;return!(!e||!n)}const Mx=null,Rx=null,sm=null,nb=null,xx=Object.freeze(Object.defineProperty({__proto__:null,readFileAsArrayBuffer:Mx,readFileAsText:Rx,requireFromFile:sm,requireFromString:nb},Symbol.toStringTag,{value:"Module"})),Ox="3.4.14",$f={};async function Vs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e&&(t=Lx(t,e,n)),$f[t]=$f[t]||Px(t),await $f[t]}function Lx(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:Ir?n.CDN?(or(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat(Ox,"/dist/libs/").concat(t)):Zp?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}async function Px(t){if(t.endsWith("wasm"))return await(await fetch(t)).arrayBuffer();if(!Ir)try{return xx&&sm&&await sm(t)}catch{return null}if(Zp)return importScripts(t);const n=await(await fetch(t)).text();return Fx(n,t)}function Fx(t,e){if(!Ir)return nb;if(Zp)return eval.call(_x,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}const Dx={},Nx=Object.freeze(Object.defineProperty({__proto__:null,default:Dx},Symbol.toStringTag,{value:"Module"}));function Ux(t,e){return!yr.isSupported()||!Ir&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function Gx(t,e,n,r,s){const i=t.id,o=wx(t,n),c=yr.getWorkerFarm(n).getWorkerPool({name:i,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const l=await c.startJob("process-on-worker",kx.bind(null,s));return l.postMessage("process",{input:e,options:n,context:r}),await(await l.result).result}async function kx(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:s,input:i,options:o}=r;try{const a=await t(i,o);e.postMessage("done",{id:s,result:a})}catch(a){const c=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:s,error:c})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function Hx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?g1(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?g1(t,0,e):""}function g1(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let s="";for(let i=0;i<n;i++)s+=String.fromCharCode(r.getUint8(e+i));return s}function Vx(t){try{return JSON.parse(t)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(Hx(t),'"'))}}function jx(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),s=new Uint8Array(e);for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}function zx(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),s=r.reduce((a,c)=>a+c.byteLength,0),i=new Uint8Array(s);let o=0;for(const a of r)i.set(a,o),o+=a.byteLength;return i.buffer}function e0(t,e,n){const r=n!==void 0?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function bc(t,e){return me(t>=0),me(e>0),t+(e-1)&~(e-1)}function Jx(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const s=t.byteOffset,i=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,s,i)}return e.set(r,n),n+bc(r.byteLength,4)}async function Xx(t){const e=[];for await(const n of t)e.push(n);return zx(...e)}function m1(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let p1=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=m1(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(m1()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},$x=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let s=this.stats[n];return s||(e instanceof p1?s=e:s=new p1(n,r),this.stats[n]=s),s}};const Wx="Queued Requests",Kx="Active Requests",Yx="Cancelled Requests",Qx="Queued Requests Ever",qx="Active Requests Ever",Zx={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class eO{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g(this,"props",void 0),g(this,"stats",void 0),g(this,"activeRequestCount",0),g(this,"requestQueue",[]),g(this,"requestMap",new Map),g(this,"deferredUpdate",null),this.props={...Zx,...e},this.stats=new $x({id:this.props.id}),this.stats.get(Wx),this.stats.get(Kx),this.stats.get(Yx),this.stats.get(Qx),this.stats.get(qx)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},s=new Promise(i=>(r.resolve=i,r));return this.requestQueue.push(r),this.requestMap.set(e,s),this._issueNewRequests(),s}_issueRequest(e){const{handle:n,resolve:r}=e;let s=!1;const i=()=>{s||(s=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let tO="";const A1={};function nO(t){for(const e in A1)if(t.startsWith(e)){const n=A1[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(tO).concat(t)),t}function rO(t){return t&&typeof t=="object"&&t.isBuffer}function rb(t){if(rO(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function sb(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function t0(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const sO=t=>typeof t=="boolean",La=t=>typeof t=="function",Sc=t=>t!==null&&typeof t=="object",_1=t=>Sc(t)&&t.constructor==={}.constructor,iO=t=>t&&typeof t[Symbol.iterator]=="function",oO=t=>t&&typeof t[Symbol.asyncIterator]=="function",ri=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,si=t=>typeof Blob<"u"&&t instanceof Blob,aO=t=>t&&typeof t=="object"&&t.isBuffer,cO=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Sc(t)&&La(t.tee)&&La(t.cancel)&&La(t.getReader),lO=t=>Sc(t)&&La(t.read)&&La(t.pipe)&&sO(t.readable),ib=t=>cO(t)||lO(t),uO=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,hO=/^([-\w.]+\/[-\w.+]+)/;function fO(t){const e=hO.exec(t);return e?e[1]:t}function y1(t){const e=uO.exec(t);return e?e[1]:""}const ob=/\?.*/;function dO(t){const e=t.match(ob);return e&&e[0]}function n0(t){return t.replace(ob,"")}function Jh(t){return ri(t)?t.url:si(t)?t.name||"":typeof t=="string"?t:""}function r0(t){if(ri(t)){const e=t,n=e.headers.get("content-type")||"",r=n0(e.url);return fO(n)||y1(r)}return si(t)?t.type||"":typeof t=="string"?y1(t):""}function gO(t){return ri(t)?t.headers["content-length"]||-1:si(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function ab(t){if(ri(t))return t;const e={},n=gO(t);n>=0&&(e["content-length"]=String(n));const r=Jh(t),s=r0(t);s&&(e["content-type"]=s);const i=await AO(t);i&&(e["x-first-bytes"]=i),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function mO(t){if(!t.ok){const e=await pO(t);throw new Error(e)}}async function pO(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function AO(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const s=new FileReader;s.onload=i=>{var o;return r(i==null||(o=i.target)===null||o===void 0?void 0:o.result)},s.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=_O(n);return"data:base64,".concat(r)}return null}function _O(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function E1(t,e){if(typeof t=="string"){t=nO(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await ab(t)}function yO(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function wc(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||yO()}const gl=globalThis.window||globalThis.self||globalThis.global,$o=globalThis.process||{},cb=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";wc();function EO(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let TO=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=EO(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function vO(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function CO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Wf(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const s=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const i=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(i/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(s,");"),"background-size:".concat(i,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let th;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(th||(th={}));const BO=10;function T1(t){return typeof t!="string"?t:(t=t.toUpperCase(),th[t]||th.WHITE)}function bO(t,e,n){if(!wc&&typeof t=="string"){if(e){const r=T1(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=T1(n);t="\x1B[".concat(r+BO,"m").concat(t,"\x1B[49m")}}return t}function SO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),s=t;for(const i of r){const o=s[i];typeof o=="function"&&(e.find(a=>i===a)||(s[i]=o.bind(t)))}}function nh(t,e){if(!t)throw new Error(e||"Assertion failed")}function hi(){let t;if(wc()&&gl.performance){var e,n;t=gl==null||(e=gl.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in $o){var r;const s=$o==null||(r=$o.hrtime)===null||r===void 0?void 0:r.call($o);t=s[0]*1e3+s[1]/1e6}else t=Date.now();return t}const fi={debug:wc()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},wO={enabled:!0,level:0};function rn(){}const v1={},C1={once:!0};let s0=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=cb,this._startTs=hi(),this._deltaTs=hi(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new TO("__probe-".concat(this.id,"__"),wO),this.timeStamp("".concat(this.id," started")),SO(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((hi()-this._startTs).toPrecision(10))}getDelta(){return Number((hi()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){nh(e,n)}warn(e){return this._getLogFunction(0,e,fi.warn,arguments,C1)}error(e){return this._getLogFunction(0,e,fi.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,fi.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,fi.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,fi.debug||fi.info,arguments,C1)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||rn,r&&[r],{tag:xO(n)}):rn}image(e){let{logLevel:n,priority:r,image:s,message:i="",scale:o=1}=e;return this._shouldLog(n||r)?wc()?RO({image:s,message:i,scale:o}):MO():rn}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||rn)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const s=B1({logLevel:e,message:n,opts:r}),{collapsed:i}=r;return s.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||rn)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=lb(e)}_getLogFunction(e,n,r,s,i){if(this._shouldLog(e)){i=B1({logLevel:e,message:n,args:s,opts:i}),r=r||i.method,nh(r),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=hi();const o=i.tag||i.message;if(i.once&&o)if(!v1[o])v1[o]=hi();else return rn;return n=IO(this.id,i.message,i),r.bind(console,n,...i.args)}return rn}};s0.VERSION=cb;function lb(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return nh(Number.isFinite(e)&&e>=0),e}function B1(t){const{logLevel:e,message:n}=t;t.logLevel=lb(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const s=typeof t.message;return nh(s==="string"||s==="object"),Object.assign(t,{args:r},t.opts)}function IO(t,e,n){if(typeof e=="string"){const r=n.time?CO(vO(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=bO(e,n.color,n.background)}return e}function MO(t){return console.warn("removed"),rn}function RO(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const i=new Image;return i.onload=()=>{const o=Wf(i,n,r);console.log(...o)},i.src=e,rn}const s=e.nodeName||"";if(s.toLowerCase()==="img")return console.log(...Wf(e,n,r)),rn;if(s.toLowerCase()==="canvas"){const i=new Image;return i.onload=()=>console.log(...Wf(i,n,r)),i.src=e.toDataURL(),rn}return rn}function xO(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const b1=new s0({id:"loaders.gl"});class OO{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class LO{constructor(){g(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const ub={fetch:null,mimeType:void 0,nothrow:!1,log:new LO,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:zh,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},PO={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function hb(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const fb=()=>{const t=hb();return t.globalOptions=t.globalOptions||{...ub},t.globalOptions};function FO(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],DO(t,n),UO(e,t,r)}function DO(t,e){S1(t,null,ub,PO,e);for(const n of e){const r=t&&t[n.id]||{},s=n.options&&n.options[n.id]||{},i=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};S1(r,n.id,s,i,e)}}function S1(t,e,n,r,s){const i=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const c=!e&&Sc(t[a]),l=a==="baseUri"&&!e,u=a==="workerUrl"&&e;if(!(a in n)&&!l&&!u){if(a in r)b1.warn("".concat(i," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!c){const h=NO(a,s);b1.warn("".concat(i," loader option '").concat(o).concat(a,"' not recognized. ").concat(h))()}}}}function NO(t,e){const n=t.toLowerCase();let r="";for(const s of e)for(const i in s.options){if(t===i)return"Did you mean '".concat(s.id,".").concat(i,"'?");const o=i.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(s.id,".").concat(i,"'?"))}return r}function UO(t,e,n){const s={...t.options||{}};return GO(s,n),s.log===null&&(s.log=new OO),w1(s,fb()),w1(s,e),s}function w1(t,e){for(const n in e)if(n in e){const r=e[n];_1(r)&&_1(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function GO(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function i0(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function o0(t){var e,n;me(t,"null loader"),me(i0(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const db=()=>{const t=hb();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function kO(t){const e=db();t=Array.isArray(t)?t:[t];for(const n of t){const r=o0(n);e.find(s=>r===s)||e.unshift(r)}}function HO(){return db()}const VO=new s0({id:"loaders.gl"}),jO=/\.([^.]+)$/;async function zO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!gb(t))return null;let s=I1(t,e,{...n,nothrow:!0},r);if(s)return s;if(si(t)&&(t=await t.slice(0,10).arrayBuffer(),s=I1(t,e,n,r)),!s&&!(n!=null&&n.nothrow))throw new Error(mb(t));return s}function I1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!gb(t))return null;if(e&&!Array.isArray(e))return o0(e);let s=[];e&&(s=s.concat(e)),n!=null&&n.ignoreRegisteredLoaders||s.push(...HO()),XO(s);const i=JO(t,s,n,r);if(!i&&!(n!=null&&n.nothrow))throw new Error(mb(t));return i}function JO(t,e,n,r){const s=Jh(t),i=r0(t),o=n0(s)||(r==null?void 0:r.url);let a=null,c="";if(n!=null&&n.mimeType&&(a=Kf(e,n==null?void 0:n.mimeType),c="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||$O(e,o),c=c||(a?"matched url ".concat(o):""),a=a||Kf(e,i),c=c||(a?"matched MIME type ".concat(i):""),a=a||KO(e,t),c=c||(a?"matched initial data ".concat(pb(t)):""),a=a||Kf(e,n==null?void 0:n.fallbackMimeType),c=c||(a?"matched fallback MIME type ".concat(i):""),c){var l;VO.log(1,"selectLoader selected ".concat((l=a)===null||l===void 0?void 0:l.name,": ").concat(c,"."))}return a}function gb(t){return!(t instanceof Response&&t.status===204)}function mb(t){const e=Jh(t),n=r0(t);let r="No valid loader found (";r+=e?"".concat(sb(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const s=t?pb(t):"";return r+=s?' first bytes: "'.concat(s,'"'):"first bytes: not available",r+=")",r}function XO(t){for(const e of t)o0(e)}function $O(t,e){const n=e&&jO.exec(e),r=n&&n[1];return r?WO(t,r):null}function WO(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function Kf(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function KO(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(YO(e,n))return n}else if(ArrayBuffer.isView(e)){if(M1(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&M1(e,0,n))return n;return null}function YO(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function M1(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(s=>QO(t,e,n,s))}function QO(t,e,n,r){if(r instanceof ArrayBuffer)return jx(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const s=im(t,e,r.length);return r===s;default:return!1}}function pb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?im(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?im(t,0,e):""}function im(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let s="";for(let i=0;i<n;i++)s+=String.fromCharCode(r.getUint8(e+i));return s}const qO=256*1024;function*ZO(t,e){const n=(e==null?void 0:e.chunkSize)||qO;let r=0;const s=new TextEncoder;for(;r<t.length;){const i=Math.min(t.length-r,n),o=t.slice(r,r+i);r+=i,yield s.encode(o)}}const eL=256*1024;function tL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=eL}=e;let r=0;for(;r<t.byteLength;){const s=Math.min(t.byteLength-r,n),i=new ArrayBuffer(s),o=new Uint8Array(t,r,s);new Uint8Array(i).set(o),r+=s,yield i}}()}const nL=1024*1024;async function*rL(t,e){const n=(e==null?void 0:e.chunkSize)||nL;let r=0;for(;r<t.size;){const s=r+n,i=await t.slice(r,s).arrayBuffer();r=s,yield i}}function R1(t,e){return zh?sL(t,e):iL(t)}async function*sL(t,e){const n=t.getReader();let r;try{for(;;){const s=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:i,value:o}=await s;if(i)return;yield rb(o)}}catch{n.releaseLock()}}async function*iL(t,e){for await(const n of t)yield rb(n)}function oL(t,e){if(typeof t=="string")return ZO(t,e);if(t instanceof ArrayBuffer)return tL(t,e);if(si(t))return rL(t,e);if(ib(t))return R1(t,e);if(ri(t))return R1(t.body,e);throw new Error("makeIterator")}const Ab="Cannot convert supplied data type";function aL(t,e,n){if(e.text&&typeof t=="string")return t;if(aO(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const s=t.byteLength||t.length;return(t.byteOffset!==0||s!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+s)),r}throw new Error(Ab)}async function cL(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return aL(t,e);if(si(t)&&(t=await ab(t)),ri(t)){const s=t;return await mO(s),e.binary?await s.arrayBuffer():await s.text()}if(ib(t)&&(t=oL(t,n)),iO(t)||oO(t))return Xx(t);throw new Error(Ab)}function _b(t,e){const n=fb(),r=t||n;return typeof r.fetch=="function"?r.fetch:Sc(r.fetch)?s=>E1(s,r):e!=null&&e.fetch?e==null?void 0:e.fetch:E1}function lL(t,e,n){if(n)return n;const r={fetch:_b(e,t),...t};if(r.url){const s=n0(r.url);r.baseUrl=s,r.queryString=dO(r.url),r.filename=sb(s),r.baseUrl=t0(s)}return Array.isArray(r.loaders)||(r.loaders=null),r}function uL(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function a0(t,e,n,r){or(!r||typeof r=="object"),e&&!Array.isArray(e)&&!i0(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const s=Jh(t),o=uL(e,r),a=await zO(t,o,n);return a?(n=FO(n,a,o,s),r=lL({url:s,parse:a0,loaders:o},n,r||null),await hL(a,t,n,r)):null}async function hL(t,e,n,r){if(Ix(t),ri(e)){const s=e,{ok:i,redirected:o,status:a,statusText:c,type:l,url:u}=s,h=Object.fromEntries(s.headers.entries());r.response={headers:h,ok:i,redirected:o,status:a,statusText:c,type:l,url:u}}if(e=await cL(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(Ux(t,n))return await Gx(t,e,n,r,a0);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw or(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function ar(t,e,n,r){!Array.isArray(e)&&!i0(e)&&(n=e,e=void 0);const s=_b(n);let i=t;return typeof t=="string"&&(i=await s(t)),si(t)&&(i=await s(t)),await a0(i,e,n)}const fL="3.4.14",{_parseImageNode:dL}=globalThis,om=typeof Image<"u",am=typeof ImageBitmap<"u",gL=!!dL,cm=zh?!0:gL;function mL(t){switch(t){case"auto":return am||om||cm;case"imagebitmap":return am;case"image":return om;case"data":return cm;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function pL(){if(am)return"imagebitmap";if(om)return"image";if(cm)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function AL(t){const e=yL(t);if(!e)throw new Error("Not an image");return e}function _L(t){switch(AL(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function yL(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const EL=/^data:image\/svg\+xml/,TL=/\.svg((\?|#).*)?$/;function c0(t){return t&&(EL.test(t)||TL.test(t))}function vL(t,e){if(c0(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(i){throw new Error(i.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return yb(t,e)}function yb(t,e){if(c0(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Eb(t,e,n){const r=vL(t,n),s=self.URL||self.webkitURL,i=typeof r!="string"&&s.createObjectURL(r);try{return await CL(i||r,e)}finally{i&&s.revokeObjectURL(i)}}async function CL(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,s)=>{try{n.onload=()=>r(n),n.onerror=i=>s(new Error("Could not load image ".concat(t,": ").concat(i)))}catch(i){s(i)}})}const BL={};let x1=!0;async function bL(t,e,n){let r;c0(n)?r=await Eb(t,e,n):r=yb(t,n);const s=e&&e.imagebitmap;return await SL(r,s)}async function SL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((wL(e)||!x1)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),x1=!1}return await createImageBitmap(t)}function wL(t){for(const e in t||BL)return!1;return!0}function IL(t){return!OL(t,"ftyp",4)||!(t[8]&96)?null:ML(t)}function ML(t){switch(RL(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function RL(t,e,n){return String.fromCharCode(...t.slice(e,n))}function xL(t){return[...t].map(e=>e.charCodeAt(0))}function OL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=xL(e);for(let s=0;s<r.length;++s)if(r[s]!==t[s+n])return!1;return!0}const Qn=!1,Pa=!0;function l0(t){const e=Ic(t);return PL(e)||NL(e)||FL(e)||DL(e)||LL(e)}function LL(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=IL(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function PL(t){const e=Ic(t);return e.byteLength>=24&&e.getUint32(0,Qn)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Qn),height:e.getUint32(20,Qn)}:null}function FL(t){const e=Ic(t);return e.byteLength>=10&&e.getUint32(0,Qn)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Pa),height:e.getUint16(8,Pa)}:null}function DL(t){const e=Ic(t);return e.byteLength>=14&&e.getUint16(0,Qn)===16973&&e.getUint32(2,Pa)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Pa),height:e.getUint32(22,Pa)}:null}function NL(t){const e=Ic(t);if(!(e.byteLength>=3&&e.getUint16(0,Qn)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:s}=UL();let i=2;for(;i+9<e.byteLength;){const o=e.getUint16(i,Qn);if(s.has(o))return{mimeType:"image/jpeg",height:e.getUint16(i+5,Qn),width:e.getUint16(i+7,Qn)};if(!r.has(o))return null;i+=2,i+=e.getUint16(i,Qn)}return null}function UL(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Ic(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function kL(t,e){const{mimeType:n}=l0(t)||{},r=globalThis._parseImageNode;return me(r),await r(t,n)}async function HL(t,e,n){e=e||{};const s=(e.image||{}).type||"auto",{url:i}=n||{},o=VL(s);let a;switch(o){case"imagebitmap":a=await bL(t,e,i);break;case"image":a=await Eb(t,e,i);break;case"data":a=await kL(t);break;default:me(!1)}return s==="data"&&(a=_L(a)),a}function VL(t){switch(t){case"auto":case"data":return pL();default:return mL(t),t}}const jL=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],zL=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],JL={image:{type:"auto",decode:!0}},Tb={id:"image",module:"images",name:"Images",version:fL,mimeTypes:zL,extensions:jL,parse:HL,tests:[t=>!!l0(new DataView(t))],options:JL},Yf={};function XL(t){if(Yf[t]===void 0){const e=zh?WL(t):$L(t);Yf[t]=e}return Yf[t]}function $L(t){const e=["image/png","image/jpeg","image/gif"],{_parseImageNode:n,_imageFormatsNode:r=e}=globalThis;return!!n&&r.includes(t)}function WL(t){switch(t){case"image/avif":case"image/webp":return KL(t);default:return!0}}function KL(t){try{return document.createElement("canvas").toDataURL(t).indexOf("data:".concat(t))===0}catch{return!1}}function vb(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Ur(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||vb()}const Au={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},ml=Au.window||Au.self||Au.global,Wo=Au.process||{},Cb=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Ur();const Qf=globalThis;function Bb(t){if(!t&&!Ur())return"Node";if(vb(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,s=n.indexOf("Trident/")!==-1;return r||s?"IE":Qf.chrome?"Chrome":Qf.safari?"Safari":Qf.mozInnerScreenX?"Firefox":"Unknown"}function YL(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let QL=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";g(this,"storage",void 0),g(this,"id",void 0),g(this,"config",void 0),this.storage=YL(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function qL(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function ZL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function qf(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const s=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const i=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(i/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(s,");"),"background-size:".concat(i,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let rh;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(rh||(rh={}));function O1(t){return typeof t=="string"?rh[t.toUpperCase()]||rh.WHITE:t}function eP(t,e,n){return!Ur&&typeof t=="string"&&(e&&(e=O1(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=O1(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function tP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const s of r)typeof t[s]=="function"&&(e.find(i=>s===i)||(t[s]=t[s].bind(t)))}function sh(t,e){if(!t)throw new Error(e||"Assertion failed")}function di(){let t;if(Ur&&"performance"in ml){var e,n;t=ml==null||(e=ml.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Wo){var r;const s=Wo==null||(r=Wo.hrtime)===null||r===void 0?void 0:r.call(Wo);t=s[0]*1e3+s[1]/1e6}else t=Date.now();return t}const gi={debug:Ur&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},nP={enabled:!0,level:0};function sn(){}const L1={},P1={once:!0};let u0=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};g(this,"id",void 0),g(this,"VERSION",Cb),g(this,"_startTs",di()),g(this,"_deltaTs",di()),g(this,"_storage",void 0),g(this,"userData",{}),g(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new QL("__probe-".concat(this.id,"__"),nP),this.timeStamp("".concat(this.id," started")),tP(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((di()-this._startTs).toPrecision(10))}getDelta(){return Number((di()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){sh(e,n)}warn(e){return this._getLogFunction(0,e,gi.warn,arguments,P1)}error(e){return this._getLogFunction(0,e,gi.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,gi.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,gi.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i];return this._getLogFunction(e,n,gi.debug||gi.info,arguments,P1)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||sn,r&&[r],{tag:oP(n)}):sn}image(e){let{logLevel:n,priority:r,image:s,message:i="",scale:o=1}=e;return this._shouldLog(n||r)?Ur?iP({image:s,message:i,scale:o}):sP():sn}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||sn)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const s=F1({logLevel:e,message:n,opts:r}),{collapsed:i}=r;return s.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||sn)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=bb(e)}_getLogFunction(e,n,r,s,i){if(this._shouldLog(e)){i=F1({logLevel:e,message:n,args:s,opts:i}),r=r||i.method,sh(r),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=di();const o=i.tag||i.message;if(i.once)if(!L1[o])L1[o]=di();else return sn;return n=rP(this.id,i.message,i),r.bind(console,n,...i.args)}return sn}};g(u0,"VERSION",Cb);function bb(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return sh(Number.isFinite(e)&&e>=0),e}function F1(t){const{logLevel:e,message:n}=t;t.logLevel=bb(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const s=typeof t.message;return sh(s==="string"||s==="object"),Object.assign(t,{args:r},t.opts)}function rP(t,e,n){if(typeof e=="string"){const r=n.time?ZL(qL(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=eP(e,n.color,n.background)}return e}function sP(t){return console.warn("removed"),sn}function iP(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const i=new Image;return i.onload=()=>{const o=qf(i,n,r);console.log(...o)},i.src=e,sn}const s=e.nodeName||"";if(s.toLowerCase()==="img")return console.log(...qf(e,n,r)),sn;if(s.toLowerCase()==="canvas"){const i=new Image;return i.onload=()=>console.log(...qf(i,n,r)),i.src=e.toDataURL(),sn}return sn}function oP(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const se=new u0({id:"deck"});let lm={};function aP(t){lm=t}function st(t,e,n,r){se.level>0&&lm[t]&&lm[t].call(null,e,n,r)}function cP(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const lP={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:cP,parseTextSync:JSON.parse};function uP(){const t="8.9.33",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(se.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:se,_registerLoggers:aP},kO([lP,[Tb,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const hP=uP(),ee={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ee,"IDENTITY",{get:()=>(se.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const tr={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},um={common:0,meters:1,pixels:2},D1={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},z=new u0({id:"luma.gl"});function dt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const fP="Invalid WebGLRenderingContext",dP="Requires WebGL2";function Xh(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Y(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function gP(t){return Y(t)?t:null}function $h(t){return dt(Xh(t),fP),t}function gt(t){return dt(Y(t),dP),t}const Aa={};function mP(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function pP(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function AP(t,e){Aa[t]=!0,e!==void 0&&mP(e)}function _P(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Aa[r]=!0);while(r!==0);for(r in Aa)if(Aa[r])return delete Aa[r],parseInt(r,10);return 0}}const Mc=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const s=new t.VertexAttrib(n);this.attribs[r]=s}this.maxAttrib=0};Mc.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Mc.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const ii=function(e){const n=this;this.gl=e,_P(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(i){return i===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(i){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,i);const a=o.attribs[i];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(i){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,i);const a=o.attribs[i];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(i,o){switch(i){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(i,o){const c=n.currentVertexArrayObject.attribs[i];switch(o){case 34975:return c.buffer;case 34338:return c.enabled;case 34339:return c.size;case 34340:return c.stride;case 34341:return c.type;case 34922:return c.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(i,o,a,c,l,u){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,i);const f=h.attribs[i];return f.buffer=n.currentArrayBuffer,f.size=o,f.type=a,f.normalized=c,f.stride=l,f.offset=u,f.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{pP("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};ii.prototype.VERTEX_ARRAY_BINDING_OES=34229;ii.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Mc(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};ii.prototype.createVertexArrayOES=function(){const e=new Mc(this);return this.vertexArrayObjects.push(e),e};ii.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};ii.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Mc&&e.hasBeenBound&&e.ext===this)};ii.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){AP(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,s=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const i=this.currentVertexArrayObject;if(s===i)return;(!s||i.elementArrayBuffer!==s.elementArrayBuffer)&&r.bindBuffer.call(n,34963,i.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(s?s.maxAttrib:0,i.maxAttrib);for(let c=0;c<=a;c++){const l=i.attribs[c],u=s?s.attribs[c]:null;if((!s||l.enabled!==u.enabled)&&(l.enabled?r.enableVertexAttribArray.call(n,c):r.disableVertexAttribArray.call(n,c)),l.enabled){let h=!1;(!s||l.buffer!==u.buffer)&&(o!==l.buffer&&(r.bindBuffer.call(n,34962,l.buffer),o=l.buffer),h=!0),(h||l.cached!==u.cached)&&r.vertexAttribPointer.call(n,c,l.size,l.type,l.normalized,l.stride,l.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function yP(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const s=e.call(this)||[];return s.indexOf("OES_vertex_array_object")<0&&s.push("OES_vertex_array_object"),s};const n=t.getExtension;t.getExtension=function(s){const i=n.call(this,s);return i||(s!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new ii(this)),this.__OESVertexArrayObject))}}const N1="OES_element_index",U1="WEBGL_draw_buffers",EP="EXT_disjoint_timer_query",TP="EXT_disjoint_timer_query_webgl2",vP="EXT_texture_filter_anisotropic",G1="WEBGL_debug_renderer_info",CP=35723,BP=4352,bP=36795,SP=34047,wP=37445,IP=37446,pe=t=>Y(t)?void 0:0,MP={3074:t=>Y(t)?void 0:36064,[CP]:t=>Y(t)?void 0:BP,35977:pe,32937:pe,[bP]:(t,e)=>{const n=Y(t)?t.getExtension(TP):t.getExtension(EP);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[wP]:(t,e)=>{const n=t.getExtension(G1);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[IP]:(t,e)=>{const n=t.getExtension(G1);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[SP]:(t,e)=>{const n=t.luma.extensions[vP];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:pe,35071:pe,37447:pe,36063:(t,e)=>{if(!Y(t)){const n=t.getExtension(U1);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:pe,35374:pe,35377:pe,34852:t=>{if(!Y(t)){const e=t.getExtension(U1);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(N1)?2147483647:65535,33001:t=>t.getExtension(N1)?16777216:65535,33e3:t=>16777216,37157:pe,35373:pe,35657:pe,36183:pe,37137:pe,34045:pe,35978:pe,35979:pe,35968:pe,35376:pe,35375:pe,35659:pe,37154:pe,35371:pe,35658:pe,35076:pe,35077:pe,35380:pe};function RP(t,e,n){const r=MP[n],s=typeof r=="function"?r(t,e,n):r;return s!==void 0?s:e(n)}const xP="OES_vertex_array_object",Sb="ANGLE_instanced_arrays",OP="WEBGL_draw_buffers",LP="EXT_disjoint_timer_query",PP="EXT_texture_filter_anisotropic",FP="VertexArray requires WebGL2 or OES_vertex_array_object extension";function DP(t,e){return{webgl2:Y(t),ext:t.getExtension(e)}}const wb={[xP]:{meta:{suffix:"OES"},createVertexArray:()=>{dt(!1,FP)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[Sb]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){dt(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[OP]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{dt(!1)}},[LP]:{meta:{suffix:"EXT"},createQuery:()=>{dt(!1)},deleteQuery:()=>{dt(!1)},beginQuery:()=>{dt(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},Zf={readBuffer:(t,e,n)=>{Y(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:s,ext:i}=DP(t,Sb);let o;switch(r){case 35069:o=s?void 0:!1;break;case 35070:o=!s&&!i?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Y(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,s)=>{if(!Y(t))switch(s){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,s)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:s}=t.luma,i=s[PP];r=i&&i.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:RP,hint(t,e,n,r){return e(n,r)}};function NP(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(yP(t),UP(t),kP(t,wb),GP(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=NP;function UP(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function GP(t,e){let{target:n,target2:r}=e;Object.keys(Zf).forEach(s=>{if(typeof Zf[s]=="function"){const i=t[s]?t[s].bind(t):()=>{},o=Zf[s].bind(null,t,i);n[s]=o,r[s]=o}})}function kP(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&HP(t,{extension:n,target:t.luma,target2:t})}function HP(t,e){let{extension:n,target:r,target2:s}=e;const i=wb[n];dt(i);const{meta:o={}}=i,{suffix:a=""}=o,c=t.getExtension(n);for(const l of Object.keys(i)){const u="".concat(l).concat(a);let h=null;l==="meta"||typeof t[l]=="function"||(c&&typeof c[u]=="function"?h=function(){return c[u](...arguments)}:typeof i[l]=="function"&&(h=i[l].bind(r))),h&&(r[l]=h,s[l]=h)}}const h0={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Vr=(t,e,n)=>e?t.enable(n):t.disable(n),k1=(t,e,n)=>t.hint(n,e),Ot=(t,e,n)=>t.pixelStorei(n,e),VP=(t,e)=>{const n=Y(t)?36009:36160;return t.bindFramebuffer(n,e)},jP=(t,e)=>t.bindFramebuffer(36008,e);function Ko(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const zP={3042:Vr,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Vr,2885:(t,e)=>t.cullFace(e),2929:Vr,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Vr,35723:k1,36006:VP,2886:(t,e)=>t.frontFace(e),33170:k1,2849:(t,e)=>t.lineWidth(e),32823:Vr,32824:"polygonOffset",10752:"polygonOffset",35977:Vr,32938:"sampleCoverage",32939:"sampleCoverage",3089:Vr,3088:(t,e)=>t.scissor(...e),2960:Vr,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Ot,3317:Ot,37440:Ot,37441:Ot,37443:Ot,3330:Ot,3332:Ot,3331:Ot,36010:jP,3314:Ot,32878:Ot,3316:Ot,3315:Ot,32877:Ot,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Ko(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Ko(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Ko(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Ko(e)&&e.length===3?[...e,...e]:e;const[n,r,s,i,o,a]=e;t.stencilFuncSeparate(1028,n,r,s),t.stencilFuncSeparate(1029,i,o,a)},stencilOp:(t,e)=>{e=Ko(e)&&e.length===3?[...e,...e]:e;const[n,r,s,i,o,a]=e;t.stencilOpSeparate(1028,n,r,s),t.stencilOpSeparate(1029,i,o,a)},viewport:(t,e)=>t.viewport(...e)};function Ie(t,e,n){return e[t]!==void 0?e[t]:n[t]}const JP={blendEquation:(t,e,n)=>t.blendEquationSeparate(Ie(32777,e,n),Ie(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Ie(32969,e,n),Ie(32968,e,n),Ie(32971,e,n),Ie(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Ie(32824,e,n),Ie(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Ie(32938,e,n),Ie(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Ie(2962,e,n),Ie(2967,e,n),Ie(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Ie(34816,e,n),Ie(36003,e,n),Ie(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Ie(2964,e,n),Ie(2965,e,n),Ie(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Ie(34817,e,n),Ie(34818,e,n),Ie(34819,e,n))},H1={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,s)=>t({32773:new Float32Array([e,n,r,s])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,s)=>t({32969:e,32968:n,32971:r,32970:s}),clearColor:(t,e,n,r,s)=>t({3106:new Float32Array([e,n,r,s])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,s)=>t({3107:[e,n,r,s]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,s)=>t({3088:new Int32Array([e,n,r,s])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,s)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:s}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,s)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:s}),viewport:(t,e,n,r,s)=>t({2978:[e,n,r,s]})},zn=(t,e)=>t.isEnabled(e),V1={3042:zn,2884:zn,2929:zn,3024:zn,32823:zn,32926:zn,32928:zn,3089:zn,2960:zn,35977:zn};function Ib(t){for(const e in t)return!1;return!0}function XP(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}return!1}function j1(t,e){const n=t[e].bind(t);t[e]=function(){const s=arguments.length<=0?void 0:arguments[0];return s in t.state.cache?t.state.enable?t.state.cache[s]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function $P(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];const{valueChanged:c,oldValue:l}=n(t.state._updateCache,...o);return c&&r(...o),l},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function WP(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class KP{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?QP(e):Object.assign({},h0),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){dt(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Pr(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const s=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const i in e){dt(i!==void 0);const o=e[i],a=this.cache[i];XP(o,a)||(n=!0,r=a,s&&!(i in s)&&(s[i]=a),this.cache[i]=o)}return{valueChanged:n,oldValue:r}}}function Mb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(dt(r!==void 0),!t.state){const{polyfillContext:s}=globalThis;s&&s(t),t.state=new KP(t,{copyState:r}),WP(t);for(const i in H1){const o=H1[i];$P(t,i,o)}j1(t,"getParameter"),j1(t,"isEnabled")}return t.state.enable=n,t}function YP(t){t.state||Mb(t,{copyState:!1}),t.state.push()}function z1(t){dt(t.state),t.state.pop()}function Pr(t,e){if(dt(Xh(t),"setParameters requires a WebGL context"),Ib(e))return;const n={};for(const s in e){const i=Number(s),o=zP[s];o&&(typeof o=="string"?n[o]=!0:o(t,e[s],i))}const r=t.state&&t.state.cache;if(r)for(const s in n){const i=JP[s];i(t,e,r)}}function QP(t,e){if(e=e||h0,typeof e=="number"){const s=e,i=V1[s];return i?i(t,s):t.getParameter(s)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const s of n){const i=V1[s];r[s]=i?i(t,Number(s)):t.getParameter(Number(s))}return r}function qP(t){Pr(t,h0)}function On(t,e,n){if(Ib(e))return n(t);const{nocatch:r=!0}=e;YP(t),Pr(t,e);let s;if(r)s=n(t),z1(t);else try{s=n(t)}finally{z1(t)}return s}function uo(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function ed(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=uo(t),s=t.drawingBufferWidth,i=t.drawingBufferHeight;return e3(e,r,s,i,n)}function ZP(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function e3(t,e,n,r,s){const i=J1(t[0],e,n);let o=X1(t[1],e,r,s),a=J1(t[0]+1,e,n);const c=a===n-1?a:a-1;a=X1(t[1]+1,e,r,s);let l;return s?(a=a===0?a:a+1,l=o,o=a):l=a===r-1?a:a-1,{x:i,y:o,width:Math.max(c-i+1,1),height:Math.max(l-o+1,1)}}function J1(t,e,n){return Math.min(Math.round(t*e),n-1)}function X1(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const f0=Ur(),t3=f0&&typeof document<"u",Rb={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function xb(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};dt(f0,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},Rb,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let s;const{canvas:i}=t,o=i3({canvas:i,width:e,height:n,onError:r});return s=s3(o,t),s?(s=d0(s,t),o3(s),s):null}function d0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||a3(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Rb,e);const{manageState:n,debug:r}=e;return n&&Mb(t,{copyState:!1,log:function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return z.log(1,...i)()}}),f0&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),z.level=Math.max(z.level,1)):z.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function n3(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),s=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),i=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:s||e,renderer:i||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function r3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=ZP(e.useDevicePixels);c3(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function s3(t,e){const{onError:n}=e;let r=null;const s=c=>r=c.statusMessage||r;t.addEventListener("webglcontextcreationerror",s,!1);const{webgl1:i=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),i&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",s,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!i?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function i3(t){let{canvas:e,width:n=800,height:r=600,onError:s}=t,i;return typeof e=="string"?(t3&&document.readyState==="complete"||s("createGLContext called on canvas '".concat(e,"' before page was loaded")),i=document.getElementById(e)):e?i=e:(i=document.createElement("canvas"),i.id="lumagl-canvas",i.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",i.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(i,document.body.firstChild)),i}function o3(t){const e=Y(t)?"WebGL2":"WebGL1",n=n3(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",s=t.debug?" debug":"";z.info(1,"".concat(e).concat(s," context ").concat(r))()}function a3(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function c3(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,s="height"in n?n.height:t.canvas.clientHeight;(!r||!s)&&(z.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,s=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const i=t.luma.canvasSizeInfo;if(i.clientWidth!==r||i.clientHeight!==s||i.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),c=Math.floor(s*o);t.canvas.width=a,t.canvas.height=c,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==c)&&(z.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/s),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(s*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:s,devicePixelRatio:e})}}function $1(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let W1=class{constructor(e,n){g(this,"name",void 0),g(this,"type",void 0),g(this,"sampleSize",1),g(this,"time",void 0),g(this,"count",void 0),g(this,"samples",void 0),g(this,"lastTiming",void 0),g(this,"lastSampleTime",void 0),g(this,"lastSampleCount",void 0),g(this,"_count",0),g(this,"_time",0),g(this,"_samples",0),g(this,"_startTime",0),g(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=$1(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime($1()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},g0=class{constructor(e){g(this,"id",void 0),g(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof W1?this.stats[n]=e:this.stats[n]=new W1(n,r)),this.stats[n]}};const Fa="8.5.21",l3="set luma.log.level=1 (or higher) to trace rendering";class u3{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new g0({id:e})),this.stats.get(e)}}const Ns=new u3;if(globalThis.luma&&globalThis.luma.VERSION!==Fa)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Fa));globalThis.luma||(Ur()&&z.log(1,"luma.gl ".concat(Fa," - ").concat(l3))(),globalThis.luma=globalThis.luma||{VERSION:Fa,version:Fa,log:z,stats:Ns,globals:{modules:{},nodeIO:{}}});function h3(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function f3(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function k(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function td(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return k(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function fs(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const nd={};function Fr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";nd[t]=nd[t]||1;const e=nd[t]++;return"".concat(t,"-").concat(e)}function K1(t){return k(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function ho(t){let e=!0;for(const n in t){e=!1;break}return e}function Ob(t,e,n,r){const s="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),i=Object.getPrototypeOf(t);r.forEach(o=>{i.methodName||(i[o]=()=>{throw z.removed("Calling removed method ".concat(e,".").concat(o,": "),s)(),new Error(o)})})}const mi="Resource subclass must define virtual methods";let Gr=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};$h(e);const{id:r,userData:s={}}=n;this.gl=e,this.gl2=e,this.id=r||Fr(this[Symbol.toStringTag]),this.userData=s,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=td(this.gl,e),k(e);const s=(this.constructor.PARAMETERS||{})[e];if(s){const i=Y(this.gl);if(!((!("webgl2"in s)||i)&&(!("extension"in s)||this.gl.getExtension(s.extension)))){const a=s.webgl1,c="webgl2"in s?s.webgl2:s.webgl1;return i?c:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,s=this.constructor.PARAMETERS||{},i=Y(this.gl),o={},a=n||Object.keys(s);for(const c of a){const l=s[c];if(l&&(!("webgl2"in l)||i)&&(!("extension"in l)||this.gl.getExtension(l.extension))){const h=r?fs(this.gl,c):c;o[h]=this.getParameter(c,e),r&&l.type==="GLenum"&&(o[h]=fs(this.gl,o[h]))}}return o}setParameter(e,n){e=td(this.gl,e),k(e);const s=(this.constructor.PARAMETERS||{})[e];if(s){const i=Y(this.gl);if(!((!("webgl2"in s)||i)&&(!("extension"in s)||this.gl.getExtension(s.extension))))throw new Error("Parameter not available on this platform");s.type==="GLenum"&&(n=td(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return Ob(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(mi)}_deleteHandle(){throw new Error(mi)}_bindHandle(e){throw new Error(mi)}_getOptsFromHandle(){throw new Error(mi)}_getParameter(e,n){throw new Error(mi)}_setParameter(e,n){throw new Error(mi)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Ns.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Ns.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const s=Ns.get("Memory Usage".concat(r));s.get("GPU Memory").addCount(e),s.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=Ns.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const d3="Failed to deduce GL constant from typed array";function hm(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(d3)}}function cc(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function g3(t){let{data:e,width:n,height:r,bytesPerPixel:s=4,temp:i}=t;const o=n*s;i=i||new Uint8Array(o);for(let a=0;a<r/2;++a){const c=a*o,l=(r-a-1)*o;i.set(e.subarray(c,c+o)),e.copyWithin(c,l,l+o),e.set(i,l)}}function m3(t){let{data:e,width:n,height:r}=t;const s=Math.round(n/2),i=Math.round(r/2),o=new Uint8Array(s*i*4);for(let a=0;a<i;a++)for(let c=0;c<s;c++)for(let l=0;l<4;l++)o[(a*s+c)*4+l]=e[(a*2*n+c*2)*4+l];return{data:o,width:s,height:i}}function fm(t,e,n){const{removedProps:r={},deprecatedProps:s={},replacedProps:i={}}=n;for(const a in r)if(a in e){const l=r[a]?"".concat(t,".").concat(r[a]):"N/A";z.removed("".concat(t,".").concat(a),l)()}for(const a in s)if(a in e){const c=s[a];z.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))()}let o=null;for(const a in i)if(a in e){const c=i[a];z.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))(),o=o||Object.assign({},e),o[c]=e[a],delete o[a]}return o||e}const p3={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},A3={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Ct{static getBytesPerElement(e){return cc(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return k(e.size),cc(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Ct(p3,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(s=>this._assign(s)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Ct.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Ct.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=fm("Accessor",e,A3),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const Y1=10,Lb={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},_3={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Lb},y3={removedProps:Lb};class ge extends Gr{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ct.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ct.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=fm("Buffer",e,_3),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=fm("Buffer",e,y3),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Ct(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:s=0}=e,i=e.byteLength||e.length;k(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),s!==0||i!==void 0?(gt(this.gl),this.gl.bufferSubData(this.target,r,n,s,i)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:s=0,size:i}=e;const{gl:o}=this;return gt(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,s,i),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:s=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt(this.gl);const i=cc(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let c,l;e?(l=e.length,c=l-a):(c=Math.min(o,s||o),l=a+c);const u=Math.min(o,c);return s=s||u,k(s<=u),e=e||new i(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,s),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?s!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,s):(k(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(Y1,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;k(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const s=this._getTarget();this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,r,this.usage),this.gl.bufferSubData(s,n,e),this.gl.bindBuffer(s,null),this.debugData=e.slice(0,Y1),this.bytesUsed=r,this._trackAllocatedMemory(r);const i=hm(e);return k(i),this.setAccessor(new Ct(this.accessor,{type:i})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;k(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const s=this._getTarget();return this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,r,n),this.gl.bindBuffer(s,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=cc(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Ct(this.accessor,{type:hm(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return z.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return z.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return z.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return z.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Ct(this.accessor,e),this}}const m0={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},Pb={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},Fb={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function E3(t,e){const n=m0[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Y(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function T3(t,e){const n=m0[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const v3=[9729,9728],Q1=globalThis.WebGLBuffer||function(){};class fo extends Gr{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:s}=n;let i=!0;return r&&(i=i&&E3(e,r),i=i&&(!s||T3(e,r))),i}constructor(e,n){const{id:r=Fr("texture"),handle:s,target:i}=n;super(e,{id:r,handle:s}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(A=>this.initialize(Object.assign({},e,{pixels:A,data:A}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:s=null,format:i=6408,border:o=0,recreate:a=!1,parameters:c={},pixelStore:l={},textureUnit:u=void 0}=e;n||(n=s);let{width:h,height:f,dataFormat:d,type:m,compressed:_=!1,mipmaps:T=!0}=e;const{depth:p=0}=e;return{width:h,height:f,compressed:_,dataFormat:d,type:m}=this._deduceParameters({format:i,type:m,dataFormat:d,compressed:_,data:n,width:h,height:f}),this.width=h,this.height=f,this.depth=p,this.format=i,this.type=m,this.dataFormat=d,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),T&&this._isNPOT()&&(z.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),T=!1,this._updateForNPOT(c)),this.mipmaps=T,this.setImageData({data:n,width:h,height:f,depth:p,format:i,type:m,dataFormat:d,border:o,mipmaps:T,parameters:l,compressed:_}),T&&this.generateMipmap(),this.setParameters(c),a&&(this.data=n),r&&(this._video={video:n,parameters:c,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:s=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:s}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(z.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),On(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:s=0,format:i=this.format,border:o=this.border,offset:a=0,parameters:c={}}=e;let{data:l=null,type:u=this.type,width:h=this.width,height:f=this.height,dataFormat:d=this.dataFormat,compressed:m=!1}=e;l||(l=r),{type:u,dataFormat:d,compressed:m,width:h,height:f}=this._deduceParameters({format:i,type:u,dataFormat:d,compressed:m,data:l,width:h,height:f});const{gl:_}=this;_.bindTexture(this.target,this.handle);let T=null;({data:l,dataType:T}=this._getDataType({data:l,compressed:m}));let p,A=0;if(On(this.gl,c,()=>{switch(T){case"null":_.texImage2D(n,s,i,h,f,o,d,u,l);break;case"typed-array":_.texImage2D(n,s,i,h,f,o,d,u,l,a);break;case"buffer":p=gt(_),p.bindBuffer(35052,l.handle||l),p.texImage2D(n,s,i,h,f,o,d,u,a),p.bindBuffer(35052,null);break;case"browser-object":Y(_)?_.texImage2D(n,s,i,h,f,o,d,u,l):_.texImage2D(n,s,i,d,u,l);break;case"compressed":for(const[y,C]of l.entries())_.compressedTexImage2D(n,y,C.format,C.width,C.height,o,C.data),A+=C.levelSize;break;default:k(!1,"Unknown image data type")}}),T==="compressed")this._trackAllocatedMemory(A,"Texture");else if(l&&l.byteLength)this._trackAllocatedMemory(l.byteLength,"Texture");else{const y=Pb[this.dataFormat]||4,C=Fb[this.type]||1;this._trackAllocatedMemory(this.width*this.height*y*C,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:s=null,x:i=0,y:o=0,width:a=this.width,height:c=this.height,level:l=0,format:u=this.format,type:h=this.type,dataFormat:f=this.dataFormat,compressed:d=!1,offset:m=0,border:_=this.border,parameters:T={}}=e;if({type:h,dataFormat:f,compressed:d,width:a,height:c}=this._deduceParameters({format:u,type:h,dataFormat:f,compressed:d,data:s,width:a,height:c}),k(this.depth===0,"texSubImage not supported for 3D textures"),s||(s=r),s&&s.data){const p=s;s=p.data,a=p.shape[0],c=p.shape[1]}s instanceof ge&&(s=s.handle),this.gl.bindTexture(this.target,this.handle),On(this.gl,T,()=>{if(d)this.gl.compressedTexSubImage2D(n,l,i,o,a,c,u,s);else if(s===null)this.gl.texSubImage2D(n,l,i,o,a,c,f,h,null);else if(ArrayBuffer.isView(s))this.gl.texSubImage2D(n,l,i,o,a,c,f,h,s,m);else if(s instanceof Q1){const p=gt(this.gl);p.bindBuffer(35052,s),p.texSubImage2D(n,l,i,o,a,c,f,h,m),p.bindBuffer(35052,null)}else Y(this.gl)?gt(this.gl).texSubImage2D(n,l,i,o,a,c,f,h,s):this.gl.texSubImage2D(n,l,i,o,f,h,s)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return z.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ge?{data:n.handle,dataType:"buffer"}:n instanceof Q1?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:s,height:i,dataFormat:o,type:a,compressed:c}=e;const l=m0[n];return o=o||l&&l.dataFormat,a=a||l&&l.types[0],c=c||l&&l.compressed,{width:s,height:i}=this._deduceImageSize(r,s,i),{dataFormat:o,type:a,compressed:c,width:s,height:i,format:n,data:r}}_deduceImageSize(e,n,r){let s;return typeof ImageData<"u"&&e instanceof ImageData?s={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?s={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?s={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?s={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?s={width:e.videoWidth,height:e.videoHeight}:e?s={width:n,height:r}:s={width:n>=0?n:1,height:r>=0?r:1},k(s,"Could not deduced texture size"),k(n===void 0||s.width===n,"Deduced texture width does not match supplied width"),k(r===void 0||s.height===r,"Deduced texture height does not match supplied height"),s}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:k(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Y(this.gl)||!this.width||!this.height?!1:!K1(this.width)||!K1(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:v3.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let C3="";function B3(t,e){return k(typeof t=="string"),t=C3+t,new Promise((n,r)=>{try{const s=new Image;s.onload=()=>n(s),s.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),s.crossOrigin=e&&e.crossOrigin||"anonymous",s.src=t}catch(s){r(s)}})}class $t extends fo{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return fo.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};$h(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:B3(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const dm=[34069,34070,34071,34072,34073,34074];class Db extends fo{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};$h(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:s=0,y:i=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:s,y:i,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:s,data:i,border:o=0,format:a=6408,type:c=5121}=e;const{gl:l}=this,u=s||i,h=await Promise.all(dm.map(f=>{const d=u[f];return Promise.all(Array.isArray(d)?d:[d])}));this.bind(),dm.forEach((f,d)=>{h[d].length>1&&this.opts.mipmaps!==!1&&z.warn("".concat(this.id," has mipmap and multiple LODs."))(),h[d].forEach((m,_)=>{n&&r?l.texImage2D(f,_,a,n,r,o,a,c,m):l.texImage2D(f,_,a,a,c,m)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:s,pixels:i,data:o,border:a=0,format:c=6408,type:l=5121}=e,{gl:u}=this,h=i||o;return this.bind(),h instanceof Promise?h.then(f=>this.setImageDataForFace(Object.assign({},e,{face:n,data:f,pixels:f}))):this.width||this.height?u.texImage2D(n,0,c,r,s,a,c,l,h):u.texImage2D(n,0,c,c,l,h),this}}Db.FACES=dm;class b3 extends fo{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Y(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gt(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:s,height:i,depth:o=1,border:a=0,format:c,type:l=5121,offset:u=0,data:h,parameters:f={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),On(this.gl,f,()=>{ArrayBuffer.isView(h)&&this.gl.texImage3D(this.target,n,r,s,i,o,a,c,l,h),h instanceof ge&&(this.gl.bindBuffer(35052,h.handle),this.gl.texImage3D(this.target,n,r,s,i,o,a,c,l,u))}),h&&h.byteLength)this._trackAllocatedMemory(h.byteLength,"Texture");else{const d=Pb[this.dataFormat]||4,m=Fb[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*d*m,"Texture")}return this.loaded=!0,this}}const Ss="EXT_color_buffer_float",q1={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Ss,bpp:2},33327:{gl2:Ss,bpp:4},34842:{gl2:Ss,bpp:8},33326:{gl2:Ss,bpp:4},33328:{gl2:Ss,bpp:8},34836:{gl2:Ss,bpp:16},35898:{gl2:Ss,bpp:4}};function S3(t,e,n){const r=n[e];if(!r)return!1;const s=Y(t)&&r.gl2||r.gl1;return typeof s=="string"?t.getExtension(s):s}class Vi extends Gr{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||S3(e,n,q1)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:s=1,samples:i=0}=e;return k(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),i!==0&&Y(this.gl)?this.gl.renderbufferStorageMultisample(36161,i,n,r,s):this.gl.renderbufferStorage(36161,n,r,s),this.format=n,this.width=r,this.height=s,this.samples=i,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*q1[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const w3=256,I3=1024,M3=16384,Z1=6144,ey=6145,ty=6146,ny=34041,Nb="clear: bad arguments";function p0(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:s=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};e&&(i.framebuffer=e);let o=0;n&&(o|=M3,n!==!0&&(i.clearColor=n)),r&&(o|=w3,r!==!0&&(i.clearDepth=r)),s&&(o|=I3,r!==!0&&(i.clearStencil=r)),k(o!==0,Nb),On(t,i,()=>{t.clear(o)})}function R3(t){let{framebuffer:e=null,buffer:n=Z1,drawBuffer:r=0,value:s=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gt(t),On(t,{framebuffer:e},()=>{switch(n){case Z1:switch(s.constructor){case Int32Array:t.clearBufferiv(n,r,s);break;case Uint32Array:t.clearBufferuiv(n,r,s);break;case Float32Array:default:t.clearBufferfv(n,r,s)}break;case ey:t.clearBufferfv(ey,0,[s]);break;case ty:t.clearBufferiv(ty,0,[s]);break;case ny:const[i,o]=s;t.clearBufferfi(ny,0,i,o);break;default:k(!1,Nb)}})}function x3(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return k(!1),0}}function Wh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:s=6408}=e;let{sourceAttachment:i=36064,target:o=null,sourceWidth:a,sourceHeight:c,sourceType:l}=e;const{framebuffer:u,deleteFramebuffer:h}=O3(t);k(u);const{gl:f,handle:d,attachments:m}=u;a=a||u.width,c=c||u.height,i===36064&&d===null&&(i=1028),k(m[i]),l=l||m[i].type,o=L3(o,l,s,a,c),l=l||hm(o);const _=f.bindFramebuffer(36160,d);return f.readPixels(n,r,a,c,s,l,o),f.bindFramebuffer(36160,_||null),h&&u.delete(),o}function ry(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Wh(t,{sourceAttachment:e}),{width:s,height:i}=t;for(;i>n;)({data:r,width:s,height:i}=m3({data:r,width:s,height:i}));g3({data:r,width:s,height:i});const o=document.createElement("canvas");o.width=s,o.height=i;const a=o.getContext("2d"),c=a.createImageData(s,i);return c.data.set(r),a.putImageData(c,0,0),o.toDataURL()}function O3(t){return t instanceof Je?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:V3(t),deleteFramebuffer:!0}}function L3(t,e,n,r,s){if(t)return t;e=e||5121;const i=cc(e,{clamped:!1}),o=x3(n);return new i(r*s*o)}const Ae={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function P3(t){const e=new $t(t,{format:6408,type:5126,dataFormat:6408}),n=new Je(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const Ub={[Ae.WEBGL2]:[!1,!0],[Ae.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Ae.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Ae.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Ae.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Ae.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Ae.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Ae.FLOAT_BLEND]:["EXT_float_blend"],[Ae.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Ae.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Ae.TEXTURE_FLOAT]:["OES_texture_float",!0],[Ae.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Ae.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Ae.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Ae.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Ae.COLOR_ATTACHMENT_RGBA32F]:[P3,"EXT_color_buffer_float"],[Ae.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Ae.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Ae.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Ae.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Ae.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Ae.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},F3=2;function A0(t,e){return Gb(t,e)}function Gb(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>kb(t,n))}function D3(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Ub)t.luma.caps[e]===void 0&&(t.luma.caps[e]=kb(t,e));return t.luma.caps}function kb(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=N3(t,e)),t.luma.caps[e]||z.log(F3,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function N3(t,e){const n=Ub[e];k(n,e);let r;const s=Y(t)&&n[1]||n[0];if(typeof s=="function")r=s(t);else if(Array.isArray(s)){r=!0;for(const i of s)r=r&&!!t.getExtension(i)}else typeof s=="string"?r=!!t.getExtension(s):typeof s=="boolean"?r=s:k(!1);return r}const sy="Multiple render targets not supported";class Je extends Gr{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:s}=n;let i=!0;return r&&(i=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),s&&(i=i&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Je(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=gt(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=gt(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:s=null,color:i=!0,depth:o=!0,stencil:a=!1,check:c=!0,readBuffer:l=void 0,drawBuffers:u=void 0}=e;if(k(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,s)for(const h in s){const f=s[h];(Array.isArray(f)?f[0]:f).resize({width:n,height:r})}else s=this._createDefaultAttachments(i,o,a,n,r);this.update({clearAttachments:!0,attachments:s,readBuffer:l,drawBuffers:u}),s&&c&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:s,clearAttachments:i=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:i,resizeAttachments:o});const{gl:a}=this,c=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),s&&this._setDrawBuffers(s),a.bindFramebuffer(36160,c||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return k(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&z.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const s in this.attachments)this.attachments[s].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};n&&Object.keys(this.attachments).forEach(o=>{s[o]=null}),Object.assign(s,e);const i=this.gl.bindFramebuffer(36160,this.handle);for(const o in s){k(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),c=s[a];let l=c;if(!l)this._unattach(a);else if(l instanceof Vi)this._attachRenderbuffer({attachment:a,renderbuffer:l});else if(Array.isArray(c)){const[u,h=0,f=0]=c;l=u,this._attachTexture({attachment:a,texture:u,layer:h,level:f})}else this._attachTexture({attachment:a,texture:l,layer:0,level:0});r&&l&&l.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(G3(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:s,drawBuffers:i=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||s)&&p0(this.gl,{color:n,depth:r,stencil:s}),i.forEach((a,c)=>{R3(this.gl,{drawBuffer:c,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return z.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return z.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return z.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return z.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return z.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return z.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:s=0,width:i,height:o}=e;const a=gt(this.gl),c=a.bindFramebuffer(36008,this.handle);return r===0&&s===0&&i===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,s,i,o),a.bindFramebuffer(36008,c),this}getAttachmentParameter(e,n,r){let s=this._getAttachmentParameterFallback(n);return s===null&&(this.gl.bindFramebuffer(36160,this.handle),s=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&s>1e3&&(s=fs(this.gl,s)),s}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const s={};for(const i of r){const o=n?fs(this.gl,i):i;s[o]=this.getAttachmentParameter(e,i,n)}return s}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const s of n){const i=Number(s),o=e?fs(this.gl,i):i;r[o]=this.getAttachmentParameters(i,e)}return r}show(){return typeof window<"u"&&window.open(ry(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>z.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=ry(this,{targetMaxHeight:100});return z.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,s,i){let o=null;return e&&(o=o||{},o[36064]=new $t(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:s,height:i,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new Vi(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:s,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new Vi(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:s,height:i}),this.ownResources.push(o[36096])):r&&k(!1),o}_unattach(e){const n=this.attachments[e];n&&(n instanceof Vi?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:s}=this;s.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:s,level:i}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:gt(o).framebufferTextureLayer(36160,n,r.target,i,s);break;case 34067:const c=U3(s);o.framebufferTexture2D(36160,n,c,r.handle,i);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,i);break;default:k(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=gP(this.gl);n?n.readBuffer(e):k(e===36064||e===1029,sy),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=gt(n);if(r)r.drawBuffers(e);else{const s=n.getExtension("WEBGL_draw_buffers");s?s.drawBuffersWEBGL(e):k(e.length===1&&(e[0]===36064||e[0]===1029),sy)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=D3(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function U3(t){return t<34069?t+34069:t}function G3(t){return(Je.STATUS||{})[t]||"Framebuffer error ".concat(t)}const k3=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Je.ATTACHMENT_PARAMETERS=k3;function H3(t,e){k(t instanceof $t||t instanceof Db||t instanceof b3);const n=t.constructor,{gl:r,width:s,height:i,format:o,type:a,dataFormat:c,border:l,mipmaps:u}=t,h=Object.assign({width:s,height:i,format:o,type:a,dataFormat:c,border:l,mipmaps:u},e);return new n(r,h)}function V3(t,e){const{gl:n,width:r,height:s,id:i}=t;return new Je(n,Object.assign({},e,{id:"framebuffer-for-".concat(i),width:r,height:s,attachments:{36064:t}}))}function _u(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const j3=35632,z3=35633;function J3(t){switch(t){case j3:return"fragment";case z3:return"vertex";default:return"unknown type"}}function X3(t,e,n,r){const s=t.split(/\r?\n/),i={},o={},a=r||_u(e)||"(unnamed)",c="".concat(J3(n)," shader ").concat(a);for(let u=0;u<s.length;u++){const h=s[u];if(h.length<=1)continue;const f=h.split(":"),d=f[0],m=parseInt(f[2],10);if(isNaN(m))throw new Error("GLSL compilation error in ".concat(c,": ").concat(t));d!=="WARNING"?i[m]=h:o[m]=h}const l=$3(e);return{shaderName:c,errors:iy(i,l),warnings:iy(o,l)}}function iy(t,e){let n="";for(let r=0;r<e.length;r++){const s=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(s,`
`),t[r+1])){const i=t[r+1],o=i.split(":",3),a=o[0],c=parseInt(o[1],10)||0,l=i.substring(o.join(":").length+1).trim();n+=Hb("^^^ ".concat(a,": ").concat(l,`

`),c)}}return n}function $3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),s=String(r.length+e-1).length;return r.map((i,o)=>{const a=String(o+e),c=a.length;return Hb(a,s-c)+n+i})}function Hb(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function Vb(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const W3="Shader: GLSL source code must be a JavaScript string";class lc extends Gr{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return k(!1),"unknown"}}constructor(e,n){$h(e),k(typeof n.source=="string",W3);const r=_u(n.source,null)||n.id||Fr("unnamed ".concat(lc.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=_u(n,null);r&&(this.id=Fr(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(lc.getTypeName(this.shaderType),":").concat(this.id)}getName(){return _u(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:s,errors:i,warnings:o}=X3(r,this.source,this.shaderType,this.id);throw z.error("GLSL compilation errors in ".concat(s,`
`).concat(i))(),z.warn("GLSL compilation warnings in ".concat(s,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(s))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class rd extends lc{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class sd extends lc{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const K3={5126:ye.bind(null,"uniform1fv",Lt,1,rt),35664:ye.bind(null,"uniform2fv",Lt,2,rt),35665:ye.bind(null,"uniform3fv",Lt,3,rt),35666:ye.bind(null,"uniform4fv",Lt,4,rt),5124:ye.bind(null,"uniform1iv",jr,1,rt),35667:ye.bind(null,"uniform2iv",jr,2,rt),35668:ye.bind(null,"uniform3iv",jr,3,rt),35669:ye.bind(null,"uniform4iv",jr,4,rt),35670:ye.bind(null,"uniform1iv",jr,1,rt),35671:ye.bind(null,"uniform2iv",jr,2,rt),35672:ye.bind(null,"uniform3iv",jr,3,rt),35673:ye.bind(null,"uniform4iv",jr,4,rt),35674:ye.bind(null,"uniformMatrix2fv",Lt,4,fr),35675:ye.bind(null,"uniformMatrix3fv",Lt,9,fr),35676:ye.bind(null,"uniformMatrix4fv",Lt,16,fr),35678:Qe,35680:Qe,5125:ye.bind(null,"uniform1uiv",pl,1,rt),36294:ye.bind(null,"uniform2uiv",pl,2,rt),36295:ye.bind(null,"uniform3uiv",pl,3,rt),36296:ye.bind(null,"uniform4uiv",pl,4,rt),35685:ye.bind(null,"uniformMatrix2x3fv",Lt,6,fr),35686:ye.bind(null,"uniformMatrix2x4fv",Lt,8,fr),35687:ye.bind(null,"uniformMatrix3x2fv",Lt,6,fr),35688:ye.bind(null,"uniformMatrix3x4fv",Lt,12,fr),35689:ye.bind(null,"uniformMatrix4x2fv",Lt,8,fr),35690:ye.bind(null,"uniformMatrix4x3fv",Lt,12,fr),35678:Qe,35680:Qe,35679:Qe,35682:Qe,36289:Qe,36292:Qe,36293:Qe,36298:Qe,36299:Qe,36300:Qe,36303:Qe,36306:Qe,36307:Qe,36308:Qe,36311:Qe},Y3={},Q3={},q3={},oy=[0];function _0(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(oy[0]=t,t=oy);const s=t.length;if(s%e&&z.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let i=r[s];i||(i=new n(s),r[s]=i);for(let o=0;o<s;o++)i[o]=t[o];return i}function Lt(t,e){return _0(t,e,Float32Array,Y3)}function jr(t,e){return _0(t,e,Int32Array,Q3)}function pl(t,e){return _0(t,e,Uint32Array,q3)}function ay(t,e,n){const r=K3[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function Z3(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function eF(t,e,n){for(const r in t){const s=t[r];if((!n||!!n[r])&&!tF(s))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),s),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function tF(t){return Array.isArray(t)||ArrayBuffer.isView(t)?rF(t):isFinite(t)||t===!0||t===!1||t instanceof fo||t instanceof Vi?!0:t instanceof Je?!!t.texture:!1}function nF(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let s=0,i=n.length;s<i;++s)r[s]=n[s]}else t[e]=n.slice();else t[e]=n}function rF(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Qe(){let t=null;return(e,n,r)=>{const s=t!==r;return s&&(e.uniform1i(n,r),t=r),s}}function ye(t,e,n,r){let s=null,i=null;return(o,a,c)=>{const l=e(c,n),u=l.length;let h=!1;if(s===null)s=new Float32Array(u),i=u,h=!0;else{k(i===u,"Uniform length cannot change.");for(let f=0;f<u;++f)if(l[f]!==s[f]){h=!0;break}}return h&&(r(o,t,a,l),s.set(l)),h}}function rt(t,e,n,r){t[e](n,r)}function fr(t,e,n,r){t[e](n,!1,r)}const sF=5120,iF=5121,oF=5122,aF=5123,cy=0,Al=1,cF=2,lF=3,_l=4,uF=5,hF=6,ke=5126,fF=35664,dF=35665,gF=35666,Yo=5124,mF=35667,pF=35668,AF=35669,Qo=5125,_F=36294,yF=36295,EF=36296,TF=35670,vF=35671,CF=35672,BF=35673,bF=35674,SF=35675,wF=35676,IF=35685,MF=35686,RF=35687,xF=35688,OF=35689,LF=35690,gm={[ke]:[ke,1,"float"],[fF]:[ke,2,"vec2"],[dF]:[ke,3,"vec3"],[gF]:[ke,4,"vec4"],[Yo]:[Yo,1,"int"],[mF]:[Yo,2,"ivec2"],[pF]:[Yo,3,"ivec3"],[AF]:[Yo,4,"ivec4"],[Qo]:[Qo,1,"uint"],[_F]:[Qo,2,"uvec2"],[yF]:[Qo,3,"uvec3"],[EF]:[Qo,4,"uvec4"],[TF]:[ke,1,"bool"],[vF]:[ke,2,"bvec2"],[CF]:[ke,3,"bvec3"],[BF]:[ke,4,"bvec4"],[bF]:[ke,8,"mat2"],[IF]:[ke,8,"mat2x3"],[MF]:[ke,8,"mat2x4"],[SF]:[ke,12,"mat3"],[RF]:[ke,12,"mat3x2"],[xF]:[ke,12,"mat3x4"],[wF]:[ke,16,"mat4"],[OF]:[ke,16,"mat4x2"],[LF]:[ke,16,"mat4x3"]};function PF(t){switch(t){case cy:return cy;case Al:return Al;case lF:return Al;case cF:return Al;case _l:return _l;case uF:return _l;case hF:return _l;default:return k(!1),0}}function ly(t){const e=gm[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function jb(t,e){switch(t){case sF:case iF:case oF:case aF:t=ke;break}for(const n in gm){const[r,s,i]=gm[n];if(r===t&&s===e)return{glType:n,name:i}}return null}class FF{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let s=0;s<r;s++){const{name:i,type:o,size:a}=n.getActiveAttrib(e.handle,s),c=n.getAttribLocation(e.handle,i);c>=0&&this._addAttribute(c,i,o,a)}this.attributeInfos.sort((s,i)=>s.location-i.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Y(n))return;const r=n.getProgramParameter(e.handle,35971);for(let s=0;s<r;s++){const{name:i,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,s);this._addVarying(s,i,o,a)}this.varyingInfos.sort((s,i)=>s.location-i.location)}_addAttribute(e,n,r,s){const{type:i,components:o}=ly(r),a={type:i,size:s*o};this._inferProperties(e,n,a);const c={location:e,name:n,accessor:new Ct(a)};this.attributeInfos.push(c),this.attributeInfosByLocation[e]=c,this.attributeInfosByName[c.name]=c}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,s){const{type:i,components:o}=ly(r),a=new Ct({type:i,size:s*o}),c={location:e,name:n,accessor:a};this.varyingInfos.push(c),this.varyingInfosByName[c.name]=c}}const uy=4,DF=35981,NF=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class zb extends Gr{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",NF),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:s,varyings:i,bufferMode:o=DF}=e;return this.hash=n||"",this.vs=typeof r=="string"?new rd(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof s=="string"?new sd(this.gl,{id:"".concat(e.id,"-fs"),source:s}):s,k(this.vs instanceof rd),k(this.fs instanceof sd),this.uniforms={},this._textureUniforms={},i&&i.length>0&&(gt(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new FF(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:s,offset:i=0,start:o,end:a,isIndexed:c=!1,indexType:l=5123,instanceCount:u=0,isInstanced:h=u>0,vertexArray:f=null,transformFeedback:d,framebuffer:m,parameters:_={},uniforms:T,samplers:p}=e;if((T||p)&&(z.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(T||{})),z.priority>=n){const A=m?m.id:"default",y="mode=".concat(fs(this.gl,r)," verts=").concat(s," ")+"instances=".concat(u," indexType=").concat(fs(this.gl,l)," ")+"isInstanced=".concat(h," isIndexed=").concat(c," ")+"Framebuffer=".concat(A);z.log(n,y)()}return k(f),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||s===0||h&&u===0?!1:(f.bindForDraw(s,u,()=>{if(m!==void 0&&(_=Object.assign({},_,{framebuffer:m})),d){const A=PF(r);d.begin(A)}this._bindTextures(),On(this.gl,_,()=>{c&&h?this.gl2.drawElementsInstanced(r,s,l,i,u):c&&Y(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,s,l,i):c?this.gl.drawElements(r,s,l,i):h?this.gl2.drawArraysInstanced(r,i,s,u):this.gl.drawArrays(r,i,s)}),d&&d.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};z.priority>=2&&eF(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],s=this._uniformSetters[n];if(s){let i=r,o=!1;if(i instanceof Je&&(i=i.texture),i instanceof fo)if(o=this.uniforms[n]!==r,o){s.textureIndex===void 0&&(s.textureIndex=this._textureIndexCounter++);const a=i,{textureIndex:c}=s;a.bind(c),i=c,this._textureUniforms[n]=a}else i=s.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(s(i)||o)&&nF(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const s of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new rd({handle:s});break;case 35632:r.fs=new sd({handle:s});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Fr(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),z.time(uy,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),z.timeEnd(uy,"linkProgram for ".concat(this._getName()))(),e.debug||z.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:s}=Z3(r.name);let i=e.getUniformLocation(this.handle,s);if(this._uniformSetters[s]=ay(e,i,r),r.size>1)for(let o=0;o<r.size;o++)i=e.getUniformLocation(this.handle,"".concat(s,"[").concat(o,"]")),this._uniformSetters["".concat(s,"[").concat(o,"]")]=ay(e,i,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const UF=34918,GF=34919,kF=35007,HF=36795,VF=35976,jF=35887,zF=36202;class ih extends Gr{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=Y(e),s=Gb(e,Ae.TIMER_QUERY);let i=r||s;for(const o of n)switch(o){case"queries":i=i&&r;break;case"timers":i=i&&s;break;default:k(!1)}return i}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(kF)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?zF:jF)}beginTransformFeedbackQuery(){return this.begin(VF)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,GF);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(HF)}getResult(){return this.gl2.getQueryParameter(this.handle,UF)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,s)=>{const i=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)}),this._pollingPromise}_createHandle(){return ih.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class Jb extends Gr{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Y(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gt(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,ho(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:s,byteSize:i,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=s,z.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,s,o,i),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,s;return e instanceof ge?s=e:(s=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||s.byteLength-n),{buffer:s,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:s}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,s,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0;const i=n&&n.handle;return!i||s===void 0?this.gl.bindBufferBase(35982,e,i):this.gl.bindBufferRange(35982,e,i,r,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let yl=null;function JF(t){return(!yl||yl.byteLength<t)&&(yl=new ArrayBuffer(t)),yl}function XF(t,e){const n=JF(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function $F(t){let{target:e,source:n,start:r=0,count:s=1}=t;const i=n.length,o=s*i;let a=0;for(let c=r;a<i;a++)e[c++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const WF="elements must be GL.ELEMENT_ARRAY_BUFFER";class Nt extends Gr{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Y(e)||Bb()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Nt(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Nt.MAX_ATTRIBUTES=Nt.MAX_ATTRIBUTES||e.getParameter(34921),Nt.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Nt._setConstantFloatArray(e,n,r);break;case Int32Array:Nt._setConstantIntArray(e,n,r);break;case Uint32Array:Nt._setConstantUintArray(e,n,r);break;default:k(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Nt.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return k(!e||e.target===34963,WF),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:s,type:i,stride:o,offset:a,normalized:c,integer:l,divisor:u}=r,{gl:h,gl2:f}=this;return e=Number(e),this.bind(()=>{h.bindBuffer(34962,n.handle),l?(k(Y(h)),f.vertexAttribIPointer(e,s,i,o,a)):h.vertexAttribPointer(e,s,i,c,o,a),h.enableVertexAttribArray(e),f.vertexAttribDivisor(e,u||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Nt.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),s=r.byteLength*e,i=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new ge(this.gl,s),o=o||this.buffer.reallocate(s),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=XF(n.constructor,i);$F({target:a,source:r,start:0,count:i}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:k(!1)}}static _setConstantIntArray(e,n,r){switch(k(Y(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:k(!1)}}static _setConstantUintArray(e,n,r){switch(k(Y(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:k(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return k(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const KF="VertexArray: attributes must be Buffers or constants (i.e. typed array)",YF=/^(.+)__LOCATION_([0-9]+)$/,QF=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class qF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Nt(e),Ob(this,"VertexArray","v6.0",QF),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:s,accessor:i}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return s>=0&&(this.values[s]=n,this.accessors[s]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(s,n,i)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:s,accessor:i}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return s>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[s]=n,this.accessors[s]=i,this.clearDrawParams(),this.vertexArrayObject.enable(s,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ge(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ge&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ge&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let s;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),s=r()}),s}_resolveLocationAndAccessor(e,n,r,s){const i={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,z.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),i;const c=this._getAttributeInfo(a||o);if(!c)return i;const l=this.accessors[o]||{},u=Ct.resolve(c.accessor,l,r,s),{size:h,type:f}=u;return k(Number.isFinite(h)&&Number.isFinite(f)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=YF.exec(e),s=r?r[1]:e,i=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(s)+i,name:s}:{location:-1}}_setAttribute(e,n){if(n instanceof ge)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ge){const r=n[0],s=n[1];this.setBuffer(e,r,s)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof ge){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(KF)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let s=this.values[0];ArrayBuffer.isView(s)&&this._setConstantAttributeZero(s,r);for(let i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)s=this.values[i],ArrayBuffer.isView(s)&&this._setConstantAttribute(i,s)}_setConstantAttributeZero(e,n){if(Nt.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Nt.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],s=this.accessors[n];if(!r)return;const{divisor:i}=s,o=i>0;if(e.isInstanced=e.isInstanced||o,r instanceof ge){const a=r;if(o){const c=a.getVertexCount(s);e.instanceCount=Math.min(e.instanceCount,c)}else{const c=a.getVertexCount(s);e.vertexCount=Math.min(e.vertexCount,c)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return z.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function ZF(t,e){const{maxElts:n=16,size:r=1}=e;let s="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(s+=",".concat(o%r===0?" ":"")),s+=uc(t[o],e);const i=t.length>n?"...":"]";return"".concat(s).concat(i)}function uc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return ZF(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const s=t.toPrecision(2);return s.indexOf(".0")===s.length-2?s.slice(0,-1):s}function hy(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:s=!1}=t;k(n);const i=".*_.*",o=".*Matrix",a=n._uniformSetters,c={},l=Object.keys(a).sort();let u=0;for(const d of l)!d.match(i)&&!d.match(o)&&id({table:c,header:e,uniforms:r,uniformName:d,undefinedOnly:s})&&u++;for(const d of l)d.match(o)&&id({table:c,header:e,uniforms:r,uniformName:d,undefinedOnly:s})&&u++;for(const d of l)c[d]||id({table:c,header:e,uniforms:r,uniformName:d,undefinedOnly:s})&&u++;let h=0;const f={};if(!s)for(const d in r){const m=r[d];c[d]||(h++,f[d]={Type:"NOT USED: ".concat(m),[e]:uc(m)})}return{table:c,count:u,unusedTable:f,unusedCount:h}}function id(t){let{table:e,header:n,uniforms:r,uniformName:s,undefinedOnly:i}=t;const o=r[s],a=eD(o);return!i||!a?(e[s]={[n]:a?uc(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function eD(t){return t!=null}function tD(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=fy(e,e.elements,null,n));const s=e.values;for(const i in s){const o=e._getAttributeInfo(i);if(o){let a="".concat(i,": ").concat(o.name);const c=e.accessors[o.location];c&&(a="".concat(i,": ").concat(nD(o.name,c))),r[a]=fy(e,s[i],c,n)}}return r}function fy(t,e,n,r){const{gl:s}=t;if(!e)return{[r]:"null","Format ":"N/A"};let i="NOT PROVIDED",o=1,a=0,c=0,l,u,h;if(n&&(i=n.type,o=n.size,i=String(i).replace("Array",""),l=i.indexOf("nt")!==-1),e instanceof ge){const f=e,{data:d,changed:m}=f.getDebugData();u=m?"*":"",h=d,c=f.byteLength,a=c/d.BYTES_PER_ELEMENT/o;let _;if(n){const T=n.divisor>0;_="".concat(T?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(c," bytes ").concat(fs(s,i),")")}else l=!0,_="".concat(c," bytes");return{[r]:"".concat(u).concat(uc(h,{size:o,isInteger:l})),"Format ":_}}return h=e,o=e.length,i=String(e.constructor.name).replace("Array",""),l=i.indexOf("nt")!==-1,{[r]:"".concat(uc(h,{size:o,isInteger:l})," (constant)"),"Format ":"".concat(o,"x").concat(i," (constant)")}}function nD(t,e){const{type:n,size:r}=e,s=jb(n,r);return s?"".concat(t," (").concat(s.name,")"):t}function rD(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const s=dy(r);e["in ".concat(s)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const s=dy(r);e["out ".concat(s)]={[n]:JSON.stringify(r.accessor)}}return e}function dy(t){const{type:e,size:n}=t.accessor,r=jb(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const gy=Ur()&&typeof document<"u";let sD=0;class iD{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=T=>xb(T),onAddHTML:r=null,onInitialize:s=()=>{},onRender:i=()=>{},onFinalize:o=()=>{},onError:a,gl:c=null,glOptions:l={},debug:u=!1,createFramebuffer:h=!1,autoResizeViewport:f=!0,autoResizeDrawingBuffer:d=!0,stats:m=Ns.get("animation-loop-".concat(sD++))}=e;let{useDevicePixels:_=!0}=e;"useDevicePixelRatio"in e&&(z.deprecated("useDevicePixelRatio","useDevicePixels")(),_=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:s,onRender:i,onFinalize:o,onError:a,gl:c,glOptions:l,debug:u,createFramebuffer:h},this.gl=c,this.needsRedraw=null,this.timeline=null,this.stats=m,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:f,autoResizeDrawingBuffer:d,useDevicePixels:_}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return k(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=ih.isSupported(this.gl,["timers"])?new ih(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return z.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=gy?new Promise((e,n)=>{if(gy&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):f3(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):h3(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?d0(this.props.gl,e):this.onCreateContext(e),!Xh(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");qP(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:s}=this.gl;return s&&s.clientHeight?r=s.clientWidth/s.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&r3(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Je(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Rc="vs",y0="fs";function Jt(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const od={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function oD(t){const e={};for(const n in t){const r=t[n],s=aD(r);e[n]=s}return e}function aD(t){let e=my(t);return e==="object"?t?"type"in t?Object.assign({},t,od[t.type]):"value"in t?(e=my(t.value),Object.assign({type:e},t,od[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},od[e])}function my(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const cD="vs",lD="fs";class py{constructor(e){let{name:n,vs:r,fs:s,dependencies:i=[],uniforms:o,getUniforms:a,deprecations:c=[],defines:l={},inject:u={},vertexShader:h,fragmentShader:f}=e;Jt(typeof n=="string"),this.name=n,this.vs=r||h,this.fs=s||f,this.getModuleUniforms=a,this.dependencies=i,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=l,this.injections=uD(u),o&&(this.uniforms=oD(o))}getModuleSource(e){let n;switch(e){case cD:n=this.vs||"";break;case lD:n=this.fs||"";break;default:Jt(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const s in r){const i=r[s];s in e&&!i.private?(i.validate&&Jt(i.validate(e[s],i),"".concat(this.name,": invalid ").concat(s)),n[s]=e[s]):n[s]=i.value}return n}}function uD(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const s=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[s][n]=r}return e}function hD(t){return fD($b(t))}function fD(t){const e={},n={};return Xb({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,s)=>n[s]-n[r]).map(r=>e[r])}function Xb(t){let{modules:e,level:n,moduleMap:r,moduleDepth:s}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const i of e)r[i.name]=i,(s[i.name]===void 0||s[i.name]<n)&&(s[i.name]=n);for(const i of e)i.dependencies&&Xb({modules:i.dependencies,level:n+1,moduleMap:r,moduleDepth:s})}function $b(t,e){return t.map(n=>(n instanceof py||(Jt(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Jt(n.name,"shader module has no name"),n=new py(n),n.dependencies=$b(n.dependencies)),n))}function dD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,s=n.indexOf("Trident/")!==-1;return r||s}const gD=7936,mD=7937,pD=7938,AD=35724,E0={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Ls={};Object.keys(E0).forEach(t=>{Ls[t]=t});function _D(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function yD(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||gD),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||mD);return{gpuVendor:ED(n,r),vendor:n,renderer:r,version:t.getParameter(pD),shadingLanguageVersion:t.getParameter(AD)}}function ED(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const ad={};function Ay(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=E0[e];if(Jt(r,e),!dD(n))return!0;if(e in ad)return ad[e];const s=r[0],i=n.behavior||"enable",o="#extension GL_".concat(s," : ").concat(i,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const c=t.getShaderParameter(a,35713);return t.deleteShader(a),ad[e]=c,c}function TD(t,e){const n=E0[e];Jt(n,e);const r=_D(t)&&n[1]||n[0],s=typeof r=="string"?!!t.getExtension(r):r;return Jt(s===!1||s===!0),s}function El(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>TD(t,n))}function vD(t){switch(yD(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function CD(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return El(t,Ls.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),El(t,Ls.GLSL_DERIVATIVES)&&Ay(t,Ls.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),El(t,Ls.GLSL_FRAG_DATA)&&Ay(t,Ls.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),El(t,Ls.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const BD=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,bD=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,SD={[Rc]:BD,[y0]:bD},yu="__LUMA_INJECT_DECLARATIONS__",_y=/void\s+main\s*\([^)]*\)\s*\{\n?/,yy=/}\n?[^{}]*$/,cd=[];function Ey(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=e===Rc;for(const i in n){const o=n[i];o.sort((c,l)=>c.order-l.order),cd.length=o.length;for(let c=0,l=o.length;c<l;++c)cd[c]=o[c].injection;const a="".concat(cd.join(`
`),`
`);switch(i){case"vs:#decl":s&&(t=t.replace(yu,a));break;case"vs:#main-start":s&&(t=t.replace(_y,c=>c+a));break;case"vs:#main-end":s&&(t=t.replace(yy,c=>a+c));break;case"fs:#decl":s||(t=t.replace(yu,a));break;case"fs:#main-start":s||(t=t.replace(_y,c=>c+a));break;case"fs:#main-end":s||(t=t.replace(yy,c=>a+c));break;default:t=t.replace(i,c=>c+a)}}return t=t.replace(yu,""),r&&(t=t.replace(/\}\s*$/,i=>i+SD[e])),t}function mm(t){const e={};return Jt(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function go(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const Wb=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],wD=[...Wb,[go("attribute"),"in $1"],[go("varying"),"out $1"]],ID=[...Wb,[go("varying"),"in $1"]],Kb=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],MD=[...Kb,[go("in"),"attribute $1"],[go("out"),"varying $1"]],RD=[...Kb,[go("in"),"varying $1"]],pm="gl_FragColor",Am=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,xD=/void\s+main\s*\([^)]*\)\s*\{\n?/;function OD(t,e,n){switch(e){case 300:return n?oh(t,wD):LD(t);case 100:return n?oh(t,MD):PD(t);default:throw new Error("unknown GLSL version ".concat(e))}}function oh(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function LD(t){t=oh(t,ID);const e=t.match(Am);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(pm,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(xD,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(pm,"\\b"),"g"),n)}return t}function PD(t){t=oh(t,RD);const e=t.match(Am);if(e){const n=e[1];t=t.replace(Am,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),pm)}return t}const FD=`

`.concat(yu,`

`),Yb={[Rc]:"vertex",[y0]:"fragment"},DD=`precision highp float;

`;function ND(t,e){const{vs:n,fs:r}=e,s=hD(e.modules||[]);return{gl:t,vs:Ty(t,Object.assign({},e,{source:n,type:Rc,modules:s})),fs:Ty(t,Object.assign({},e,{source:r,type:y0,modules:s})),getUniforms:UD(s)}}function Ty(t,e){let{id:n,source:r,type:s,modules:i,defines:o={},hookFunctions:a=[],inject:c={},transpileToGLSL100:l=!1,prologue:u=!0,log:h}=e;Jt(typeof r=="string","shader source must be a string");const f=s===Rc,d=r.split(`
`);let m=100,_="",T=r;d[0].indexOf("#version ")===0?(m=300,_=d[0],T=d.slice(1).join(`
`)):_="#version ".concat(m);const p={};i.forEach(I=>{Object.assign(p,I.getDefines())}),Object.assign(p,o);let A=u?"".concat(_,`
`).concat(kD({id:n,source:r,type:s}),`
`).concat(GD({type:s}),`
`).concat(vD(t),`
`).concat(CD(t),`
`).concat(HD(p),`
`).concat(f?"":DD,`
`):"".concat(_,`
`);const y=jD(a),C={},b={},S={};for(const I in c){const x=typeof c[I]=="string"?{injection:c[I],order:0}:c[I],O=I.match(/^(v|f)s:(#)?([\w-]+)$/);if(O){const M=O[2],U=O[3];M?U==="decl"?b[I]=[x]:S[I]=[x]:C[I]=[x]}else S[I]=[x]}for(const I of i){h&&I.checkDeprecations(T,h);const x=I.getModuleSource(s,m);A+=x;const O=I.injections[s];for(const M in O){const U=M.match(/^(v|f)s:#([\w-]+)$/);if(U){const W=U[2]==="decl"?b:S;W[M]=W[M]||[],W[M].push(O[M])}else C[M]=C[M]||[],C[M].push(O[M])}}return A+=FD,A=Ey(A,s,b),A+=VD(y[s],C),A+=T,A=Ey(A,s,S),A=OD(A,l?100:m,f),A}function UD(t){return function(n){const r={};for(const s of t){const i=s.getUniforms(n,r);Object.assign(r,i)}return r}}function GD(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(Yb[e].toUpperCase(),`
`)}function kD(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(Yb[r],`

`):""}function HD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const s=t[r];(s||Number.isFinite(s))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function VD(t,e){let n="";for(const r in t){const s=t[r];if(n+="void ".concat(s.signature,` {
`),s.header&&(n+="  ".concat(s.header)),e[r]){const i=e[r];i.sort((o,a)=>o.order-a.order);for(const o of i)n+="  ".concat(o.injection,`
`)}s.footer&&(n+="  ".concat(s.footer)),n+=`}
`}return n}function jD(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[s,i]=n.split(":"),o=n.replace(/\(.+/,"");e[s][o]=Object.assign(r,{signature:i})}),e}const zD="void main() {gl_FragColor = vec4(0);}",Qb=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,JD=`#version 300 es
`.concat(Qb);function qb(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,s,i]=n;if(!e.includes(r)||!s||!i)return null;const o=i.split(";")[0];return{qualifier:r,type:s,name:o}}function Zb(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:s}=t;if(!n)return e===300?JD:e>300?"#version ".concat(e,`
`).concat(Qb):zD;const i=WD(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(s,`;
void main() {
  `).concat(s," = ").concat(i,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(i,`;
}`)}function XD(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Jt(!1),null}}function $D(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Jt(!1),null}}function WD(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Jt(!1),null}}const KD=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,YD={name:"fp32",vs:KD,fs:null};function bn(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const QD=1/Math.PI*180,qD=1/180*Math.PI,je={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function ZD(t,{precision:e=je.precision}={}){return t=rN(t),"".concat(parseFloat(t.toPrecision(e)))}function As(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function eN(t){return nN(t)}function tN(t){return Cr(t)}function nN(t,e){return T0(t,n=>n*qD,e)}function Cr(t,e){return T0(t,n=>n*QD,e)}function Br(t,e,n){return T0(t,r=>Math.max(e,Math.min(n,r)))}function ah(t,e,n){return As(t)?t.map((r,s)=>ah(r,e[s],n)):n*e+(1-n)*t}function Ln(t,e,n){const r=je.EPSILON;n&&(je.EPSILON=n);try{if(t===e)return!0;if(As(t)&&As(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!Ln(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=je.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{je.EPSILON=r}}function rN(t){return Math.round(t/je.EPSILON)*je.EPSILON}function sN(t){return t.clone?t.clone():new Array(t.length)}function T0(t,e,n){if(As(t)){const r=t;n=n||sN(r);for(let s=0;s<n.length&&s<r.length;++s)n[s]=e(t[s],s,n);return n}return e(t)}function iN(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}let v0=class extends iN(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:As(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(je)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+ZD(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Ln(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let s=0;s<this.ELEMENTS;++s){const i=e[s];this[s]=i+r*(n[s]-i)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(je.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}};function oN(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ae(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Da(t,e,n=""){if(je.debug&&!oN(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}let C0=class extends v0{get x(){return this[0]}set x(e){this[0]=ae(e)}get y(){return this[1]}set y(e){this[1]=ae(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const s=this[r]-e[r];n+=s*s}return ae(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return ae(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return bn(e>=0&&e<this.ELEMENTS,"index is out of range"),ae(this[e])}setComponent(e,n){return bn(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}};var Na=1e-6,Fn=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function aN(){var t=new Fn(2);return Fn!=Float32Array&&(t[0]=0,t[1]=0),t}function vy(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function cN(t,e){return t[0]=-e[0],t[1]=-e[1],t}function eS(t,e,n,r){var s=e[0],i=e[1];return t[0]=s+r*(n[0]-s),t[1]=i+r*(n[1]-i),t}function lN(t,e,n){var r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t}function uN(t,e,n){var r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s+n[4],t[1]=n[1]*r+n[3]*s+n[5],t}function tS(t,e,n){var r=e[0],s=e[1];return t[0]=n[0]*r+n[3]*s+n[6],t[1]=n[1]*r+n[4]*s+n[7],t}function nS(t,e,n){var r=e[0],s=e[1];return t[0]=n[0]*r+n[4]*s+n[12],t[1]=n[1]*r+n[5]*s+n[13],t}(function(){var t=aN();return function(e,n,r,s,i,o){var a,c;for(n||(n=2),r||(r=0),s?c=Math.min(s*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],i(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function rS(t,e,n){const r=e[0],s=e[1],i=n[3]*r+n[7]*s||1;return t[0]=(n[0]*r+n[4]*s)/i,t[1]=(n[1]*r+n[5]*s)/i,t}function sS(t,e,n){const r=e[0],s=e[1],i=e[2],o=n[3]*r+n[7]*s+n[11]*i||1;return t[0]=(n[0]*r+n[4]*s+n[8]*i)/o,t[1]=(n[1]*r+n[5]*s+n[9]*i)/o,t[2]=(n[2]*r+n[6]*s+n[10]*i)/o,t}function hN(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t}function fN(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t[3]=e[3],t}function iS(t,e,n){const r=e[0],s=e[1],i=e[2];return t[0]=n[0]*r+n[3]*s+n[6]*i,t[1]=n[1]*r+n[4]*s+n[7]*i,t[2]=n[2]*r+n[5]*s+n[8]*i,t[3]=e[3],t}let B0=class extends C0{constructor(e=0,n=0){super(2),As(e)&&arguments.length===1?this.copy(e):(je.debug&&(ae(e),ae(n)),this[0]=e,this[1]=n)}set(e,n){return this[0]=e,this[1]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return je.debug&&(ae(e.x),ae(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return nS(this,this,e),this.check()}transformAsVector(e){return rS(this,this,e),this.check()}transformByMatrix3(e){return tS(this,this,e),this.check()}transformByMatrix2x3(e){return uN(this,this,e),this.check()}transformByMatrix2(e){return lN(this,this,e),this.check()}};function oS(){var t=new Fn(3);return Fn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function aS(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Cy(t,e,n){var r=new Fn(3);return r[0]=t,r[1]=e,r[2]=n,r}function dN(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function gN(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function mN(t,e){var n=e[0],r=e[1],s=e[2],i=n*n+r*r+s*s;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function b0(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Eu(t,e,n){var r=e[0],s=e[1],i=e[2],o=n[0],a=n[1],c=n[2];return t[0]=s*c-i*a,t[1]=i*o-r*c,t[2]=r*a-s*o,t}function S0(t,e,n){var r=e[0],s=e[1],i=e[2],o=n[3]*r+n[7]*s+n[11]*i+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/o,t[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/o,t[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/o,t}function cS(t,e,n){var r=e[0],s=e[1],i=e[2];return t[0]=r*n[0]+s*n[3]+i*n[6],t[1]=r*n[1]+s*n[4]+i*n[7],t[2]=r*n[2]+s*n[5]+i*n[8],t}function lS(t,e,n){var r=n[0],s=n[1],i=n[2],o=n[3],a=e[0],c=e[1],l=e[2],u=s*l-i*c,h=i*a-r*l,f=r*c-s*a,d=s*f-i*h,m=i*u-r*f,_=r*h-s*u,T=o*2;return u*=T,h*=T,f*=T,d*=2,m*=2,_*=2,t[0]=a+u+d,t[1]=c+h+m,t[2]=l+f+_,t}function pN(t,e,n,r){var s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function AN(t,e,n,r){var s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function _N(t,e,n,r){var s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function yN(t,e){var n=t[0],r=t[1],s=t[2],i=e[0],o=e[1],a=e[2],c=Math.sqrt(n*n+r*r+s*s),l=Math.sqrt(i*i+o*o+a*a),u=c*l,h=u&&b0(t,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}var EN=dN,TN=aS;(function(){var t=oS();return function(e,n,r,s,i,o){var a,c;for(n||(n=3),r||(r=0),s?c=Math.min(s*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],i(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const ld=[0,0,0];let Tl,w=class uS extends C0{static get ZERO(){return Tl||(Tl=new uS(0,0,0),Object.freeze(Tl)),Tl}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&As(e)?this.copy(e):(je.debug&&(ae(e),ae(n),ae(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return je.debug&&(ae(e.x),ae(e.y),ae(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ae(e)}angle(e){return yN(this,e)}cross(e){return Eu(this,this,e),this.check()}rotateX({radians:e,origin:n=ld}){return pN(this,this,n,e),this.check()}rotateY({radians:e,origin:n=ld}){return AN(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=ld}){return _N(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return S0(this,this,e),this.check()}transformAsVector(e){return sS(this,this,e),this.check()}transformByMatrix3(e){return cS(this,this,e),this.check()}transformByMatrix2(e){return hN(this,this,e),this.check()}transformByQuaternion(e){return lS(this,this,e),this.check()}},vl,vN=class hS extends C0{static get ZERO(){return vl||(vl=new hS(0,0,0,0),Object.freeze(vl)),vl}constructor(e=0,n=0,r=0,s=0){super(-0,-0,-0,-0),As(e)&&arguments.length===1?this.copy(e):(je.debug&&(ae(e),ae(n),ae(r),ae(s)),this[0]=e,this[1]=n,this[2]=r,this[3]=s)}set(e,n,r,s){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return je.debug&&(ae(e.x),ae(e.y),ae(e.z),ae(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=ae(e)}get w(){return this[3]}set w(e){this[3]=ae(e)}transform(e){return S0(this,this,e),this.check()}transformByMatrix3(e){return iS(this,this,e),this.check()}transformByMatrix2(e){return fN(this,this,e),this.check()}transformByQuaternion(e){return lS(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}},fS=class extends v0{toString(){let e="[";if(je.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=ae(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)n[s]=this[r+s];return n}setColumn(e,n){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=n[s];return this}};function CN(){var t=new Fn(9);return Fn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function BN(t,e){if(t===e){var n=e[1],r=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function bN(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=u*o-a*l,f=-u*i+a*c,d=l*i-o*c,m=n*h+r*f+s*d;return m?(m=1/m,t[0]=h*m,t[1]=(-u*r+s*l)*m,t[2]=(a*r-s*o)*m,t[3]=f*m,t[4]=(u*n-s*c)*m,t[5]=(-a*n+s*i)*m,t[6]=d*m,t[7]=(-l*n+r*c)*m,t[8]=(o*n-r*i)*m,t):null}function SN(t){var e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],o=t[5],a=t[6],c=t[7],l=t[8];return e*(l*i-o*c)+n*(-l*s+o*a)+r*(c*s-i*a)}function By(t,e,n){var r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=n[0],d=n[1],m=n[2],_=n[3],T=n[4],p=n[5],A=n[6],y=n[7],C=n[8];return t[0]=f*r+d*o+m*l,t[1]=f*s+d*a+m*u,t[2]=f*i+d*c+m*h,t[3]=_*r+T*o+p*l,t[4]=_*s+T*a+p*u,t[5]=_*i+T*c+p*h,t[6]=A*r+y*o+C*l,t[7]=A*s+y*a+C*u,t[8]=A*i+y*c+C*h,t}function wN(t,e,n){var r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=n[0],d=n[1];return t[0]=r,t[1]=s,t[2]=i,t[3]=o,t[4]=a,t[5]=c,t[6]=f*r+d*o+l,t[7]=f*s+d*a+u,t[8]=f*i+d*c+h,t}function IN(t,e,n){var r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*r+f*o,t[1]=d*s+f*a,t[2]=d*i+f*c,t[3]=d*o-f*r,t[4]=d*a-f*s,t[5]=d*c-f*i,t[6]=l,t[7]=u,t[8]=h,t}function by(t,e,n){var r=n[0],s=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function MN(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],o=n+n,a=r+r,c=s+s,l=n*o,u=r*o,h=r*a,f=s*o,d=s*a,m=s*c,_=i*o,T=i*a,p=i*c;return t[0]=1-h-m,t[3]=u-p,t[6]=f+T,t[1]=u+p,t[4]=1-l-m,t[7]=d-_,t[2]=f-T,t[5]=d+_,t[8]=1-l-h,t}var _m;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(_m||(_m={}));const RN=Object.freeze([1,0,0,0,1,0,0,0,1]);let xe=class extends fS{static get IDENTITY(){return ON()}static get ZERO(){return xN()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return _m}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(RN)}fromObject(e){return this.check()}fromQuaternion(e){return MN(this,e),this.check()}set(e,n,r,s,i,o,a,c,l){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=i,this[5]=o,this[6]=a,this[7]=c,this[8]=l,this.check()}setRowMajor(e,n,r,s,i,o,a,c,l){return this[0]=e,this[1]=s,this[2]=a,this[3]=n,this[4]=i,this[5]=c,this[6]=r,this[7]=o,this[8]=l,this.check()}determinant(){return SN(this)}transpose(){return BN(this,this),this.check()}invert(){return bN(this,this),this.check()}multiplyLeft(e){return By(this,e,this),this.check()}multiplyRight(e){return By(this,this,e),this.check()}rotate(e){return IN(this,this,e),this.check()}scale(e){return Array.isArray(e)?by(this,this,e):by(this,this,[e,e]),this.check()}translate(e){return wN(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=tS(n||[-0,-0],e,this);break;case 3:r=cS(n||[-0,-0,-0],e,this);break;case 4:r=iS(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Da(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}},Cl,Bl;function xN(){return Cl||(Cl=new xe([0,0,0,0,0,0,0,0,0]),Object.freeze(Cl)),Cl}function ON(){return Bl||(Bl=new xe,Object.freeze(Bl)),Bl}function LN(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function PN(t,e){if(t===e){var n=e[1],r=e[2],s=e[3],i=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=s,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ym(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=e[9],f=e[10],d=e[11],m=e[12],_=e[13],T=e[14],p=e[15],A=n*a-r*o,y=n*c-s*o,C=n*l-i*o,b=r*c-s*a,S=r*l-i*a,I=s*l-i*c,x=u*_-h*m,O=u*T-f*m,M=u*p-d*m,U=h*T-f*_,J=h*p-d*_,W=f*p-d*T,H=A*W-y*J+C*U+b*M-S*O+I*x;return H?(H=1/H,t[0]=(a*W-c*J+l*U)*H,t[1]=(s*J-r*W-i*U)*H,t[2]=(_*I-T*S+p*b)*H,t[3]=(f*S-h*I-d*b)*H,t[4]=(c*M-o*W-l*O)*H,t[5]=(n*W-s*M+i*O)*H,t[6]=(T*C-m*I-p*y)*H,t[7]=(u*I-f*C+d*y)*H,t[8]=(o*J-a*M+l*x)*H,t[9]=(r*M-n*J-i*x)*H,t[10]=(m*S-_*C+p*A)*H,t[11]=(h*C-u*S-d*A)*H,t[12]=(a*O-o*U-c*x)*H,t[13]=(n*U-r*O+s*x)*H,t[14]=(_*y-m*b-T*A)*H,t[15]=(u*b-h*y+f*A)*H,t):null}function FN(t){var e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],o=t[5],a=t[6],c=t[7],l=t[8],u=t[9],h=t[10],f=t[11],d=t[12],m=t[13],_=t[14],T=t[15],p=e*o-n*i,A=e*a-r*i,y=e*c-s*i,C=n*a-r*o,b=n*c-s*o,S=r*c-s*a,I=l*m-u*d,x=l*_-h*d,O=l*T-f*d,M=u*_-h*m,U=u*T-f*m,J=h*T-f*_;return p*J-A*U+y*M+C*O-b*x+S*I}function js(t,e,n){var r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=e[9],d=e[10],m=e[11],_=e[12],T=e[13],p=e[14],A=e[15],y=n[0],C=n[1],b=n[2],S=n[3];return t[0]=y*r+C*a+b*h+S*_,t[1]=y*s+C*c+b*f+S*T,t[2]=y*i+C*l+b*d+S*p,t[3]=y*o+C*u+b*m+S*A,y=n[4],C=n[5],b=n[6],S=n[7],t[4]=y*r+C*a+b*h+S*_,t[5]=y*s+C*c+b*f+S*T,t[6]=y*i+C*l+b*d+S*p,t[7]=y*o+C*u+b*m+S*A,y=n[8],C=n[9],b=n[10],S=n[11],t[8]=y*r+C*a+b*h+S*_,t[9]=y*s+C*c+b*f+S*T,t[10]=y*i+C*l+b*d+S*p,t[11]=y*o+C*u+b*m+S*A,y=n[12],C=n[13],b=n[14],S=n[15],t[12]=y*r+C*a+b*h+S*_,t[13]=y*s+C*c+b*f+S*T,t[14]=y*i+C*l+b*d+S*p,t[15]=y*o+C*u+b*m+S*A,t}function ch(t,e,n){var r=n[0],s=n[1],i=n[2],o,a,c,l,u,h,f,d,m,_,T,p;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*i+e[12],t[13]=e[1]*r+e[5]*s+e[9]*i+e[13],t[14]=e[2]*r+e[6]*s+e[10]*i+e[14],t[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(o=e[0],a=e[1],c=e[2],l=e[3],u=e[4],h=e[5],f=e[6],d=e[7],m=e[8],_=e[9],T=e[10],p=e[11],t[0]=o,t[1]=a,t[2]=c,t[3]=l,t[4]=u,t[5]=h,t[6]=f,t[7]=d,t[8]=m,t[9]=_,t[10]=T,t[11]=p,t[12]=o*r+u*s+m*i+e[12],t[13]=a*r+h*s+_*i+e[13],t[14]=c*r+f*s+T*i+e[14],t[15]=l*r+d*s+p*i+e[15]),t}function w0(t,e,n){var r=n[0],s=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function DN(t,e,n,r){var s=r[0],i=r[1],o=r[2],a=Math.hypot(s,i,o),c,l,u,h,f,d,m,_,T,p,A,y,C,b,S,I,x,O,M,U,J,W,H,Ce;return a<Na?null:(a=1/a,s*=a,i*=a,o*=a,c=Math.sin(n),l=Math.cos(n),u=1-l,h=e[0],f=e[1],d=e[2],m=e[3],_=e[4],T=e[5],p=e[6],A=e[7],y=e[8],C=e[9],b=e[10],S=e[11],I=s*s*u+l,x=i*s*u+o*c,O=o*s*u-i*c,M=s*i*u-o*c,U=i*i*u+l,J=o*i*u+s*c,W=s*o*u+i*c,H=i*o*u-s*c,Ce=o*o*u+l,t[0]=h*I+_*x+y*O,t[1]=f*I+T*x+C*O,t[2]=d*I+p*x+b*O,t[3]=m*I+A*x+S*O,t[4]=h*M+_*U+y*J,t[5]=f*M+T*U+C*J,t[6]=d*M+p*U+b*J,t[7]=m*M+A*U+S*J,t[8]=h*W+_*H+y*Ce,t[9]=f*W+T*H+C*Ce,t[10]=d*W+p*H+b*Ce,t[11]=m*W+A*H+S*Ce,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function dS(t,e,n){var r=Math.sin(n),s=Math.cos(n),i=e[4],o=e[5],a=e[6],c=e[7],l=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*s+l*r,t[5]=o*s+u*r,t[6]=a*s+h*r,t[7]=c*s+f*r,t[8]=l*s-i*r,t[9]=u*s-o*r,t[10]=h*s-a*r,t[11]=f*s-c*r,t}function NN(t,e,n){var r=Math.sin(n),s=Math.cos(n),i=e[0],o=e[1],a=e[2],c=e[3],l=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s-l*r,t[1]=o*s-u*r,t[2]=a*s-h*r,t[3]=c*s-f*r,t[8]=i*r+l*s,t[9]=o*r+u*s,t[10]=a*r+h*s,t[11]=c*r+f*s,t}function gS(t,e,n){var r=Math.sin(n),s=Math.cos(n),i=e[0],o=e[1],a=e[2],c=e[3],l=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s+l*r,t[1]=o*s+u*r,t[2]=a*s+h*r,t[3]=c*s+f*r,t[4]=l*s-i*r,t[5]=u*s-o*r,t[6]=h*s-a*r,t[7]=f*s-c*r,t}function UN(t,e){var n=e[0],r=e[1],s=e[2],i=e[4],o=e[5],a=e[6],c=e[8],l=e[9],u=e[10];return t[0]=Math.hypot(n,r,s),t[1]=Math.hypot(i,o,a),t[2]=Math.hypot(c,l,u),t}function GN(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],o=n+n,a=r+r,c=s+s,l=n*o,u=r*o,h=r*a,f=s*o,d=s*a,m=s*c,_=i*o,T=i*a,p=i*c;return t[0]=1-h-m,t[1]=u+p,t[2]=f-T,t[3]=0,t[4]=u-p,t[5]=1-l-m,t[6]=d+_,t[7]=0,t[8]=f+T,t[9]=d-_,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function kN(t,e,n,r,s,i,o){var a=1/(n-e),c=1/(s-r),l=1/(i-o);return t[0]=i*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(s+r)*c,t[10]=(o+i)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*l,t[15]=0,t}function HN(t,e,n,r,s){var i=1/Math.tan(e/2),o;return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(o=1/(r-s),t[10]=(s+r)*o,t[14]=2*s*r*o):(t[10]=-1,t[14]=-2*r),t}var VN=HN;function jN(t,e,n,r,s,i,o){var a=1/(e-n),c=1/(r-s),l=1/(i-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*a,t[13]=(s+r)*c,t[14]=(o+i)*l,t[15]=1,t}var zN=jN;function JN(t,e,n,r){var s,i,o,a,c,l,u,h,f,d,m=e[0],_=e[1],T=e[2],p=r[0],A=r[1],y=r[2],C=n[0],b=n[1],S=n[2];return Math.abs(m-C)<Na&&Math.abs(_-b)<Na&&Math.abs(T-S)<Na?LN(t):(u=m-C,h=_-b,f=T-S,d=1/Math.hypot(u,h,f),u*=d,h*=d,f*=d,s=A*f-y*h,i=y*u-p*f,o=p*h-A*u,d=Math.hypot(s,i,o),d?(d=1/d,s*=d,i*=d,o*=d):(s=0,i=0,o=0),a=h*o-f*i,c=f*s-u*o,l=u*i-h*s,d=Math.hypot(a,c,l),d?(d=1/d,a*=d,c*=d,l*=d):(a=0,c=0,l=0),t[0]=s,t[1]=a,t[2]=u,t[3]=0,t[4]=i,t[5]=c,t[6]=h,t[7]=0,t[8]=o,t[9]=l,t[10]=f,t[11]=0,t[12]=-(s*m+i*_+o*T),t[13]=-(a*m+c*_+l*T),t[14]=-(u*m+h*_+f*T),t[15]=1,t)}function XN(){var t=new Fn(4);return Fn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function $N(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function mS(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function WN(t){var e=t[0],n=t[1],r=t[2],s=t[3];return Math.hypot(e,n,r,s)}function KN(t){var e=t[0],n=t[1],r=t[2],s=t[3];return e*e+n*n+r*r+s*s}function YN(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],o=n*n+r*r+s*s+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=s*o,t[3]=i*o,t}function QN(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function qN(t,e,n,r){var s=e[0],i=e[1],o=e[2],a=e[3];return t[0]=s+r*(n[0]-s),t[1]=i+r*(n[1]-i),t[2]=o+r*(n[2]-o),t[3]=a+r*(n[3]-a),t}function xc(t,e,n){var r=e[0],s=e[1],i=e[2],o=e[3];return t[0]=n[0]*r+n[4]*s+n[8]*i+n[12]*o,t[1]=n[1]*r+n[5]*s+n[9]*i+n[13]*o,t[2]=n[2]*r+n[6]*s+n[10]*i+n[14]*o,t[3]=n[3]*r+n[7]*s+n[11]*i+n[15]*o,t}function ZN(t,e,n){var r=e[0],s=e[1],i=e[2],o=n[0],a=n[1],c=n[2],l=n[3],u=l*r+a*i-c*s,h=l*s+c*r-o*i,f=l*i+o*s-a*r,d=-o*r-a*s-c*i;return t[0]=u*l+d*-o+h*-c-f*-a,t[1]=h*l+d*-a+f*-o-u*-c,t[2]=f*l+d*-c+u*-a-h*-o,t[3]=e[3],t}(function(){var t=XN();return function(e,n,r,s,i,o){var a,c;for(n||(n=4),r||(r=0),s?c=Math.min(s*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],i(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Em;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Em||(Em={}));const eU=45*Math.PI/180,tU=1,ud=.1,hd=500,nU=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);let q=class extends fS{static get IDENTITY(){return sU()}static get ZERO(){return rU()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Em}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,s,i,o,a,c,l,u,h,f,d,m,_,T){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=i,this[5]=o,this[6]=a,this[7]=c,this[8]=l,this[9]=u,this[10]=h,this[11]=f,this[12]=d,this[13]=m,this[14]=_,this[15]=T,this.check()}setRowMajor(e,n,r,s,i,o,a,c,l,u,h,f,d,m,_,T){return this[0]=e,this[1]=i,this[2]=l,this[3]=d,this[4]=n,this[5]=o,this[6]=u,this[7]=m,this[8]=r,this[9]=a,this[10]=h,this[11]=_,this[12]=s,this[13]=c,this[14]=f,this[15]=T,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(nU)}fromObject(e){return this.check()}fromQuaternion(e){return GN(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:s,top:i,near:o=ud,far:a=hd}=e;return a===1/0?iU(this,n,r,s,i,o):kN(this,n,r,s,i,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:s=[0,1,0]}=e;return JN(this,n,r,s),this.check()}ortho(e){const{left:n,right:r,bottom:s,top:i,near:o=ud,far:a=hd}=e;return zN(this,n,r,s,i,o,a),this.check()}orthographic(e){const{fovy:n=eU,aspect:r=tU,focalDistance:s=1,near:i=ud,far:o=hd}=e;Sy(n);const a=n/2,c=s*Math.tan(a),l=c*r;return this.ortho({left:-l,right:l,bottom:-c,top:c,near:i,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:s=.1,far:i=500}=e;return Sy(n),VN(this,n,r,s,i),this.check()}determinant(){return FN(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*i,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*i,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=this[4]*s,e[4]=this[5]*i,e[5]=this[6]*o,e[6]=this[8]*s,e[7]=this[9]*i,e[8]=this[10]*o,e}transpose(){return PN(this,this),this.check()}invert(){return ym(this,this),this.check()}multiplyLeft(e){return js(this,e,this),this.check()}multiplyRight(e){return js(this,this,e),this.check()}rotateX(e){return dS(this,this,e),this.check()}rotateY(e){return NN(this,this,e),this.check()}rotateZ(e){return gS(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return DN(this,this,e,n),this.check()}scale(e){return w0(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return ch(this,this,e),this.check()}transform(e,n){return e.length===4?(n=xc(n||[-0,-0,-0,-0],e,this),Da(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let s;switch(r){case 2:s=nS(n||[-0,-0],e,this);break;case 3:s=S0(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Da(s,e.length),s}transformAsVector(e,n){let r;switch(e.length){case 2:r=rS(n||[-0,-0],e,this);break;case 3:r=sS(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Da(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}},bl,Sl;function rU(){return bl||(bl=new q([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(bl)),bl}function sU(){return Sl||(Sl=new q,Object.freeze(Sl)),Sl}function Sy(t){if(t>Math.PI*2)throw Error("expected radians")}function iU(t,e,n,r,s,i){const o=2*i/(n-e),a=2*i/(s-r),c=(n+e)/(n-e),l=(s+r)/(s-r),u=-1,h=-1,f=-2*i;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=c,t[9]=l,t[10]=u,t[11]=h,t[12]=0,t[13]=0,t[14]=f,t[15]=0,t}function wy(){var t=new Fn(4);return Fn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function oU(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function pS(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Iy(t,e,n){var r=e[0],s=e[1],i=e[2],o=e[3],a=n[0],c=n[1],l=n[2],u=n[3];return t[0]=r*u+o*a+s*l-i*c,t[1]=s*u+o*c+i*a-r*l,t[2]=i*u+o*l+r*c-s*a,t[3]=o*u-r*a-s*c-i*l,t}function aU(t,e,n){n*=.5;var r=e[0],s=e[1],i=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*a,t[1]=s*c+i*a,t[2]=i*c-s*a,t[3]=o*c-r*a,t}function cU(t,e,n){n*=.5;var r=e[0],s=e[1],i=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c-i*a,t[1]=s*c+o*a,t[2]=i*c+r*a,t[3]=o*c-s*a,t}function lU(t,e,n){n*=.5;var r=e[0],s=e[1],i=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+s*a,t[1]=s*c-r*a,t[2]=i*c+o*a,t[3]=o*c-i*a,t}function uU(t,e){var n=e[0],r=e[1],s=e[2];return t[0]=n,t[1]=r,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-s*s)),t}function Tu(t,e,n,r){var s=e[0],i=e[1],o=e[2],a=e[3],c=n[0],l=n[1],u=n[2],h=n[3],f,d,m,_,T;return d=s*c+i*l+o*u+a*h,d<0&&(d=-d,c=-c,l=-l,u=-u,h=-h),1-d>Na?(f=Math.acos(d),m=Math.sin(f),_=Math.sin((1-r)*f)/m,T=Math.sin(r*f)/m):(_=1-r,T=r),t[0]=_*s+T*c,t[1]=_*i+T*l,t[2]=_*o+T*u,t[3]=_*a+T*h,t}function hU(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],o=n*n+r*r+s*s+i*i,a=o?1/o:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-s*a,t[3]=i*a,t}function fU(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function AS(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var i=(s+1)%3,o=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[i*3+i]-e[o*3+o]+1),t[s]=.5*r,r=.5/r,t[3]=(e[i*3+o]-e[o*3+i])*r,t[i]=(e[i*3+s]+e[s*3+i])*r,t[o]=(e[o*3+s]+e[s*3+o])*r}return t}var dU=$N,gU=mS,mU=QN,pU=qN,AU=WN,_U=KN,_S=YN,yU=function(){var t=oS(),e=Cy(1,0,0),n=Cy(0,1,0);return function(r,s,i){var o=b0(s,i);return o<-.999999?(Eu(t,e,s),TN(t)<1e-6&&Eu(t,n,s),mN(t,t),pS(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Eu(t,s,i),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,_S(r,r))}}();(function(){var t=wy(),e=wy();return function(n,r,s,i,o,a){return Tu(t,r,o,a),Tu(e,s,i,a),Tu(n,t,e,2*a*(1-a)),n}})();(function(){var t=CN();return function(e,n,r,s){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],_S(e,AS(e,t))}})();const EU=[0,0,0,1];let hc=class extends v0{constructor(e=0,n=0,r=0,s=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,s)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,s){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return AS(this,e),this.check()}fromAxisRotation(e,n){return pS(this,e,n),this.check()}identity(){return oU(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=ae(e)}get y(){return this[1]}set y(e){this[1]=ae(e)}get z(){return this[2]}set z(e){this[2]=ae(e)}get w(){return this[3]}set w(e){this[3]=ae(e)}len(){return AU(this)}lengthSquared(){return _U(this)}dot(e){return mU(this,e)}rotationTo(e,n){return yU(this,e,n),this.check()}add(e){return dU(this,this,e),this.check()}calculateW(){return uU(this,this),this.check()}conjugate(){return fU(this,this),this.check()}invert(){return hU(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(pU(this,e,n,r),this.check())}multiplyRight(e){return Iy(this,this,e),this.check()}multiplyLeft(e){return Iy(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return aU(this,this,e),this.check()}rotateY(e){return cU(this,this,e),this.check()}rotateZ(e){return lU(this,this,e),this.check()}scale(e){return gU(this,this,e),this.check()}slerp(e,n,r){let s,i,o;switch(arguments.length){case 1:({start:s=EU,target:i,ratio:o}=e);break;case 2:s=this,i=e,o=n;break;default:s=e,i=n,o=r}return Tu(this,s,i,o),this.check()}transformVector4(e,n=new vN){return ZN(n,e,this),Da(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}};const fc={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},My=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,TU={lightSources:{}};function fd(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function vU(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const s={};return e?s["lighting_uAmbientLight.color"]=fd(e):s["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((i,o)=>{s["lighting_uPointLight[".concat(o,"].color")]=fd(i),s["lighting_uPointLight[".concat(o,"].position")]=i.position,s["lighting_uPointLight[".concat(o,"].attenuation")]=i.attenuation||[1,0,0]}),s.lighting_uPointLightCount=n.length,r.forEach((i,o)=>{s["lighting_uDirectionalLight[".concat(o,"].color")]=fd(i),s["lighting_uDirectionalLight[".concat(o,"].direction")]=i.direction}),s.lighting_uDirectionalLightCount=r.length,s}function yS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:TU;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},vU({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return yS({lightSources:e})}return{}}const I0={name:"lights",vs:My,fs:My,getUniforms:yS,defines:{MAX_LIGHTS:3}},CU=new Uint8Array([0,255,255,255]),BU={pickingSelectedColor:null,pickingHighlightColor:CU,pickingActive:!1,pickingAttribute:!1};function bU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:BU;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const SU=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,wU=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,IU={name:"picking",vs:SU,fs:wU,getUniforms:bU},ES=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,MU={};function RU(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:s=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:s.map(i=>i/255)}}function TS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:MU;if(!("material"in t))return{};const{material:e}=t;return e?RU(e):{lighting_uEnabled:!1}}const xU={name:"gouraud-lighting",dependencies:[I0],vs:ES,defines:{LIGHTING_VERTEX:1},getUniforms:TS},OU={name:"phong-lighting",dependencies:[I0],fs:ES,defines:{LIGHTING_FRAGMENT:1},getUniforms:TS},LU=`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,PU=`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,M0={name:"pbr",vs:LU,fs:PU,defines:{LIGHTING_FRAGMENT:1},dependencies:[I0]},FU=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,DU={name:"transform",vs:FU,fs:null};class Oc{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Oc(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:s={},inject:i={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:c=!1}=e,l=this._getModuleList(e.modules),u=this._getHash(n),h=this._getHash(r),f=l.map(y=>this._getHash(y.name)).sort(),d=o.map(y=>this._getHash(y)),m=Object.keys(s).sort(),_=Object.keys(i).sort(),T=[],p=[];for(const y of m)T.push(this._getHash(y)),T.push(this._getHash(s[y]));for(const y of _)p.push(this._getHash(y)),p.push(this._getHash(i[y]));const A="".concat(u,"/").concat(h,"D").concat(T.join("/"),"M").concat(f.join("/"),"I").concat(p.join("/"),"V").concat(d.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(c?"T":"");if(!this._programCache[A]){const y=ND(this.gl,{vs:n,fs:r,modules:l,inject:i,defines:s,hookFunctions:this._hookFunctions,transpileToGLSL100:c});this._programCache[A]=new zb(this.gl,{hash:A,vs:y.vs,fs:y.fs,varyings:o,bufferMode:a}),this._getUniforms[A]=y.getUniforms||(C=>{}),this._useCounts[A]=0}return this._useCounts[A]++,this._programCache[A]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let s=0;for(let i=0,o=this._defaultModules.length;i<o;++i){const a=this._defaultModules[i],c=a.name;n[s++]=a,r[c]=!0}for(let i=0,o=e.length;i<o;++i){const a=e[i],c=a.name;r[c]||(n[s++]=a,r[c]=!0)}return n.length=s,n}}const NU={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function UU(t,e,n){const r={};let s=e.indices;for(const i in e.attributes){const o=e.attributes[i],a=GU(i,n);if(i==="indices")s=o;else if(o.constant)r[a]=o.value;else{const c=o.value,l={...o};delete l.value,r[a]=[new ge(t,c),l],kU(i,l)}}if(s){const i=s.value||s;k(i instanceof Uint16Array||i instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:s.isIndexed===void 0?!0:s.isIndexed};r.indices=[new ge(t,{data:i,target:34963}),o]}return r}function GU(t,e){const{attributeMap:n=NU}=e||{};return n&&n[t]||t}function kU(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}k(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const pi=2,HU=1e4,VU="Model needs drawMode and vertexCount",Ry=()=>{},jU={};class mo{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Fr("model")}=n;k(Xh(e)),this.id=r,this.gl=e,this.id=n.id||Fr("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Oc.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:s,modules:i,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:n,vs:r,fs:s,modules:i,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},k(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),VU)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:s,modules:i,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:n,vs:r,fs:s,modules:i,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return k(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return k(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=UU(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ho(e))return this;const n={};for(const r in e){const s=e[r];n[r]=s.getValue?s.getValue():s}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return p0(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:s={},attributes:i={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:c=this.vertexArray}=e;this.setAttributes(i),this.updateModuleSettings(n),this.setUniforms(s);let l;z.priority>=pi&&(l=this._logDrawCallStart(pi));const u=this.vertexArray.getDrawParams(),{isIndexed:h=u.isIndexed,indexType:f=u.indexType,indexOffset:d=u.indexOffset,vertexArrayInstanced:m=u.isInstanced}=this.props;m&&!this.isInstanced&&z.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:_,instanceCount:T}=this,{onBeforeRender:p=Ry,onAfterRender:A=Ry}=this.props;p(),this.program.setUniforms(this.uniforms);const y=this.program.draw(Object.assign(jU,e,{logPriority:l,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:c,transformFeedback:o,isIndexed:h,indexType:f,isInstanced:_,instanceCount:T,offset:h?d:0}));return A(),z.priority>=pi&&this._logDrawCallEnd(l,c,r),y}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:s=[]}=e;let{parameters:i}=e;r&&this._setFeedbackBuffers(r),n&&(i=Object.assign({},i,{35977:n})),s.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:i}))}finally{s.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return z.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:s,modules:i,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=this.programProps;n=this.programManager.get({vs:r,fs:s,modules:i,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}k(n instanceof zb,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new qF(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ge&&n.delete()}}_setAnimationProps(e){this.animated&&k(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ho(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new Jb(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:HU;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),z.group(pi,">>> DRAWING MODEL ".concat(this.id),{collapsed:z.level<=2})(),e}_logDrawCallEnd(e,n,r,s){if(e===void 0)return;const i=tD({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:c}=hy({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:l,count:u}=hy({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});u>0&&z.log("MISSING UNIFORMS",Object.keys(l))(),c>0&&z.log("UNUSED UNIFORMS",Object.keys(a))();const h=rD(this.vertexArray.configuration);z.table(e,i)(),z.table(e,o)(),z.table(e+1,h)(),s&&s.log({logLevel:pi,message:"Rendered to ".concat(s.id)}),z.groupEnd(pi)()}}class zU{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:s}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:s}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof ge?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&k(Y(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const s in this.feedbackMap){const i=this.feedbackMap[s];s in n&&(r[i]=s)}Object.assign(r,e.feedbackBuffers);for(const s in r){const i=r[s];if(typeof i=="string"){const o=n[i],{byteLength:a,usage:c,accessor:l}=o;r[s]=this._createNewBuffer(s,{byteLength:a,usage:c,accessor:l})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:s}=r;e.transformFeedback=new Jb(this.gl,{program:s,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),s=this._getNextIndex();this.bindings[s]=this._updateBinding(this.bindings[s],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const s in this.feedbackMap){const i=this.feedbackMap[s];n[s]=e.feedbackBuffers[i],r[i]=e.sourceBuffers[s],k(r[i]instanceof ge)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new ge(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const JU="transform_uSampler_",lh="transform_uSize_",xy="transform_position";function XU(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:s}=t,o=Object.keys(n).length,a=null;const c={};let l=e,u={};if(o>0||r){const h=l.split(`
`),f=h.slice();if(h.forEach((d,m,_)=>{if(o>0){const T=QU(d,n);if(T){const{updatedLine:p,inject:A}=T;f[m]=p,u=mm([u,A]),Object.assign(c,T.samplerTextureMap),o--}}r&&!a&&(a=YU(d,r))}),r){k(s);const d="".concat(lh).concat(r),m="uniform vec2 ".concat(d,`;
`),_="     vec2 ".concat(xy," = transform_getPos(").concat(d,`);
     gl_Position = vec4(`).concat(xy,`, 0, 1.);
`);u=mm([u,{"vs:#decl":m,"vs:#main-start":_}])}l=f.join(`
`)}return{vs:l,targetTextureType:a,inject:u,samplerTextureMap:c}}function $U(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const s={};let i,o;n&&({width:i,height:o}=r,s["".concat(lh).concat(n)]=[i,o]);for(const a in e)({width:i,height:o}=e[a]),s["".concat(lh).concat(a)]=[i,o];return s}function WU(t){return qb(t,["attribute","in"])}function KU(t){const e="".concat(JU).concat(t),n="".concat(lh).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function YU(t,e){const n=qb(t,["varying","out"]);return n&&n.name===e?n.type:null}function QU(t,e){const n={},r=WU(t);if(!r)return null;const{type:s,name:i}=r;if(i&&e[i]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:c,uniformDeclerations:l}=KU(i),u=XD(s),h="  ".concat(s," ").concat(i," = transform_getInput(").concat(a,", ").concat(c,").").concat(u,`;
`);return n[a]=i,{updatedLine:o,inject:{"vs:#decl":l,"vs:#main-start":h},samplerTextureMap:n}}return null}const qU={10241:9728,10240:9728,10242:33071,10243:33071},ZU="transform_output";class eG{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:s,targetTexture:i}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),c=Object.assign({},e.parameters);let l=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const h in this.samplerTextureMap){const f=this.samplerTextureMap[h];a[h]=r[f]}this._setSourceTextureParameters();const u=$U({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(a,u)}return this.hasTargetTexture&&(l=!1,c.viewport=[0,0,s.width,s.height]),{attributes:o,framebuffer:s,uniforms:a,discard:l,parameters:c}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=Wh(n);if(!e)return r;const s=r.constructor,i=$D(this.targetTextureType),o=new s(r.length*i/4);let a=0;for(let c=0;c<r.length;c+=4)for(let l=0;l<i;l++)o[a++]=r[c+l];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof $t)return r;const s=n[r];return s?(this._targetRefTexName=r,this._createNewTexture(s)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:s}=e,i=this._createTargetTexture({sourceTextures:r,textureOrReference:s});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:i}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,s,i)=>{i[s]=s}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ge(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),s=this._getNextIndex();this.bindings[s]=this._updateBinding(this.bindings[s],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:s,targetTexture:i}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,s),Object.assign(e.sourceBuffers,r),i){e.targetTexture=i;const{width:o,height:a}=i,{framebuffer:c}=e;c?(c.update({attachments:{36064:i},resizeAttachments:!1}),c.resize({width:o,height:a})):e.framebuffer=new Je(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:i}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(qU)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=H3(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:s,uniforms:i,targetTextureType:o,inject:a,samplerTextureMap:c}=XU({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),l=mm([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=c;const u=e._fs||Zb({version:Vb(s),input:this.targetTextureVarying,inputType:o,output:ZU}),h=this.hasSourceTextures||this.targetTextureVarying?[DU].concat(e.modules||[]):e.modules;return{vs:s,fs:u,modules:h,uniforms:i,inject:l}}}class R0{static isSupported(e){return Y(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();k(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const s=r.getData(e);if(s)return s}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new mo(n,Object.assign({},e,{fs:e.fs||Zb({version:Vb(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const s of r)n=s.updateModelProps(n);return n}_buildResourceTransforms(e,n){tG(n)&&(this.bufferTransform=new zU(e,n)),nG(n)&&(this.textureTransform=new eG(e,n)),k(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const s of r)n=Object.assign(n,s.getDrawOptions(n));return n}}function tG(t){return!!(!ho(t.feedbackBuffers)||!ho(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function nG(t){return!!(!ho(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const Oy={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Ua{static get DRAW_MODE(){return Oy}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Fr("geometry"),drawMode:r=Oy.TRIANGLES,attributes:s={},indices:i=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(s,i),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let s=e[r];s=ArrayBuffer.isView(s)?{value:s}:s,k(ArrayBuffer.isView(s.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!s.size&&(s.size=3),r==="indices"?(k(!this.indices),this.indices=s):this.attributes[r]=s}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const s in e){const i=e[s],{value:o,size:a,constant:c}=i;!c&&o&&a>=1&&(r=Math.min(r,o.length/a))}return k(Number.isFinite(r)),r}}let rG=1,sG=1;class vS{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:s=1,repeat:i=1}=e,o=rG++,a={time:0,delay:n,duration:r,rate:s,repeat:i};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const s of n)this._setChannelTime(s,this.time);const r=this.animations.values();for(const s of r){const{animation:i,channel:o}=s;i.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=sG++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,s=e.duration*e.repeat;r>=s?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const iG=[255,255,255],oG=1;let aG=0;class cG{constructor(e={}){g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","ambient");const{color:n=iG}=e,{intensity:r=oG}=e;this.id=e.id||"ambient-".concat(aG++),this.color=n,this.intensity=r}}const lG=[255,255,255],uG=1,hG=[0,0,-1];let fG=0;class Ly{constructor(e={}){g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","directional"),g(this,"direction",void 0),g(this,"shadow",void 0);const{color:n=lG}=e,{intensity:r=uG}=e,{direction:s=hG}=e,{_shadow:i=!1}=e;this.id=e.id||"directional-".concat(fG++),this.color=n,this.intensity=r,this.type="directional",this.direction=new w(s).normalize().toArray(),this.shadow=i}getProjectedLight(e){return this}}class dG{constructor(e,n={id:"pass"}){g(this,"id",void 0),g(this,"gl",void 0),g(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class x0 extends dG{constructor(...e){super(...e),g(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return Pr(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:s,views:i,onViewportActive:o,clearStack:a=!0,clearCanvas:c=!0}=e;e.pass=e.pass||"unknown";const l=this.gl;c&&mG(l,n),a&&(this._lastRenderIndex=-1);const u=[];for(const h of s){const f=i&&i[h.id];o==null||o(h);const d=this._getDrawLayerParams(h,e),m=h.subViewports||[h];for(const _ of m){const T=this._drawLayersInViewport(l,{target:n,moduleParameters:r,viewport:_,view:f,pass:e.pass,layers:e.layers},d);u.push(T)}}return u}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:s=!1,layerFilter:i,cullRect:o,effects:a,moduleParameters:c},l=!1){const u=[],h=CS(this._lastRenderIndex+1),f={layer:n[0],viewport:e,isPicking:s,renderPass:r,cullRect:o},d={};for(let m=0;m<n.length;m++){const _=n[m],T=this._shouldDrawLayer(_,f,i,d),p={shouldDrawLayer:T};T&&!l&&(p.layerRenderIndex=h(_,T),p.moduleParameters=this._getModuleParameters(_,a,r,c),p.layerParameters=this.getLayerParameters(_,m,e)),u[m]=p}return u}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:s,target:i,viewport:o,view:a},c){const l=gG(e,{moduleParameters:r,target:i,viewport:o});if(a&&a.props.clear){const h=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;On(e,{scissorTest:!0,scissor:l},()=>p0(e,h))}const u={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};Pr(e,{viewport:l});for(let h=0;h<n.length;h++){const f=n[h],{shouldDrawLayer:d,layerRenderIndex:m,moduleParameters:_,layerParameters:T}=c[h];if(d&&f.props.pickable&&u.pickableCount++,f.isComposite)u.compositeCount++;else if(d){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,m),_.viewport=o;try{f._drawLayer({moduleParameters:_,uniforms:{layerIndex:m},parameters:T})}catch(p){f.raiseError(p,"drawing ".concat(f," to ").concat(s))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,s){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in s||(s[a]=r(n)),!s[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,s){var i;const o=Object.assign(Object.create(((i=e.internalState)===null||i===void 0?void 0:i.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:uo(this.gl)});if(n)for(const c of n){var a;Object.assign(o,(a=c.getModuleParameters)===null||a===void 0?void 0:a.call(c,e))}return Object.assign(o,this.getModuleParameters(e,n),s)}}function CS(t=0,e={}){const n={},r=(s,i)=>{const o=s.props._offset,a=s.id,c=s.parent&&s.parent.id;let l;if(c&&!(c in e)&&r(s.parent,!1),c in n){const u=n[c]=n[c]||CS(e[c],e);l=u(s,i),n[a]=u}else Number.isFinite(o)?(l=o+(e[c]||0),n[a]=null):l=t;return i&&l>=t&&(t=l+1),e[a]=l,l};return r}function gG(t,{moduleParameters:e,target:n,viewport:r}){const s=n&&n.id!=="default-framebuffer",i=e&&e.devicePixelRatio||uo(t),o=s?n.height:t.drawingBufferHeight,a=r;return[a.x*i,o-(a.y+a.height)*i,a.width*i,a.height*i]}function mG(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;Pr(t,{viewport:[0,0,n,r]}),t.clear(16640)}class pG extends x0{constructor(e,n){super(e,n),g(this,"shadowMap",void 0),g(this,"depthBuffer",void 0),g(this,"fbo",void 0),this.shadowMap=new $t(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Vi(e,{format:33189,width:1,height:1}),this.fbo=new Je(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;On(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],s=uo(this.gl),i=r.width*s,o=r.height*s;(i!==n.width||o!==n.height)&&n.resize({width:i,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const BS="#define SMOOTH_EDGE_RADIUS 0.5",AG=`
`.concat(BS,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),_G=`
`.concat(BS,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),yG={name:"geometry",vs:AG,fs:_G},EG=Object.keys(ee).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(ee[t],";")).join(""),TG=Object.keys(tr).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(tr[t],";")).join(""),vG=Object.keys(um).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(um[t],";")).join(""),CG="".concat(EG,`
`).concat(TG,`
`).concat(vG,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function BG(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Lc(t){let e={},n;return r=>{for(const s in r)if(!BG(r[s],e[s])){n=t(r),e=r;break}return n}}const Py=[0,0,0,0],bG=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],bS=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],SG=[0,0,0],SS=[0,0,0],wG=Lc(RG);function wS(t,e,n=SS){n.length<3&&(n=[n[0],n[1],0]);let r=n,s,i=!0;switch(e===ee.LNGLAT_OFFSETS||e===ee.METER_OFFSETS?s=n:s=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case tr.WEB_MERCATOR:(e===ee.LNGLAT||e===ee.CARTESIAN)&&(s=[0,0,0],i=!1);break;case tr.WEB_MERCATOR_AUTO_OFFSET:e===ee.LNGLAT?r=s:e===ee.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],s=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case tr.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case tr.GLOBE:i=!1,s=null;break;default:i=!1}return{geospatialOrigin:s,shaderCoordinateOrigin:r,offsetMode:i}}function IG(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:s}=t;let{viewMatrix:i,viewProjectionMatrix:o}=t,a=Py,c=Py,l=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:f}=wS(t,e,n);return f&&(c=t.projectPosition(u||h),l=[l[0]-c[0],l[1]-c[1],l[2]-c[2]],c[3]=1,a=xc([],c,o),i=r||i,o=js([],s,i),o=js([],o,bG)),{viewMatrix:i,viewProjectionMatrix:o,projectionCenter:a,originCommon:c,cameraPosCommon:l,shaderCoordinateOrigin:h,geospatialOrigin:u}}function MG({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=ee.DEFAULT,coordinateOrigin:s=SS,autoWrapLongitude:i=!1}){r===ee.DEFAULT&&(r=t.isGeospatial?ee.LNGLAT:ee.CARTESIAN);const o=wG({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:s});return o.project_uWrapLongitude=i,o.project_uModelMatrix=n||bS,o}function RG({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:s,viewProjectionMatrix:i,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:c,geospatialOrigin:l}=IG(t,n,r),u=t.getDistanceScales(),h=[t.width*e,t.height*e],f=xc([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,d={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:o.slice(0,3),project_uCenter:s,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:f,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:SG,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:i,project_uModelMatrix:bS,project_uCameraPosition:a};if(l){const m=t.getDistanceScales(l);switch(n){case ee.METER_OFFSETS:d.project_uCommonUnitsPerWorldUnit=m.unitsPerMeter,d.project_uCommonUnitsPerWorldUnit2=m.unitsPerMeter2;break;case ee.LNGLAT:case ee.LNGLAT_OFFSETS:t._pseudoMeters||(d.project_uCommonUnitsPerMeter=m.unitsPerMeter),d.project_uCommonUnitsPerWorldUnit=m.unitsPerDegree,d.project_uCommonUnitsPerWorldUnit2=m.unitsPerDegree2;break;case ee.CARTESIAN:d.project_uCommonUnitsPerWorldUnit=[1,1,m.unitsPerMeter[2]],d.project_uCommonUnitsPerWorldUnit2=[0,0,m.unitsPerMeter2[2]];break}}return d}const xG={};function OG(t=xG){return"viewport"in t?MG(t):{}}const O0={name:"project",dependencies:[YD,yG],vs:CG,getUniforms:OG};function LG(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Zi(t,e){const n=xc([],e,t);return mS(n,n,1/n[3]),n}function Fy(t,e){const n=t%e;return n<0?e+n:n}function Tm(t,e,n){return t<e?e:t>n?n:t}function PG(t){return Math.log(t)*Math.LOG2E}const L0=Math.log2||PG;function Dr(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const wn=Math.PI,IS=wn/4,mn=wn/180,vm=180/wn,po=512,uh=4003e4,wl=85.051129,FG=1.5;function DG(t){return L0(t)}function dc(t){const[e,n]=t;Dr(Number.isFinite(e)),Dr(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*mn,s=n*mn,i=po*(r+wn)/(2*wn),o=po*(wn+Math.log(Math.tan(IS+s*.5)))/(2*wn);return[i,o]}function Ao(t){const[e,n]=t,r=e/po*(2*wn)-wn,s=2*(Math.atan(Math.exp(n/po*(2*wn)-wn))-IS);return[r*vm,s*vm]}function NG(t){const{latitude:e}=t;Dr(Number.isFinite(e));const n=Math.cos(e*mn);return DG(uh*n)-9}function vu(t){const e=Math.cos(t*mn);return po/uh/e}function Cm(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Dr(Number.isFinite(e)&&Number.isFinite(n));const s=po,i=Math.cos(e*mn),o=s/360,a=o/i,c=s/uh/i,l={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[o,a,c],degreesPerUnit:[1/o,1/a,1/c]};if(r){const u=mn*Math.tan(e*mn)/i,h=o*u/2,f=s/uh*u,d=f/a*c;l.unitsPerDegree2=[0,h,f],l.unitsPerMeter2=[d,0,d]}return l}function MS(t,e){const[n,r,s]=t,[i,o,a]=e,{unitsPerMeter:c,unitsPerMeter2:l}=Cm({longitude:n,latitude:r,highPrecision:!0}),u=dc(t);u[0]+=i*(c[0]+l[0]*o),u[1]+=o*(c[1]+l[1]*o);const h=Ao(u),f=(s||0)+(a||0);return Number.isFinite(s)||Number.isFinite(a)?[h[0],h[1],f]:h}function UG(t){const{height:e,pitch:n,bearing:r,altitude:s,scale:i,center:o}=t,a=LG();ch(a,a,[0,0,-s]),dS(a,a,-n*mn),gS(a,a,r*mn);const c=i/e;return w0(a,a,[c,c,c]),o&&ch(a,a,gN([],o)),a}function GG(t){const{width:e,height:n,altitude:r,pitch:s=0,offset:i,center:o,scale:a,nearZMultiplier:c=1,farZMultiplier:l=1}=t;let{fovy:u=hh(FG)}=t;r!==void 0&&(u=hh(r));const h=u*mn,f=s*mn,d=RS(u);let m=d;o&&(m+=o[2]*a/Math.cos(f)/n);const _=h*(.5+(i?i[1]:0)/n),T=Math.sin(_)*m/Math.sin(Tm(Math.PI/2-f-_,.01,Math.PI-.01)),p=Math.sin(f)*T+m,A=m*10,y=Math.min(p*l,A);return{fov:h,aspect:e/n,focalDistance:d,near:c,far:y}}function hh(t){return 2*Math.atan(.5/t)*vm}function RS(t){return .5/Math.tan(.5*t*mn)}function xS(t,e){const[n,r,s=0]=t;return Dr(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(s)),Zi(e,[n,r,s,1])}function P0(t,e,n=0){const[r,s,i]=t;if(Dr(Number.isFinite(r)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(i))return Zi(e,[r,s,i,1]);const o=Zi(e,[r,s,0,1]),a=Zi(e,[r,s,1,1]),c=o[2],l=a[2],u=c===l?0:((n||0)-c)/(l-c);return eS([],o,a,u)}function kG(t){const{width:e,height:n,bounds:r,minExtent:s=0,maxZoom:i=24,offset:o=[0,0]}=t,[[a,c],[l,u]]=r,h=HG(t.padding),f=dc([a,Tm(u,-wl,wl)]),d=dc([l,Tm(c,-wl,wl)]),m=[Math.max(Math.abs(d[0]-f[0]),s),Math.max(Math.abs(d[1]-f[1]),s)],_=[e-h.left-h.right-Math.abs(o[0])*2,n-h.top-h.bottom-Math.abs(o[1])*2];Dr(_[0]>0&&_[1]>0);const T=_[0]/m[0],p=_[1]/m[1],A=(h.right-h.left)/2/T,y=(h.top-h.bottom)/2/p,C=[(d[0]+f[0])/2+A,(d[1]+f[1])/2+y],b=Ao(C),S=Math.min(i,L0(Math.abs(Math.min(T,p))));return Dr(Number.isFinite(S)),{longitude:b[0],latitude:b[1],zoom:S}}function HG(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Dr(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const Dy=Math.PI/180;function VG(t,e=0){const{width:n,height:r,unproject:s}=t,i={targetZ:e},o=s([0,r],i),a=s([n,r],i);let c,l;const u=t.fovy?.5*t.fovy*Dy:Math.atan(.5/t.altitude),h=(90-t.pitch)*Dy;return u>h-.01?(c=Ny(t,0,e),l=Ny(t,n,e)):(c=s([0,0],i),l=s([n,0],i)),[o,a,l,c]}function Ny(t,e,n){const{pixelUnprojectionMatrix:r}=t,s=Zi(r,[e,0,1,1]),i=Zi(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-s[2])/(i[2]-s[2]),c=eS([],s,i,a),l=Ao(c);return l.push(n),l}const Uy=512;function jG(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:s,latitude:i,zoom:o,bearing:a=0}=t;(s<-180||s>180)&&(s=Fy(s+180,360)-180),(a<-180||a>180)&&(a=Fy(a+180,360)-180);const c=L0(n/Uy);if(o<=c)o=c,i=0;else{const l=n/2/Math.pow(2,o),u=Ao([0,l])[1];if(i<u)i=u;else{const h=Ao([0,Uy-l])[1];i>h&&(i=h)}}return{width:e,height:n,longitude:s,latitude:i,zoom:o,pitch:r,bearing:a}}const zG=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,JG=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,XG=Lc(QG),$G=Lc(qG),WG=[0,0,0,1],KG=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function YG(t,e){const[n,r,s]=t,i=P0([n,r,s],e);return Number.isFinite(s)?i:[i[0],i[1],0]}function QG({viewport:t,center:e}){return new q(t.viewProjectionMatrix).invert().transform(e)}function qG({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,i=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>YG(o,r));for(const o of e){const a=o.clone().translate(new w(t.center).negate()),c=i.map(u=>a.transform(u)),l=new q().ortho({left:Math.min(...c.map(u=>u[0])),right:Math.max(...c.map(u=>u[0])),bottom:Math.min(...c.map(u=>u[1])),top:Math.max(...c.map(u=>u[1])),near:Math.min(...c.map(u=>-u[2])),far:Math.max(...c.map(u=>-u[2]))});n.push(l.multiplyRight(o))}return n}function ZG(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||WG,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},s=XG({viewport:t.viewport,center:e.project_uCenter}),i=[],o=$G({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const c=o[a],l=c.clone().translate(new w(t.viewport.center).negate());e.project_uCoordinateSystem===ee.LNGLAT&&e.project_uProjectionMode===tr.WEB_MERCATOR?(o[a]=l,i[a]=s):(o[a]=c.clone().multiplyRight(KG),i[a]=l.transform(s))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=i[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const dd={name:"shadow",dependencies:[O0],vs:zG,fs:JG,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?ZG(t,e):{}},e9={color:[255,255,255],intensity:1},Gy=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],t9=[0,0,0,200/255];class OS{constructor(e={}){g(this,"id","lighting-effect"),g(this,"props",void 0),g(this,"shadowColor",t9),g(this,"shadow",void 0),g(this,"ambientLight",void 0),g(this,"directionalLights",void 0),g(this,"pointLights",void 0),g(this,"shadowPasses",[]),g(this,"shadowMaps",[]),g(this,"dummyShadowMap",null),g(this,"programManager",void 0),g(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:s,onViewportActive:i,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Oc.getDefaultProgramManager(e),dd&&this.programManager.addDefaultModule(dd)),this.dummyShadowMap||(this.dummyShadowMap=new $t(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:s,onViewportActive:i,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(dd),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new q().lookAt({eye:new w(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new pG(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new cG(e9),this.directionalLights.push(new Ly(Gy[0]),new Ly(Gy[1])))}}class n9{constructor(e={}){g(this,"_pool",[]),g(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:s,padding:i=0,copy:o=!1,initialize:a=!1,maxCount:c}){const l=s||e&&e.constructor||Float32Array,u=n*r+i;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new l(e.buffer,0,u)}let h=1/0;c&&(h=c*r+i);const f=this._allocate(l,u,a,h);return e&&o?f.set(e):a||f.fill(0,0,4),this._release(e),f}release(e){this._release(e)}_allocate(e,n,r,s){let i=Math.max(Math.ceil(n*this.opts.overAlloc),1);i>s&&(i=s);const o=this._pool,a=e.BYTES_PER_ELEMENT*i,c=o.findIndex(l=>l.byteLength>=a);if(c>=0){const l=new e(o.splice(c,1)[0],0,i);return r&&l.fill(0),l}return new e(i)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:s}=r,i=n.findIndex(o=>o.byteLength>=s);i<0?n.push(r):(i>0||n.length<this.opts.poolSize)&&n.splice(i,0,r),n.length>this.opts.poolSize&&n.shift()}}const gc=new n9;function _a(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function r9(t){return[t[12],t[13],t[14]]}function s9(t){return{left:Ai(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Ai(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Ai(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Ai(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Ai(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Ai(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const ky=new w;function Ai(t,e,n,r){ky.set(t,e,n);const s=ky.len();return{distance:r/s,normal:new w(-t/s,-e/s,-n/s)}}function i9(t){return t-Math.fround(t)}let qo;function gd(t,e){const{size:n=1,startIndex:r=0}=e,s=e.endIndex!==void 0?e.endIndex:t.length,i=(s-r)/n;qo=gc.allocate(qo,i,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<s;){for(let c=0;c<n;c++){const l=t[o++];qo[a+c]=l,qo[a+c+n]=i9(l)}a+=n*2}return qo.subarray(0,i*n*2)}function o9(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const a9=Math.PI/180,c9=_a(),Hy=[0,0,0],l9={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function u9({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:s,padding:i,near:o,far:a}){const c=t/e,l=n?new q().orthographic({fovy:r,aspect:c,focalDistance:s,near:o,far:a}):new q().perspective({fovy:r,aspect:c,near:o,far:a});if(i){const{left:u=0,right:h=0,top:f=0,bottom:d=0}=i,m=Br((u+t-h)/2,0,t)-t/2,_=Br((f+e-d)/2,0,e)-e/2;l[8]-=m*2/t,l[9]+=_*2/e}return l}class Io{constructor(e={}){g(this,"id",void 0),g(this,"x",void 0),g(this,"y",void 0),g(this,"width",void 0),g(this,"height",void 0),g(this,"padding",void 0),g(this,"isGeospatial",void 0),g(this,"zoom",void 0),g(this,"focalDistance",void 0),g(this,"position",void 0),g(this,"modelMatrix",void 0),g(this,"distanceScales",void 0),g(this,"scale",void 0),g(this,"center",void 0),g(this,"cameraPosition",void 0),g(this,"projectionMatrix",void 0),g(this,"viewMatrix",void 0),g(this,"viewMatrixUncentered",void 0),g(this,"viewMatrixInverse",void 0),g(this,"viewProjectionMatrix",void 0),g(this,"pixelProjectionMatrix",void 0),g(this,"pixelUnprojectionMatrix",void 0),g(this,"resolution",void 0),g(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||l9,this.focalDistance=e.focalDistance||1,this.position=e.position||Hy,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?tr.WEB_MERCATOR:tr.WEB_MERCATOR_AUTO_OFFSET:tr.IDENTITY}equals(e){return e instanceof Io?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Ln(e.projectionMatrix,this.projectionMatrix)&&Ln(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),s=xS(r,this.pixelProjectionMatrix),[i,o]=s,a=n?o:this.height-o;return e.length===2?[i,a]:[i,a,s[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[s,i,o]=e,a=n?i:this.height-i,c=r&&r*this.distanceScales.unitsPerMeter[2],l=P0([s,a,o],this.pixelUnprojectionMatrix,c),[u,h,f]=this.unprojectPosition(l);return Number.isFinite(o)?[u,h,f]:Number.isFinite(r)?[u,h,r]:[u,h]}projectPosition(e){const[n,r]=this.projectFlat(e),s=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,s]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),s=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,s]}projectFlat(e){if(this.isGeospatial){const n=dc(e);return n[1]=Br(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Ao(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),s=this.unproject([this.width,0],n),i=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],s[0],i[0],o[0]),Math.min(r[1],s[1],i[1],o[1]),Math.max(r[0],s[0],i[0],o[0]),Math.max(r[1],s[1],i[1],o[1])]}getDistanceScales(e){return e?Cm({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:s=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,s9(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=NG({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Cm({latitude:r,longitude:n}));const s=Math.pow(2,this.zoom);this.scale=s;const{position:i,modelMatrix:o}=e;let a=Hy;if(i&&(a=o?new q(o).transformAsVector(i,[]):i),this.isGeospatial){const c=this.projectPosition([n,r,0]);this.center=new w(a).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=c9,projectionMatrix:r=null,orthographic:s=!1,fovyRadians:i,fovy:o=75,near:a=.1,far:c=1e3,padding:l=null,focalDistance:u=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new q().multiplyRight(n).translate(new w(this.center).negate()),this.projectionMatrix=r||u9({width:this.width,height:this.height,orthographic:s,fovyRadians:i||o*a9,focalDistance:u,padding:l,near:a,far:c});const h=_a();js(h,h,this.projectionMatrix),js(h,h,this.viewMatrix),this.viewProjectionMatrix=h,this.viewMatrixInverse=ym([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=r9(this.viewMatrixInverse);const f=_a(),d=_a();w0(f,f,[this.width/2,-this.height/2,1]),ch(f,f,[1,-1,0]),js(d,f,this.viewProjectionMatrix),this.pixelProjectionMatrix=d,this.pixelUnprojectionMatrix=ym(_a(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||se.warn("Pixel project matrix not invertible")()}}g(Io,"displayName","Viewport");class Qs extends Io{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:s=0,pitch:i=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:c=1.01,nearZ:l,farZ:u,orthographic:h=!1,projectionMatrix:f,repeat:d=!1,worldOffset:m=0,position:_,padding:T,legacyMeterSizes:p=!1}=e;let{width:A,height:y,altitude:C=1.5}=e;const b=Math.pow(2,s);A=A||1,y=y||1;let S,I=null;if(f)C=f[5]/2,S=hh(C);else{e.fovy?(S=e.fovy,C=RS(S)):S=hh(C);let O;if(T){const{top:M=0,bottom:U=0}=T;O=[0,Br((M+y-U)/2,0,y)-y/2]}I=GG({width:A,height:y,scale:b,center:_&&[0,0,_[2]*vu(n)],offset:O,pitch:i,fovy:S,nearZMultiplier:a,farZMultiplier:c}),Number.isFinite(l)&&(I.near=l),Number.isFinite(u)&&(I.far=u)}let x=UG({height:y,pitch:i,bearing:o,scale:b,altitude:C});m&&(x=new q().translate([512*m,0,0]).multiplyLeft(x)),super({...e,width:A,height:y,viewMatrix:x,longitude:r,latitude:n,zoom:s,...I,fovy:S,focalDistance:C}),g(this,"longitude",void 0),g(this,"latitude",void 0),g(this,"pitch",void 0),g(this,"bearing",void 0),g(this,"altitude",void 0),g(this,"fovy",void 0),g(this,"orthographic",void 0),g(this,"_subViewports",void 0),g(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=s,this.pitch=i,this.bearing=o,this.altitude=C,this.fovy=S,this.orthographic=h,this._subViewports=d?[]:null,this._pseudoMeters=p,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let s=n;s<=r;s++){const i=s?new Qs({...this,worldOffset:s}):this;this._subViewports.push(i)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),s=(e[2]||0)*vu(e[1]);return[n,r,s]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),s=(e[2]||0)/vu(r);return[n,r,s]}addMetersToLngLat(e,n){return MS(e,n)}panByPosition(e,n){const r=P0(n,this.pixelUnprojectionMatrix),s=this.projectFlat(e),i=vy([],s,cN([],r)),o=vy([],this.center,i),[a,c]=this.unprojectFlat(o);return{longitude:a,latitude:c}}getBounds(e={}){const n=VG(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:s}=this,{longitude:i,latitude:o,zoom:a}=kG({width:r,height:s,bounds:e,...n});return new Qs({width:r,height:s,longitude:i,latitude:o,zoom:a})}}g(Qs,"displayName","WebMercatorViewport");const Vy=[0,0,0];function md(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Qs){const[s,i,o=0]=t,a=e.getDistanceScales([s,i]);r[2]=o*a.unitsPerMeter[2]}return r}function h9(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:s,fromCoordinateSystem:i,fromCoordinateOrigin:o}=t;return s===ee.DEFAULT&&(s=e.isGeospatial?ee.LNGLAT:ee.CARTESIAN),i===void 0&&(i=s),o===void 0&&(o=r),{viewport:e,coordinateSystem:s,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:i,fromCoordinateOrigin:o}}function LS(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:s,offsetMode:i}){let[o,a,c=0]=t;switch(n&&([o,a,c]=xc([],[o,a,c,1],n)),r){case ee.LNGLAT:return md([o,a,c],e,i);case ee.LNGLAT_OFFSETS:return md([o+s[0],a+s[1],c+(s[2]||0)],e,i);case ee.METER_OFFSETS:return md(MS(s,[o,a,c]),e,i);case ee.CARTESIAN:default:return e.isGeospatial?[o+s[0],a+s[1],c+s[2]]:e.projectPosition([o,a,c])}}function f9(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:s,modelMatrix:i,fromCoordinateSystem:o,fromCoordinateOrigin:a}=h9(e),{autoOffset:c=!0}=e,{geospatialOrigin:l=Vy,shaderCoordinateOrigin:u=Vy,offsetMode:h=!1}=c?wS(n,r,s):{},f=LS(t,{viewport:n,modelMatrix:i,coordinateSystem:o,coordinateOrigin:a,offsetMode:h});if(h){const d=n.projectPosition(l||u);EN(f,f,d)}return f}const jy={blendFunc:[1,0,32771,0],blendEquation:32774};class PS extends x0{constructor(...e){super(...e),g(this,"pickZ",void 0),g(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:s,onViewportActive:i,pickingFBO:o,deviceRect:{x:a,y:c,width:l,height:u},cullRect:h,effects:f,pass:d="picking",pickZ:m,moduleParameters:_}){const T=this.gl;this.pickZ=m;const p=this._resetColorEncoder(m),A=On(T,{scissorTest:!0,scissor:[a,c,l,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...jy,blend:!m},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:s,onViewportActive:i,cullRect:h,effects:f==null?void 0:f.filter(C=>C.useInPicking),pass:d,isPicking:!0,moduleParameters:_}));return this._colorEncoderState=null,{decodePickingColor:p&&g9.bind(null,p),stats:A}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const s={...e.props.parameters},{pickable:i,operation:o}=e.props;return this._colorEncoderState?i&&o.includes("draw")&&(Object.assign(s,jy),s.blend=!0,s.blendColor=d9(this._colorEncoderState,e,r)):s.blend=!1,o.includes("terrain")&&(s.blend=!1),s}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function d9(t,e,n){const{byLayer:r,byAlpha:s}=t;let i,o=r.get(e);return o?(o.viewports.push(n),i=o.a):(i=r.size+1,i<=255?(o={a:i,layer:e,viewports:[n]},r.set(e,o),s[i]=o):(se.warn("Too many pickable layers, only picking the first 255")(),i=0)),[0,0,0,i/255]}function g9(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const wi={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},fh=Symbol.for("component"),ds=Symbol.for("propTypes"),pd=Symbol.for("deprecatedProps"),eo=Symbol.for("asyncPropDefaults"),qs=Symbol.for("asyncPropOriginal"),ns=Symbol.for("asyncPropResolved");function _o(t,e=()=>!0){return Array.isArray(t)?FS(t,e,[]):e(t)?[t]:[]}function FS(t,e,n){let r=-1;for(;++r<t.length;){const s=t[r];Array.isArray(s)?FS(s,e,n):e(s)&&n.push(s)}return n}function m9({target:t,source:e,start:n=0,count:r=1}){const s=e.length,i=r*s;let o=0;for(let a=n;o<s;o++)t[a++]=e[o];for(;o<i;)o<i-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+i-o),o=i);return t}class p9{constructor(e,n,r){g(this,"id",void 0),g(this,"context",void 0),g(this,"isLoaded",void 0),g(this,"persistent",void 0),g(this,"_loadCount",0),g(this,"_subscribers",new Set),g(this,"_data",void 0),g(this,"_loader",void 0),g(this,"_error",void 0),g(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let s=e;typeof e=="string"&&(s=ar(e)),s instanceof Promise?(this.isLoaded=!1,this._loader=s.then(i=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=i)}).catch(i=>{this._loadCount===r&&(this.isLoaded=!0,this._error=i||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const i of this._subscribers)i.onChange(this.getData())}}class A9{constructor({gl:e,protocol:n}){g(this,"protocol",void 0),g(this,"_context",void 0),g(this,"_resources",void 0),g(this,"_consumers",void 0),g(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:s=!0}){let i=this._resources[e];i?i.setData(n,r):(i=new p9(e,n,this._context),this._resources[e]=i),i.persistent=s}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const s=n[r],i=this._resources[s.resourceId];i&&i.unsubscribe(s)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:s="default"}){const{_resources:i,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),i[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=i[e];if(this._track(r,s,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,s){const i=this._consumers,o=i[e]=i[e]||{},a=o[n]||{},c=a.resourceId&&this._resources[a.resourceId];c&&(c.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=s,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const _9=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,F0={name:"project32",dependencies:[O0],vs:_9},D0={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...IU},y9=[O0],E9=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function T9(t){const e=Oc.getDefaultProgramManager(t);for(const n of y9)e.addDefaultModule(n);for(const n of E9)e.addShaderHook(n);return e}const v9="layerManager.setLayers",C9="layerManager.activateViewport";class B9{constructor(e,{deck:n,stats:r,viewport:s,timeline:i}={}){g(this,"layers",void 0),g(this,"context",void 0),g(this,"resourceManager",void 0),g(this,"_lastRenderedLayers",[]),g(this,"_needsRedraw",!1),g(this,"_needsUpdate",!1),g(this,"_nextLayers",null),g(this,"_debug",!1),g(this,"activateViewport",o=>{st(C9,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new A9({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&T9(e),stats:r||new g0({id:"deck.gl"}),viewport:s||new Io({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:i||new vS,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const s=r.getNeedsRedraw(e);n=n||s}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){st(v9,this,n,e),this._lastRenderedLayers=e;const r=_o(e,Boolean);for(const s of r)s.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?se.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const s=[];this._updateSublayersRecursively(n,r,s),this._finalizeOldLayers(r);let i=!1;for(const o of s)if(o.hasUniformTransition()){i="Uniform transition in ".concat(o);break}this._needsUpdate=i,this.layers=s}_updateSublayersRecursively(e,n,r){for(const s of e){s.context=this.context;const i=n[s.id];i===null&&se.warn("Multiple new layers with same id ".concat(s.id))(),n[s.id]=null;let o=null;try{this._debug&&i!==s&&s.validateProps(),i?(this._transferLayerState(i,s),this._updateLayer(s)):this._initializeLayer(s),r.push(s),o=s.isComposite?s.getSubLayers():null}catch(a){this._handleError("matching",a,s)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=wi.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=wi.MATCHED,n!==e&&(e.lifecycle=wi.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=wi.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=wi.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function nr(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!nr(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(const i of r)if(!e.hasOwnProperty(i)||!nr(t[i],e[i],n-1))return!1;return!0}return!1}class b9{constructor(e){g(this,"width",void 0),g(this,"height",void 0),g(this,"views",void 0),g(this,"viewState",void 0),g(this,"controllers",void 0),g(this,"timeline",void 0),g(this,"_viewports",void 0),g(this,"_viewportMap",void 0),g(this,"_isUpdating",void 0),g(this,"_needsRedraw",void 0),g(this,"_needsUpdate",void 0),g(this,"_eventManager",void 0),g(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),s={x:e[0],y:e[1]};for(let i=r.length-1;i>=0;--i){const o=r[i];if(o.containsPixel(s)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=_o(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!nr(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):se.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:i=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:i,width:this.width,height:this.height})}})}_updateController(e,n,r,s){const i=e.controller;if(i&&r){const o={...n,...i,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!s||s.constructor!==i.type)&&(s=this._createController(e,o)),s&&s.setProps(o),s}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let s=e.length;s--;){const i=e[s],o=this.getViewState(i),a=i.makeViewport({viewState:o,width:this.width,height:this.height});let c=n[i.id];const l=!!i.controller;l&&!c&&(r=!0),(r||!l)&&c&&(c.finalize(),c=null),this.controllers[i.id]=this._updateController(i,o,a,c),a&&this._viewports.unshift(a)}for(const s in n){const i=n[s];i&&!this.controllers[s]&&i.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,s)=>!e[s].equals(n[s]))}}const S9=/([0-9]+\.?[0-9]*)(%|px)/;function zr(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=S9.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Jr(t,e){return t.relative?Math.round(t.position*e):t.position}function Ue(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class w9{constructor(e){g(this,"id",void 0),g(this,"viewportInstance",void 0),g(this,"_x",void 0),g(this,"_y",void 0),g(this,"_width",void 0),g(this,"_height",void 0),g(this,"_padding",void 0),g(this,"props",void 0);const{id:n,x:r=0,y:s=0,width:i="100%",height:o="100%",padding:a=null,viewportInstance:c}=e||{};Ue(!c||c instanceof Io),this.viewportInstance=c,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=zr(r),this._y=zr(s),this._width=zr(i),this._height=zr(o),this._padding=a&&{left:zr(a.left||0),right:zr(a.right||0),top:zr(a.top||0),bottom:zr(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&nr(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const s=this.getDimensions({width:e,height:n});return!s.height||!s.width?null:new this.ViewportType({...r,...this.props,...s})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Jr(this._x,e),y:Jr(this._y,n),width:Jr(this._width,e),height:Jr(this._height,n)};return this._padding&&(r.padding={left:Jr(this._padding.left,e),top:Jr(this._padding.top,n),right:Jr(this._padding.right,e),bottom:Jr(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Pc{constructor(e){g(this,"_inProgress",void 0),g(this,"_handle",void 0),g(this,"_timeline",void 0),g(this,"time",void 0),g(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:s}=this;this._handle=r.addChannel({delay:r.getTime(),duration:s.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const zy=()=>{},Bm={BREAK:1,SNAP_TO_END:2,IGNORE:3},I9=t=>t,M9=Bm.BREAK;class R9{constructor(e){g(this,"getControllerState",void 0),g(this,"props",void 0),g(this,"propsInTransition",void 0),g(this,"transition",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:s,startProps:i,endProps:o,duration:a,easing:c}}=n,l=c(r/a),u=s.interpolateProps(i,o,l);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Pc(e.timeline),this.onViewStateChange=e.onViewStateChange||zy,this.onStateChange=e.onStateChange||zy}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let s=r;if(this.transition.inProgress){const{interruption:i,endProps:o}=this.transition.settings;s={...r,...i===Bm.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(s,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Bm.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),s=this.getControllerState(n).shortestPathFrom(r),i=n.transitionInterpolator,o=i.getDuration?i.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=i.initializeProps(e,s);this.propsInTransition={};const c={duration:o,easing:n.transitionEasing||I9,interpolator:i,interruption:n.transitionInterruption||M9,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class x9{constructor(e){g(this,"_propsToCompare",void 0),g(this,"_propsToExtract",void 0),g(this,"_requiredProps",void 0);const{compare:n,extract:r,required:s}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=s}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Ln(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},s={};for(const i of this._propsToExtract)(i in e||i in n)&&(r[i]=e[i],s[i]=n[i]);return this._checkRequiredProps(r),this._checkRequiredProps(s),{start:r,end:s}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Ue(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const O9=["longitude","latitude","zoom","bearing","pitch"],L9=["longitude","latitude","zoom"];class DS extends x9{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:O9,required:L9},super(r.transitionProps),g(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:s,around:i}=this.opts;if(s&&i){const o=s(e),a=s(n),c=o.unproject(i);r.start.around=i,Object.assign(r.end,{around:a.project(c),aroundPosition:c,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const s={};for(const i of this._propsToExtract)s[i]=ah(e[i]||0,n[i]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const i=this.opts.makeViewport({...n,...s});Object.assign(s,i.panByPosition(n.aroundPosition,ah(e.around,n.around,r)))}return s}}const Xr={transitionDuration:0},P9=300,Il=t=>1-(1-t)*(1-t),_i={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},ws={};class F9{constructor(e){g(this,"props",void 0),g(this,"state",{}),g(this,"transitionManager",void 0),g(this,"eventManager",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"makeViewport",void 0),g(this,"_controllerState",void 0),g(this,"_events",{}),g(this,"_interactionState",{isDragging:!1}),g(this,"_customEvents",[]),g(this,"_eventStartBlocked",null),g(this,"_panMove",!1),g(this,"invertPan",!1),g(this,"dragMode","rotate"),g(this,"inertia",0),g(this,"scrollZoom",!0),g(this,"dragPan",!0),g(this,"dragRotate",!0),g(this,"doubleClickZoom",!0),g(this,"touchZoom",!0),g(this,"touchRotate",!1),g(this,"keyboard",!0),this.transitionManager=new R9({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:s}=e;return[s.x-n,s.y-r]}isPointInBounds(e,n){const{width:r,height:s}=this.props;if(n&&n.handled)return!1;const i=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=s;return i&&n&&n.stopPropagation(),i}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?P9:0;const{scrollZoom:r=!0,dragPan:s=!0,dragRotate:i=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:c=!1,keyboard:l=!0}=e,u=!!this.onViewStateChange;this.toggleEvents(_i.WHEEL,u&&r),this.toggleEvents(_i.PAN,u),this.toggleEvents(_i.PINCH,u&&(a||c)),this.toggleEvents(_i.TRIPLE_PAN,u&&c),this.toggleEvents(_i.DOUBLE_TAP,u&&o),this.toggleEvents(_i.KEYBOARD,u&&l),this.scrollZoom=r,this.dragPan=s,this.dragRotate=i,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=c,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const s={...e.getViewportProps(),...n},i=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),i){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:s,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const s=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(s,Xr,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Xr,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),s=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],i=this.controllerState.pan({pos:s}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Il},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Xr,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),s=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],i=this.controllerState.rotate({pos:s}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Il},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:s=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:i}=e;let o=2/(1+Math.exp(-Math.abs(i*r)));i<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:s?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Xr,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Xr,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),s=[r[0],r[1]+=e.velocityY*n/2],i=this.controllerState.rotate({pos:s});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Il},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return ws._startPinchRotation=e.rotation,ws._lastPinchEvent=e,this.updateViewport(r,Xr,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,s=this.getCenter(e);n=n.zoom({pos:s,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:ws._startPinchRotation-r})}return this.updateViewport(n,Xr,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),ws._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=ws;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const s=this.getCenter(e);let i=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),c=Math.pow(2,o+a*n/2);i=i.zoom({pos:s,scale:c}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:s}),transitionDuration:n,transitionEasing:Il},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const s=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(s,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return ws._startPinchRotation=null,ws._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),s=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(s,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:s,rotateSpeedX:i,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let c;const l={};switch(e.srcEvent.code){case"Minus":c=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),l.isZooming=!0;break;case"Equal":c=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),l.isZooming=!0;break;case"ArrowLeft":n?(c=a.rotateLeft(i),l.isRotating=!0):(c=a.moveLeft(s),l.isPanning=!0);break;case"ArrowRight":n?(c=a.rotateRight(i),l.isRotating=!0):(c=a.moveRight(s),l.isPanning=!0);break;case"ArrowUp":n?(c=a.rotateUp(o),l.isRotating=!0):(c=a.moveUp(s),l.isPanning=!0);break;case"ArrowDown":n?(c=a.rotateDown(o),l.isRotating=!0):(c=a.moveDown(s),l.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Xr:e?{...n,transitionInterpolator:new DS({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class D9{constructor(e,n){g(this,"_viewportProps",void 0),g(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Jy=5,N9=1.2;class U9 extends D9{constructor(e){const{width:n,height:r,latitude:s,longitude:i,zoom:o,bearing:a=0,pitch:c=0,altitude:l=1.5,position:u=[0,0,0],maxZoom:h=20,minZoom:f=0,maxPitch:d=60,minPitch:m=0,startPanLngLat:_,startZoomLngLat:T,startRotatePos:p,startBearing:A,startPitch:y,startZoom:C,normalize:b=!0}=e;Ue(Number.isFinite(i)),Ue(Number.isFinite(s)),Ue(Number.isFinite(o)),super({width:n,height:r,latitude:s,longitude:i,zoom:o,bearing:a,pitch:c,altitude:l,maxZoom:h,minZoom:f,maxPitch:d,minPitch:m,normalize:b,position:u},{startPanLngLat:_,startZoomLngLat:T,startRotatePos:p,startBearing:A,startPitch:y,startZoom:C}),g(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:s,startBearing:i,startPitch:o}=this.getState();if(!s||i===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,s,o,i):a={bearing:i+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:s,startZoomLngLat:i}=this.getState();if(i||(s=this.getViewportProps().zoom,i=this._unproject(n)||this._unproject(e)),!i)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let c=s+Math.log2(r);c=Br(c,a,o);const l=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...l.panByPosition(i,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:s,longitude:i}=r;return Math.abs(s-n.bearing)>180&&(r.bearing=s<0?s+360:s-360),Math.abs(i-n.longitude)>180&&(r.longitude=i<0?i+360:i-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:s}=e;e.zoom=Br(s,r,n);const{maxPitch:i,minPitch:o,pitch:a}=e;e.pitch=Br(a,o,i);const{normalize:c=!0}=e;return c&&Object.assign(e,jG(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,s){const i=e[0]-n[0],o=e[1]-n[1],a=e[1],c=n[1],{width:l,height:u}=this.getViewportProps(),h=i/l;let f=0;o>0?Math.abs(u-c)>Jy&&(f=o/(c-u)*N9):o<0&&c>Jy&&(f=1-a/c),f=Br(f,-1,1);const{minPitch:d,maxPitch:m}=this.getViewportProps(),_=s+180*h;let T=r;return f>0?T=r+f*(m-r):f<0&&(T=r-f*(d-r)),{pitch:T,bearing:_}}}class G9 extends F9{constructor(...e){super(...e),g(this,"ControllerState",U9),g(this,"transition",{transitionDuration:300,transitionInterpolator:new DS({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),g(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class N0 extends w9{get ViewportType(){return Qs}get ControllerType(){return G9}}g(N0,"displayName","MapView");const k9=new OS;function H9(t,e){var n,r;const s=(n=t.order)!==null&&n!==void 0?n:1/0,i=(r=e.order)!==null&&r!==void 0?r:1/0;return s-i}class V9{constructor(){g(this,"effects",void 0),g(this,"_resolvedEffects",[]),g(this,"_defaultEffects",[]),g(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(s=>H9(s,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(nr(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const s of this.effects)n[s.id]=s;const r=[];for(const s of e){const i=n[s.id];i&&i!==s?i.setProps?(i.setProps(s.props),r.push(i)):(i.cleanup(),r.push(s)):r.push(s),delete n[s.id]}for(const s in n)n[s].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(s=>s instanceof OS)||this._resolvedEffects.push(k9),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class j9 extends x0{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const z9="deckRenderer.renderLayers";class J9{constructor(e){g(this,"gl",void 0),g(this,"layerFilter",void 0),g(this,"drawPickingColors",void 0),g(this,"drawLayersPass",void 0),g(this,"pickLayersPass",void 0),g(this,"renderCount",void 0),g(this,"_needsRedraw",void 0),g(this,"renderBuffers",void 0),g(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new j9(e),this.pickLayersPass=new PS(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||Je.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const s=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,i=n.render({...r,target:s});r.effects&&this._postRender(r.effects,r),this.renderCount++,st(z9,this,i,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new Je(this.gl),new Je(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,s={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const i of e)if(i.postRender){if(i.id===this.lastPostProcessEffect){s.target=n.target,i.postRender(this.gl,s);break}const o=i.postRender(this.gl,s);s.inputBuffer=o,s.swapBuffer=o===r[0]?r[1]:r[0]}}}const X9={pickedColor:null,pickedObjectIndex:-1};function $9({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:s,deviceRect:i}){const{x:o,y:a,width:c,height:l}=i;let u=s*s,h=-1,f=0;for(let d=0;d<l;d++){const m=d+a-r,_=m*m;if(_>u)f+=4*c;else for(let T=0;T<c;T++){if(t[f+3]-1>=0){const A=T+o-n,y=A*A+_;y<=u&&(u=y,h=f)}f+=4}}if(h>=0){const d=t.slice(h,h+4),m=e(d);if(m){const _=Math.floor(h/4/c),T=h/4-_*c;return{...m,pickedColor:d,pickedX:o+T,pickedY:a+_}}se.error("Picked non-existent layer. Is picking buffer corrupt?")()}return X9}function W9({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const i=t.slice(r,r+4),o=i.join(",");if(!n.has(o)){const a=e(i);a?n.set(o,{...a,color:i}):se.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function NS({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:s,z:i}){let o=e[0];e.length>1&&(o=Y9((t==null?void 0:t.pickedViewports)||e,{x:r,y:s}));let a;if(o){const c=[r-o.x,s-o.y];i!==void 0&&(c[2]=i),a=o.unproject(c)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:s,pixel:[r,s],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function K9(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:s}=t,{pickedColor:i,pickedLayer:o,pickedObjectIndex:a}=e,c=o?[o]:[];if(r==="hover"){const h=n.index,f=n.layerId,d=o?o.props.id:null;if(d!==f||a!==h){if(d!==f){const m=s.find(_=>_.props.id===f);m&&c.unshift(m)}n.layerId=d,n.index=a,n.info=null}}const l=NS(t),u=new Map;return u.set(null,l),c.forEach(h=>{let f={...l};h===o&&(f.color=i,f.index=a,f.picked=!0),f=US({layer:h,info:f,mode:r});const d=f.layer;h===o&&r==="hover"&&(n.info=f),u.set(d.id,f),r==="hover"&&d.updateAutoHighlight(f)}),u}function US({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function Y9(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class Q9{constructor(e){g(this,"gl",void 0),g(this,"pickingFBO",void 0),g(this,"depthFBO",void 0),g(this,"pickLayersPass",void 0),g(this,"layerFilter",void 0),g(this,"lastPickedInfo",void 0),g(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new PS(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:s},i=this.lastPickedInfo.info){const o=i&&i.layer&&i.layer.id,a=i&&i.viewport&&i.viewport.id,c=o?r.find(f=>f.id===o):null,l=a&&s.find(f=>f.id===a)||s[0],u=l&&l.unproject([e-l.x,n-l.y]);return{...i,...{x:e,y:n,viewport:l,coordinate:u,layer:c}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new Je(r),Je.isSupported(r,{colorBufferFloat:!0}))){const s=new Je(r);s.attach({36064:new $t(r,{format:Y(r)?34836:6408,type:5126})}),this.depthFBO=s}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:s,y:i,radius:o=0,depth:a=1,mode:c="query",unproject3D:l,onViewportActive:u,effects:h}){const f=this._getPickable(e),d=uo(this.gl);if(!f)return{result:[],emptyInfo:NS({viewports:r,x:s,y:i,pixelRatio:d})};this._resizeBuffer();const m=ed(this.gl,[s,i],!0),_=[m.x+Math.floor(m.width/2),m.y+Math.floor(m.height/2)],T=Math.round(o*d),{width:p,height:A}=this.pickingFBO,y=this._getPickingRect({deviceX:_[0],deviceY:_[1],deviceRadius:T,deviceWidth:p,deviceHeight:A}),C={x:s-o,y:i-o,width:o*2+1,height:o*2+1};let b;const S=[],I=new Set;for(let x=0;x<a;x++){let O;if(y){const U=this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:u,deviceRect:y,cullRect:C,effects:h,pass:"picking:".concat(c)});O=$9({...U,deviceX:_[0],deviceY:_[1],deviceRadius:T,deviceRect:y})}else O={pickedColor:null,pickedObjectIndex:-1};let M;if(O.pickedLayer&&l&&this.depthFBO){const{pickedColors:U}=this._drawAndSample({layers:[O.pickedLayer],views:n,viewports:r,onViewportActive:u,deviceRect:{x:O.pickedX,y:O.pickedY,width:1,height:1},cullRect:C,effects:h,pass:"picking:".concat(c,":z")},!0);U[3]&&(M=U[0])}O.pickedLayer&&x+1<a&&(I.add(O.pickedLayer),O.pickedLayer.disablePickingIndex(O.pickedObjectIndex)),b=K9({pickInfo:O,lastPickedInfo:this.lastPickedInfo,mode:c,layers:f,viewports:r,x:s,y:i,z:M,pixelRatio:d});for(const U of b.values())U.layer&&S.push(U);if(!O.pickedColor)break}for(const x of I)x.restorePickingColors();return{result:S,emptyInfo:b.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:s,y:i,width:o=1,height:a=1,mode:c="query",maxObjects:l=null,onViewportActive:u,effects:h}){const f=this._getPickable(e);if(!f)return[];this._resizeBuffer();const d=uo(this.gl),m=ed(this.gl,[s,i],!0),_=m.x,T=m.y+m.height,p=ed(this.gl,[s+o,i+a],!0),A=p.x+p.width,y=p.y,C={x:_,y,width:A-_,height:T-y},b=this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:u,deviceRect:C,cullRect:{x:s,y:i,width:o,height:a},effects:h,pass:"picking:".concat(c)}),S=W9(b),I=new Map,x=Number.isFinite(l);for(let M=0;M<S.length;M++){var O;if(x&&l&&I.size>=l)break;const U=S[M];let J={color:U.pickedColor,layer:null,index:U.pickedObjectIndex,picked:!0,x:s,y:i,pixelRatio:d};J=US({layer:U.pickedLayer,info:J,mode:c});const W=(O=J.object)!==null&&O!==void 0?O:"".concat(J.layer.id,"[").concat(J.index,"]");I.has(W)||I.set(W,J)}return Array.from(I.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:s,deviceRect:i,cullRect:o,effects:a,pass:c},l=!1){const u=l?this.depthFBO:this.pickingFBO,h={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:s,pickingFBO:u,deviceRect:i,cullRect:o,effects:a,pass:c,pickZ:l,preRenderStats:{}};for(const A of a)A.useInPicking&&(h.preRenderStats[A.id]=A.preRender(this.gl,h));const{decodePickingColor:f}=this.pickLayersPass.render(h),{x:d,y:m,width:_,height:T}=i,p=new(l?Float32Array:Uint8Array)(_*T*4);return Wh(u,{sourceX:d,sourceY:m,sourceWidth:_,sourceHeight:T,target:p}),{pickedColors:p,decodePickingColor:f}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:s,deviceHeight:i}){const o=Math.max(0,e-r),a=Math.max(0,n-r),c=Math.min(s,e+r+1)-o,l=Math.min(i,n+r+1)-a;return c<=0||l<=0?null:{x:o,y:a,width:c,height:l}}}const q9={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Z9{constructor(e){g(this,"el",null),g(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,q9),n.appendChild(this.el))}setTooltip(e,n,r){const s=this.el;if(s){if(typeof e=="string")s.innerText=e;else if(e)e.text&&(s.innerText=e.text),e.html&&(s.innerHTML=e.html),e.className&&(s.className=e.className);else{this.isVisible=!1,s.style.display="none";return}this.isVisible=!0,s.style.display="block",s.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(s.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var GS={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,s){var i=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",c=Math.round,l=Math.abs,u=Date.now;function h(E,v,B){return setTimeout(y(E,B),v)}function f(E,v,B){return Array.isArray(E)?(d(E,B[v],B),!0):!1}function d(E,v,B){var R;if(E)if(E.forEach)E.forEach(v,B);else if(E.length!==s)for(R=0;R<E.length;)v.call(B,E[R],R,E),R++;else for(R in E)E.hasOwnProperty(R)&&v.call(B,E[R],R,E)}function m(E,v,B){var R="DEPRECATED METHOD: "+v+`
`+B+` AT 
`;return function(){var P=new Error("get-stack-trace"),V=P&&P.stack?P.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Q=e.console&&(e.console.warn||e.console.log);return Q&&Q.call(e.console,R,V),E.apply(this,arguments)}}var _;typeof Object.assign!="function"?_=function(v){if(v===s||v===null)throw new TypeError("Cannot convert undefined or null to object");for(var B=Object(v),R=1;R<arguments.length;R++){var P=arguments[R];if(P!==s&&P!==null)for(var V in P)P.hasOwnProperty(V)&&(B[V]=P[V])}return B}:_=Object.assign;var T=m(function(v,B,R){for(var P=Object.keys(B),V=0;V<P.length;)(!R||R&&v[P[V]]===s)&&(v[P[V]]=B[P[V]]),V++;return v},"extend","Use `assign`."),p=m(function(v,B){return T(v,B,!0)},"merge","Use `assign`.");function A(E,v,B){var R=v.prototype,P;P=E.prototype=Object.create(R),P.constructor=E,P._super=R,B&&_(P,B)}function y(E,v){return function(){return E.apply(v,arguments)}}function C(E,v){return typeof E==a?E.apply(v&&v[0]||s,v):E}function b(E,v){return E===s?v:E}function S(E,v,B){d(M(v),function(R){E.addEventListener(R,B,!1)})}function I(E,v,B){d(M(v),function(R){E.removeEventListener(R,B,!1)})}function x(E,v){for(;E;){if(E==v)return!0;E=E.parentNode}return!1}function O(E,v){return E.indexOf(v)>-1}function M(E){return E.trim().split(/\s+/g)}function U(E,v,B){if(E.indexOf&&!B)return E.indexOf(v);for(var R=0;R<E.length;){if(B&&E[R][B]==v||!B&&E[R]===v)return R;R++}return-1}function J(E){return Array.prototype.slice.call(E,0)}function W(E,v,B){for(var R=[],P=[],V=0;V<E.length;){var Q=v?E[V][v]:E[V];U(P,Q)<0&&R.push(E[V]),P[V]=Q,V++}return B&&(v?R=R.sort(function(Ye,ht){return Ye[v]>ht[v]}):R=R.sort()),R}function H(E,v){for(var B,R,P=v[0].toUpperCase()+v.slice(1),V=0;V<i.length;){if(B=i[V],R=B?B+P:v,R in E)return R;V++}return s}var Ce=1;function Yt(){return Ce++}function xt(E){var v=E.ownerDocument||E;return v.defaultView||v.parentWindow||e}var G=/mobile|tablet|ip(ad|hone|od)|android/i,X="ontouchstart"in e,K=H(e,"PointerEvent")!==s,ue=X&&G.test(navigator.userAgent),le="touch",Gn="pen",Qt="mouse",vs="kinect",cr=25,Pe=1,Cs=2,Fe=4,_t=8,Hc=1,Oo=2,Lo=4,Po=8,Fo=16,kn=Oo|Lo,Bs=Po|Fo,NA=kn|Bs,UA=["x","y"],Vc=["clientX","clientY"];function qt(E,v){var B=this;this.manager=E,this.callback=v,this.element=E.element,this.target=E.options.inputTarget,this.domHandler=function(R){C(E.options.enable,[E])&&B.handler(R)},this.init()}qt.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(xt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&I(this.element,this.evEl,this.domHandler),this.evTarget&&I(this.target,this.evTarget,this.domHandler),this.evWin&&I(xt(this.element),this.evWin,this.domHandler)}};function pM(E){var v,B=E.options.inputClass;return B?v=B:K?v=cf:ue?v=Jc:X?v=lf:v=zc,new v(E,AM)}function AM(E,v,B){var R=B.pointers.length,P=B.changedPointers.length,V=v&Pe&&R-P===0,Q=v&(Fe|_t)&&R-P===0;B.isFirst=!!V,B.isFinal=!!Q,V&&(E.session={}),B.eventType=v,_M(E,B),E.emit("hammer.input",B),E.recognize(B),E.session.prevInput=B}function _M(E,v){var B=E.session,R=v.pointers,P=R.length;B.firstInput||(B.firstInput=GA(v)),P>1&&!B.firstMultiple?B.firstMultiple=GA(v):P===1&&(B.firstMultiple=!1);var V=B.firstInput,Q=B.firstMultiple,Xe=Q?Q.center:V.center,Ye=v.center=kA(R);v.timeStamp=u(),v.deltaTime=v.timeStamp-V.timeStamp,v.angle=af(Xe,Ye),v.distance=jc(Xe,Ye),yM(B,v),v.offsetDirection=VA(v.deltaX,v.deltaY);var ht=HA(v.deltaTime,v.deltaX,v.deltaY);v.overallVelocityX=ht.x,v.overallVelocityY=ht.y,v.overallVelocity=l(ht.x)>l(ht.y)?ht.x:ht.y,v.scale=Q?vM(Q.pointers,R):1,v.rotation=Q?TM(Q.pointers,R):0,v.maxPointers=B.prevInput?v.pointers.length>B.prevInput.maxPointers?v.pointers.length:B.prevInput.maxPointers:v.pointers.length,EM(B,v);var Vn=E.element;x(v.srcEvent.target,Vn)&&(Vn=v.srcEvent.target),v.target=Vn}function yM(E,v){var B=v.center,R=E.offsetDelta||{},P=E.prevDelta||{},V=E.prevInput||{};(v.eventType===Pe||V.eventType===Fe)&&(P=E.prevDelta={x:V.deltaX||0,y:V.deltaY||0},R=E.offsetDelta={x:B.x,y:B.y}),v.deltaX=P.x+(B.x-R.x),v.deltaY=P.y+(B.y-R.y)}function EM(E,v){var B=E.lastInterval||v,R=v.timeStamp-B.timeStamp,P,V,Q,Xe;if(v.eventType!=_t&&(R>cr||B.velocity===s)){var Ye=v.deltaX-B.deltaX,ht=v.deltaY-B.deltaY,Vn=HA(R,Ye,ht);V=Vn.x,Q=Vn.y,P=l(Vn.x)>l(Vn.y)?Vn.x:Vn.y,Xe=VA(Ye,ht),E.lastInterval=v}else P=B.velocity,V=B.velocityX,Q=B.velocityY,Xe=B.direction;v.velocity=P,v.velocityX=V,v.velocityY=Q,v.direction=Xe}function GA(E){for(var v=[],B=0;B<E.pointers.length;)v[B]={clientX:c(E.pointers[B].clientX),clientY:c(E.pointers[B].clientY)},B++;return{timeStamp:u(),pointers:v,center:kA(v),deltaX:E.deltaX,deltaY:E.deltaY}}function kA(E){var v=E.length;if(v===1)return{x:c(E[0].clientX),y:c(E[0].clientY)};for(var B=0,R=0,P=0;P<v;)B+=E[P].clientX,R+=E[P].clientY,P++;return{x:c(B/v),y:c(R/v)}}function HA(E,v,B){return{x:v/E||0,y:B/E||0}}function VA(E,v){return E===v?Hc:l(E)>=l(v)?E<0?Oo:Lo:v<0?Po:Fo}function jc(E,v,B){B||(B=UA);var R=v[B[0]]-E[B[0]],P=v[B[1]]-E[B[1]];return Math.sqrt(R*R+P*P)}function af(E,v,B){B||(B=UA);var R=v[B[0]]-E[B[0]],P=v[B[1]]-E[B[1]];return Math.atan2(P,R)*180/Math.PI}function TM(E,v){return af(v[1],v[0],Vc)+af(E[1],E[0],Vc)}function vM(E,v){return jc(v[0],v[1],Vc)/jc(E[0],E[1],Vc)}var CM={mousedown:Pe,mousemove:Cs,mouseup:Fe},BM="mousedown",bM="mousemove mouseup";function zc(){this.evEl=BM,this.evWin=bM,this.pressed=!1,qt.apply(this,arguments)}A(zc,qt,{handler:function(v){var B=CM[v.type];B&Pe&&v.button===0&&(this.pressed=!0),B&Cs&&v.which!==1&&(B=Fe),this.pressed&&(B&Fe&&(this.pressed=!1),this.callback(this.manager,B,{pointers:[v],changedPointers:[v],pointerType:Qt,srcEvent:v}))}});var SM={pointerdown:Pe,pointermove:Cs,pointerup:Fe,pointercancel:_t,pointerout:_t},wM={2:le,3:Gn,4:Qt,5:vs},jA="pointerdown",zA="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(jA="MSPointerDown",zA="MSPointerMove MSPointerUp MSPointerCancel");function cf(){this.evEl=jA,this.evWin=zA,qt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}A(cf,qt,{handler:function(v){var B=this.store,R=!1,P=v.type.toLowerCase().replace("ms",""),V=SM[P],Q=wM[v.pointerType]||v.pointerType,Xe=Q==le,Ye=U(B,v.pointerId,"pointerId");V&Pe&&(v.button===0||Xe)?Ye<0&&(B.push(v),Ye=B.length-1):V&(Fe|_t)&&(R=!0),!(Ye<0)&&(B[Ye]=v,this.callback(this.manager,V,{pointers:B,changedPointers:[v],pointerType:Q,srcEvent:v}),R&&B.splice(Ye,1))}});var IM={touchstart:Pe,touchmove:Cs,touchend:Fe,touchcancel:_t},MM="touchstart",RM="touchstart touchmove touchend touchcancel";function JA(){this.evTarget=MM,this.evWin=RM,this.started=!1,qt.apply(this,arguments)}A(JA,qt,{handler:function(v){var B=IM[v.type];if(B===Pe&&(this.started=!0),!!this.started){var R=xM.call(this,v,B);B&(Fe|_t)&&R[0].length-R[1].length===0&&(this.started=!1),this.callback(this.manager,B,{pointers:R[0],changedPointers:R[1],pointerType:le,srcEvent:v})}}});function xM(E,v){var B=J(E.touches),R=J(E.changedTouches);return v&(Fe|_t)&&(B=W(B.concat(R),"identifier",!0)),[B,R]}var OM={touchstart:Pe,touchmove:Cs,touchend:Fe,touchcancel:_t},LM="touchstart touchmove touchend touchcancel";function Jc(){this.evTarget=LM,this.targetIds={},qt.apply(this,arguments)}A(Jc,qt,{handler:function(v){var B=OM[v.type],R=PM.call(this,v,B);R&&this.callback(this.manager,B,{pointers:R[0],changedPointers:R[1],pointerType:le,srcEvent:v})}});function PM(E,v){var B=J(E.touches),R=this.targetIds;if(v&(Pe|Cs)&&B.length===1)return R[B[0].identifier]=!0,[B,B];var P,V,Q=J(E.changedTouches),Xe=[],Ye=this.target;if(V=B.filter(function(ht){return x(ht.target,Ye)}),v===Pe)for(P=0;P<V.length;)R[V[P].identifier]=!0,P++;for(P=0;P<Q.length;)R[Q[P].identifier]&&Xe.push(Q[P]),v&(Fe|_t)&&delete R[Q[P].identifier],P++;if(Xe.length)return[W(V.concat(Xe),"identifier",!0),Xe]}var FM=2500,XA=25;function lf(){qt.apply(this,arguments);var E=y(this.handler,this);this.touch=new Jc(this.manager,E),this.mouse=new zc(this.manager,E),this.primaryTouch=null,this.lastTouches=[]}A(lf,qt,{handler:function(v,B,R){var P=R.pointerType==le,V=R.pointerType==Qt;if(!(V&&R.sourceCapabilities&&R.sourceCapabilities.firesTouchEvents)){if(P)DM.call(this,B,R);else if(V&&NM.call(this,R))return;this.callback(v,B,R)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function DM(E,v){E&Pe?(this.primaryTouch=v.changedPointers[0].identifier,$A.call(this,v)):E&(Fe|_t)&&$A.call(this,v)}function $A(E){var v=E.changedPointers[0];if(v.identifier===this.primaryTouch){var B={x:v.clientX,y:v.clientY};this.lastTouches.push(B);var R=this.lastTouches,P=function(){var V=R.indexOf(B);V>-1&&R.splice(V,1)};setTimeout(P,FM)}}function NM(E){for(var v=E.srcEvent.clientX,B=E.srcEvent.clientY,R=0;R<this.lastTouches.length;R++){var P=this.lastTouches[R],V=Math.abs(v-P.x),Q=Math.abs(B-P.y);if(V<=XA&&Q<=XA)return!0}return!1}var WA=H(o.style,"touchAction"),KA=WA!==s,YA="compute",QA="auto",uf="manipulation",bs="none",Do="pan-x",No="pan-y",Xc=GM();function hf(E,v){this.manager=E,this.set(v)}hf.prototype={set:function(E){E==YA&&(E=this.compute()),KA&&this.manager.element.style&&Xc[E]&&(this.manager.element.style[WA]=E),this.actions=E.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var E=[];return d(this.manager.recognizers,function(v){C(v.options.enable,[v])&&(E=E.concat(v.getTouchAction()))}),UM(E.join(" "))},preventDefaults:function(E){var v=E.srcEvent,B=E.offsetDirection;if(this.manager.session.prevented){v.preventDefault();return}var R=this.actions,P=O(R,bs)&&!Xc[bs],V=O(R,No)&&!Xc[No],Q=O(R,Do)&&!Xc[Do];if(P){var Xe=E.pointers.length===1,Ye=E.distance<2,ht=E.deltaTime<250;if(Xe&&Ye&&ht)return}if(!(Q&&V)&&(P||V&&B&kn||Q&&B&Bs))return this.preventSrc(v)},preventSrc:function(E){this.manager.session.prevented=!0,E.preventDefault()}};function UM(E){if(O(E,bs))return bs;var v=O(E,Do),B=O(E,No);return v&&B?bs:v||B?v?Do:No:O(E,uf)?uf:QA}function GM(){if(!KA)return!1;var E={},v=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(B){E[B]=v?e.CSS.supports("touch-action",B):!0}),E}var $c=1,Zt=2,li=4,kr=8,lr=kr,Uo=16,Hn=32;function ur(E){this.options=_({},this.defaults,E||{}),this.id=Yt(),this.manager=null,this.options.enable=b(this.options.enable,!0),this.state=$c,this.simultaneous={},this.requireFail=[]}ur.prototype={defaults:{},set:function(E){return _(this.options,E),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(E){if(f(E,"recognizeWith",this))return this;var v=this.simultaneous;return E=Wc(E,this),v[E.id]||(v[E.id]=E,E.recognizeWith(this)),this},dropRecognizeWith:function(E){return f(E,"dropRecognizeWith",this)?this:(E=Wc(E,this),delete this.simultaneous[E.id],this)},requireFailure:function(E){if(f(E,"requireFailure",this))return this;var v=this.requireFail;return E=Wc(E,this),U(v,E)===-1&&(v.push(E),E.requireFailure(this)),this},dropRequireFailure:function(E){if(f(E,"dropRequireFailure",this))return this;E=Wc(E,this);var v=U(this.requireFail,E);return v>-1&&this.requireFail.splice(v,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(E){return!!this.simultaneous[E.id]},emit:function(E){var v=this,B=this.state;function R(P){v.manager.emit(P,E)}B<kr&&R(v.options.event+qA(B)),R(v.options.event),E.additionalEvent&&R(E.additionalEvent),B>=kr&&R(v.options.event+qA(B))},tryEmit:function(E){if(this.canEmit())return this.emit(E);this.state=Hn},canEmit:function(){for(var E=0;E<this.requireFail.length;){if(!(this.requireFail[E].state&(Hn|$c)))return!1;E++}return!0},recognize:function(E){var v=_({},E);if(!C(this.options.enable,[this,v])){this.reset(),this.state=Hn;return}this.state&(lr|Uo|Hn)&&(this.state=$c),this.state=this.process(v),this.state&(Zt|li|kr|Uo)&&this.tryEmit(v)},process:function(E){},getTouchAction:function(){},reset:function(){}};function qA(E){return E&Uo?"cancel":E&kr?"end":E&li?"move":E&Zt?"start":""}function ZA(E){return E==Fo?"down":E==Po?"up":E==Oo?"left":E==Lo?"right":""}function Wc(E,v){var B=v.manager;return B?B.get(E):E}function _n(){ur.apply(this,arguments)}A(_n,ur,{defaults:{pointers:1},attrTest:function(E){var v=this.options.pointers;return v===0||E.pointers.length===v},process:function(E){var v=this.state,B=E.eventType,R=v&(Zt|li),P=this.attrTest(E);return R&&(B&_t||!P)?v|Uo:R||P?B&Fe?v|kr:v&Zt?v|li:Zt:Hn}});function Kc(){_n.apply(this,arguments),this.pX=null,this.pY=null}A(Kc,_n,{defaults:{event:"pan",threshold:10,pointers:1,direction:NA},getTouchAction:function(){var E=this.options.direction,v=[];return E&kn&&v.push(No),E&Bs&&v.push(Do),v},directionTest:function(E){var v=this.options,B=!0,R=E.distance,P=E.direction,V=E.deltaX,Q=E.deltaY;return P&v.direction||(v.direction&kn?(P=V===0?Hc:V<0?Oo:Lo,B=V!=this.pX,R=Math.abs(E.deltaX)):(P=Q===0?Hc:Q<0?Po:Fo,B=Q!=this.pY,R=Math.abs(E.deltaY))),E.direction=P,B&&R>v.threshold&&P&v.direction},attrTest:function(E){return _n.prototype.attrTest.call(this,E)&&(this.state&Zt||!(this.state&Zt)&&this.directionTest(E))},emit:function(E){this.pX=E.deltaX,this.pY=E.deltaY;var v=ZA(E.direction);v&&(E.additionalEvent=this.options.event+v),this._super.emit.call(this,E)}});function ff(){_n.apply(this,arguments)}A(ff,_n,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bs]},attrTest:function(E){return this._super.attrTest.call(this,E)&&(Math.abs(E.scale-1)>this.options.threshold||this.state&Zt)},emit:function(E){if(E.scale!==1){var v=E.scale<1?"in":"out";E.additionalEvent=this.options.event+v}this._super.emit.call(this,E)}});function df(){ur.apply(this,arguments),this._timer=null,this._input=null}A(df,ur,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[QA]},process:function(E){var v=this.options,B=E.pointers.length===v.pointers,R=E.distance<v.threshold,P=E.deltaTime>v.time;if(this._input=E,!R||!B||E.eventType&(Fe|_t)&&!P)this.reset();else if(E.eventType&Pe)this.reset(),this._timer=h(function(){this.state=lr,this.tryEmit()},v.time,this);else if(E.eventType&Fe)return lr;return Hn},reset:function(){clearTimeout(this._timer)},emit:function(E){this.state===lr&&(E&&E.eventType&Fe?this.manager.emit(this.options.event+"up",E):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function gf(){_n.apply(this,arguments)}A(gf,_n,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bs]},attrTest:function(E){return this._super.attrTest.call(this,E)&&(Math.abs(E.rotation)>this.options.threshold||this.state&Zt)}});function mf(){_n.apply(this,arguments)}A(mf,_n,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:kn|Bs,pointers:1},getTouchAction:function(){return Kc.prototype.getTouchAction.call(this)},attrTest:function(E){var v=this.options.direction,B;return v&(kn|Bs)?B=E.overallVelocity:v&kn?B=E.overallVelocityX:v&Bs&&(B=E.overallVelocityY),this._super.attrTest.call(this,E)&&v&E.offsetDirection&&E.distance>this.options.threshold&&E.maxPointers==this.options.pointers&&l(B)>this.options.velocity&&E.eventType&Fe},emit:function(E){var v=ZA(E.offsetDirection);v&&this.manager.emit(this.options.event+v,E),this.manager.emit(this.options.event,E)}});function Yc(){ur.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}A(Yc,ur,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[uf]},process:function(E){var v=this.options,B=E.pointers.length===v.pointers,R=E.distance<v.threshold,P=E.deltaTime<v.time;if(this.reset(),E.eventType&Pe&&this.count===0)return this.failTimeout();if(R&&P&&B){if(E.eventType!=Fe)return this.failTimeout();var V=this.pTime?E.timeStamp-this.pTime<v.interval:!0,Q=!this.pCenter||jc(this.pCenter,E.center)<v.posThreshold;this.pTime=E.timeStamp,this.pCenter=E.center,!Q||!V?this.count=1:this.count+=1,this._input=E;var Xe=this.count%v.taps;if(Xe===0)return this.hasRequireFailures()?(this._timer=h(function(){this.state=lr,this.tryEmit()},v.interval,this),Zt):lr}return Hn},failTimeout:function(){return this._timer=h(function(){this.state=Hn},this.options.interval,this),Hn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==lr&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function hr(E,v){return v=v||{},v.recognizers=b(v.recognizers,hr.defaults.preset),new pf(E,v)}hr.VERSION="2.0.7",hr.defaults={domEvents:!1,touchAction:YA,enable:!0,inputTarget:null,inputClass:null,preset:[[gf,{enable:!1}],[ff,{enable:!1},["rotate"]],[mf,{direction:kn}],[Kc,{direction:kn},["swipe"]],[Yc],[Yc,{event:"doubletap",taps:2},["tap"]],[df]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var kM=1,e_=2;function pf(E,v){this.options=_({},hr.defaults,v||{}),this.options.inputTarget=this.options.inputTarget||E,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=E,this.input=pM(this),this.touchAction=new hf(this,this.options.touchAction),t_(this,!0),d(this.options.recognizers,function(B){var R=this.add(new B[0](B[1]));B[2]&&R.recognizeWith(B[2]),B[3]&&R.requireFailure(B[3])},this)}pf.prototype={set:function(E){return _(this.options,E),E.touchAction&&this.touchAction.update(),E.inputTarget&&(this.input.destroy(),this.input.target=E.inputTarget,this.input.init()),this},stop:function(E){this.session.stopped=E?e_:kM},recognize:function(E){var v=this.session;if(!v.stopped){this.touchAction.preventDefaults(E);var B,R=this.recognizers,P=v.curRecognizer;(!P||P&&P.state&lr)&&(P=v.curRecognizer=null);for(var V=0;V<R.length;)B=R[V],v.stopped!==e_&&(!P||B==P||B.canRecognizeWith(P))?B.recognize(E):B.reset(),!P&&B.state&(Zt|li|kr)&&(P=v.curRecognizer=B),V++}},get:function(E){if(E instanceof ur)return E;for(var v=this.recognizers,B=0;B<v.length;B++)if(v[B].options.event==E)return v[B];return null},add:function(E){if(f(E,"add",this))return this;var v=this.get(E.options.event);return v&&this.remove(v),this.recognizers.push(E),E.manager=this,this.touchAction.update(),E},remove:function(E){if(f(E,"remove",this))return this;if(E=this.get(E),E){var v=this.recognizers,B=U(v,E);B!==-1&&(v.splice(B,1),this.touchAction.update())}return this},on:function(E,v){if(E!==s&&v!==s){var B=this.handlers;return d(M(E),function(R){B[R]=B[R]||[],B[R].push(v)}),this}},off:function(E,v){if(E!==s){var B=this.handlers;return d(M(E),function(R){v?B[R]&&B[R].splice(U(B[R],v),1):delete B[R]}),this}},emit:function(E,v){this.options.domEvents&&HM(E,v);var B=this.handlers[E]&&this.handlers[E].slice();if(!(!B||!B.length)){v.type=E,v.preventDefault=function(){v.srcEvent.preventDefault()};for(var R=0;R<B.length;)B[R](v),R++}},destroy:function(){this.element&&t_(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function t_(E,v){var B=E.element;if(B.style){var R;d(E.options.cssProps,function(P,V){R=H(B.style,V),v?(E.oldCssProps[R]=B.style[R],B.style[R]=P):B.style[R]=E.oldCssProps[R]||""}),v||(E.oldCssProps={})}}function HM(E,v){var B=n.createEvent("Event");B.initEvent(E,!0,!0),B.gesture=v,v.target.dispatchEvent(B)}_(hr,{INPUT_START:Pe,INPUT_MOVE:Cs,INPUT_END:Fe,INPUT_CANCEL:_t,STATE_POSSIBLE:$c,STATE_BEGAN:Zt,STATE_CHANGED:li,STATE_ENDED:kr,STATE_RECOGNIZED:lr,STATE_CANCELLED:Uo,STATE_FAILED:Hn,DIRECTION_NONE:Hc,DIRECTION_LEFT:Oo,DIRECTION_RIGHT:Lo,DIRECTION_UP:Po,DIRECTION_DOWN:Fo,DIRECTION_HORIZONTAL:kn,DIRECTION_VERTICAL:Bs,DIRECTION_ALL:NA,Manager:pf,Input:qt,TouchAction:hf,TouchInput:Jc,MouseInput:zc,PointerEventInput:cf,TouchMouseInput:lf,SingleTouchInput:JA,Recognizer:ur,AttrRecognizer:_n,Tap:Yc,Pan:Kc,Swipe:mf,Pinch:ff,Rotate:gf,Press:df,on:S,off:I,each:d,merge:p,extend:T,assign:_,inherit:A,bindFn:y,prefixed:H});var VM=typeof e<"u"?e:typeof self<"u"?self:{};VM.Hammer=hr,typeof s=="function"&&s.amd?s(function(){return hr}):t.exports?t.exports=hr:e[r]=hr})(window,document,"Hammer")})(GS);var Fc=GS.exports;const ek=kv(Fc),Jn=jM({__proto__:null,default:ek},[Fc]),kS=1,HS=2,bm=4,tk={mousedown:kS,mousemove:HS,mouseup:bm};function nk(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function rk(t){const e=t.prototype.handler;t.prototype.handler=function(r){const s=this.store;r.button>0&&r.type==="pointerdown"&&(nk(s,i=>i.pointerId===r.pointerId)||s.push(r)),e.call(this,r)}}function sk(t){t.prototype.handler=function(n){let r=tk[n.type];r&kS&&n.button>=0&&(this.pressed=!0),r&HS&&n.which===0&&(r=bm),this.pressed&&(r&bm&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}rk(Fc.PointerEventInput);sk(Fc.MouseInput);const ik=Fc.Manager;class Kh{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const ok=Jn?[[Jn.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Jn.Rotate,{enable:!1}],[Jn.Pinch,{enable:!1}],[Jn.Swipe,{enable:!1}],[Jn.Pan,{threshold:0,enable:!1}],[Jn.Press,{enable:!1}],[Jn.Tap,{event:"doubletap",taps:2,enable:!1}],[Jn.Tap,{event:"anytap",enable:!1}],[Jn.Tap,{enable:!1}]]:null,Xy={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},ak={doubletap:["tap"]},ck={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},U0={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},lk={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},$y={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},uk=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ji=typeof window<"u"?window:global;let Sm=!1;try{const t={get passive(){return Sm=!0,!0}};ji.addEventListener("test",null,t),ji.removeEventListener("test",null)}catch{Sm=!1}const hk=uk.indexOf("firefox")!==-1,{WHEEL_EVENTS:fk}=U0,Wy="wheel",Ky=4.000244140625,dk=40,gk=.25;class mk extends Kh{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{if(!this.options.enable)return;let i=s.deltaY;ji.WheelEvent&&(hk&&s.deltaMode===ji.WheelEvent.DOM_DELTA_PIXEL&&(i/=ji.devicePixelRatio),s.deltaMode===ji.WheelEvent.DOM_DELTA_LINE&&(i*=dk)),i!==0&&i%Ky===0&&(i=Math.floor(i/Ky)),s.shiftKey&&i&&(i=i*gk),this.callback({type:Wy,center:{x:s.clientX,y:s.clientY},delta:-i,srcEvent:s,pointerType:"mouse",target:s.target})},this.events=(this.options.events||[]).concat(fk),this.events.forEach(s=>e.addEventListener(s,this.handleEvent,Sm?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Wy&&(this.options.enable=n)}}const{MOUSE_EVENTS:pk}=U0,Yy="pointermove",Qy="pointerover",qy="pointerout",Zy="pointerenter",eE="pointerleave";class Ak extends Kh{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.handleOverEvent(i),this.handleOutEvent(i),this.handleEnterEvent(i),this.handleLeaveEvent(i),this.handleMoveEvent(i)},this.pressed=!1;const{enable:s}=this.options;this.enableMoveEvent=s,this.enableLeaveEvent=s,this.enableEnterEvent=s,this.enableOutEvent=s,this.enableOverEvent=s,this.events=(this.options.events||[]).concat(pk),this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Yy&&(this.enableMoveEvent=n),e===Qy&&(this.enableOverEvent=n),e===qy&&(this.enableOutEvent=n),e===Zy&&(this.enableEnterEvent=n),e===eE&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(Qy,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(qy,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(Zy,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(eE,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(Yy,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:_k}=U0,tE="keydown",nE="keyup";class yk extends Kh{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{const i=s.target||s.srcElement;i.tagName==="INPUT"&&i.type==="text"||i.tagName==="TEXTAREA"||(this.enableDownEvent&&s.type==="keydown"&&this.callback({type:tE,srcEvent:s,key:s.key,target:s.target}),this.enableUpEvent&&s.type==="keyup"&&this.callback({type:nE,srcEvent:s,key:s.key,target:s.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(_k),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===tE&&(this.enableDownEvent=n),e===nE&&(this.enableUpEvent=n)}}const rE="contextmenu";class Ek extends Kh{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.options.enable&&this.callback({type:rE,center:{x:s.clientX,y:s.clientY},srcEvent:s,pointerType:"mouse",target:s.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===rE&&(this.options.enable=n)}}const wm=1,dh=2,Im=4,Tk={pointerdown:wm,pointermove:dh,pointerup:Im,mousedown:wm,mousemove:dh,mouseup:Im},vk=1,Ck=2,Bk=3,bk=0,Sk=1,wk=2,Ik=1,Mk=2,Rk=4;function xk(t){const e=Tk[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:s}=t.srcEvent;let i=!1,o=!1,a=!1;return e===Im||e===dh&&!Number.isFinite(n)?(i=s===vk,o=s===Ck,a=s===Bk):e===dh?(i=!!(n&Ik),o=!!(n&Rk),a=!!(n&Mk)):e===wm&&(i=r===bk,o=r===Sk,a=r===wk),{leftButton:i,middleButton:o,rightButton:a}}function Ok(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),s=r.width/e.offsetWidth||1,i=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/s,y:(n.y-r.top-e.clientTop)/i};return{center:n,offsetCenter:o}}const Ad={srcElement:"root",priority:0};class Lk{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let s=n.srcEvent.target;for(;s&&s!==r.rootElement;){if(this._emit(r,s),r.handled)return;s=s.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,s=!1,i=!1){const{handlers:o,handlersByElement:a}=this;let c=Ad;typeof r=="string"||r&&r.addEventListener?c={...Ad,srcElement:r}:r&&(c={...Ad,...r});let l=a.get(c.srcElement);l||(l=[],a.set(c.srcElement,l));const u={type:e,handler:n,srcElement:c.srcElement,priority:c.priority};s&&(u.once=!0),i&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let h=l.length-1;for(;h>=0&&!(l[h].priority>=u.priority);)h--;l.splice(h+1,0,u)}remove(e,n){const{handlers:r,handlersByElement:s}=this;for(let i=r.length-1;i>=0;i--){const o=r[i];if(o.type===e&&o.handler===n){r.splice(i,1);const a=s.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&s.delete(o.srcElement)}}this._active=r.some(i=>!i.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let s=!1;const i=()=>{e.handled=!0},o=()=>{e.handled=!0,s=!0},a=[];for(let c=0;c<r.length;c++){const{type:l,handler:u,once:h}=r[c];if(u({...e,type:l,stopPropagation:i,stopImmediatePropagation:o}),h&&a.push(r[c]),s)break}for(let c=0;c<a.length;c++){const{type:l,handler:u}=a[c];this.remove(l,u)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...xk(e),...Ok(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Pk={events:null,recognizers:null,recognizerOptions:{},Manager:ik,touchAction:"none",tabIndex:0};class Fk{constructor(e=null,n){this._onBasicInput=s=>{const{srcEvent:i}=s,o=ck[i.type];o&&this.manager.emit(o,s)},this._onOtherEvent=s=>{this.manager.emit(s.type,s)},this.options={...Pk,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||ok}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(Xy).forEach(s=>{const i=this.manager.get(s);i&&Xy[s].forEach(o=>{i.recognizeWith(o)})});for(const s in n.recognizerOptions){const i=this.manager.get(s);if(i){const o=n.recognizerOptions[s];delete o.enable,i.set(o)}}this.wheelInput=new mk(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Ak(e,this._onOtherEvent,{enable:!1}),this.keyInput=new yk(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new Ek(e,this._onOtherEvent,{enable:!1});for(const[s,i]of this.events)i.isEmpty()||(this._toggleRecognizer(i.recognizerName,!0),this.manager.on(s,i.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const s=r.get(e);if(s&&s.options.enable!==n){s.set({enable:n});const i=ak[e];i&&!this.options.recognizers&&i.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),s.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,s,i){if(typeof e!="string"){r=n;for(const u in e)this._addEventHandler(u,e[u],r,s,i);return}const{manager:o,events:a}=this,c=$y[e]||e;let l=a.get(c);l||(l=new Lk(this),a.set(c,l),l.recognizerName=lk[c]||c,o&&o.on(c,l.handleEvent)),l.add(e,n,r,s,i),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,s=$y[e]||e,i=r.get(s);if(i&&(i.remove(e,n),i.isEmpty())){const{recognizerName:o}=i;let a=!1;for(const c of r.values())if(c.recognizerName===o&&!c.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function Is(){}const Dk=({isDragging:t})=>t?"grabbing":"grab",VS={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Is,onResize:Is,onViewStateChange:Is,onInteractionStateChange:Is,onBeforeRender:Is,onAfterRender:Is,onLoad:Is,onError:t=>se.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Dk,getTooltip:null,debug:!1,drawPickingColors:!1};class mc{constructor(e){g(this,"props",void 0),g(this,"width",0),g(this,"height",0),g(this,"userData",{}),g(this,"canvas",null),g(this,"viewManager",null),g(this,"layerManager",null),g(this,"effectManager",null),g(this,"deckRenderer",null),g(this,"deckPicker",null),g(this,"eventManager",null),g(this,"tooltip",null),g(this,"metrics",void 0),g(this,"animationLoop",void 0),g(this,"stats",void 0),g(this,"viewState",void 0),g(this,"cursorState",void 0),g(this,"_needsRedraw",void 0),g(this,"_pickRequest",void 0),g(this,"_lastPointerDownInfo",null),g(this,"_metricsCounter",void 0),g(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const s=n.offsetCenter;if(!s)return;r.x=s.x,r.y=s.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),g(this,"_onEvent",n=>{const r=D1[n.type],s=n.offsetCenter;if(!r||!s||!this.layerManager)return;const i=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:s.x,y:s.y,layers:i,viewports:this.getViewports(s)},this._lastPointerDownInfo),{layer:a}=o,c=a&&(a[r.handler]||a.props[r.handler]),l=this.props[r.handler];let u=!1;c&&(u=c.call(a,o,n)),!u&&l&&l(o,n)}),g(this,"_onPointerDown",n=>{const r=n.offsetCenter,s=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=s.result[0]||s.emptyInfo}),this.props={...VS,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&se.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),Bb()==="IE"&&se.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new g0({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&gc.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,s,i,o,a,c;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(s=this.effectManager)===null||s===void 0||s.finalize(),this.effectManager=null,(i=this.deckRenderer)===null||i===void 0||i.finalize(),this.deckRenderer=null,(o=this.deckPicker)===null||o===void 0||o.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(c=this.tooltip)===null||c===void 0||c.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var l;(l=this.canvas.parentElement)===null||l===void 0||l.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&se.removed("onLayerHover","onHover")(),"onLayerClick"in e&&se.removed("onLayerClick","onClick")(),e.initialViewState&&!nr(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),s=this.layerManager.needsRedraw(e),i=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||s||i||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Ue(this.viewManager),this.viewManager.views}getViewports(e){return Ue(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Ue(this.deckPicker);const{stats:s}=this;s.get("Pick Count").incrementCount(),s.get(n).timeStart();const i=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return s.get(n).timeEnd(),i}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Ue(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const i=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=i}if(r||r===0){var s;const i=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((s=e.style)===null||s===void 0?void 0:s.position)||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const s=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,i=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(s!==this.width||i!==this.height){var o,a;this.width=s,this.height=i,(o=this.viewManager)===null||o===void 0||o.setProps({width:s,height:i}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:s,height:i})}}_createAnimationLoop(e){const{width:n,height:r,gl:s,glOptions:i,debug:o,onError:a,onBeforeRender:c,onAfterRender:l,useDevicePixels:u}=e;return new iD({width:n,height:r,useDevicePixels:u,autoResizeDrawingBuffer:!s,autoResizeViewport:!1,gl:s,onCreateContext:h=>xb({...i,...h,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:h=>this._setGLContext(h.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:c,onAfterRender:l,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new N0({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:s}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let i=s,o=!1;for(const a of r){var n;i=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(i,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(i);this.tooltip.setTooltip(a,i.x,i.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,d0(e,{enable:!0,copyState:!0})),this.tooltip=new Z9(this.canvas),Pr(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new vS;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new Fk(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const s in D1)this.eventManager.on(s,this._onEvent);this.viewManager=new b9({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new B9(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new V9,this.deckRenderer=new J9(e),this.deckPicker=new Q9(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;Pr(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),se.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=Ns.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}g(mc,"defaultProps",VS);g(mc,"VERSION",hP);class _d{constructor(e,n){g(this,"opts",void 0),g(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:s}=n;let i=r;if(r&&r.length!==s){i=new Float32Array(s);const o=n.elementOffset||0;for(let a=0;a<s;++a)i[a]=r[o+a]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function Nk(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Cu(t){return t.stride||t.size*t.bytesPerElement}function jS(t,e){e.offset&&se.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Cu(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,s=e.elementOffset||0,i=r*n+s*t.bytesPerElement+(t.offset||0);return{...e,offset:i,stride:n}}function Uk(t,e){const n=jS(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class Gk{constructor(e,n,r){g(this,"gl",void 0),g(this,"id",void 0),g(this,"size",void 0),g(this,"settings",void 0),g(this,"value",void 0),g(this,"doublePrecision",void 0),g(this,"_buffer",void 0),g(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const s=n.logicalType||n.type,i=s===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;i?a=5126:!s&&n.isIndexed?a=e&&A0(e,Ae.ELEMENT_INDEX_UINT32)?5125:5123:a=s||5126;let c=Nk(s||a||5126);this.doublePrecision=i,i&&n.fp64===!1&&(c=Float32Array),this.value=null,this.settings={...n,defaultType:c,defaultValue:o,logicalType:s,type:a,size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ge(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Cu(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),gc.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},s=this.value instanceof Float64Array,i=Uk(this.getAccessor(),n||{});return r[e]=new _d(this,i.high),r["".concat(e,"64Low")]=s?new _d(this,i.low):new Float32Array(this.size),r}if(n){const r=jS(this.getAccessor(),n);return{[e]:new _d(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:s}=this,i=r*s;if(n&&i&&n.length>=i){const o=new Array(s).fill(1/0),a=new Array(s).fill(-1/0);for(let c=0;c<i;)for(let l=0;l<s;l++){const u=n[c++];u<o[l]&&(o[l]=u),u>a[l]&&(a[l]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ge?r={buffer:e}:r=e;const s={...this.settings,...r};if(n.bufferAccessor=s,n.bounds=null,r.constant){let i=r.value;if(i=this._normalizeValue(i,[],0),this.settings.normalized&&(i=this.normalizeConstant(i)),!(!n.constant||!this._areValuesEqual(i,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=i}else if(r.buffer){const i=r.buffer;n.externalBuffer=i,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;s.type=r.type||i.accessor.type,s.bytesPerElement=i.accessor.BYTES_PER_ELEMENT*(o?2:1),s.stride=Cu(s)}else if(r.value){this._checkExternalBuffer(r);let i=r.value;n.externalBuffer=null,n.constant=!1,this.value=i,s.bytesPerElement=i.BYTES_PER_ELEMENT,s.stride=Cu(s);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&i instanceof Float64Array&&(i=gd(i,s));const c=i.byteLength+a+s.stride*2;o.byteLength<c&&o.reallocate(c),o.setAccessor(null),o.subData({data:i,offset:a}),s.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:s}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?gd(n,{size:this.size,startIndex:r,endIndex:s}):n.subarray(r,s),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,s=r.allocatedValue,i=gc.allocate(s,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=i;const{buffer:o,byteOffset:a}=this;return o.byteLength<i.byteLength+a&&(o.reallocate(i.byteLength+a),n&&s&&o.subData({data:s instanceof Float64Array?gd(s,this):s,offset:a})),r.allocatedValue=i,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let s=!1;if(this.doublePrecision&&(s=n.BYTES_PER_ELEMENT<4),s)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&se.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:s,size:i}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=i;for(;--o>=0;)n[r+o]=s[o];return n}switch(i){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:s[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:s[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:s[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:s[0];break;default:let o=i;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:s[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let s=0;s<r;s++)if(e[s]!==n[s])return!1;return!0}}const sE=[],iE=[];function zS(t,e=0,n=1/0){let r=sE;const s={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(iE.length=t.length,r=iE):r=sE,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),s.index=e-1),{iterable:r,objectInfo:s}}function JS(t){return t&&t[Symbol.asyncIterator]}function kk(t,e){const{size:n,stride:r,offset:s,startIndices:i,nested:o}=e,a=t.BYTES_PER_ELEMENT,c=r?r/a:n,l=s?s/a:0,u=Math.floor((t.length-l)/c);return(h,{index:f,target:d})=>{if(!i){const p=f*c+l;for(let A=0;A<n;A++)d[A]=t[p+A];return d}const m=i[f],_=i[f+1]||u;let T;if(o){T=new Array(_-m);for(let p=m;p<_;p++){const A=p*c+l;d=new Array(n);for(let y=0;y<n;y++)d[y]=t[A+y];T[p-m]=d}}else if(c===n)T=t.subarray(m*n+l,_*n+l);else{T=new t.constructor((_-m)*n);let p=0;for(let A=m;A<_;A++){const y=A*c+l;for(let C=0;C<n;C++)T[p++]=t[y+C]}}return T}}const Hk=[],Bu=[[0,1/0]];function Vk(t,e){if(t===Bu||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let s=0;for(let i=0;i<r;i++){const o=t[i];o[1]<e[0]?(n.push(o),s=i+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(s,0,e),n}function yd(t){const{source:e,target:n,start:r=0,size:s,getData:i}=t,o=t.end||n.length,a=e.length,c=o-r;if(a>c){n.set(e.subarray(0,c),r);return}if(n.set(e,r),!i)return;let l=a;for(;l<c;){const u=i(l,e);for(let h=0;h<s;h++)n[r+l]=u[h]||0,l++}}function jk({source:t,target:e,size:n,getData:r,sourceStartIndices:s,targetStartIndices:i}){if(!Array.isArray(i))return yd({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const c=r&&((u,h)=>r(u+a,h)),l=Math.min(s.length,i.length);for(let u=1;u<l;u++){const h=s[u]*n,f=i[u]*n;yd({source:t.subarray(o,h),target:e,start:a,end:f,size:n,getData:c}),o=h,a=f}return a<e.length&&yd({source:[],target:e,start:a,size:n,getData:c}),e}const zk={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function XS(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...zk[n],...e,...t,type:n}}function $S(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function WS(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function KS(t){t.push(t.shift())}function G0(t,e){const{doublePrecision:n,settings:r,value:s,size:i}=t,o=n&&s instanceof Float64Array?2:1;return(r.noAlloc?s.length:e*i)*o}function YS({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:s,getData:i=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,c=n.byteOffset,l=n.startIndices,u=s&&l,h=G0(n,e),f=n.isConstant;if(!u&&r>=h)return;const d=f?n.value:n.getBuffer().getData({srcByteOffset:c});if(n.settings.normalized&&!f){const p=i;i=(A,y)=>n.normalizeConstant(p(A,y))}const m=f?(p,A)=>i(d,A):(p,A)=>i(d.subarray(p,p+a),A),_=t.getData({length:r}),T=new Float32Array(h);jk({source:_,target:T,sourceStartIndices:s,targetStartIndices:l,size:a,getData:m}),t.byteLength<T.byteLength+c&&t.reallocate(T.byteLength+c),t.subData({data:T,offset:c})}class k0 extends Gk{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Bu}),g(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,s=Array.isArray(n)?e[n.find(i=>e[i])]:e[n];return XS(s,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:s=1/0}=n;this.state.updateRanges=Vk(this.state.updateRanges,[r,s])}else this.state.updateRanges=Bu}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Hk}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Bu),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:s}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:o,noAlloc:a}}=this;let c=!0;if(o){for(const[l,u]of i)o.call(s,this,{data:n,startRow:l,endRow:u,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[l,u]of i){const h=Number.isFinite(l)?this.getVertexOffset(l):0,f=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:h,endOffset:f})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:s}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(s.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),s.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;Ue(ArrayBuffer.isView(o.value),"invalid ".concat(s.accessor));const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=kk(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:s,props:i,numInstances:o}){if(e.constant)return;const{settings:a,state:c,value:l,size:u,startIndices:h}=e,{accessor:f,transform:d}=a,m=c.binaryAccessor||(typeof f=="function"?f:i[f]);Ue(typeof m=="function",'accessor "'.concat(f,'" is not a function'));let _=e.getVertexOffset(r);const{iterable:T,objectInfo:p}=zS(n,r,s);for(const A of T){p.index++;let y=m(A,p);if(d&&(y=d.call(this,y)),h){const C=(p.index<h.length-1?h[p.index+1]:o)-h[p.index];if(y&&Array.isArray(y[0])){let b=_;for(const S of y)e._normalizeValue(S,l,b),b+=u}else y&&y.length>u?l.set(y,_):(e._normalizeValue(y,p.target,0),m9({target:l,source:p.target,start:_,count:C}));_+=C*u}else e._normalizeValue(y,l,_),_+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class Jk{constructor({gl:e,attribute:n,timeline:r}){g(this,"gl",void 0),g(this,"type","interpolation"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=e,this.transition=new Pc(r),this.attribute=n,this.attributeInTransition=new k0(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=$k(e,n);const s={byteLength:0,usage:35050};this.buffers=[new ge(e,s),new ge(e,s)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:s,attribute:i}=this;KS(s);const o={numInstances:n,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of s)YS({buffer:a,...o});this.currentStartIndices=i.startIndices,this.currentLength=G0(i,n),this.attributeInTransition.setData({buffer:s[1],value:i.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:s[0],aTo:$S(r,i)},feedbackBuffers:{vCurrent:s[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:s}=this.transition;let i=s/n;r&&(i=r(i)),this.transform.run({uniforms:{time:i}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const Xk=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function $k(t,e){const n=WS(e.size);return new R0(t,{vs:Xk,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class Wk{constructor({gl:e,attribute:n,timeline:r}){g(this,"gl",void 0),g(this,"type","spring"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"texture",void 0),g(this,"framebuffer",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Pc(r),this.attribute=n,this.attributeInTransition=new k0(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=Yk(e),this.framebuffer=Qk(e,this.texture),this.transform=Kk(e,n,this.framebuffer);const s={byteLength:0,usage:35050};this.buffers=[new ge(e,s),new ge(e,s),new ge(e,s)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:s,attribute:i}=this,o={numInstances:n,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of s)YS({buffer:a,...o});this.settings=e,this.currentStartIndices=i.startIndices,this.currentLength=G0(i,n),this.attributeInTransition.setData({buffer:s[1],value:i.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:$S(r,i)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:s}=this;if(!s.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),KS(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),Wh(r)[0]>0||s.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function Kk(t,e,n){const r=WS(e.size);return new R0(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function Yk(t){return new $t(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function Qk(t,e){return new Je(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const qk={interpolation:Jk,spring:Wk};class Zk{constructor(e,{id:n,timeline:r}){g(this,"id",void 0),g(this,"isSupported",void 0),g(this,"gl",void 0),g(this,"timeline",void 0),g(this,"transitions",void 0),g(this,"needsRedraw",void 0),g(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=R0.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const s in e){const i=e[s],o=i.getTransitionSetting(n);o&&this._updateAttribute(s,i,o)}for(const s in this.transitions){const i=e[s];(!i||!i.getTransitionSetting(n))&&this._removeTransition(s)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const s=this.transitions[e];let i=!s||s.type!==r.type;if(i){if(!this.isSupported){se.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}s&&this._removeTransition(e);const o=qk[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(se.error("unsupported transition type '".concat(r.type,"'"))(),i=!1)}(i||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const oE="attributeManager.invalidate",eH="attributeManager.updateStart",tH="attributeManager.updateEnd",nH="attribute.updateStart",rH="attribute.allocate",sH="attribute.updateEnd";class iH{constructor(e,{id:n="attribute-manager",stats:r,timeline:s}={}){g(this,"id",void 0),g(this,"gl",void 0),g(this,"attributes",void 0),g(this,"updateTriggers",void 0),g(this,"needsRedraw",void 0),g(this,"userData",void 0),g(this,"stats",void 0),g(this,"attributeTransitionManager",void 0),g(this,"mergeBoundsMemoized",Lc(o9)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Zk(e,{id:"".concat(n,"-transitions"),timeline:s}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);st(oE,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);st(oE,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:s,props:i={},buffers:o={},context:a={}}){let c=!1;st(eH,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const l in this.attributes){const u=this.attributes[l],h=u.settings.accessor;u.startIndices=r,u.numInstances=n,i[l]&&se.removed("props.".concat(l),"data.attributes.".concat(l))(),u.setExternalBuffer(o[l])||u.setBinaryValue(typeof h=="string"?o[h]:void 0,e.startIndices)||typeof h=="string"&&!o[h]&&u.setConstantValue(i[h])||u.needsUpdate()&&(c=!0,this._updateAttribute({attribute:u,numInstances:n,data:e,props:i,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}c&&st(tH,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:s})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var s;return(s=this.attributes[r])===null||s===void 0?void 0:s.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,s={...r.getAttributes()};for(const i in n){const o=n[i];o.needsRedraw(e)&&!r.hasAttribute(i)&&(s[i]=o)}return s}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const s in e)n[s]||Object.assign(r,e[s].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const s=e[r];this.attributes[r]=this._createAttribute(r,s,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const s={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new k0(this.gl,s)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(s=>{e[s]||(e[s]=[]),e[s].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:s}=this,i=s[e];return i&&i.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),i}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(st(nH,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&st(rH,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,st(sH,n,r))}}class oH extends Pc{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:s,easing:i}}=this,o=i(e/s);this._value=ah(n,r,o)}}const aE=1e-5;function cE(t,e,n,r,s){const i=e-t,a=(n-e)*s,c=-i*r;return a+c+i+e}function aH(t,e,n,r,s){if(Array.isArray(n)){const i=[];for(let o=0;o<n.length;o++)i[o]=cE(t[o],e[o],n[o],r,s);return i}return cE(t,e,n,r,s)}function lE(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const s=t[r]-e[r];n+=s*s}return Math.sqrt(n)}return Math.abs(t-e)}class cH extends Pc{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:s}=this.settings,{_prevValue:i=e,_currValue:o=e}=this;let a=aH(i,o,n,r,s);const c=lE(a,n),l=lE(a,o);c<aE&&l<aE&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const lH={interpolation:oH,spring:cH};class uH{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,s){const{transitions:i}=this;if(i.has(e)){const c=i.get(e),{value:l=c.settings.fromValue}=c;n=l,this.remove(e)}if(s=XS(s),!s)return;const o=lH[s.type];if(!o){se.error("unsupported transition type '".concat(s.type,"'"))();return}const a=new o(this.timeline);a.start({...s,fromValue:n,toValue:r}),i.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function hH(t){const e=t[ds];for(const n in e){const r=e[n],{validate:s}=r;if(s&&!s(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function fH(t,e){const n=QS({newProps:t,oldProps:e,propTypes:t[ds],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=gH(t,e);let s=!1;return r||(s=mH(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:s,extensionsChanged:pH(t,e),transitionsChanged:dH(t,e)}}function dH(t,e){if(!t.transitions)return!1;const n={},r=t[ds];let s=!1;for(const i in t.transitions){const o=r[i],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&Mm(t[i],e[i],o)&&(n[i]=!0,s=!0)}return s?n:!1}function QS({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:s="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(s," changed shallowly");for(const i of Object.keys(t))if(!(i in n)){if(!(i in e))return"".concat(s,".").concat(i," added");const o=Mm(t[i],e[i],r[i]);if(o)return"".concat(s,".").concat(i," ").concat(o)}for(const i of Object.keys(e))if(!(i in n)){if(!(i in t))return"".concat(s,".").concat(i," dropped");if(!Object.hasOwnProperty.call(t,i)){const o=Mm(t[i],e[i],r[i]);if(o)return"".concat(s,".").concat(i," ").concat(o)}}return!1}function Mm(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function gH(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:s}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&s&&(n=s(t.data,e.data)||n),n}function mH(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&uE(t,e,"all"))return{all:!0};const n={};let r=!1;for(const s in t.updateTriggers)s!=="all"&&uE(t,e,s)&&(n[s]=!0,r=!0);return r?n:!1}function pH(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let s=0;s<r.length;s++)if(!r[s].equals(n[s]))return!0;return!1}function uE(t,e,n){let r=t.updateTriggers[n];r=r??{};let s=e.updateTriggers[n];return s=s??{},QS({oldProps:s,newProps:r,triggerName:n})}const AH="count(): argument not an object",_H="count(): argument not a container";function yH(t){if(!TH(t))throw new Error(AH);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(EH(t))return Object.keys(t).length;throw new Error(_H)}function EH(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function TH(t){return t!==null&&typeof t=="object"}function vH(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(s=>s.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const s in e.inject)r[s]=(r[s]||"")+e.inject[s];n.inject=r}return n}const CH={10241:9987,10240:9729,10242:33071,10243:33071},Rm={};function BH(t,e,n,r){if(n instanceof $t)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let s=null;n.compressed&&(s={10241:n.data.length>1?9985:9729});const i=new $t(e,{...n,parameters:{...CH,...s,...r}});return Rm[i.id]=t,i}function bH(t,e){!e||!(e instanceof $t)||Rm[e.id]===t&&(e.delete(),delete Rm[e.id])}const SH={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||xm(t)&&(t.length===3||t.length===4)},equal(t,e,n){return nr(t,e,1)}},accessor:{validate(t,e){const n=gh(t);return n==="function"||n===gh(e.value)},equal(t,e,n){return typeof e=="function"?!0:nr(t,e,1)}},array:{validate(t,e){return e.optional&&!t||xm(t)},equal(t,e,n){const{compare:r}=n,s=Number.isInteger(r)?r:r?1:0;return r?nr(t,e,s):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,s=Number.isInteger(r)?r:r?1:0;return r?nr(t,e,s):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:BH(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{bH(n.id,t)}}};function wH(t){const e={},n={},r={};for(const[s,i]of Object.entries(t)){const o=i==null?void 0:i.deprecatedFor;if(o)r[s]=Array.isArray(o)?o:[o];else{const a=IH(s,i);e[s]=a,n[s]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function IH(t,e){switch(gh(e)){case"object":return Zo(t,e);case"array":return Zo(t,{type:"array",value:e,compare:!1});case"boolean":return Zo(t,{type:"boolean",value:e});case"number":return Zo(t,{type:"number",value:e});case"function":return Zo(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Zo(t,e){return"type"in e?{name:t,...SH[e.type],...e}:"value"in e?{name:t,type:gh(e.value),...e}:{name:t,type:"object",value:e}}function xm(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function gh(t){return xm(t)?"array":t===null?"null":typeof t}function MH(t,e){let n;for(let i=e.length-1;i>=0;i--){const o=e[i];"extensions"in o&&(n=o.extensions)}const r=Om(t.constructor,n),s=Object.create(r);s[fh]=t,s[qs]={},s[ns]={};for(let i=0;i<e.length;++i){const o=e[i];for(const a in o)s[a]=o[a]}return Object.freeze(s),s}const RH="_mergedDefaultProps";function Om(t,e){let n=RH;if(e)for(const s of e){const i=s.constructor;i&&(n+=":".concat(i.extensionName||i.name))}const r=qS(t,n);return r||(t[n]=xH(t,e||[]))}function xH(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),s=Om(r),i=qS(t,"defaultProps")||{},o=wH(i),a=Object.assign(Object.create(null),s,o.defaultProps),c=Object.assign(Object.create(null),s==null?void 0:s[ds],o.propTypes),l=Object.assign(Object.create(null),s==null?void 0:s[pd],o.deprecatedProps);for(const u of e){const h=Om(u.constructor);h&&(Object.assign(a,h),Object.assign(c,h[ds]),Object.assign(l,h[pd]))}return OH(a,t),PH(a,c),LH(a,l),a[ds]=c,a[pd]=l,e.length===0&&!H0(t,"_propTypes")&&(t._propTypes=c),a}function OH(t,e){const n=DH(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function LH(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const s="".concat(this.id,": ").concat(n);for(const i of e[n])H0(this,i)||(this[i]=r);se.deprecated(s,e[n].join("/"))()}})}function PH(t,e){const n={},r={};for(const s in e){const i=e[s],{name:o,value:a}=i;i.async&&(n[o]=a,r[o]=FH(o))}t[eo]=n,t[qs]={},Object.defineProperties(t,r)}function FH(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||JS(e)?this[qs][t]=e:this[ns][t]=e},get(){if(this[ns]){if(t in this[ns])return this[ns][t]||this[eo][t];if(t in this[qs]){const e=this[fh]&&this[fh].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[eo][t]}}return this[eo][t]}}}function H0(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function qS(t,e){return H0(t,e)&&t[e]}function DH(t){const e=t.componentName;return e||se.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let NH=0;class V0{constructor(...e){g(this,"id",void 0),g(this,"props",void 0),g(this,"count",void 0),this.props=MH(this,e),this.id=this.props.id,this.count=NH++}clone(e){const{props:n}=this,r={};for(const s in n[eo])s in n[ns]?r[s]=n[ns][s]:s in n[qs]&&(r[s]=n[qs][s]);return new this.constructor({...n,...r,...e})}}g(V0,"componentName","Component");g(V0,"defaultProps",{});const UH=Object.freeze({});class GH{constructor(e){g(this,"component",void 0),g(this,"onAsyncPropUpdated",void 0),g(this,"asyncProps",void 0),g(this,"oldProps",void 0),g(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||UH}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[fh]||this.component;const n=e[ns]||{},r=e[qs]||e,s=e[eo]||{};for(const i in n){const o=n[i];this._createAsyncPropData(i,s[i]),this._updateAsyncProp(i,o),n[i]=this.getAsyncProp(i)}for(const i in r){const o=r[i];this._createAsyncPropData(i,s[i]),this._updateAsyncProp(i,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(JS(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const s=this.asyncProps[e];s&&r>=s.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),s.resolvedValue=n,s.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const s=r.pendingLoadCount;n.then(i=>{this.component&&(i=this._postProcessValue(r,i),this._setAsyncPropValue(e,i,s),this._onResolve(e,i))}).catch(i=>{this._onError(e,i)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const s=r.pendingLoadCount;let i=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:c}=this.component.props;c?i=c(a,i):i=i.concat(a),Object.defineProperty(i,"__diff",{enumerable:!1,value:[{startRow:o,endRow:i.length}]}),o=i.length,this._setAsyncPropValue(e,i,s)}this._onResolve(e,i)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const s=this.component&&this.component.props[ds];this.asyncProps[e]={type:s&&s[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class kH extends GH{constructor({attributeManager:e,layer:n}){super(n),g(this,"attributeManager",void 0),g(this,"needsRedraw",void 0),g(this,"needsUpdate",void 0),g(this,"subLayers",void 0),g(this,"usesPickingColorCache",void 0),g(this,"hasPickingBuffer",void 0),g(this,"changeFlags",void 0),g(this,"viewport",void 0),g(this,"uniformTransitions",void 0),g(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,s=r==null?void 0:r.props.fetch;return s?s(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const s=r.props.onDataLoad;e==="data"&&s&&s(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const HH="layer.changeFlag",VH="layer.initialize",jH="layer.update",zH="layer.finalize",JH="layer.matched",hE=2**24-1,XH=Object.freeze([]),$H=Lc(({oldViewport:t,viewport:e})=>t.equals(e));let Xn=new Uint8ClampedArray(0);const WH={data:{type:"data",value:XH,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:s,signal:i})=>{const{resourceManager:o}=n.context;if(s=s||n.getLoadOptions(),r=r||n.props.loaders,i){var a;s={...s,fetch:{...(a=s)===null||a===void 0?void 0:a.fetch,signal:i}}}let c=o.contains(t);return!c&&!s&&(o.add({resourceId:t,data:ar(t,r),persistent:!1}),c=!0),c?o.subscribe({resourceId:t,onChange:l=>{var u;return(u=n.internalState)===null||u===void 0?void 0:u.reloadAsyncProp(e,l)},consumerId:n.id,requestId:e}):ar(t,r,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:ee.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Mo extends V0{constructor(...e){super(...e),g(this,"internalState",null),g(this,"lifecycle",wi.NO_STATE),g(this,"context",void 0),g(this,"state",void 0),g(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ue(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=LS(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,i,o]=xS(r,n.pixelProjectionMatrix);return e.length===2?[s,i]:[s,i,o]}unproject(e){return Ue(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Ue(this.internalState);const r=this.internalState.viewport||this.context.viewport;return f9(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===ee.DEFAULT||e===ee.LNGLAT||e===ee.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Ue(e instanceof Uint8Array);const[n,r,s]=e;return n+r*256+s*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:yH(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=vH(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const s of r)n.invalidateAll(s);else n.invalidateAll();if(n){const{props:s}=e,i=this.internalState.hasPickingBuffer,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable||s.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(i!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:c}=n.attributes,l=a||c;l&&(o&&l.constant&&(l.constant=!1,n.invalidate(l.id)),!l.value&&!o&&(l.constant=!0,l.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:s}=e;return s>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[s]),e}raiseError(e,n){var r,s;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(s=this.props).onError)!==null&&r!==void 0&&r.call(s,e))){var i,o;(i=this.context)===null||i===void 0||(o=i.onError)===null||o===void 0||o.call(i,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!$H({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),s=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:s,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const s in n)Object.defineProperty(r,s,{value:n[s]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Xn.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>hE&&se.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Xn=gc.allocate(Xn,n,{size:3,copy:!0,maxCount:Math.max(n,hE)});const s=Math.floor(Xn.length/3),i=[];for(let o=r;o<s;o++)this.encodePickingColor(o,i),Xn[o*3+0]=i[0],Xn[o*3+1]=i[1],Xn[o*3+2]=i[2]}e.value=Xn.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),s=e.userData.excludeAttributes||{},i=r.getShaderAttributes(n,s);e.setAttributes(i)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:s}=this.getAttributeManager().attributes,i=r||s,o=i&&n.attributes&&n.attributes[i.id];if(o&&o.value){const a=o.value,c=this.encodePickingColor(e);for(let l=0;l<n.length;l++){const u=i.getVertexOffset(l);a[u]===c[0]&&a[u+1]===c[1]&&a[u+2]===c[2]&&this._disablePickingIndex(l)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,s=n||r;if(!s)return;const i=s.getVertexOffset(e),o=s.getVertexOffset(e+1);s.buffer.subData({data:new Uint8Array(o-i),offset:i})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Xn.buffer&&(r.value=Xn.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Ue(!this.internalState),Ue(Number.isFinite(this.props.coordinateSystem)),st(VH,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new kH({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(se.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new uH(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){st(JH,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(st(jH,this,e),!e)return;const n=this.props,r=this.context,s=this.internalState,i=r.viewport,o=this._updateUniformTransition();s.propsInTransition=o,r.viewport=s.viewport||i,this.props=o;try{const a=this._getUpdateParams(),c=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const l=this.getModels()[0]!==c[0];this._postUpdate(a,l)}finally{r.viewport=i,this.props=n,this._clearChangeFlags(),s.needsUpdate=!1,s.resetOldProps()}}_finalize(){st(zH,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const s=this.props,i=this.context;this.props=this.internalState.propsInTransition||s;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,c=a&&a(n)||[0,0];Pr(i.gl,{polygonOffset:c}),On(i.gl,r,()=>{const l={moduleParameters:e,uniforms:n,parameters:r,context:i};for(const u of this.props.extensions)u.draw.call(this,l,u);this.draw(l)})}finally{this.props=s}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const s in e)if(e[s]){let i=!1;switch(s){case"dataChanged":const o=e[s],a=n[s];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,i=!0);default:n[s]||(n[s]=e[s],i=!0)}i&&st(HH,this,s,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=fH(e,n);if(r.updateTriggersChanged)for(const i in r.updateTriggersChanged)r.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(r.transitionsChanged)for(const i in r.transitionsChanged){var s;this.internalState.uniformTransitions.add(i,n[i],e[i],(s=e.transitions)===null||s===void 0?void 0:s[i])}return this.setChangeFlags(r)}validateProps(){hH(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new iH(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:s}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:i}=this.state;i==null||i.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:c}=r;if(n||s.autoHighlight!==o||s.highlightedObjectIndex!==a||s.highlightColor!==c){const l={};o||(l.pickingSelectedColor=null),Array.isArray(c)&&(l.pickingHighlightColor=c),(n||a!==s.highlightedObjectIndex)&&(l.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),s=r?r.getNeedsRedraw(e):!1;if(n=n||s,n)for(const i of this.props.extensions)i.onNeedsRedraw.call(this,i);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}g(Mo,"defaultProps",WH);g(Mo,"layerName","Layer");const KH="compositeLayer.renderLayers";class ZS extends Mo{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,s)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:s,visible:i,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:h,coordinateOrigin:f,wrapLongitude:d,positionFormat:m,modelMatrix:_,extensions:T,fetch:p,operation:A,_subLayerProps:y}=this.props,C={id:"",updateTriggers:{},opacity:r,pickable:s,visible:i,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:h,coordinateOrigin:f,wrapLongitude:d,positionFormat:m,modelMatrix:_,extensions:T,fetch:p,operation:A},b=y&&e.id&&y[e.id],S=b&&b.updateTriggers,I=e.id||"sublayer";if(b){const x=this.props[ds],O=e.type?e.type._propTypes:{};for(const M in b){const U=O[M]||x[M];U&&U.type==="accessor"&&(b[M]=this.getSubLayerAccessor(b[M]))}}Object.assign(C,e,b),C.id="".concat(this.props.id,"-").concat(I),C.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...S};for(const x of T){const O=x.getSubLayerProps.call(this,x);O&&Object.assign(C,O,{updateTriggers:Object.assign(C.updateTriggers,O.updateTriggers)})}return C}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const s=!r||this.needsUpdate();if(s){const i=this.renderLayers();r=_o(i,Boolean),this.internalState.subLayers=r}st(KH,this,s,r);for(const i of r)i.parent=this}}g(ZS,"layerName","CompositeLayer");const YH=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,QH=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,ew=[0,0,0,255],tw=[0,0,1],qH={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:tw},getColor:{type:"accessor",value:ew},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function ZH(t){const{header:e,attributes:n}=t;!e||!n||(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}class j0 extends Mo{getShaders(){return super.getShaders({vs:YH,fs:QH,modules:[F0,xU,D0]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:tw},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:ew}})}updateState(e){const{changeFlags:n,props:r}=e;if(super.updateState(e),n.extensionsChanged){var s;const{gl:i}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}n.dataChanged&&ZH(r.data)}draw({uniforms:e}){const{pointSize:n,sizeUnits:r}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:um[r],radiusPixels:n}).draw()}_getModel(e){const n=[];for(let r=0;r<3;r++){const s=r/3*Math.PI*2;n.push(Math.cos(s)*2,Math.sin(s)*2,0)}return new mo(e,{...this.getShaders(),id:this.props.id,geometry:new Ua({drawMode:4,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}g(j0,"layerName","PointCloudLayer");g(j0,"defaultProps",qH);const Gt={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};new w;new w;const ea=new w,fE=new w;let z0=class nw{constructor(e=[0,0,0],n=0){g(this,"center",void 0),g(this,"radius",void 0),this.radius=-0,this.center=new w,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=ea.from(n),this.center=new w().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new nw(this.center,this.radius)}union(e){const n=this.center,r=this.radius,s=e.center,i=e.radius,o=ea.copy(s).subtract(n),a=o.magnitude();if(r>=a+i)return this.clone();if(i>=a+r)return e.clone();const c=(r+a+i)*.5;return fE.copy(o).scale((-r+c)/a).add(n),this.center.copy(fE),this.radius=c,this}expand(e){const r=ea.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=UN(ea,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=ea.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,i=e.normal.dot(n)+e.distance;return i<-r?Gt.OUTSIDE:i<r?Gt.INTERSECTING:Gt.INSIDE}};const e4=new w,t4=new w,Ml=new w,Rl=new w,xl=new w,n4=new w,r4=new w,dr={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};let J0=class rw{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){g(this,"center",void 0),g(this,"halfAxes",void 0),this.center=new w().from(e),this.halfAxes=new xe(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new w(e).len(),new w(n).len(),new w(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),s=new w(e).normalize(),i=new w(n).normalize(),o=new w(r).normalize();return new hc().fromMatrix3(new xe([...s,...i,...o]))}fromCenterHalfSizeQuaternion(e,n,r){const s=new hc(r),i=new xe().fromQuaternion(s);return i[0]=i[0]*n[0],i[1]=i[1]*n[0],i[2]=i[2]*n[0],i[3]=i[3]*n[1],i[4]=i[4]*n[1],i[5]=i[5]*n[1],i[6]=i[6]*n[2],i[7]=i[7]*n[2],i[8]=i[8]*n[2],this.center=new w().from(e),this.halfAxes=i,this}clone(){return new rw(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new z0){const n=this.halfAxes,r=n.getColumn(0,Ml),s=n.getColumn(1,Rl),i=n.getColumn(2,xl),o=e4.copy(r).add(s).add(i);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,s=this.halfAxes,i=r.x,o=r.y,a=r.z,c=Math.abs(i*s[dr.COLUMN0ROW0]+o*s[dr.COLUMN0ROW1]+a*s[dr.COLUMN0ROW2])+Math.abs(i*s[dr.COLUMN1ROW0]+o*s[dr.COLUMN1ROW1]+a*s[dr.COLUMN1ROW2])+Math.abs(i*s[dr.COLUMN2ROW0]+o*s[dr.COLUMN2ROW1]+a*s[dr.COLUMN2ROW2]),l=r.dot(n)+e.distance;return l<=-c?Gt.OUTSIDE:l>=c?Gt.INSIDE:Gt.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=t4.from(e).subtract(this.center),r=this.halfAxes,s=r.getColumn(0,Ml),i=r.getColumn(1,Rl),o=r.getColumn(2,xl),a=s.magnitude(),c=i.magnitude(),l=o.magnitude();s.normalize(),i.normalize(),o.normalize();let u=0,h;return h=Math.abs(n.dot(s))-a,h>0&&(u+=h*h),h=Math.abs(n.dot(i))-c,h>0&&(u+=h*h),h=Math.abs(n.dot(o))-l,h>0&&(u+=h*h),u}computePlaneDistances(e,n,r=[-0,-0]){let s=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,c=a.getColumn(0,Ml),l=a.getColumn(1,Rl),u=a.getColumn(2,xl),h=n4.copy(c).add(l).add(u).add(o),f=r4.copy(h).subtract(e);let d=n.dot(f);return s=Math.min(d,s),i=Math.max(d,i),h.copy(o).add(c).add(l).subtract(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),h.copy(o).add(c).subtract(l).add(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),h.copy(o).add(c).subtract(l).subtract(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),o.copy(h).subtract(c).add(l).add(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),o.copy(h).subtract(c).add(l).subtract(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),o.copy(h).subtract(c).subtract(l).add(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),o.copy(h).subtract(c).subtract(l).subtract(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),r[0]=s,r[1]=i,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,Ml);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,Rl);r.transformAsPoint(e);const s=this.halfAxes.getColumn(2,xl);return s.transformAsPoint(e),this.halfAxes=new xe([...n,...r,...s]),this}getTransform(){throw new Error("not implemented")}};const dE=new w,gE=new w;let _r=class sw{constructor(e=[0,0,1],n=0){g(this,"normal",void 0),g(this,"distance",void 0),this.normal=new w,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return bn(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=dE.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,s){return this.normal.set(e,n,r),bn(Ln(this.normal.len(),1)),this.distance=s,this}clone(){return new sw(this.normal,this.distance)}equals(e){return Ln(this.distance,e.distance)&&Ln(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=gE.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=dE.from(e);const r=this.getPointDistance(e),s=gE.copy(this.normal).scale(r);return e.subtract(s).to(n)}};const mE=[new w([1,0,0]),new w([0,1,0]),new w([0,0,1])],pE=new w,s4=new w;new _r(new w(1,0,0),0);let zs=class ya{constructor(e=[]){g(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*mE.length;const n=e.center,r=e.radius;let s=0;for(const i of mE){let o=this.planes[s],a=this.planes[s+1];o||(o=this.planes[s]=new _r),a||(a=this.planes[s+1]=new _r);const c=pE.copy(i).scale(-r).add(n);-i.dot(c),o.fromPointNormal(c,i);const l=pE.copy(i).scale(r).add(n),u=s4.copy(i).negate();-u.dot(l),a.fromPointNormal(l,u),s+=2}return this}computeVisibility(e){let n=Gt.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case Gt.OUTSIDE:return Gt.OUTSIDE;case Gt.INTERSECTING:n=Gt.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(bn(Number.isFinite(n),"parentPlaneMask is required."),n===ya.MASK_OUTSIDE||n===ya.MASK_INSIDE)return n;let r=ya.MASK_INSIDE;const s=this.planes;for(let i=0;i<this.planes.length;++i){const o=i<31?1<<i:0;if(i<31&&!(n&o))continue;const a=s[i],c=e.intersectPlane(a);if(c===Gt.OUTSIDE)return ya.MASK_OUTSIDE;c===Gt.INTERSECTING&&(r|=o)}return r}};g(zs,"MASK_OUTSIDE",4294967295);g(zs,"MASK_INSIDE",0);g(zs,"MASK_INDETERMINATE",2147483647);new w;new w;new w;new w;new w;new w;new w;new w;new w;new w;new w;new w;new w;new w;new w;new w;new w;const $n=new xe,i4=new xe,o4=new xe,Ol=new xe,AE=new xe;function a4(t,e={}){const n=fc.EPSILON20,r=10;let s=0,i=0;const o=i4,a=o4;o.identity(),a.copy(t);const c=n*c4(a);for(;i<r&&l4(a)>c;)u4(a,Ol),AE.copy(Ol).transpose(),a.multiplyRight(Ol),a.multiplyLeft(AE),o.multiplyRight(Ol),++s>2&&(++i,s=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function c4(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const Lm=[1,0,0],Pm=[2,2,1];function l4(t){let e=0;for(let n=0;n<3;++n){const r=t[$n.getElementIndex(Pm[n],Lm[n])];e+=2*r*r}return Math.sqrt(e)}function u4(t,e){const n=fc.EPSILON15;let r=0,s=1;for(let l=0;l<3;++l){const u=Math.abs(t[$n.getElementIndex(Pm[l],Lm[l])]);u>r&&(s=l,r=u)}const i=Lm[s],o=Pm[s];let a=1,c=0;if(Math.abs(t[$n.getElementIndex(o,i)])>n){const l=t[$n.getElementIndex(o,o)],u=t[$n.getElementIndex(i,i)],h=t[$n.getElementIndex(o,i)],f=(l-u)/2/h;let d;f<0?d=-1/(-f+Math.sqrt(1+f*f)):d=1/(f+Math.sqrt(1+f*f)),a=1/Math.sqrt(1+d*d),c=d*a}return xe.IDENTITY.to(e),e[$n.getElementIndex(i,i)]=e[$n.getElementIndex(o,o)]=a,e[$n.getElementIndex(o,i)]=c,e[$n.getElementIndex(i,o)]=-c,e}const $r=new w,h4=new w,f4=new w,d4=new w,g4=new w,m4=new xe,p4={diagonal:new xe,unitary:new xe};function A4(t,e=new J0){if(!t||t.length===0)return e.halfAxes=new xe([0,0,0,0,0,0,0,0,0]),e.center=new w,e;const n=t.length,r=new w(0,0,0);for(const O of t)r.add(O);const s=1/n;r.multiplyByScalar(s);let i=0,o=0,a=0,c=0,l=0,u=0;for(const O of t){const M=$r.copy(O).subtract(r);i+=M.x*M.x,o+=M.x*M.y,a+=M.x*M.z,c+=M.y*M.y,l+=M.y*M.z,u+=M.z*M.z}i*=s,o*=s,a*=s,c*=s,l*=s,u*=s;const h=m4;h[0]=i,h[1]=o,h[2]=a,h[3]=o,h[4]=c,h[5]=l,h[6]=a,h[7]=l,h[8]=u;const{unitary:f}=a4(h,p4),d=e.halfAxes.copy(f);let m=d.getColumn(0,f4),_=d.getColumn(1,d4),T=d.getColumn(2,g4),p=-Number.MAX_VALUE,A=-Number.MAX_VALUE,y=-Number.MAX_VALUE,C=Number.MAX_VALUE,b=Number.MAX_VALUE,S=Number.MAX_VALUE;for(const O of t)$r.copy(O),p=Math.max($r.dot(m),p),A=Math.max($r.dot(_),A),y=Math.max($r.dot(T),y),C=Math.min($r.dot(m),C),b=Math.min($r.dot(_),b),S=Math.min($r.dot(T),S);m=m.multiplyByScalar(.5*(C+p)),_=_.multiplyByScalar(.5*(b+A)),T=T.multiplyByScalar(.5*(S+y)),e.center.copy(m).add(_).add(T);const I=h4.set(p-C,A-b,y-S).multiplyByScalar(.5),x=new xe([I[0],0,0,0,I[1],0,0,0,I[2]]);return e.halfAxes.multiplyRight(x),e}const Ed=Math.PI/180,Ll=new Float32Array(16),_E=new Float32Array(12);function yE(t,e,n){const r=e[0]*Ed,s=e[1]*Ed,i=e[2]*Ed,o=Math.sin(i),a=Math.sin(r),c=Math.sin(s),l=Math.cos(i),u=Math.cos(r),h=Math.cos(s),f=n[0],d=n[1],m=n[2];t[0]=f*h*u,t[1]=f*c*u,t[2]=f*-a,t[3]=d*(-c*l+h*a*o),t[4]=d*(h*l+c*a*o),t[5]=d*u*o,t[6]=m*(c*o+h*a*l),t[7]=m*(-h*o+c*a*l),t[8]=m*u*l}function EE(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const iw={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:s,getScale:i,getTranslation:o,getTransformMatrix:a}=this.props,c=Array.isArray(a),l=c&&a.length===16,u=Array.isArray(i),h=Array.isArray(s),f=Array.isArray(o),d=l||!c&&!!a(r[0]);d?t.constant=l:t.constant=h&&u&&f;const m=t.value;if(t.constant){let _;d?(Ll.set(a),_=EE(Ll)):(_=_E,yE(_,s,i),_.set(o,9)),t.value=new Float32Array(_)}else{let _=e*t.size;const{iterable:T,objectInfo:p}=zS(r,e,n);for(const A of T){p.index++;let y;if(d)Ll.set(l?a:a(A,p)),y=EE(Ll);else{y=_E;const C=h?s:s(A,p),b=u?i:i(A,p);yE(y,C,b),y.set(f?o:o(A,p),9)}m[_++]=y[0],m[_++]=y[1],m[_++]=y[2],m[_++]=y[3],m[_++]=y[4],m[_++]=y[5],m[_++]=y[6],m[_++]=y[7],m[_++]=y[8],m[_++]=y[9],m[_++]=y[10],m[_++]=y[11]}}}};function ow(t,e){return e===ee.CARTESIAN||e===ee.METER_OFFSETS||e===ee.DEFAULT&&!t.isGeospatial}const _4=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,y4=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function aw(t){let e=1/0,n=1/0,r=1/0,s=-1/0,i=-1/0,o=-1/0;const a=t.POSITION?t.POSITION.value:[],c=a&&a.length;for(let l=0;l<c;l+=3){const u=a[l],h=a[l+1],f=a[l+2];e=u<e?u:e,n=h<n?h:n,r=f<r?f:r,s=u>s?u:s,i=h>i?h:i,o=f>o?f:o}return[[e,n,r],[s,i,o]]}function E4(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class zi{constructor(e,n){g(this,"fields",void 0),g(this,"metadata",void 0),E4(Array.isArray(e)),T4(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];for(const o of r)e[o]=!0;const i=this.fields.filter(o=>e[o.name]);return new zi(i,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const s=n.map(i=>this.fields[i]).filter(Boolean);return new zi(s,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof zi){const o=e;n=o.fields,r=TE(TE(new Map,this.metadata),o.metadata)}else n=e;const s=Object.create(null);for(const o of this.fields)s[o.name]=o;for(const o of n)s[o.name]=o;const i=Object.values(s);return new zi(i,r)}}function T4(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function TE(t,e){return new Map([...t||new Map,...e||new Map])}class mh{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;g(this,"name",void 0),g(this,"type",void 0),g(this,"nullable",void 0),g(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=s}get typeId(){return this.type&&this.type.typeId}clone(){return new mh(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Me=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),cw,lw,uw;class X0{static isNull(e){return e&&e.typeId===Me.Null}static isInt(e){return e&&e.typeId===Me.Int}static isFloat(e){return e&&e.typeId===Me.Float}static isBinary(e){return e&&e.typeId===Me.Binary}static isUtf8(e){return e&&e.typeId===Me.Utf8}static isBool(e){return e&&e.typeId===Me.Bool}static isDecimal(e){return e&&e.typeId===Me.Decimal}static isDate(e){return e&&e.typeId===Me.Date}static isTime(e){return e&&e.typeId===Me.Time}static isTimestamp(e){return e&&e.typeId===Me.Timestamp}static isInterval(e){return e&&e.typeId===Me.Interval}static isList(e){return e&&e.typeId===Me.List}static isStruct(e){return e&&e.typeId===Me.Struct}static isUnion(e){return e&&e.typeId===Me.Union}static isFixedSizeBinary(e){return e&&e.typeId===Me.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Me.FixedSizeList}static isMap(e){return e&&e.typeId===Me.Map}static isDictionary(e){return e&&e.typeId===Me.Dictionary}get typeId(){return Me.NONE}compareTo(e){return this===e}}cw=Symbol.toStringTag;class Ro extends X0{constructor(e,n){super(),g(this,"isSigned",void 0),g(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Me.Int}get[cw](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class v4 extends Ro{constructor(){super(!0,8)}}class C4 extends Ro{constructor(){super(!0,16)}}class B4 extends Ro{constructor(){super(!0,32)}}class b4 extends Ro{constructor(){super(!1,8)}}class S4 extends Ro{constructor(){super(!1,16)}}class w4 extends Ro{constructor(){super(!1,32)}}const hw={HALF:16,SINGLE:32,DOUBLE:64};lw=Symbol.toStringTag;class fw extends X0{constructor(e){super(),g(this,"precision",void 0),this.precision=e}get typeId(){return Me.Float}get[lw](){return"Float"}toString(){return"Float".concat(this.precision)}}class I4 extends fw{constructor(){super(hw.SINGLE)}}class M4 extends fw{constructor(){super(hw.DOUBLE)}}uw=Symbol.toStringTag;class R4 extends X0{constructor(e,n){super(),g(this,"listSize",void 0),g(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Me.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[uw](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function x4(t){switch(t.constructor){case Int8Array:return new v4;case Uint8Array:return new b4;case Int16Array:return new C4;case Uint16Array:return new S4;case Int32Array:return new B4;case Uint32Array:return new w4;case Float32Array:return new I4;case Float64Array:return new M4;default:throw new Error("array type not supported")}}function O4(t,e,n){const r=x4(e.value),s=n||L4(e);return new mh(t,new R4(e.size,new mh("value",r)),!1,s)}function L4(t){const e=new Map;return"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10)),"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10)),"normalized"in t&&e.set("normalized",t.normalized.toString()),e}function vE(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),se.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function CE(t,e){if(t.attributes)return vE(t.attributes,e),t instanceof Ua?t:new Ua(t);if(t.positions||t.POSITION)return vE(t,e),new Ua({attributes:t});throw Error("Invalid mesh")}const P4=[0,0,0,255],F4={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:P4},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class $0 extends Mo{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){const e=!Y(this.context.gl),n={};return A0(this.context.gl,Ae.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:_4,fs:y4,modules:[F0,OU,D0],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:r}=this.props;if(!r)return null;if(n=(e=r.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:s}=CE(r,this.props._useMeshColors);s.POSITION=s.POSITION||s.positions,n=aw(s)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:iw}),this.setState({emptyTexture:new $t(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:s}=e;if(n.mesh!==r.mesh||s.extensionsChanged){var i;if(this.state.positionBounds=null,(i=this.state.model)===null||i===void 0||i.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const o=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:i}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!i||ow(n,s),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new mo(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:CE(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:s}=this.state;return n.setUniforms({sampler:r||s,hasTexture:!!r}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:!!e})}}g($0,"defaultProps",F4);g($0,"layerName","SimpleMeshLayer");class to{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n}=e;this.id=n||Fr(this.constructor.name),this.display=!0,this.position=new w,this.rotation=new w,this.scale=new w(1,1,1),this.matrix=new q,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(e){return k(e.length===3,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return k(e.length===3,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return k(e.length===3,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:n,rotation:r,scale:s,update:i=!0}=e;return n&&this.setPosition(n),r&&this.setRotation(r),s&&this.setScale(s),i&&this.updateMatrix(),this}updateMatrix(){const e=this.position,n=this.rotation,r=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(r),this}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:n,rotation:r,scale:s}=e;return n&&this.setPosition(n),r&&this.setRotation(r),s&&this.setScale(s),this.updateMatrix(),this}getCoordinateUniforms(e,n){k(e),n=n||this.matrix;const r=new q(e).multiplyRight(n),s=r.invert(),i=s.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:r,worldInverseMatrix:s,worldInverseTransposeMatrix:i}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class Ga extends to{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:n=[]}=e;z.assert(n.every(r=>r instanceof to),"every child must an instance of ScenegraphNode"),super(e),this.children=n}add(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const s of n)Array.isArray(s)?this.add(...s):this.children.push(s);return this}remove(e){const n=this.children,r=n.indexOf(e);return r>-1&&n.splice(r,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}getBounds(){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((n,r)=>{let{worldMatrix:s}=r;const i=n.getBounds();if(!i)return;const[o,a]=i,c=new w(o).add(a).divide([2,2,2]);s.transformAsPoint(c,c);const l=new w(a).subtract(o).divide([2,2,2]);s.transformAsVector(l,l);for(let u=0;u<8;u++){const h=new w(u&1?-1:1,u&2?-1:1,u&4?-1:1).multiply(l).add(c);for(let f=0;f<3;f++)e[0][f]=Math.min(e[0][f],h[f]),e[1][f]=Math.max(e[1][f],h[f])}}),Number.isFinite(e[0][0])?e:null}traverse(e){let{worldMatrix:n=new q}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new q(n).multiplyRight(this.matrix);for(const s of this.children)s instanceof Ga?s.traverse(e,{worldMatrix:r}):e(s,{worldMatrix:r})}}const D4={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},N4={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function BE(t){if(!t._animation){const e=N4[t.componentType],n=D4[t.type],r=n*t.count,{buffer:s,byteOffset:i}=t.bufferView.data,o=new e(s,i+(t.byteOffset||0),r);if(n===1)t._animation=Array.from(o);else{const a=[];for(let c=0;c<o.length;c+=n)a.push(Array.from(o.slice(c,c+n)));t._animation=a}}return t._animation}const U4=new q;function G4(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=U4.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}const Td=new hc;function k4(t,e,n,r,s){if(e==="rotation"){Td.slerp({start:n,target:r,ratio:s});for(let i=0;i<Td.length;i++)t[e][i]=Td[i]}else for(let i=0;i<n.length;i++)t[e][i]=s*r[i]+(1-s)*n[i]}function H4(t,e,n){let{p0:r,outTangent0:s,inTangent1:i,p1:o,tDiff:a,ratio:c}=n;for(let l=0;l<t[e].length;l++){const u=s[l]*a,h=i[l]*a;t[e][l]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*r[l]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*u+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[l]+(Math.pow(c,3)-Math.pow(c,2))*h}}function V4(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}function j4(t,e,n,r){let{input:s,interpolation:i,output:o}=e;const a=s[s.length-1],c=t%a,l=s.findIndex(d=>d>=c),u=Math.max(0,l-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:z.warn("Bad animation path ".concat(r))()}k(n[r].length===o[u].length);const h=s[u],f=s[l];switch(i){case"STEP":V4(n,r,o[u]);break;case"LINEAR":if(f>h){const d=(c-h)/(f-h);k4(n,r,o[u],o[l],d)}break;case"CUBICSPLINE":if(f>h){const d=(c-h)/(f-h),m=f-h,_=o[3*u+1],T=o[3*u+2],p=o[3*l+0],A=o[3*l+1];H4(n,r,{p0:_,outTangent0:T,inTangent1:p,p1:A,tDiff:m,ratio:d})}break;default:z.warn("Interpolation ".concat(i," not supported"))();break}}class z4{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const r=(e/1e3-this.startTime)*this.speed;this.channels.forEach(s=>{let{sampler:i,target:o,path:a}=s;j4(r,i,o,a),G4(o,o._node)})}}class J4{constructor(e){this.animations=e.animations.map((n,r)=>{const s=n.name||"Animation-".concat(r),i=n.samplers.map(a=>{let{input:c,interpolation:l="LINEAR",output:u}=a;return{input:BE(e.accessors[c]),interpolation:l,output:BE(e.accessors[u])}}),o=n.channels.map(a=>{let{sampler:c,target:l}=a;return{sampler:i[c],target:e.nodes[l.node],path:l.path}});return new z4({name:s,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(n=>n.animate(e))}getAnimations(){return this.animations}}class X4 extends to{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(n),this.onBeforeRender=null,this.AfterRender=null,e instanceof mo?(this.model=e,this._setModelNodeProps(n)):this.model=new mo(e,n),this.bounds=null,this.managedResources=n.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class dw{constructor(e,n){let{attributes:r,material:s,pbrDebug:i,imageBasedLightingEnvironment:o,lights:a,useTangents:c}=n;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},A0(e,Ae.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),i&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(r.NORMAL,"HAS_NORMALS"),this.defineIfPresent(r.TANGENT&&c,"HAS_TANGENTS"),this.defineIfPresent(r.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(i,"PBR_DEBUG"),s&&this.parseMaterial(s)}defineIfPresent(e,n){e&&(this.defines[n]=1)}parseTexture(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const s=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},i=e.texture.source.image;let o,a={};i.compressed?(o=i,a={[this.gl.TEXTURE_MIN_FILTER]:i.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:i};const c=new $t(this.gl,{id:e.name||e.id,parameters:{...s,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...o});this.uniforms[n]=c,this.defineIfPresent(r,r),this.generatedTextures.push(c)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:n=1,roughnessFactor:r=1}=e;this.uniforms.u_MetallicRoughnessValues=[n,r]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=!!e.unlit,e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:n=1}=e.normalTexture;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:n=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=n}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode==="MASK"){const{alphaCutoff:n=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=n}else e.alphaMode==="BLEND"&&(z.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}const $4=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,W4=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function bE(t,e){return Y(t)?`#version 300 es
`.concat(e):e}function K4(t,e){const{id:n,drawMode:r,vertexCount:s,attributes:i,modelOptions:o}=e,a=new dw(t,e);z.info(4,"createGLTFModel defines: ",a.defines)();const c=[];c.push(...a.generatedTextures),c.push(...Object.values(i).map(u=>u.buffer));const l=new X4(t,{id:n,drawMode:r,vertexCount:s,modules:[M0],parameters:a.parameters,vs:bE(t,$4),fs:bE(t,W4),managedResources:c,...o,defines:{...a.defines,...o.defines}});return l.setProps({attributes:i}),l.setUniforms(a.uniforms),l}const Y4={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Q4={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class q4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.options=Object.assign({},Q4,n)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(r=>this.createScene(r))}createAnimator(){return Array.isArray(this.gltf.animations)?new J4(this.gltf):null}createScene(e){const r=(e.nodes||[]).map(i=>this.createNode(i));return new Ga({id:e.name||e.id,children:r})}createNode(e){if(!e._node){const r=(e.children||[]).map(i=>this.createNode(i));e.mesh&&r.push(this.createMesh(e.mesh));const s=new Ga({id:e.name||e.id,children:r});if(e.matrix)s.setMatrix(e.matrix);else{if(s.matrix.identity(),e.translation&&s.matrix.translate(e.translation),e.rotation){const i=new q().fromQuaternion(e.rotation);s.matrix.multiplyRight(i)}e.scale&&s.matrix.scale(e.scale)}e._node=s}return e._node}createMesh(e){if(!e._mesh){const r=(e.primitives||[]).map((i,o)=>this.createPrimitive(i,o,e)),s=new Ga({id:e.name||e.id,children:r});e._mesh=s}return e._mesh}getVertexCount(e){z.warn("getVertexCount() not found")()}createPrimitive(e,n,r){const s=K4(this.gl,Object.assign({id:e.name||"".concat(r.name||r.id,"-primitive-").concat(n),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return s.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],s}createAttributes(e,n){const r={};return Object.keys(e).forEach(s=>{r[s]=this.createAccessor(e[s],this.createBuffer(e[s],this.gl.ARRAY_BUFFER))}),n&&(r.indices=this.createAccessor(n,this.createBuffer(n,this.gl.ELEMENT_ARRAY_BUFFER))),z.info(4,"glTF Attributes",{attributes:e,indices:n,generated:r})(),r}createBuffer(e,n){e.bufferView||(e.bufferView={});const{bufferView:r}=e;return r.lumaBuffers||(r.lumaBuffers={}),r.lumaBuffers[n]||(r.lumaBuffers[n]=new ge(this.gl,{id:"from-".concat(r.id),data:r.data||e.value,target:n})),r.lumaBuffers[n]}createAccessor(e,n){return new Ct({buffer:n,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Y4[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function Z4(t,e,n){const r=new q4(t,n),s=r.instantiate(e),i=r.createAnimator();return{scenes:s,animator:i}}const e8="3.4.14",t8="3.4.14",gw="3.4.14",n8="https://unpkg.com/@loaders.gl/textures@".concat(gw,"/dist/libs/basis_encoder.wasm"),r8="https://unpkg.com/@loaders.gl/textures@".concat(gw,"/dist/libs/basis_encoder.js");let vd;async function SE(t){const e=t.modules||{};return e.basis?e.basis:(vd=vd||s8(t),await vd)}async function s8(t){let e=null,n=null;return[e,n]=await Promise.all([await Vs("basis_transcoder.js","textures",t),await Vs("basis_transcoder.wasm","textures",t)]),e=e||globalThis.BASIS,await i8(e,n)}function i8(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(s=>{const{BasisFile:i,initializeBasis:o}=s;o(),r({BasisFile:i})})})}let Cd;async function wE(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(Cd=Cd||o8(t),await Cd)}async function o8(t){let e=null,n=null;return[e,n]=await Promise.all([await Vs(r8,"textures",t),await Vs(n8,"textures",t)]),e=e||globalThis.BASIS,await a8(e,n)}function a8(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(s=>{const{BasisFile:i,KTX2File:o,initializeBasis:a,BasisEncoder:c}=s;a(),r({BasisFile:i,KTX2File:o,BasisEncoder:c})})})}const yi={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},c8=["","WEBKIT_","MOZ_"],IE={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let Pl=null;function l8(t){if(!Pl){t=t||u8()||void 0,Pl=new Set;for(const e of c8)for(const n in IE)if(t&&t.getExtension("".concat(e).concat(n))){const r=IE[n];Pl.add(r)}}return Pl}function u8(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var ME,RE,xE,OE,LE,PE,FE,DE;(function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"})(ME||(ME={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(RE||(RE={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(xE||(xE={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(OE||(OE={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(LE||(LE={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(PE||(PE={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(FE||(FE={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(DE||(DE={}));const Pt=[171,75,84,88,32,50,48,187,13,10,26,10];function h8(t){const e=new Uint8Array(t);return!(e.byteLength<Pt.length||e[0]!==Pt[0]||e[1]!==Pt[1]||e[2]!==Pt[2]||e[3]!==Pt[3]||e[4]!==Pt[4]||e[5]!==Pt[5]||e[6]!==Pt[6]||e[7]!==Pt[7]||e[8]!==Pt[8]||e[9]!==Pt[9]||e[10]!==Pt[10]||e[11]!==Pt[11])}const f8={etc1:{basisFormat:0,compressed:!0,format:yi.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:yi.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:yi.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:yi.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:yi.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:yi.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function d8(t,e){if(e.basis.containerFormat==="auto"){if(h8(t)){const r=await wE(e);return NE(r.KTX2File,t,e)}const{BasisFile:n}=await SE(e);return Bd(n,t,e)}switch(e.basis.module){case"encoder":const n=await wE(e);switch(e.basis.containerFormat){case"ktx2":return NE(n.KTX2File,t,e);case"basis":default:return Bd(n.BasisFile,t,e)}case"transcoder":default:const{BasisFile:r}=await SE(e);return Bd(r,t,e)}}function Bd(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const s=r.getNumImages(),i=[];for(let o=0;o<s;o++){const a=r.getNumLevels(o),c=[];for(let l=0;l<a;l++)c.push(g8(r,o,l,n));i.push(c)}return i}finally{r.close(),r.delete()}}function g8(t,e,n,r){const s=t.getImageWidth(e,n),i=t.getImageHeight(e,n),o=t.getHasAlpha(),{compressed:a,format:c,basisFormat:l}=mw(r,o),u=t.getImageTranscodedSizeInBytes(e,n,l),h=new Uint8Array(u);if(!t.transcodeImage(h,e,n,l,0,0))throw new Error("failed to start Basis transcoding");return{width:s,height:i,data:h,compressed:a,format:c,hasAlpha:o}}function NE(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const s=r.getLevels(),i=[];for(let o=0;o<s;o++){i.push(m8(r,o,n));break}return[i]}finally{r.close(),r.delete()}}function m8(t,e,n){const{alphaFlag:r,height:s,width:i}=t.getImageLevelInfo(e,0,0),{compressed:o,format:a,basisFormat:c}=mw(n,r),l=t.getImageTranscodedSizeInBytes(e,0,0,c),u=new Uint8Array(l);if(!t.transcodeImage(u,e,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:i,height:s,data:u,compressed:o,levelSize:l,hasAlpha:r,format:a}}function mw(t,e){let n=t&&t.basis&&t.basis.format;return n==="auto"&&(n=pw()),typeof n=="object"&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),f8[n]}function pw(){const t=l8();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}const p8={name:"Basis",id:Ir?"basis":"basis-nodejs",module:"textures",version:t8,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},A8={...p8,parse:d8};function Vt(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function Aw(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const r=e.baseUri||e.uri;if(!r)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return r.substr(0,r.lastIndexOf("/")+1)+t}function _8(t,e,n){const r=t.bufferViews[n];Vt(r);const s=r.buffer,i=e[s];Vt(i);const o=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,r.byteLength)}const UE=["SCALAR","VEC2","VEC3","VEC4"],y8=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],E8=new Map(y8),T8={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},v8={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},C8={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function _w(t){return UE[t-1]||UE[0]}function yw(t){const e=E8.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function W0(t,e){const n=C8[t.componentType],r=T8[t.type],s=v8[t.componentType],i=t.count*r,o=t.count*r*s;return Vt(o>=0&&o<=e.byteLength),{ArrayType:n,length:i,byteLength:o}}function Ew(t){let{images:e,bufferViews:n}=t;e=e||[],n=n||[];const r=e.map(o=>o.bufferView);n=n.filter(o=>!r.includes(o));const s=n.reduce((o,a)=>o+a.byteLength,0),i=e.reduce((o,a)=>{const{width:c,height:l}=a.image;return o+c*l},0);return s+Math.ceil(4*i*1.33)}const B8={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};let Rt=class{constructor(e){g(this,"gltf",void 0),g(this,"sourceBuffers",void 0),g(this,"byteLength",void 0),this.gltf=e||{json:{...B8},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){const n=this.getUsedExtensions().find(s=>s===e),r=this.json.extensions||{};return n?r[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(r=>r===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];if(!r)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(n,"]"));return r}getTypedArrayForBufferView(e){e=this.getBufferView(e);const n=e.buffer,r=this.gltf.buffers[n];Vt(r);const s=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,s,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),s=this.getBuffer(n.buffer).data,{ArrayType:i,length:o}=W0(e,n),a=n.byteOffset+e.byteOffset;return new i(s,a,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),s=this.getBuffer(n.buffer).data,i=n.byteOffset||0;return new Uint8Array(s,i,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,r){return e.extensions=e.extensions||{},e.extensions[n]=r,this.registerUsedExtension(n),this}setObjectExtension(e,n,r){const s=e.extensions||{};s[n]=r}removeObjectExtension(e,n){const r=e.extensions||{},s=r[n];return delete r[n],s}addExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Vt(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Vt(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){if(!this.getExtension(e))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);const n=this.json.extensionsRemoved;n.includes(e)||n.push(e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){const{meshIndex:n,matrix:r}=e;this.json.nodes=this.json.nodes||[];const s={mesh:n};return r&&(s.matrix=r),this.json.nodes.push(s),this.json.nodes.length-1}addMesh(e){const{attributes:n,indices:r,material:s,mode:i=4}=e,a={primitives:[{attributes:this._addAttributes(n),mode:i}]};if(r){const c=this._addIndices(r);a.primitives[0].indices=c}return Number.isFinite(s)&&(a.primitives[0].material=s),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const r={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(e,n){const r=l0(e),s=n||(r==null?void 0:r.mimeType),o={bufferView:this.addBufferView(e),mimeType:s};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const n=e.byteLength;Vt(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const r={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=bc(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}addAccessor(e,n){const r={bufferView:e,type:_w(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3};const r=this.addBufferView(e);let s={min:n.min,max:n.max};(!s.min||!s.max)&&(s=this._getAccessorMinMax(e,n.size));const i={size:n.size,componentType:yw(e),count:Math.round(e.length/n.size),min:s.min,max:s.max};return this.addAccessor(r,Object.assign(i,n))}addTexture(e){const{imageIndex:n}=e,r={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,n;this.gltf.buffers=[];const r=this.byteLength,s=new ArrayBuffer(r),i=new Uint8Array(s);let o=0;for(const a of this.sourceBuffers||[])o=Jx(a,i,o);(e=this.json)!==null&&e!==void 0&&(n=e.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=s,this.sourceBuffers=[s]}_removeStringFromArray(e,n){let r=!0;for(;r;){const s=e.indexOf(n);s>-1?e.splice(s,1):r=!1}}_addAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={};for(const r in e){const s=e[r],i=this._getGltfAttributeName(r),o=this.addBinaryBuffer(s.value,s);n[i]=o}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,n){const r={min:null,max:null};if(e.length<n)return r;r.min=[],r.max=[];const s=e.subarray(0,n);for(const i of s)r.min.push(i),r.max.push(i);for(let i=n;i<e.length;i+=n)for(let o=0;o<n;o++)r.min[0+o]=Math.min(r.min[0+o],e[i+o]),r.max[0+o]=Math.max(r.max[0+o],e[i+o]);return r}};const b8="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",S8="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",w8=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),I8=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),M8={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},R8={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function x8(t,e,n,r,s){let i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE";const o=await O8();F8(o,o.exports[R8[s]],t,e,n,r,o.exports[M8[i||"NONE"]])}let bd;async function O8(){return bd||(bd=L8()),bd}async function L8(){let t=b8;WebAssembly.validate(w8)&&(t=S8,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(P8(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function P8(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;++r){const s=t.charCodeAt(r);e[r]=s>96?s-71:s>64?s-65:s>47?s+4:s>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?I8[e[r]]:(e[r]-60)*64+e[++r];return e.buffer.slice(0,n)}function F8(t,e,n,r,s,i,o){const a=t.exports.sbrk,c=r+3&-4,l=a(c*s),u=a(i.length),h=new Uint8Array(t.exports.memory.buffer);h.set(i,u);const f=e(l,r,s,u,i.length);if(f===0&&o&&o(l,c,s),n.set(h.subarray(l,l+r*s)),a(l-a(0)),f!==0)throw new Error("Malformed buffer data: ".concat(f))}const K0="EXT_meshopt_compression",D8=K0;async function N8(t,e){var n;const r=new Rt(t);if(!(e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const s=[];for(const i of t.json.bufferViews||[])s.push(U8(r,i));await Promise.all(s),r.removeExtension(K0)}async function U8(t,e){const n=t.getObjectExtension(e,K0);if(n){const{byteOffset:r=0,byteLength:s=0,byteStride:i,count:o,mode:a,filter:c="NONE",buffer:l}=n,u=t.gltf.buffers[l],h=new Uint8Array(u.arrayBuffer,u.byteOffset+r,s),f=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return await x8(f,o,i,h,a,c),f}return null}const G8=Object.freeze(Object.defineProperty({__proto__:null,decode:N8,name:D8},Symbol.toStringTag,{value:"Module"})),Ii="EXT_texture_webp",k8=Ii;function H8(t,e){const n=new Rt(t);if(!XL("image/webp")){if(n.getRequiredExtensions().includes(Ii))throw new Error("gltf: Required extension ".concat(Ii," not supported by browser"));return}const{json:r}=n;for(const s of r.textures||[]){const i=n.getObjectExtension(s,Ii);i&&(s.source=i.source),n.removeObjectExtension(s,Ii)}n.removeExtension(Ii)}const V8=Object.freeze(Object.defineProperty({__proto__:null,name:k8,preprocess:H8},Symbol.toStringTag,{value:"Module"})),bu="KHR_texture_basisu",j8=bu;function z8(t,e){const n=new Rt(t),{json:r}=n;for(const s of r.textures||[]){const i=n.getObjectExtension(s,bu);i&&(s.source=i.source),n.removeObjectExtension(s,bu)}n.removeExtension(bu)}const J8=Object.freeze(Object.defineProperty({__proto__:null,name:j8,preprocess:z8},Symbol.toStringTag,{value:"Module"})),X8="3.4.14",$8={draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},W8={name:"Draco",id:Ir?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:X8,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:$8};function K8(t,e,n){const r=Tw(e.metadata),s=[],i=Y8(e.attributes);for(const o in t){const a=t[o],c=GE(o,a,i[o]);s.push(c)}if(n){const o=GE("indices",n);s.push(o)}return new zi(s,r)}function Y8(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}function GE(t,e,n){const r=n?Tw(n.metadata):void 0;return O4(t,e,r)}function Tw(t){const e=new Map;for(const n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}const kE={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Q8={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},q8=4;let Z8=class{constructor(e){g(this,"draco",void 0),g(this,"decoder",void 0),g(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);const s=this.decoder.GetEncodedGeometryType(r),i=s===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(s){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(r,i);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(r,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!i.ptr){const f="DRACO decompression failed: ".concat(o.error_msg());throw new Error(f)}const a=this._getDracoLoaderData(i,s,n),c=this._getMeshData(i,a,n),l=aw(c.attributes),u=K8(c.attributes,a,c.indices);return{loader:"draco",loaderData:a,header:{vertexCount:i.num_points(),boundingBox:l},...c,schema:u}}finally{this.draco.destroy(r),i&&this.draco.destroy(i)}}_getDracoLoaderData(e,n,r){const s=this._getTopLevelMetadata(e),i=this._getDracoAttributes(e,r);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:s,attributes:i}}_getDracoAttributes(e,n){const r={};for(let s=0;s<e.num_attributes();s++){const i=this.decoder.GetAttribute(e,s),o=this._getAttributeMetadata(e,s);r[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:s,metadata:o};const a=this._getQuantizationTransform(i,n);a&&(r[i.unique_id()].quantization_transform=a);const c=this._getOctahedronTransform(i,n);c&&(r[i.unique_id()].octahedron_transform=c)}return r}_getMeshData(e,n,r){const s=this._getMeshAttributes(n,e,r);if(!s.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(r.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:s,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:s,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:s}}_getMeshAttributes(e,n,r){const s={};for(const i of Object.values(e.attributes)){const o=this._deduceAttributeName(i,r);i.name=o;const{value:a,size:c}=this._getAttributeValues(n,i);s[o]={value:a,size:c,byteOffset:i.byte_offset,byteStride:i.byte_stride,normalized:i.normalized}}return s}_getTriangleListIndices(e){const r=e.num_faces()*3,s=r*q8,i=this.draco._malloc(s);try{return this.decoder.GetTrianglesUInt32Array(e,s,i),new Uint32Array(this.draco.HEAPF32.buffer,i,r).slice()}finally{this.draco._free(i)}}_getTriangleStripIndices(e){const n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),n6(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){const r=Q8[n.data_type],s=n.num_components,o=e.num_points()*s,a=o*r.BYTES_PER_ELEMENT,c=e6(this.draco,r);let l;const u=this.draco._malloc(a);try{const h=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,h,c,a,u),l=new r(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:l,size:s}}_deduceAttributeName(e,n){const r=e.unique_id;for(const[o,a]of Object.entries(n.extraAttributes||{}))if(a===r)return o;const s=e.attribute_type;for(const o in kE)if(this.draco[o]===s)return kE[o];const i=n.attributeNameEntry||"name";return e.metadata[i]?e.metadata[i].string:"CUSTOM_ATTRIBUTE_".concat(r)}_getTopLevelMetadata(e){const n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){const r=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const n={},r=this.metadataQuerier.NumEntries(e);for(let s=0;s<r;s++){const i=this.metadataQuerier.GetEntryName(e,s);n[i]=this._getDracoMetadataField(e,i)}return n}_getDracoMetadataField(e,n){const r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,r);const s=t6(r);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:s}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){const{quantizedAttributes:n=[],octahedronAttributes:r=[]}=e,s=[...n,...r];for(const i of s)this.decoder.SkipAttributeTransform(this.draco[i])}_getQuantizationTransform(e,n){const{quantizedAttributes:r=[]}=n,s=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(s)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,n){const{octahedronAttributes:r=[]}=n,s=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(s)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}};function e6(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function t6(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}function n6(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}const r6="1.5.5",Y0="https://www.gstatic.com/draco/versioned/decoders/".concat(r6),s6="".concat(Y0,"/draco_decoder.js"),i6="".concat(Y0,"/draco_wasm_wrapper.js"),o6="".concat(Y0,"/draco_decoder.wasm");let ta;async function a6(t){const e=t.modules||{};return e.draco3d?ta=ta||e.draco3d.createDecoderModule({}).then(n=>({draco:n})):ta=ta||c6(t),await ta}async function c6(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await Vs(s6,"draco",t);break;case"wasm":default:[e,n]=await Promise.all([await Vs(i6,"draco",t),await Vs(o6,"draco",t)])}return e=e||globalThis.DracoDecoderModule,await l6(e,n)}function l6(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t({...n,onModuleLoaded:s=>r({draco:s})})})}const vw={...W8,parse:u6};async function u6(t,e){const{draco:n}=await a6(e),r=new Z8(n);try{return r.parseSync(t,e==null?void 0:e.draco)}finally{r.destroy()}}function h6(t){const e={};for(const n in t){const r=t[n];if(n!=="indices"){const s=Cw(r);e[n]=s}}return e}function Cw(t){const{buffer:e,size:n,count:r}=f6(t);return{value:e,size:n,byteOffset:0,count:r,type:_w(n),componentType:yw(e)}}function f6(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=d6(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}function d6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?Array.isArray(t)?new e(t):n&&!(t instanceof e)?new e(t):t:null}const Zs="KHR_draco_mesh_compression",g6=Zs;function m6(t,e,n){const r=new Rt(t);for(const s of Bw(r))r.getObjectExtension(s,Zs)}async function p6(t,e,n){var r;if(!(e!=null&&(r=e.gltf)!==null&&r!==void 0&&r.decompressMeshes))return;const s=new Rt(t),i=[];for(const o of Bw(s))s.getObjectExtension(o,Zs)&&i.push(_6(s,o,e,n));await Promise.all(i),s.removeExtension(Zs)}function A6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new Rt(t);for(const r of n.json.meshes||[])y6(r,e),n.addRequiredExtension(Zs)}async function _6(t,e,n,r){const s=t.getObjectExtension(e,Zs);if(!s)return;const i=t.getTypedArrayForBufferView(s.bufferView),o=e0(i.buffer,i.byteOffset),{parse:a}=r,c={...n};delete c["3d-tiles"];const l=await a(o,vw,c,r),u=h6(l.attributes);for(const[h,f]of Object.entries(u))if(h in e.attributes){const d=e.attributes[h],m=t.getAccessor(d);m!=null&&m.min&&m!==null&&m!==void 0&&m.max&&(f.min=m.min,f.max=m.max)}e.attributes=u,l.indices&&(e.indices=Cw(l.indices)),E6(e)}function y6(t,e){var n;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!s.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=s.DracoWriter.encodeSync({attributes:t}),a=i==null||(n=i.parseSync)===null||n===void 0?void 0:n.call(i,{attributes:t}),c=s._addFauxAttributes(a.attributes),l=s.addBufferView(o);return{primitives:[{attributes:c,mode:r,extensions:{[Zs]:{bufferView:l,attributes:c}}}]}}function E6(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Bw(t){for(const e of t.json.meshes||[])for(const n of e.primitives)yield n}const T6=Object.freeze(Object.defineProperty({__proto__:null,decode:p6,encode:A6,name:g6,preprocess:m6},Symbol.toStringTag,{value:"Module"})),v6={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},C6={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Q0="KHR_texture_transform",B6=Q0,Fl=new w,b6=new xe,S6=new xe;async function w6(t,e){if(!new Rt(t).getExtension(Q0))return;const s=t.json.materials||[];for(let i=0;i<s.length;i++)I6(i,t)}function I6(t,e){var n,r,s;const i=[],o=(n=e.json.materials)===null||n===void 0?void 0:n[t],a=o==null||(r=o.pbrMetallicRoughness)===null||r===void 0?void 0:r.baseColorTexture;a&&na(e,t,a,i);const c=o==null?void 0:o.emissiveTexture;c&&na(e,t,c,i);const l=o==null?void 0:o.normalTexture;l&&na(e,t,l,i);const u=o==null?void 0:o.occlusionTexture;u&&na(e,t,u,i);const h=o==null||(s=o.pbrMetallicRoughness)===null||s===void 0?void 0:s.metallicRoughnessTexture;h&&na(e,t,h,i)}function na(t,e,n,r){const s=M6(n,r);if(!s)return;const i=t.json.meshes||[];for(const o of i)for(const a of o.primitives){const c=a.material;Number.isFinite(c)&&e===c&&R6(t,a,s)}}function M6(t,e){var n;const r=(n=t.extensions)===null||n===void 0?void 0:n[Q0],{texCoord:s=0}=t,{texCoord:i=s}=r;if(!(e.findIndex(a=>{let[c,l]=a;return c===s&&l===i})!==-1)){const a=L6(r);return s!==i&&(t.texCoord=i),e.push([s,i]),{originalTexCoord:s,texCoord:i,matrix:a}}return null}function R6(t,e,n){const{originalTexCoord:r,texCoord:s,matrix:i}=n,o=e.attributes["TEXCOORD_".concat(r)];if(Number.isFinite(o)){var a;const l=(a=t.json.accessors)===null||a===void 0?void 0:a[o];if(l&&l.bufferView){var c;const u=(c=t.json.bufferViews)===null||c===void 0?void 0:c[l.bufferView];if(u){const{arrayBuffer:h,byteOffset:f}=t.buffers[u.buffer],d=(f||0)+(l.byteOffset||0)+(u.byteOffset||0),{ArrayType:m,length:_}=W0(l,u),T=C6[l.componentType],p=v6[l.type],A=u.byteStride||T*p,y=new Float32Array(_);for(let C=0;C<l.count;C++){const b=new m(h,d+C*A,2);Fl.set(b[0],b[1],1),Fl.transformByMatrix3(i),y.set([Fl[0],Fl[1]],C*p)}r===s?x6(l,u,t.buffers,y):O6(s,l,e,t,y)}}}}function x6(t,e,n,r){t.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),e.buffer=n.length-1,e.byteLength=r.buffer.byteLength,e.byteOffset=0,delete e.byteStride}function O6(t,e,n,r,s){r.buffers.push({arrayBuffer:s.buffer,byteOffset:0,byteLength:s.buffer.byteLength});const i=r.json.bufferViews;if(!i)return;i.push({buffer:r.buffers.length-1,byteLength:s.buffer.byteLength,byteOffset:0});const o=r.json.accessors;o&&(o.push({bufferView:(i==null?void 0:i.length)-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),n.attributes["TEXCOORD_".concat(t)]=o.length-1)}function L6(t){const{offset:e=[0,0],rotation:n=0,scale:r=[1,1]}=t,s=new xe().set(1,0,0,0,1,0,e[0],e[1],1),i=b6.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),o=S6.set(r[0],0,0,0,r[1],0,0,0,1);return s.multiplyRight(i).multiplyRight(o)}const P6=Object.freeze(Object.defineProperty({__proto__:null,decode:w6,name:B6},Symbol.toStringTag,{value:"Module"})),Us="KHR_lights_punctual",F6=Us;async function D6(t){const e=new Rt(t),{json:n}=e,r=e.getExtension(Us);r&&(e.json.lights=r.lights,e.removeExtension(Us));for(const s of n.nodes||[]){const i=e.getObjectExtension(s,Us);i&&(s.light=i.light),e.removeObjectExtension(s,Us)}}async function N6(t){const e=new Rt(t),{json:n}=e;if(n.lights){const r=e.addExtension(Us);Vt(!r.lights),r.lights=n.lights,delete n.lights}if(e.json.lights){for(const r of e.json.lights){const s=r.node;e.addObjectExtension(s,Us,r)}delete e.json.lights}}const U6=Object.freeze(Object.defineProperty({__proto__:null,decode:D6,encode:N6,name:F6},Symbol.toStringTag,{value:"Module"})),pc="KHR_materials_unlit",G6=pc;async function k6(t){const e=new Rt(t),{json:n}=e;for(const r of n.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,pc);e.removeExtension(pc)}function H6(t){const e=new Rt(t),{json:n}=e;if(e.materials)for(const r of n.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,pc,{}),e.addExtension(pc))}const V6=Object.freeze(Object.defineProperty({__proto__:null,decode:k6,encode:H6,name:G6},Symbol.toStringTag,{value:"Module"})),Ea="KHR_techniques_webgl",j6=Ea;async function z6(t){const e=new Rt(t),{json:n}=e,r=e.getExtension(Ea);if(r){const s=X6(r,e);for(const i of n.materials||[]){const o=e.getObjectExtension(i,Ea);o&&(i.technique=Object.assign({},o,s[o.technique]),i.technique.values=$6(i.technique,e)),e.removeObjectExtension(i,Ea)}e.removeExtension(Ea)}}async function J6(t,e){}function X6(t,e){const{programs:n=[],shaders:r=[],techniques:s=[]}=t,i=new TextDecoder;return r.forEach(o=>{if(Number.isFinite(o.bufferView))o.code=i.decode(e.getTypedArrayForBufferView(o.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(o=>{o.fragmentShader=r[o.fragmentShader],o.vertexShader=r[o.vertexShader]}),s.forEach(o=>{o.program=n[o.program]}),s}function $6(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(r=>{t.uniforms[r].value&&!(r in n)&&(n[r]=t.uniforms[r].value)}),Object.keys(n).forEach(r=>{typeof n[r]=="object"&&n[r].index!==void 0&&(n[r].texture=e.getTexture(n[r].index))}),n}const W6=Object.freeze(Object.defineProperty({__proto__:null,decode:z6,encode:J6,name:j6},Symbol.toStringTag,{value:"Module"})),bw="EXT_feature_metadata",K6=bw;async function Y6(t){const e=new Rt(t);Q6(e)}function Q6(t){var e;const n=t.getExtension(bw),r=n==null||(e=n.schema)===null||e===void 0?void 0:e.classes,s=n==null?void 0:n.featureTables;if((n==null?void 0:n.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),r&&s)for(const o in r){const a=r[o],c=eV(s,o);c&&q6(t,c,a)}}function q6(t,e,n){for(const s in n.properties){var r;const i=n.properties[s],o=e==null||(r=e.properties)===null||r===void 0?void 0:r[s],a=e.count;if(o){const c=Z6(t,i,a,o);o.data=c}}}function Z6(t,e,n,r){const s=r.bufferView;let i=t.getTypedArrayForBufferView(s);switch(e.type){case"STRING":{const o=r.stringOffsetBufferView,a=t.getTypedArrayForBufferView(o);i=tV(i,a,n);break}}return i}function eV(t,e){for(const n in t){const r=t[n];if(r.class===e)return r}return null}function tV(t,e,n){const r=[],s=new TextDecoder("utf8");let i=0;const o=4;for(let a=0;a<n;a++){const c=e[(a+1)*o]-e[a*o],l=t.subarray(i,c+i),u=s.decode(l);r.push(u),i+=c}return r}const nV=Object.freeze(Object.defineProperty({__proto__:null,decode:Y6,name:K6},Symbol.toStringTag,{value:"Module"})),Sw=[G8,V8,J8,T6,U6,V6,W6,P6,nV];function rV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=Sw.filter(i=>ww(i.name,e));for(const i of r){var s;(s=i.preprocess)===null||s===void 0||s.call(i,t,e,n)}}async function sV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=Sw.filter(i=>ww(i.name,e));for(const i of r){var s;await((s=i.decode)===null||s===void 0?void 0:s.call(i,t,e,n))}}function ww(t,e){var n;const r=(e==null||(n=e.gltf)===null||n===void 0?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}const Sd="KHR_binary_glTF";function iV(t){const e=new Rt(t),{json:n}=e;for(const r of n.images||[]){const s=e.getObjectExtension(r,Sd);s&&Object.assign(r,s),e.removeObjectExtension(r,Sd)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(Sd)}const HE={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},oV={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};let aV=class{constructor(){g(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),g(this,"json",void 0)}normalize(e,n){this.json=e.json;const r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(r.asset.version));return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),iV(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const n in HE)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){const r=e[n];if(!(!r||Array.isArray(r))){e[n]=[];for(const s in r){const i=r[s];i.id=i.id||s;const o=e[n].length;e[n].push(i),this.idToIndexMap[n][s]=o}}}_convertObjectIdsToArrayIndices(e){for(const n in HE)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const n of e.textures)this._convertTextureIds(n);for(const n of e.meshes)this._convertMeshIds(n);for(const n of e.nodes)this._convertNodeIds(n);for(const n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const n of e.primitives){const{attributes:r,indices:s,material:i}=n;for(const o in r)r[o]=this._convertIdToIndex(r[o],"accessor");s&&(n.indices=this._convertIdToIndex(s,"accessor")),i&&(n.material=this._convertIdToIndex(i,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,"node"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(e,n){e[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),e[n]=[]);for(const r of e[n])for(const s in r){const i=r[s],o=this._convertIdToIndex(i,s);r[s]=o}}_convertIdToIndex(e,n){const r=oV[n];if(r in this.idToIndexMap){const s=this.idToIndexMap[r][e];if(!Number.isFinite(s))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(e));return s}return e}_updateObjects(e){for(const n of this.json.buffers)delete n.type}_updateMaterial(e){for(const i of e.materials){var n,r,s;i.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const o=((n=i.values)===null||n===void 0?void 0:n.tex)||((r=i.values)===null||r===void 0?void 0:r.texture2d_0)||((s=i.values)===null||s===void 0?void 0:s.diffuseTex),a=e.textures.findIndex(c=>c.id===o);a!==-1&&(i.pbrMetallicRoughness.baseColorTexture={index:a})}}};function cV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new aV().normalize(t,e)}const lV={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},uV={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},tn={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},hV={magFilter:tn.TEXTURE_MAG_FILTER,minFilter:tn.TEXTURE_MIN_FILTER,wrapS:tn.TEXTURE_WRAP_S,wrapT:tn.TEXTURE_WRAP_T},fV={[tn.TEXTURE_MAG_FILTER]:tn.LINEAR,[tn.TEXTURE_MIN_FILTER]:tn.NEAREST_MIPMAP_LINEAR,[tn.TEXTURE_WRAP_S]:tn.REPEAT,[tn.TEXTURE_WRAP_T]:tn.REPEAT};function dV(t){return uV[t]}function gV(t){return lV[t]}let mV=class{constructor(){g(this,"baseUri",""),g(this,"json",{}),g(this,"buffers",[]),g(this,"images",[])}postProcess(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{json:r,buffers:s=[],images:i=[],baseUri:o=""}=e;return Vt(r),this.baseUri=o,this.json=r,this.buffers=s,this.images=i,this._resolveTree(this.json,n),this.json}_resolveTree(e){e.bufferViews&&(e.bufferViews=e.bufferViews.map((n,r)=>this._resolveBufferView(n,r))),e.images&&(e.images=e.images.map((n,r)=>this._resolveImage(n,r))),e.samplers&&(e.samplers=e.samplers.map((n,r)=>this._resolveSampler(n,r))),e.textures&&(e.textures=e.textures.map((n,r)=>this._resolveTexture(n,r))),e.accessors&&(e.accessors=e.accessors.map((n,r)=>this._resolveAccessor(n,r))),e.materials&&(e.materials=e.materials.map((n,r)=>this._resolveMaterial(n,r))),e.meshes&&(e.meshes=e.meshes.map((n,r)=>this._resolveMesh(n,r))),e.nodes&&(e.nodes=e.nodes.map((n,r)=>this._resolveNode(n,r))),e.skins&&(e.skins=e.skins.map((n,r)=>this._resolveSkin(n,r))),e.scenes&&(e.scenes=e.scenes.map((n,r)=>this._resolveScene(n,r))),e.scene!==void 0&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(n,"]")),r}_resolveScene(e,n){return e.id=e.id||"scene-".concat(n),e.nodes=(e.nodes||[]).map(r=>this.getNode(r)),e}_resolveNode(e,n){return e.id=e.id||"node-".concat(n),e.children&&(e.children=e.children.map(r=>this.getNode(r))),e.mesh!==void 0?e.mesh=this.getMesh(e.mesh):e.meshes!==void 0&&e.meshes.length&&(e.mesh=e.meshes.reduce((r,s)=>{const i=this.getMesh(s);return r.id=i.id,r.primitives=r.primitives.concat(i.primitives),r},{primitives:[]})),e.camera!==void 0&&(e.camera=this.getCamera(e.camera)),e.skin!==void 0&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,n){return e.id=e.id||"skin-".concat(n),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,n){return e.id=e.id||"mesh-".concat(n),e.primitives&&(e.primitives=e.primitives.map(r=>{r={...r};const s=r.attributes;r.attributes={};for(const i in s)r.attributes[i]=this.getAccessor(s[i]);return r.indices!==void 0&&(r.indices=this.getAccessor(r.indices)),r.material!==void 0&&(r.material=this.getMaterial(r.material)),r})),e}_resolveMaterial(e,n){if(e.id=e.id||"material-".concat(n),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture={...r.baseColorTexture},r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture={...r.metallicRoughnessTexture},r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,n){if(e.id=e.id||"accessor-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=dV(e.componentType),e.components=gV(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const r=e.bufferView.buffer,{ArrayType:s,byteLength:i}=W0(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+r.byteOffset;let a=r.arrayBuffer.slice(o,o+i);e.bufferView.byteStride&&(a=this._getValueFromInterleavedBuffer(r,o,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new s(a)}return e}_getValueFromInterleavedBuffer(e,n,r,s,i){const o=new Uint8Array(i*s);for(let a=0;a<i;a++){const c=n+a*r;o.set(new Uint8Array(e.arrayBuffer.slice(c,c+s)),a*s)}return o.buffer}_resolveTexture(e,n){return e.id=e.id||"texture-".concat(n),e.sampler="sampler"in e?this.getSampler(e.sampler):fV,e.source=this.getImage(e.source),e}_resolveSampler(e,n){e.id=e.id||"sampler-".concat(n),e.parameters={};for(const r in e){const s=this._enumSamplerParameter(r);s!==void 0&&(e.parameters[s]=e[r])}return e}_enumSamplerParameter(e){return hV[e]}_resolveImage(e,n){e.id=e.id||"image-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView));const r=this.images[n];return r&&(e.image=r),e}_resolveBufferView(e,n){const r=e.buffer,s={id:"bufferView-".concat(n),...e,buffer:this.buffers[r]},i=this.buffers[r].arrayBuffer;let o=this.buffers[r].byteOffset||0;return"byteOffset"in e&&(o+=e.byteOffset),s.data=new Uint8Array(i,o,e.byteLength),s}_resolveCamera(e,n){return e.id=e.id||"camera-".concat(n),e.perspective,e.orthographic,e}};function pV(t,e){return new mV().postProcess(t,e)}const VE=1735152710,q0=12,ph=8,AV=1313821514,_V=5130562,yV=0,EV=1,TV=0,yo=!0;function vV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}function CV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=new DataView(t),{magic:s=VE}=n,i=r.getUint32(e,!1);return i===s||i===VE}function BV(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=new DataView(e),s=vV(r,n+0),i=r.getUint32(n+4,yo),o=r.getUint32(n+8,yo);switch(Object.assign(t,{header:{byteOffset:n,byteLength:o,hasBinChunk:!1},type:s,version:i,json:{},binChunks:[]}),n+=q0,t.version){case 1:return bV(t,r,n);case 2:return SV(t,r,n,{});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}function bV(t,e,n){me(t.header.byteLength>q0+ph);const r=e.getUint32(n+0,yo),s=e.getUint32(n+4,yo);return n+=ph,me(s===TV),Fm(t,e,n,r),n+=r,n+=Dm(t,e,n,t.header.byteLength),n}function SV(t,e,n,r){return me(t.header.byteLength>q0+ph),wV(t,e,n,r),n+t.header.byteLength}function wV(t,e,n,r){for(;n+8<=t.header.byteLength;){const s=e.getUint32(n+0,yo),i=e.getUint32(n+4,yo);switch(n+=ph,i){case AV:Fm(t,e,n,s);break;case _V:Dm(t,e,n,s);break;case yV:r.strict||Fm(t,e,n,s);break;case EV:r.strict||Dm(t,e,n,s);break}n+=bc(s,4)}return n}function Fm(t,e,n,r){const s=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(s);return t.json=JSON.parse(o),bc(r,4)}function Dm(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),bc(r,4)}async function IV(t,e){var n,r,s,i;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0;MV(t,e,o,a),cV(t,{normalize:a==null||(n=a.gltf)===null||n===void 0?void 0:n.normalize}),rV(t,a,c);const l=[];if(a!=null&&(r=a.gltf)!==null&&r!==void 0&&r.loadBuffers&&t.json.buffers&&await RV(t,a,c),a!=null&&(s=a.gltf)!==null&&s!==void 0&&s.loadImages){const h=xV(t,a,c);l.push(h)}const u=sV(t,a,c);return l.push(u),await Promise.all(l),a!=null&&(i=a.gltf)!==null&&i!==void 0&&i.postProcess?pV(t,a):t}function MV(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!CV(e,n,r)&&(e=new TextDecoder().decode(e)),typeof e=="string")t.json=Vx(e);else if(e instanceof ArrayBuffer){const o={};n=BV(o,e,n,r.glb),Vt(o.type==="glTF","Invalid GLB magic string ".concat(o.type)),t._glb=o,t.json=o.json}else Vt(!1,"GLTF: must be ArrayBuffer or string");const s=t.json.buffers||[];if(t.buffers=new Array(s.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:o}=t._glb;t.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}const i=t.json.images||[];t.images=new Array(i.length).fill({})}async function RV(t,e,n){const r=t.json.buffers||[];for(let o=0;o<r.length;++o){const a=r[o];if(a.uri){var s,i;const{fetch:c}=n;Vt(c);const l=Aw(a.uri,e),u=await(n==null||(s=n.fetch)===null||s===void 0?void 0:s.call(n,l)),h=await(u==null||(i=u.arrayBuffer)===null||i===void 0?void 0:i.call(u));t.buffers[o]={arrayBuffer:h,byteOffset:0,byteLength:h.byteLength},delete a.uri}else t.buffers[o]===null&&(t.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}async function xV(t,e,n){const r=OV(t),s=t.json.images||[],i=[];for(const o of r)i.push(LV(t,s[o],o,e,n));return await Promise.all(i)}function OV(t){const e=new Set,n=t.json.textures||[];for(const r of n)r.source!==void 0&&e.add(r.source);return Array.from(e).sort()}async function LV(t,e,n,r,s){const{fetch:i,parse:o}=s;let a;if(e.uri&&!e.hasOwnProperty("bufferView")){const l=Aw(e.uri,r);a=await(await i(l)).arrayBuffer(),e.bufferView={data:a}}if(Number.isFinite(e.bufferView)){const l=_8(t.json,t.buffers,e.bufferView);a=e0(l.buffer,l.byteOffset,l.byteLength)}Vt(a,"glTF image has no data");let c=await o(a,[Tb,A8],{mimeType:e.mimeType,basis:r.basis||{format:pw()}},s);c&&c[0]&&(c={compressed:!0,mipmaps:!1,width:c[0].width,height:c[0].height,data:c[0]}),t.images=t.images||[],t.images[n]=c}const Ac={name:"glTF",id:"gltf",module:"gltf",version:e8,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:PV,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function PV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;e={...Ac.options,...e},e.gltf={...Ac.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await IV({},t,r,e,n)}async function FV(t){const e=[];return t.scenes.forEach(n=>{n.traverse(r=>{Object.values(r.model.getUniforms()).forEach(s=>{s.loaded===!1&&e.push(s)})})}),await DV(()=>e.some(n=>!n.loaded))}async function DV(t){for(;t();)await new Promise(e=>requestAnimationFrame(e))}const NV=`#version 300 es
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    geometry.normal = project_normal(normal);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,UV=`#version 300 es
uniform float opacity;
in vec4 vColor;

out vec4 fragmentColor;
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,Iw=[255,255,255,255],GV={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?typeof t.scene=="object"?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Iw},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Ac]};class Z0 extends Mo{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){const e=[F0,D0];return this.props._lighting==="pbr"&&e.push(M0),super.getShaders({vs:NV,fs:UV,modules:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:Iw,transition:!0},instanceModelMatrix:iw})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.scenegraph!==r.scenegraph?this._updateScenegraph():n._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,n._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){const e=this.props,{gl:n}=this.context;let r=null;if(e.scenegraph instanceof to)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const a=e.scenegraph,c=Z4(n,a,this._getModelOptions());r={gltf:a,...c},FV(c).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(se.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);const s={layer:this,gl:n},i=e.getScene(r,s),o=e.getAnimator(r,s);i instanceof to?(this._deleteScenegraph(),this._applyAllAttributes(i),this._applyAnimationsProp(i,o,e._animations),this.setState({scenegraph:i,animator:o})):i!==null&&se.warn("invalid scenegraph:",i)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const n=this.getAttributeManager().getAttributes();e.traverse(r=>{this._setModelAttributes(r.model,n)})}}_applyAnimationsProp(e,n,r){if(!e||!n||!r)return;const s=n.getAnimations();Object.keys(r).sort().forEach(i=>{const o=r[i];if(i==="*")s.forEach(a=>{Object.assign(a,o)});else if(Number.isFinite(Number(i))){const a=Number(i);a>=0&&a<s.length?Object.assign(s[a],o):se.warn("animation ".concat(i," not found"))()}else{const a=s.find(({name:c})=>c===i);a?Object.assign(a,o):se.warn("animation ".concat(i," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof to&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let n=null;return e&&(typeof e=="function"?n=e({gl:this.context.gl,layer:this}):n=e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:n,modelOptions:{isInstanced:!0,transpileToGLSL100:!Y(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(n=>{this._setModelAttributes(n.model,e)})}draw({moduleParameters:e=null,parameters:n={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:i,sizeMinPixels:o,sizeMaxPixels:a,opacity:c,coordinateSystem:l}=this.props,u=this.getNumInstances();this.state.scenegraph.traverse((h,{worldMatrix:f})=>{h.model.setInstanceCount(u),h.updateModuleSettings(e),h.draw({parameters:n,uniforms:{sizeScale:i,opacity:c,sizeMinPixels:o,sizeMaxPixels:a,composeModelMatrix:ow(s,l),sceneModelMatrix:f,u_Camera:h.model.getUniforms().project_uCameraPosition}})})}}g(Z0,"defaultProps",GV);g(Z0,"layerName","ScenegraphLayer");const kV=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,HV=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function VV(t){t.COLOR_0||t.colors||(t.colors={constant:!0,value:new Float32Array([1,1,1])})}const jV={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class eA extends $0{getShaders(){const e=super.getShaders();return e.modules.push(M0),{...e,vs:kV,fs:HV}}initializeState(){const{featureIds:e}=this.props;super.initializeState();const n=this.getAttributeManager();e&&n.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.pbrMaterial!==r.pbrMaterial&&this.updatePbrMaterialUniforms(n.pbrMaterial)}draw(e){const{featureIds:n}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:!!n}),super.draw(e))}getModel(e){const{id:n,pbrMaterial:r}=this.props,s=this.parseMaterial(r,e);this.setState({materialParser:s});const i=this.getShaders();return VV(e.attributes),new mo(this.context.gl,{...this.getShaders(),id:n,geometry:e,defines:{...i.defines,...s==null?void 0:s.defines,HAS_UV_REGIONS:e.attributes.uvRegions},parameters:s==null?void 0:s.parameters,isInstanced:!0})}updatePbrMaterialUniforms(e){const{model:n}=this.state;if(n){const{mesh:r}=this.props,s=this.parseMaterial(e,r);this.setState({materialParser:s}),n.setUniforms(s.uniforms)}}parseMaterial(e,n){var r;const s=!!(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return(r=this.state.materialParser)===null||r===void 0||r.delete(),new dw(this.context.gl,{attributes:{NORMAL:n.attributes.normals,TEXCOORD_0:n.attributes.texCoords},material:{unlit:s,...e},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(e){const n=this.props.featureIds,r=new Uint8ClampedArray(n.length*e.size),s=[];for(let i=0;i<n.length;i++)this.encodePickingColor(n[i],s),r[i*3]=s[0],r[i*3+1]=s[1],r[i*3+2]=s[2];e.value=r}finalizeState(e){var n;super.finalizeState(e),(n=this.state.materialParser)===null||n===void 0||n.delete(),this.setState({materialParser:null})}}g(eA,"layerName","MeshLayer");g(eA,"defaultProps",jV);const zV=6378137,JV=6378137,XV=6356752314245179e-9;function Yh(t){return t}new w;function $V(t,e=[],n=Yh){return"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):"x"in t?(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function WV(t,e=[]){return $V(t,e,je._cartographicRadians?Yh:eN)}function KV(t,e,n=Yh){return"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):"x"in e?(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function YV(t,e){return KV(t,e,je._cartographicRadians?Yh:tN)}const Ei=new w,QV=new w,qV=new w;function ZV(t,e,n=[]){const{oneOverRadii:r,oneOverRadiiSquared:s,centerToleranceSquared:i}=e;Ei.from(t);const o=Ei.x,a=Ei.y,c=Ei.z,l=r.x,u=r.y,h=r.z,f=o*o*l*l,d=a*a*u*u,m=c*c*h*h,_=f+d+m,T=Math.sqrt(1/_);if(!Number.isFinite(T))return;const p=QV;if(p.copy(t).scale(T),_<i)return p.to(n);const A=s.x,y=s.y,C=s.z,b=qV;b.set(p.x*A*2,p.y*y*2,p.z*C*2);let S=(1-T)*Ei.len()/(.5*b.len()),I=0,x,O,M,U;do{S-=I,x=1/(1+S*A),O=1/(1+S*y),M=1/(1+S*C);const J=x*x,W=O*O,H=M*M,Ce=J*x,Yt=W*O,xt=H*M;U=f*J+d*W+m*H-1;const X=-2*(f*Ce*A+d*Yt*y+m*xt*C);I=U/X}while(Math.abs(U)>fc.EPSILON12);return Ei.scale([x,O,M]).to(n)}const jE=1e-14,ej=new w,zE={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},wd={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},ra={east:new w,north:new w,up:new w,west:new w,south:new w,down:new w},tj=new w,nj=new w,rj=new w;function JE(t,e,n,r,s,i){const o=zE[e]&&zE[e][n];bn(o&&(!r||r===o));let a,c,l;const u=ej.copy(s);if(Ln(u.x,0,jE)&&Ln(u.y,0,jE)){const f=Math.sign(u.z);a=tj.fromArray(wd[e]),e!=="east"&&e!=="west"&&a.scale(f),c=nj.fromArray(wd[n]),n!=="east"&&n!=="west"&&c.scale(f),l=rj.fromArray(wd[r]),r!=="east"&&r!=="west"&&l.scale(f)}else{const{up:f,east:d,north:m}=ra;d.set(-u.y,u.x,0).normalize(),t.geodeticSurfaceNormal(u,f),m.copy(f).cross(d);const{down:_,west:T,south:p}=ra;_.copy(f).scale(-1),T.copy(d).scale(-1),p.copy(m).scale(-1),a=ra[e],c=ra[n],l=ra[r]}return i[0]=a.x,i[1]=a.y,i[2]=a.z,i[3]=0,i[4]=c.x,i[5]=c.y,i[6]=c.z,i[7]=0,i[8]=l.x,i[9]=l.y,i[10]=l.z,i[11]=0,i[12]=u.x,i[13]=u.y,i[14]=u.z,i[15]=1,i}const Dl=new w,XE=new w,sj=new w,En=new w,ij=new w,Nl=new w;let be=class{constructor(e=0,n=0,r=0){g(this,"radii",void 0),g(this,"radiiSquared",void 0),g(this,"radiiToTheFourth",void 0),g(this,"oneOverRadii",void 0),g(this,"oneOverRadiiSquared",void 0),g(this,"minimumRadius",void 0),g(this,"maximumRadius",void 0),g(this,"centerToleranceSquared",fc.EPSILON1),g(this,"squaredXOverSquaredZ",void 0),bn(e>=0),bn(n>=0),bn(r>=0),this.radii=new w(e,n,r),this.radiiSquared=new w(e*e,n*n,r*r),this.radiiToTheFourth=new w(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new w(e===0?0:1/e,n===0?0:1/n,r===0?0:1/r),this.oneOverRadiiSquared=new w(e===0?0:1/(e*e),n===0?0:1/(n*n),r===0?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||!!(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,n=[0,0,0]){const r=XE,s=sj,[,,i]=e;this.geodeticSurfaceNormalCartographic(e,r),s.copy(this.radiiSquared).scale(r);const o=Math.sqrt(r.dot(s));return s.scale(1/o),r.scale(i),s.add(r),s.to(n)}cartesianToCartographic(e,n=[0,0,0]){Nl.from(e);const r=this.scaleToGeodeticSurface(Nl,En);if(!r)return;const s=this.geodeticSurfaceNormal(r,XE),i=ij;i.copy(Nl).subtract(r);const o=Math.atan2(s.y,s.x),a=Math.asin(s.z),c=Math.sign(b0(i,Nl))*aS(i);return YV([o,a,c],n)}eastNorthUpToFixedFrame(e,n=new q){return JE(this,"east","north","up",e,n)}localFrameToFixedFrame(e,n,r,s,i=new q){return JE(this,e,n,r,s,i)}geocentricSurfaceNormal(e,n=[0,0,0]){return Dl.from(e).normalize().to(n)}geodeticSurfaceNormalCartographic(e,n=[0,0,0]){const r=WV(e),s=r[0],i=r[1],o=Math.cos(i);return Dl.set(o*Math.cos(s),o*Math.sin(s),Math.sin(i)).normalize(),Dl.to(n)}geodeticSurfaceNormal(e,n=[0,0,0]){return Dl.from(e).scale(this.oneOverRadiiSquared).normalize().to(n)}scaleToGeodeticSurface(e,n){return ZV(e,this,n)}scaleToGeocentricSurface(e,n=[0,0,0]){En.from(e);const r=En.x,s=En.y,i=En.z,o=this.oneOverRadiiSquared,a=1/Math.sqrt(r*r*o.x+s*s*o.y+i*i*o.z);return En.multiplyScalar(a).to(n)}transformPositionToScaledSpace(e,n=[0,0,0]){return En.from(e).scale(this.oneOverRadii).to(n)}transformPositionFromScaledSpace(e,n=[0,0,0]){return En.from(e).scale(this.radii).to(n)}getSurfaceNormalIntersectionWithZAxis(e,n=0,r=[0,0,0]){bn(Ln(this.radii.x,this.radii.y,fc.EPSILON15)),bn(this.radii.z>0),En.from(e);const s=En.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(s)>=this.radii.z-n))return En.set(0,0,s).to(r)}};g(be,"WGS84",new be(zV,JV,XV));function $E(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class WE{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=$E(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime($E()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class oj{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let s=this.stats[n];return s||(e instanceof WE?s=e:s=new WE(n,r),this.stats[n]=s),s}}class aj{constructor(e,n,r){g(this,"item",void 0),g(this,"previous",void 0),g(this,"next",void 0),this.item=e,this.previous=n,this.next=r}}class cj{constructor(){g(this,"head",null),g(this,"tail",null),g(this,"_length",0)}get length(){return this._length}add(e){const n=new aj(e,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}remove(e){e&&(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,n){e!==n&&(this.remove(n),this._insert(e,n))}_insert(e,n){const r=e.next;e.next=n,this.tail===e?this.tail=n:r.previous=n,n.next=r,n.previous=e,++this._length}}class lj{constructor(){g(this,"_list",void 0),g(this,"_sentinel",void 0),g(this,"_trimTiles",void 0),this._list=new cj,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){const n=e._cacheNode;n&&this._list.splice(this._sentinel,n)}add(e,n,r){n._cacheNode||(n._cacheNode=this._list.add(n),r&&r(e,n))}unloadTile(e,n,r){const s=n._cacheNode;s&&(this._list.remove(s),n._cacheNode=null,r&&r(e,n))}unloadTiles(e,n){const r=this._trimTiles;this._trimTiles=!1;const s=this._list,i=e.maximumMemoryUsage*1024*1024,o=this._sentinel;let a=s.head;for(;a!==o&&(e.gpuMemoryUsageInBytes>i||r);){const c=a.item;a=a.next,this.unloadTile(e,c,n)}}trim(){this._trimTiles=!0}}function uj(t,e){me(t),me(e);const{rtcCenter:n,gltfUpAxis:r}=e,{computedTransform:s,boundingVolume:{center:i}}=t;let o=new q(s);switch(n&&o.translate(n),r){case"Z":break;case"Y":const h=new q().rotateX(Math.PI/2);o=o.multiplyRight(h);break;case"X":const f=new q().rotateY(-Math.PI/2);o=o.multiplyRight(f);break}e.isQuantized&&o.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const a=new w(i);e.cartesianModelMatrix=o,e.cartesianOrigin=a;const c=be.WGS84.cartesianToCartographic(a,new w),u=be.WGS84.eastNorthUpToFixedFrame(a).invert();e.cartographicModelMatrix=u.multiplyRight(o),e.cartographicOrigin=c,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}const KE=new w,Id=new w,Nm=new zs([new _r,new _r,new _r,new _r,new _r,new _r]);function hj(t,e){const{cameraDirection:n,cameraUp:r,height:s}=t,{metersPerUnit:i}=t.distanceScales,o=Su(t,t.center),a=be.WGS84.eastNorthUpToFixedFrame(o),c=t.unprojectPosition(t.cameraPosition),l=be.WGS84.cartographicToCartesian(c,new w),u=new w(a.transformAsVector(new w(n).scale(i))).normalize(),h=new w(a.transformAsVector(new w(r).scale(i))).normalize();dj(t);const f=t.constructor,{longitude:d,latitude:m,width:_,bearing:T,zoom:p}=t,A=new f({longitude:d,latitude:m,height:s,width:_,bearing:T,zoom:p,pitch:0});return{camera:{position:l,direction:u,up:h},viewport:t,topDownViewport:A,height:s,cullingVolume:Nm,frameNumber:e,sseDenominator:1.15}}function fj(t,e,n){if(n===0||t.length<=n)return[t,[]];const r=[],{longitude:s,latitude:i}=e.viewport;for(const[l,u]of t.entries()){const[h,f]=u.header.mbs,d=Math.abs(s-h),m=Math.abs(i-f),_=Math.sqrt(m*m+d*d);r.push([l,_])}const o=r.sort((l,u)=>l[1]-u[1]),a=[];for(let l=0;l<n;l++)a.push(t[o[l][0]]);const c=[];for(let l=n;l<o.length;l++)c.push(t[o[l][0]]);return[a,c]}function dj(t){const e=t.getFrustumPlanes(),n=YE(e.near,t.cameraPosition),r=Su(t,n),s=Su(t,t.cameraPosition,Id);let i=0;Nm.planes[i++].fromPointNormal(r,KE.copy(r).subtract(s));for(const o in e){if(o==="near")continue;const a=e[o],c=YE(a,n,Id),l=Su(t,c,Id);Nm.planes[i++].fromPointNormal(l,KE.copy(r).subtract(l))}}function YE(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new w;const r=t.normal.dot(e);return n.copy(t.normal).scale(t.distance-r).add(e),n}function Su(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new w;const r=t.unprojectPosition(e);return be.WGS84.cartographicToCartesian(r,n)}const gj=6378137,mj=6378137,Um=6356752314245179e-9,QE=new w;function pj(t,e){if(t instanceof J0){const{halfAxes:n}=t,r=_j(n);return Math.log2(Um/(r+e[2]))}else if(t instanceof z0){const{radius:n}=t;return Math.log2(Um/(n+e[2]))}else if(t.width&&t.height){const{width:n,height:r}=t,s=Math.log2(gj/n),i=Math.log2(mj/r);return(s+i)/2}return 1}function Mw(t,e,n){const r=be.WGS84.cartographicToCartesian([t.xmax,t.ymax,t.zmax],new w),s=Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)+Math.pow(r[2]-n[2],2));return Math.log2(Um/(s+e[2]))}function Aj(t,e,n){const[r,s,i,o]=t;return Mw({xmin:r,xmax:i,ymin:s,ymax:o,zmin:0,zmax:0},e,n)}function _j(t){t.getColumn(0,QE);const e=t.getColumn(1),n=t.getColumn(2);return QE.add(e).add(n).len()}const Ft={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},Mr={ADD:1,REPLACE:2},no={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},en={I3S:"I3S",TILES3D:"TILES3D"},Qh={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},yj={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function Rw(t){return t!=null}const it=new w,wu=new w,Ej=new w,Tj=new w;function Md(t,e,n){if(me(t,"3D Tile: boundingVolume must be defined"),t.box)return Cj(t.box,e,n);if(t.region){const[r,s,i,o,a,c]=t.region,l=be.WGS84.cartographicToCartesian([Cr(r),Cr(o),a],Ej),u=be.WGS84.cartographicToCartesian([Cr(i),Cr(s),c],Tj),h=new w().addVectors(l,u).multiplyScalar(.5),f=new w().subVectors(l,u).len()/2;return qE([h[0],h[1],h[2],f],new q)}if(t.sphere)return qE(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function vj(t,e){if(t.box)return Bj(e);if(t.region){const[n,r,s,i,o,a]=t.region;return[[Cr(n),Cr(r),o],[Cr(s),Cr(i),a]]}if(t.sphere)return bj(e);throw new Error("Unkown boundingVolume type")}function Cj(t,e,n){const r=new w(t[0],t[1],t[2]);e.transform(r,r);let s=[];if(t.length===10){const l=t.slice(3,6),u=new hc;u.fromArray(t,6);const h=new w([1,0,0]),f=new w([0,1,0]),d=new w([0,0,1]);h.transformByQuaternion(u),h.scale(l[0]),f.transformByQuaternion(u),f.scale(l[1]),d.transformByQuaternion(u),d.scale(l[2]),s=[...h.toArray(),...f.toArray(),...d.toArray()]}else s=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];const i=e.transformAsVector(s.slice(0,3)),o=e.transformAsVector(s.slice(3,6)),a=e.transformAsVector(s.slice(6,9)),c=new xe([i[0],i[1],i[2],o[0],o[1],o[2],a[0],a[1],a[2]]);return Rw(n)?(n.center=r,n.halfAxes=c,n):new J0(r,c)}function qE(t,e,n){const r=new w(t[0],t[1],t[2]);e.transform(r,r);const s=e.getScale(wu),i=Math.max(Math.max(s[0],s[1]),s[2]),o=t[3]*i;return Rw(n)?(n.center=r,n.radius=o,n):new z0(r,o)}function Bj(t){const e=xw(),{halfAxes:n}=t,r=new w(n.getColumn(0)),s=new w(n.getColumn(1)),i=new w(n.getColumn(2));for(let o=0;o<2;o++){for(let a=0;a<2;a++){for(let c=0;c<2;c++)it.copy(t.center),it.add(r),it.add(s),it.add(i),Ow(e,it),i.negate();s.negate()}r.negate()}return e}function bj(t){const e=xw(),{center:n,radius:r}=t,s=be.WGS84.scaleToGeodeticSurface(n,it);let i;s?i=be.WGS84.geodeticSurfaceNormal(s):i=new w(0,0,1);let o=new w(i[2],-i[1],0);o.len()>0?o.normalize():o=new w(0,1,0);const a=o.clone().cross(i);for(const c of[o,a,i]){wu.copy(c).scale(r);for(let l=0;l<2;l++)it.copy(n),it.add(wu),Ow(e,it),wu.negate()}return e}function xw(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function Ow(t,e){be.WGS84.cartesianToCartographic(e,it),t[0][0]=Math.min(t[0][0],it[0]),t[0][1]=Math.min(t[0][1],it[1]),t[0][2]=Math.min(t[0][2],it[2]),t[1][0]=Math.max(t[1][0],it[0]),t[1][1]=Math.max(t[1][1],it[1]),t[1][2]=Math.max(t[1][2],it[2])}new w;new w;new q;new w;new w;new w;function Sj(t,e){const n=t*e;return 1-Math.exp(-(n*n))}function wj(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){const n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return Sj(e,n)*r}return 0}function Ij(t,e,n){const r=t.tileset,s=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,i=n?s:t.lodMetricValue;if(i===0)return 0;const o=Math.max(t._distanceToCamera,1e-7),{height:a,sseDenominator:c}=e,{viewDistanceScale:l}=r.options;let u=i*a*(l||1)/(o*c);return u-=wj(r,o),u}const Rd=new w,ZE=new w,Wr=new w,eT=new w,Mj=new w,xd=new q,tT=new q;function Rj(t,e){if(t.lodMetricValue===0||isNaN(t.lodMetricValue))return"DIG";const n=2*Lw(t,e);return n<2?"OUT":!t.header.children||n<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}function Lw(t,e){const{topDownViewport:n}=e,r=t.header.mbs[1],s=t.header.mbs[0],i=t.header.mbs[2],o=t.header.mbs[3],a=[...t.boundingVolume.center],c=n.unprojectPosition(n.cameraPosition);be.WGS84.cartographicToCartesian(c,Rd),ZE.copy(Rd).subtract(a).normalize(),be.WGS84.eastNorthUpToFixedFrame(a,xd),tT.copy(xd).invert(),Wr.copy(Rd).transform(tT);const l=Math.sqrt(Wr[0]*Wr[0]+Wr[1]*Wr[1]),u=l*l/Wr[2];eT.copy([Wr[0],Wr[1],u]);const f=eT.transform(xd).subtract(a).normalize(),m=ZE.cross(f).normalize().scale(o).add(a),_=be.WGS84.cartesianToCartographic(m),T=n.project([s,r,i]),p=n.project(_);return Mj.copy(T).subtract(p).magnitude()}function xj(t){return{assetGltfUpAxis:t.asset&&t.asset.gltfUpAxis||"Y"}}class nT{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;g(this,"_map",new Map),g(this,"_array",void 0),g(this,"_length",void 0),this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return me(e<this._array.length),this._array[e]}set(e,n){me(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=n,this._map.set(n,e)}delete(e){const n=this._map.get(e);n>=0&&(this._array.splice(n,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){const n=this.length++;this._array[n]=e,this._map.set(e,n)}}pop(){const e=this._array[--this.length];return this._map.delete(e),e}reserve(e){me(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){me(e>=0),this.length=e}trim(e){e==null&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}}const Oj={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class qh{traversalFinished(e){return!0}constructor(e){g(this,"options",void 0),g(this,"root",null),g(this,"selectedTiles",{}),g(this,"requestedTiles",{}),g(this,"emptyTiles",{}),g(this,"lastUpdate",new Date().getTime()),g(this,"updateDebounceTime",1e3),g(this,"_traversalStack",new nT),g(this,"_emptyTraversalStack",new nT),g(this,"_frameNumber",null),this.options={...Oj,...e}}traverse(e,n,r){this.root=e,this.options={...this.options,...r},this.reset(),this.updateTile(e,n),this._frameNumber=n.frameNumber,this.executeTraversal(e,n)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,n){const r=this._traversalStack;for(e._selectionDepth=1,r.push(e);r.length>0;){const i=r.pop();let o=!1;this.canTraverse(i,n)&&(this.updateChildTiles(i,n),o=this.updateAndPushChildren(i,n,r,i.hasRenderContent?i._selectionDepth+1:i._selectionDepth));const a=i.parent,c=!!(!a||a._shouldRefine),l=!o;i.hasRenderContent?i.refine===Mr.ADD?(this.loadTile(i,n),this.selectTile(i,n)):i.refine===Mr.REPLACE&&(this.loadTile(i,n),l&&this.selectTile(i,n)):(this.emptyTiles[i.id]=i,this.loadTile(i,n),l&&this.selectTile(i,n)),this.touchTile(i,n),i._shouldRefine=o&&c}const s=new Date().getTime();(this.traversalFinished(n)||s-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=s,this.options.onTraversalEnd(n))}updateChildTiles(e,n){const r=e.children;for(const s of r)this.updateTile(s,n)}updateAndPushChildren(e,n,r,s){const{loadSiblings:i,skipLevelOfDetail:o}=this.options,a=e.children;a.sort(this.compareDistanceToCamera.bind(this));const c=e.refine===Mr.REPLACE&&e.hasRenderContent&&!o;let l=!1,u=!0;for(const h of a)if(h._selectionDepth=s,h.isVisibleAndInRequestVolume?(r.find(h)&&r.delete(h),r.push(h),l=!0):(c||i)&&(this.loadTile(h,n),this.touchTile(h,n)),c){let f;if(h._inRequestVolume?h.hasRenderContent?f=h.contentAvailable:f=this.executeEmptyTraversal(h,n):f=!1,u=u&&f,!u)return!1}return l||(u=!1),u}updateTile(e,n){this.updateTileVisibility(e,n)}selectTile(e,n){this.shouldSelectTile(e)&&(e._selectedFrame=n.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,n){this.shouldLoadTile(e)&&(e._requestedFrame=n.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,n){e.tileset._cache.touch(e),e._touchedFrame=n.frameNumber}canTraverse(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.hasChildren?e.hasTilesetContent?!e.contentExpired:!s&&!e.isVisibleAndInRequestVolume?!1:this.shouldRefine(e,n,r):!1}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=e._screenSpaceError;return r&&(s=e.getScreenSpaceError(n,!0)),s>this.options.maximumScreenSpaceError}updateTileVisibility(e,n){const r=[];if(this.options.viewportTraversersMap)for(const s in this.options.viewportTraversersMap)this.options.viewportTraversersMap[s]===n.viewport.id&&r.push(s);else r.push(n.viewport.id);e.updateVisibility(n,r)}compareDistanceToCamera(e,n){return e._distanceToCamera-n._distanceToCamera}anyChildrenVisible(e,n){let r=!1;for(const s of e.children)s.updateVisibility(n),r=r||s.isVisibleAndInRequestVolume;return r}executeEmptyTraversal(e,n){let r=!0;const s=this._emptyTraversalStack;for(s.push(e);s.length>0&&r;){const i=s.pop();if(this.updateTile(i,n),i.isVisibleAndInRequestVolume||this.loadTile(i,n),this.touchTile(i,n),!i.hasRenderContent&&this.canTraverse(i,n,!1,!0)){const a=i.children;for(const c of a)s.find(c)&&s.delete(c),s.push(c)}else!i.contentAvailable&&!i.hasEmptyContent&&(r=!1)}return r}}const rT=new w;function Lj(t){return t!=null}class Gm{constructor(e,n,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";g(this,"tileset",void 0),g(this,"header",void 0),g(this,"id",void 0),g(this,"url",void 0),g(this,"parent",void 0),g(this,"refine",void 0),g(this,"type",void 0),g(this,"contentUrl",void 0),g(this,"lodMetricType","geometricError"),g(this,"lodMetricValue",0),g(this,"boundingVolume",null),g(this,"content",null),g(this,"contentState",Ft.UNLOADED),g(this,"gpuMemoryUsageInBytes",0),g(this,"children",[]),g(this,"depth",0),g(this,"viewportIds",[]),g(this,"transform",new q),g(this,"extensions",null),g(this,"implicitTiling",null),g(this,"userData",{}),g(this,"computedTransform",void 0),g(this,"hasEmptyContent",!1),g(this,"hasTilesetContent",!1),g(this,"traverser",new qh({})),g(this,"_cacheNode",null),g(this,"_frameNumber",null),g(this,"_expireDate",null),g(this,"_expiredContent",null),g(this,"_boundingBox",void 0),g(this,"_distanceToCamera",0),g(this,"_screenSpaceError",0),g(this,"_visibilityPlaneMask",void 0),g(this,"_visible",void 0),g(this,"_contentBoundingVolume",void 0),g(this,"_viewerRequestVolume",void 0),g(this,"_initialTransform",new q),g(this,"_priority",0),g(this,"_selectedFrame",0),g(this,"_requestedFrame",0),g(this,"_selectionDepth",0),g(this,"_touchedFrame",0),g(this,"_centerZDepth",0),g(this,"_shouldRefine",!1),g(this,"_stackLength",0),g(this,"_visitedFrame",0),g(this,"_inRequestVolume",!1),g(this,"_lodJudge",null),this.header=n,this.tileset=e,this.id=s||n.id,this.url=n.url,this.parent=r,this.refine=this._getRefine(n.refine),this.type=n.type,this.contentUrl=n.contentUrl,this._initializeLodMetric(n),this._initializeTransforms(n),this._initializeBoundingVolumes(n),this._initializeContent(n),this._initializeRenderingState(n),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Ft.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Ft.UNLOADED}get contentExpired(){return this.contentState===Ft.EXPIRED}get contentFailed(){return this.contentState===Ft.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=vj(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(e,n){switch(this.tileset.type){case en.I3S:return Lw(this,e);case en.TILES3D:return Ij(this,e,n);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const e=this.tileset._traverser,{skipLevelOfDetail:n}=e.options,r=this.refine===Mr.ADD||n;if(r&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Ft.UNLOADED)return-1;const s=this.parent,o=s&&(!r||this._screenSpaceError===0||s.hasTilesetContent)?s._screenSpaceError:this._screenSpaceError,a=e.root?e.root._screenSpaceError:0;return Math.max(a-o,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Ft.LOADING;const n=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!n)return this.contentState=Ft.UNLOADED,!1;try{const r=this.tileset.getTileUrl(this.contentUrl),s=this.tileset.loader,i={...this.tileset.loadOptions,[s.id]:{...this.tileset.loadOptions[s.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(s.id)}};return this.content=await ar(r,s,i),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Ft.READY,this._onContentLoaded(),!0}catch(r){throw this.contentState=Ft.FAILED,r}finally{n.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Ft.UNLOADED,!0}updateVisibility(e,n){if(this._frameNumber===e.frameNumber)return;const r=this.parent,s=r?r._visibilityPlaneMask:zs.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const i=r?r.computedTransform:this.tileset.modelMatrix;this._updateTransform(i)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,s),this._visible=this._visibilityPlaneMask!==zs.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=n}visibility(e,n){const{cullingVolume:r}=e,{boundingVolume:s}=this;return r.computeVisibilityWithPlaneMask(s,n)}contentVisibility(){return!0}distanceToTile(e){const n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth(e){let{camera:n}=e;const r=this.boundingVolume;return rT.subVectors(r.center,n.position),n.direction.dot(rT)}insideViewerRequestVolume(e){const n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(Lj(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=Ft.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(e){this.transform=e.transform?new q(e.transform):new q;const n=this.parent,r=this.tileset,s=n&&n.computedTransform?n.computedTransform.clone():r.modelMatrix.clone();this.computedTransform=new q(s).multiplyRight(this.transform);const i=n&&n._initialTransform?n._initialTransform.clone():new q;this._initialTransform=new q(i).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Ft.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=zs.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||Mr.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(e){this.boundingVolume=Md(e.boundingVolume,this.computedTransform,this.boundingVolume);const n=e.content;n&&(n.boundingVolume&&(this._contentBoundingVolume=Md(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=Md(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:new q).clone().multiplyRight(this.transform);n.equals(this.computedTransform)||(this.computedTransform=n,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){switch(e){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return xj(this.tileset.tileset)}}}class Pj extends qh{compareDistanceToCamera(e,n){return n._distanceToCamera===0&&e._distanceToCamera===0?n._centerZDepth-e._centerZDepth:n._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,n){if(super.updateTileVisibility(e,n),!e.isVisibleAndInRequestVolume)return;const r=e.children.length>0;if(e.hasTilesetContent&&r){const o=e.children[0];this.updateTileVisibility(o,n),e._visible=o._visible;return}if(this.meetsScreenSpaceErrorEarly(e,n)){e._visible=!1;return}const s=e.refine===Mr.REPLACE,i=e._optimChildrenWithinParent===yj.USE_OPTIMIZATION;if(s&&i&&r&&!this.anyChildrenVisible(e,n)){e._visible=!1;return}}meetsScreenSpaceErrorEarly(e,n){const{parent:r}=e;return!r||r.hasTilesetContent||r.refine!==Mr.ADD?!1:!this.shouldRefine(e,n,!0)}}class Fj{constructor(){g(this,"frameNumberMap",new Map)}register(e,n){const r=this.frameNumberMap.get(e)||new Map,s=r.get(n)||0;r.set(n,s+1),this.frameNumberMap.set(e,r)}deregister(e,n){const r=this.frameNumberMap.get(e);if(!r)return;const s=r.get(n)||1;r.set(n,s-1)}isZero(e,n){var r;return(((r=this.frameNumberMap.get(e))===null||r===void 0?void 0:r.get(n))||0)===0}}const Od={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class Dj{constructor(){g(this,"_statusMap",void 0),g(this,"pendingTilesRegister",new Fj),this._statusMap={}}add(e,n,r,s){if(!this._statusMap[n]){const{frameNumber:i,viewport:{id:o}}=s;this._statusMap[n]={request:e,callback:r,key:n,frameState:s,status:Od.REQUESTED},this.pendingTilesRegister.register(o,i),e().then(a=>{this._statusMap[n].status=Od.COMPLETED;const{frameNumber:c,viewport:{id:l}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(l,c),this._statusMap[n].callback(a,s)}).catch(a=>{this._statusMap[n].status=Od.ERROR;const{frameNumber:c,viewport:{id:l}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(l,c),r(a)})}}update(e,n){if(this._statusMap[e]){const{frameNumber:r,viewport:{id:s}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(s,r);const{frameNumber:i,viewport:{id:o}}=n;this.pendingTilesRegister.register(o,i),this._statusMap[e].frameState=n}}find(e){return this._statusMap[e]}hasPendingTiles(e,n){return!this.pendingTilesRegister.isZero(e,n)}}class Nj extends qh{constructor(e){super(e),g(this,"_tileManager",void 0),this._tileManager=new Dj}traversalFinished(e){return!this._tileManager.hasPendingTiles(e.viewport.id,this._frameNumber||0)}shouldRefine(e,n){return e._lodJudge=Rj(e,n),e._lodJudge==="DIG"}updateChildTiles(e,n){const r=e.header.children||[],s=e.children,i=e.tileset;for(const o of r){const a="".concat(o.id,"-").concat(n.viewport.id),c=s&&s.find(l=>l.id===a);if(c)c&&this.updateTile(c,n);else{let l=()=>this._loadTile(o.id,i);this._tileManager.find(a)?this._tileManager.update(a,n):(i.tileset.nodePages&&(l=()=>i.tileset.nodePagesTile.formTileFromNodePages(o.id)),this._tileManager.add(l,a,h=>this._onTileLoad(h,e,a),n))}}return!1}async _loadTile(e,n){const{loader:r}=n,s=n.getTileUrl("".concat(n.url,"/nodes/").concat(e)),i={...n.loadOptions,i3s:{...n.loadOptions.i3s,isTileHeader:!0}};return await ar(s,r,i)}_onTileLoad(e,n,r){const s=new Gm(n.tileset,e,n,r);n.children.push(s);const i=this._tileManager.find(s.id).frameState;this.updateTile(s,i),this._frameNumber===i.frameNumber&&(this.traversalFinished(i)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(s,i)}}const Uj={description:"",ellipsoid:be.WGS84,modelMatrix:new q,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},Ul="Tiles In Tileset(s)",Ld="Tiles In Memory",sT="Tiles In View",iT="Tiles To Render",oT="Tiles Loaded",Pd="Tiles Loading",aT="Tiles Unloaded",cT="Failed Tile Loads",lT="Points/Vertices",Fd="Tile Memory Use";class Gj{constructor(e,n){g(this,"options",void 0),g(this,"loadOptions",void 0),g(this,"type",void 0),g(this,"tileset",void 0),g(this,"loader",void 0),g(this,"url",void 0),g(this,"basePath",void 0),g(this,"modelMatrix",void 0),g(this,"ellipsoid",void 0),g(this,"lodMetricType",void 0),g(this,"lodMetricValue",void 0),g(this,"refine",void 0),g(this,"root",null),g(this,"roots",{}),g(this,"asset",{}),g(this,"description",""),g(this,"properties",void 0),g(this,"extras",null),g(this,"attributions",{}),g(this,"credits",{}),g(this,"stats",void 0),g(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),g(this,"cartographicCenter",null),g(this,"cartesianCenter",null),g(this,"zoom",1),g(this,"boundingVolume",null),g(this,"dynamicScreenSpaceErrorComputedDensity",0),g(this,"maximumMemoryUsage",32),g(this,"gpuMemoryUsageInBytes",0),g(this,"_frameNumber",0),g(this,"_queryParams",{}),g(this,"_extensionsUsed",[]),g(this,"_tiles",{}),g(this,"_pendingCount",0),g(this,"selectedTiles",[]),g(this,"traverseCounter",0),g(this,"geometricError",0),g(this,"lastUpdatedVieports",null),g(this,"_requestedTiles",[]),g(this,"_emptyTiles",[]),g(this,"frameStateData",{}),g(this,"_traverser",void 0),g(this,"_cache",new lj),g(this,"_requestScheduler",void 0),g(this,"updatePromise",null),g(this,"tilesetInitializationPromise",void 0),this.options={...Uj,...n},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||t0(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new eO({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new oj({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(e){this.options={...this.options,...e}}setOptions(e){this.options={...this.options,...e}}getTileUrl(e){return e.startsWith("data:")?e:"".concat(e).concat(e.includes("?")?"&":"?").concat(this.queryParams)}hasExtension(e){return this._extensionsUsed.indexOf(e)>-1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.tilesetInitializationPromise.then(()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)})}async selectTiles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise(n=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),n(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(e){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const n=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;const r=[];for(const s of n){const i=s.id;this._needTraverse(i)?r.push(i):this.traverseCounter--}for(const s of n){const i=s.id;if(this.roots[i]||(this.roots[i]=this._initializeTileHeaders(this.tileset,null)),!r.includes(i))continue;const o=hj(s,this._frameNumber);this._traverser.traverse(this.roots[i],o,this.options)}}_needTraverse(e){let n=e;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[e]),n===e}_onTraversalEnd(e){const n=e.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const r=this.frameStateData[n],s=Object.values(this._traverser.selectedTiles),[i,o]=fj(s,e,this.options.maximumTilesSelected);r.selectedTiles=i;for(const a of o)a.unselect();r._requestedTiles=Object.values(this._traverser.requestedTiles),r._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const e in this.frameStateData){const n=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,n){if(e.length!==n.length)return!0;const r=new Set(e.map(o=>o.id)),s=new Set(n.map(o=>o.id));let i=e.filter(o=>!s.has(o.id)).length>0;return i=i||n.filter(o=>!r.has(o.id)).length>0,i}_loadTiles(){for(const e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,(e,n)=>e._unloadTile(n))}_updateStats(){let e=0,n=0;for(const r of this.selectedTiles)r.contentAvailable&&r.content&&(e++,r.content.pointCount?n+=r.content.pointCount:n+=r.content.vertexCount);this.stats.get(sT).count=this.selectedTiles.length,this.stats.get(iT).count=e,this.stats.get(lT).count=n}async _initializeTileSet(e){this.type===en.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===en.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===en.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var e;const n=this.tileset.fullExtent;if(n){const{xmin:s,xmax:i,ymin:o,ymax:a,zmin:c,zmax:l}=n;this.cartographicCenter=new w(s+(i-s)/2,o+(a-o)/2,c+(l-c)/2),this.cartesianCenter=be.WGS84.cartographicToCartesian(this.cartographicCenter,new w),this.zoom=Mw(n,this.cartographicCenter,this.cartesianCenter);return}const r=(e=this.tileset.store)===null||e===void 0?void 0:e.extent;if(r){const[s,i,o,a]=r;this.cartographicCenter=new w(s+(o-s)/2,i+(a-i)/2,0),this.cartesianCenter=be.WGS84.cartographicToCartesian(this.cartographicCenter,new w),this.zoom=Aj(r,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new w,this.zoom=1}calculateViewPropsTiles3D(){const e=this.root,{center:n}=e.boundingVolume;if(!n){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new w,this.zoom=1;return}n[0]!==0||n[1]!==0||n[2]!==0?this.cartographicCenter=be.WGS84.cartesianToCartographic(n,new w):this.cartographicCenter=new w(0,0,-be.WGS84.radii[0]),this.cartesianCenter=n,this.zoom=pj(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(Ul),this.stats.get(Pd),this.stats.get(Ld),this.stats.get(sT),this.stats.get(iT),this.stats.get(oT),this.stats.get(aT),this.stats.get(cT),this.stats.get(lT),this.stats.get(Fd,"memory")}_initializeTileHeaders(e,n){const r=new Gm(this,e.root,n);if(n&&(n.children.push(r),r.depth=n.depth+1),this.type===en.TILES3D){const i=[];for(i.push(r);i.length>0;){const o=i.pop();this.stats.get(Ul).incrementCount();const a=o.header.children||[];for(const c of a){var s;const l=new Gm(this,c,o);if((s=l.contentUrl)!==null&&s!==void 0&&s.includes("?session=")){const h=new URL(l.contentUrl).searchParams.get("session");h&&(this._queryParams.session=h)}o.children.push(l),l.depth=o.depth+1,i.push(l)}}}return r}_initializeTraverser(){let e;switch(this.type){case en.TILES3D:e=Pj;break;case en.I3S:e=Nj;break;default:e=qh}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let n;try{this._onStartTileLoading(),n=await e.loadContent()}catch(r){this._onTileLoadError(e,r instanceof Error?r:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(e,n)}}_onTileLoadError(e,n){this.stats.get(cT).incrementCount();const r=n.message||n.toString(),s=e.url;console.error("A 3D tile failed to load: ".concat(e.url," ").concat(r)),this.options.onTileError(e,r,s)}_onTileLoad(e,n){if(n){if(this.type===en.I3S){var r,s;const i=((r=this.tileset)===null||r===void 0||(s=r.nodePagesTile)===null||s===void 0?void 0:s.nodesInNodePages)||0;this.stats.get(Ul).reset(),this.stats.get(Ul).addCount(i)}e&&e.content&&uj(e,e.content),this.updateContentTypes(e),this._addTileToCache(e),this.options.onTileLoad(e)}}updateContentTypes(e){if(this.type===en.I3S)switch(e.header.isDracoGeometry&&(this.contentFormats.draco=!0),e.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===en.TILES3D){var n;const{extensionsRemoved:r=[]}=((n=e.content)===null||n===void 0?void 0:n.gltf)||{};r.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),r.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),r.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(Pd).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(Pd).decrementCount()}_addTileToCache(e){this._cache.add(this,e,n=>n._updateCacheStats(e))}_updateCacheStats(e){this.stats.get(oT).incrementCount(),this.stats.get(Ld).incrementCount(),this.gpuMemoryUsageInBytes+=e.gpuMemoryUsageInBytes||0,this.stats.get(Fd).count=this.gpuMemoryUsageInBytes}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.gpuMemoryUsageInBytes||0,this.stats.get(Ld).decrementCount(),this.stats.get(aT).incrementCount(),this.stats.get(Fd).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){const e=[];for(this.root&&e.push(this.root);e.length>0;){const n=e.pop();for(const r of n.children)e.push(r);this._destroyTile(n)}this.root=null}_destroySubtree(e){const n=e,r=[];for(r.push(n);r.length>0;){e=r.pop();for(const s of e.children)r.push(s);e!==n&&this._destroyTile(e)}n.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(e.queryString){const n=new URLSearchParams(e.queryString),r=Object.fromEntries(n.entries());this._queryParams={...this._queryParams,...r}}if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed||[],this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const Pw="3.4.14",sa={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function Fw(t,e,n){me(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),s=new Uint8Array(t,e,n);return r.decode(s)}function kj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=new DataView(t);return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}const Hj={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},De={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},te={...Hj,...De},Dd={[De.DOUBLE]:Float64Array,[De.FLOAT]:Float32Array,[De.UNSIGNED_SHORT]:Uint16Array,[De.UNSIGNED_INT]:Uint32Array,[De.UNSIGNED_BYTE]:Uint8Array,[De.BYTE]:Int8Array,[De.SHORT]:Int16Array,[De.INT]:Int32Array},Vj={DOUBLE:De.DOUBLE,FLOAT:De.FLOAT,UNSIGNED_SHORT:De.UNSIGNED_SHORT,UNSIGNED_INT:De.UNSIGNED_INT,UNSIGNED_BYTE:De.UNSIGNED_BYTE,BYTE:De.BYTE,SHORT:De.SHORT,INT:De.INT},Nd="Failed to convert GL type";let ka=class Ta{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const n in Dd)if(Dd[n]===e)return n;throw new Error(Nd)}static fromName(e){const n=Vj[e];if(!n)throw new Error(Nd);return n}static getArrayType(e){switch(e){case De.UNSIGNED_SHORT_5_6_5:case De.UNSIGNED_SHORT_4_4_4_4:case De.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const n=Dd[e];if(!n)throw new Error(Nd);return n}}static getByteSize(e){return Ta.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return!!Ta.getArrayType(e)}static createTypedArray(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0;s===void 0&&(s=(n.byteLength-r)/Ta.getByteSize(e));const i=Ta.getArrayType(e);return new i(n,r,s)}};function jj(t,e){if(!t)throw new Error("math.gl assertion failed. ".concat(e))}function zj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=t>>11&31,r=t>>5&63,s=t&31;return e[0]=n<<3,e[1]=r<<2,e[2]=s<<3,e}new B0;new w;new B0;new B0;function uT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return Br(t,0,e)/e*2-1}function hT(t){return t<0?-1:1}function Jj(t,e,n,r){if(jj(r),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(n));if(r.x=uT(t,n),r.y=uT(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const s=r.x;r.x=(1-Math.abs(r.y))*hT(s),r.y=(1-Math.abs(s))*hT(r.y)}return r.normalize()}function Xj(t,e,n){return Jj(t,e,255,n)}let tA=class{constructor(e,n){g(this,"json",void 0),g(this,"buffer",void 0),g(this,"featuresLength",0),g(this,"_cachedTypedArrays",{}),this.json=e,this.buffer=n}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return!!this.json[e]}getGlobalProperty(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:te.UNSIGNED_INT,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=this.json[e];return s&&Number.isFinite(s.byteOffset)?this._getTypedArrayFromBinary(e,n,r,1,s.byteOffset):s}getPropertyArray(e,n,r){const s=this.json[e];return s&&Number.isFinite(s.byteOffset)?("componentType"in s&&(n=ka.fromName(s.componentType)),this._getTypedArrayFromBinary(e,n,r,this.featuresLength,s.byteOffset)):this._getTypedArrayFromArray(e,n,s)}getProperty(e,n,r,s,i){const o=this.json[e];if(!o)return o;const a=this.getPropertyArray(e,n,r);if(r===1)return a[s];for(let c=0;c<r;++c)i[c]=a[r*s+c];return i}_getTypedArrayFromBinary(e,n,r,s,i){const o=this._cachedTypedArrays;let a=o[e];return a||(a=ka.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+i,s*r),o[e]=a),a}_getTypedArrayFromArray(e,n,r){const s=this._cachedTypedArrays;let i=s[e];return i||(i=ka.createTypedArray(n,r),s[e]=i),i}};const $j={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Wj={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},Kj={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};function Yj(t,e,n,r){const{componentType:s}=t;me(t.componentType);const i=typeof s=="string"?ka.fromName(s):s,o=$j[t.type],a=Wj[t.type],c=Kj[t.type];return n+=t.byteOffset,{values:ka.createTypedArray(i,e,n,o*r),type:i,size:o,unpacker:a,packer:c}}const qn=t=>t!==void 0;function Qj(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const s=e.HIERARCHY;return s&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=s,r=s),r?qj(r,n):null}function qj(t,e){let n,r,s;const i=t.instancesLength,o=t.classes;let a=t.classIds,c=t.parentCounts,l=t.parentIds,u=i;qn(a.byteOffset)&&(a.componentType=defaultValue(a.componentType,GL.UNSIGNED_SHORT),a.type=AttributeType.SCALAR,s=getBinaryAccessor(a),a=s.createArrayBufferView(e.buffer,e.byteOffset+a.byteOffset,i));let h;if(qn(c))for(qn(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,s=getBinaryAccessor(c),c=s.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,i)),h=new Uint16Array(i),u=0,n=0;n<i;++n)h[n]=u,u+=c[n];qn(l)&&qn(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,s=getBinaryAccessor(l),l=s.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,u));const f=o.length;for(n=0;n<f;++n){const T=o[n].length,p=o[n].instances,A=getBinaryProperties(T,p,e);o[n].instances=combine(A,p)}const d=new Array(f).fill(0),m=new Uint16Array(i);for(n=0;n<i;++n)r=a[n],m[n]=d[r],++d[r];const _={classes:o,classIds:a,classIndexes:m,parentCounts:c,parentIndexes:h,parentIds:l};return tz(_),_}function ia(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?Zj(t,e,n):ez(t,e,n)}function Zj(t,e,n){const r=t.classIds,s=t.parentCounts,i=t.parentIds,o=t.parentIndexes,a=r.length,c=scratchVisited;c.length=Math.max(c.length,a);const l=++marker,u=scratchStack;for(u.length=0,u.push(e);u.length>0;){if(e=u.pop(),c[e]===l)continue;c[e]=l;const h=n(t,e);if(qn(h))return h;const f=s[e],d=o[e];for(let m=0;m<f;++m){const _=i[d+m];_!==e&&u.push(_)}}return null}function ez(t,e,n){let r=!0;for(;r;){const s=n(t,e);if(qn(s))return s;const i=t.parentIds[e];r=i!==e,e=i}throw new Error("traverseHierarchySingleParent")}function tz(t){const n=t.classIds.length;for(let r=0;r<n;++r)Dw(t,r,stack)}function Dw(t,e,n){const r=t.parentCounts,s=t.parentIds,i=t.parentIndexes,a=t.classIds.length;if(!qn(s))return;assert(e<a,"Parent index ".concat(e," exceeds the total number of instances: ").concat(a)),assert(n.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),n.push(e);const c=qn(r)?r[e]:1,l=qn(r)?i[e]:e;for(let u=0;u<c;++u){const h=s[l+u];h!==e&&Dw(t,h,n)}n.pop(e)}function yt(t){return t!=null}const Gl=(t,e)=>t,nz={HIERARCHY:!0,extensions:!0,extras:!0};let Nw=class{constructor(e,n,r){var s;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};g(this,"json",void 0),g(this,"binary",void 0),g(this,"featureCount",void 0),g(this,"_extensions",void 0),g(this,"_properties",void 0),g(this,"_binaryProperties",void 0),g(this,"_hierarchy",void 0),me(r>=0),this.json=e||{},this.binary=n,this.featureCount=r,this._extensions=((s=this.json)===null||s===void 0?void 0:s.extensions)||{},this._properties={};for(const o in this.json)nz[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=Qj(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,n){if(this._checkBatchId(e),me(typeof n=="string",n),this._hierarchy){const r=ia(this._hierarchy,e,(s,i)=>{const o=s.classIds[i];return s.classes[o].name===n});return yt(r)}return!1}isExactClass(e,n){return me(typeof n=="string",n),this.getExactClassName(e)===n}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const n=this._hierarchy.classIds[e];return this._hierarchy.classes[n].name}}hasProperty(e,n){return this._checkBatchId(e),me(typeof n=="string",n),yt(this._properties[n])||this._hasPropertyInHierarchy(e,n)}getPropertyNames(e,n){this._checkBatchId(e),n=yt(n)?n:[],n.length=0;const r=Object.keys(this._properties);return n.push(...r),this._hierarchy&&this._getPropertyNamesInHierarchy(e,n),n}getProperty(e,n){if(this._checkBatchId(e),me(typeof n=="string",n),this._binaryProperties){const s=this._binaryProperties[n];if(yt(s))return this._getBinaryProperty(s,e)}const r=this._properties[n];if(yt(r))return Gl(r[e]);if(this._hierarchy){const s=this._getHierarchyProperty(e,n);if(yt(s))return s}}setProperty(e,n,r){const s=this.featureCount;if(this._checkBatchId(e),me(typeof n=="string",n),this._binaryProperties){const o=this._binaryProperties[n];if(o){this._setBinaryProperty(o,e,r);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,n,r))return;let i=this._properties[n];yt(i)||(this._properties[n]=new Array(s),i=this._properties[n]),i[e]=Gl(r)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,n){return e.unpack(e.typedArray,n)}_setBinaryProperty(e,n,r){e.pack(r,e.typedArray,n)}_initializeBinaryProperties(){let e=null;for(const n in this._properties){const r=this._properties[n],s=this._initializeBinaryProperty(n,r);s&&(e=e||{},e[n]=s)}return e}_initializeBinaryProperty(e,n){if("byteOffset"in n){const r=n;me(this.binary,"Property ".concat(e," requires a batch table binary.")),me(r.type,"Property ".concat(e," requires a type."));const s=Yj(r,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:s.values,componentCount:s.size,unpack:s.unpacker,pack:s.packer}}return null}_hasPropertyInHierarchy(e,n){if(!this._hierarchy)return!1;const r=ia(this._hierarchy,e,(s,i)=>{const o=s.classIds[i],a=s.classes[o].instances;return yt(a[n])});return yt(r)}_getPropertyNamesInHierarchy(e,n){ia(this._hierarchy,e,(r,s)=>{const i=r.classIds[s],o=r.classes[i].instances;for(const a in o)o.hasOwnProperty(a)&&n.indexOf(a)===-1&&n.push(a)})}_getHierarchyProperty(e,n){return ia(this._hierarchy,e,(r,s)=>{const i=r.classIds[s],o=r.classes[i],a=r.classIndexes[s],c=o.instances[n];return yt(c)?yt(c.typedArray)?this._getBinaryProperty(c,a):Gl(c[a]):null})}_setHierarchyProperty(e,n,r,s){const i=ia(this._hierarchy,n,(o,a)=>{const c=o.classIds[a],l=o.classes[c],u=o.classIndexes[a],h=l.instances[r];return yt(h)?(me(a===n,'Inherited property "'.concat(r,'" is read-only.')),yt(h.typedArray)?this._setBinaryProperty(h,u,s):h[u]=Gl(s),!0):!1});return yt(i)}};const Ud=4;function Zh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=Ud,t.version=r.getUint32(n,!0),n+=Ud,t.byteLength=r.getUint32(n,!0),n+=Ud,t.version!==1)throw new Error("3D Tile Version ".concat(t.version," not supported"));return n}const Ti=4,fT="b3dm tile in legacy format.";function nA(t,e,n){const r=new DataView(e);let s;t.header=t.header||{};let i=r.getUint32(n,!0);n+=Ti;let o=r.getUint32(n,!0);n+=Ti;let a=r.getUint32(n,!0);n+=Ti;let c=r.getUint32(n,!0);return n+=Ti,a>=570425344?(n-=Ti*2,s=i,a=o,c=0,i=0,o=0,console.warn(fT)):c>=570425344&&(n-=Ti,s=a,a=i,c=o,i=0,o=0,console.warn(fT)),t.header.featureTableJsonByteLength=i,t.header.featureTableBinaryByteLength=o,t.header.batchTableJsonByteLength=a,t.header.batchTableBinaryByteLength=c,t.header.batchLength=s,n}function rA(t,e,n,r){return n=rz(t,e,n),n=sz(t,e,n),n}function rz(t,e,n,r){const{featureTableJsonByteLength:s,featureTableBinaryByteLength:i,batchLength:o}=t.header;if(t.featureTableJson={BATCH_LENGTH:o||0},s>0){const a=Fw(e,n,s);t.featureTableJson=JSON.parse(a)}return n+=s,t.featureTableBinary=new Uint8Array(e,n,i),n+=i,n}function sz(t,e,n,r){const{batchTableJsonByteLength:s,batchTableBinaryByteLength:i}=t.header;if(s>0){const o=Fw(e,n,s);t.batchTableJson=JSON.parse(o),n+=s,i>0&&(t.batchTableBinary=new Uint8Array(e,n,i),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=i)}return n}function Uw(t,e,n){if(!e&&(!t||!t.batchIds||!n))return null;const{batchIds:r,isRGB565:s,pointCount:i}=t;if(r&&n){const o=new Uint8ClampedArray(i*3);for(let a=0;a<i;a++){const c=r[a],u=n.getProperty(c,"dimensions").map(h=>h*255);o[a*3]=u[0],o[a*3+1]=u[1],o[a*3+2]=u[2]}return{type:te.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(s){const o=new Uint8ClampedArray(i*3);for(let a=0;a<i;a++){const c=zj(e[a]);o[a*3]=c[0],o[a*3+1]=c[1],o[a*3+2]=c[2]}return{type:te.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}return e&&e.length===i*3?{type:te.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:te.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}const dT=new w;function iz(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(t.pointsLength*3);for(let r=0;r<t.pointsLength;r++)Xj(e[r*2],e[r*2+1],dT),dT.toArray(n,r*3);return{type:te.FLOAT,size:2,value:n}}return{type:te.FLOAT,size:2,value:e}}function oz(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,az(t,e)):{type:te.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function az(t,e){const n=new w,r=new Float32Array(t.pointCount*3);for(let s=0;s<t.pointCount;s++)n.set(e[s*3],e[s*3+1],e[s*3+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,s*3);return r}async function cz(t,e,n,r,s){n=Zh(t,e,n),n=nA(t,e,n),n=rA(t,e,n),lz(t);const{featureTable:i,batchTable:o}=uz(t);return await mz(t,i,o,r,s),hz(t,i,r),fz(t,i,o),dz(t,i),n}function lz(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function uz(t){const e=new tA(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",te.FLOAT,3);const r=gz(t,e);return{featureTable:e,batchTable:r}}function hz(t,e,n){if(!t.attributes.positions){if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",te.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",te.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",te.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",te.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=oz(t,r,n)}}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function fz(t,e,n){if(!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",te.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",te.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",te.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=Uw(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",te.UNSIGNED_BYTE,4))}function dz(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",te.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",te.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=iz(t,n)}}function gz(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",te.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:s,batchTableBinary:i}=t;n=new Nw(s,i,r)}return n}async function mz(t,e,n,r,s){let i,o,a;const c=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];c&&(a=c.properties);const l=e.getExtension("3DTILES_draco_point_compression");if(l){o=l.properties;const h=l.byteOffset,f=l.byteLength;if(!o||!Number.isFinite(h)||!f)throw new Error("Draco properties, byteOffset, and byteLength must be defined");i=t.featureTableBinary.slice(h,h+f),t.hasPositions=Number.isFinite(o.POSITION),t.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),t.hasNormals=Number.isFinite(o.NORMAL),t.hasBatchIds=Number.isFinite(o.BATCH_ID),t.isTranslucent=Number.isFinite(o.RGBA)}if(!i)return!0;const u={buffer:i,properties:{...o,...a},featureTableProperties:o,batchTableProperties:a,dequantizeInShader:!1};return await pz(t,u,r,s)}async function pz(t,e,n,r){const{parse:s}=r,i={...n,draco:{...n.draco,extraAttributes:e.batchTableProperties||{}}};delete i["3d-tiles"];const o=await s(e.buffer,vw,i),a=o.attributes.POSITION&&o.attributes.POSITION.value,c=o.attributes.COLOR_0&&o.attributes.COLOR_0.value,l=o.attributes.NORMAL&&o.attributes.NORMAL.value,u=o.attributes.BATCH_ID&&o.attributes.BATCH_ID.value,h=a&&o.attributes.POSITION.value.quantization,f=l&&o.attributes.NORMAL.value.quantization;if(h){const m=o.POSITION.data.quantization,_=m.range;t.quantizedVolumeScale=new w(_,_,_),t.quantizedVolumeOffset=new w(m.minValues),t.quantizedRange=(1<<m.quantizationBits)-1,t.isQuantizedDraco=!0}f&&(t.octEncodedRange=(1<<o.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const d={};if(e.batchTableProperties)for(const m of Object.keys(e.batchTableProperties))o.attributes[m]&&o.attributes[m].value&&(d[m.toLowerCase()]=o.attributes[m].value);t.attributes={positions:a,colors:Uw(t,c,void 0),normals:l,batchIds:u,...d}}const km={URI:0,EMBEDDED:1};function Gw(t,e,n,r){t.rotateYtoZ=!0;const s=t.byteOffset+t.byteLength-n;if(s===0)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=e0(e,n,s),t.gltfByteOffset=0,t.gltfByteLength=s,n%4===0||console.warn("".concat(t.type,": embedded glb is not aligned to a 4-byte boundary.")),t.byteOffset+t.byteLength}async function kw(t,e,n,r){const s=n["3d-tiles"]||{};if(Az(t,e),s.loadGLTF){const{parse:i,fetch:o}=r;t.gltfUrl&&(t.gltfArrayBuffer=await o(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await i(t.gltfArrayBuffer,Ac,n,r),t.gpuMemoryUsageInBytes=Ew(t.gltf),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}function Az(t,e,n){switch(e){case km.URI:const r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),i=new TextDecoder().decode(r);t.gltfUrl=i.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case km.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function _z(t,e,n,r,s){var i;n=yz(t,e,n,r),await kw(t,km.EMBEDDED,r,s);const o=t==null||(i=t.gltf)===null||i===void 0?void 0:i.extensions;return o&&o.CESIUM_RTC&&(t.rtcCenter=o.CESIUM_RTC.center),n}function yz(t,e,n,r,s){n=Zh(t,e,n),n=nA(t,e,n),n=rA(t,e,n),n=Gw(t,e,n,r);const i=new tA(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=i.getGlobalProperty("RTC_CENTER",te.FLOAT,3),n}async function Ez(t,e,n,r,s){return n=Tz(t,e,n,r),await kw(t,t.gltfFormat,r,s),n}function Tz(t,e,n,r,s){if(n=Zh(t,e,n),t.version!==1)throw new Error("Instanced 3D Model version ".concat(t.version," is not supported"));n=nA(t,e,n);const i=new DataView(e);if(t.gltfFormat=i.getUint32(n,!0),n+=4,n=rA(t,e,n),n=Gw(t,e,n,r),t.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new tA(t.featureTableJson,t.featureTableBinary),a=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",te.FLOAT,3);const c=new Nw(t.batchTableJson,t.batchTableBinary,a);return vz(t,o,c,a),n}function vz(t,e,n,r){const i={instances:new Array(r),batchTable:t._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,o=new w;new w,new w,new w;const a=new xe,c=new hc,l=new w,u={},h=new q,f=[],d=[],m=new w,_=new w;for(let T=0;T<r;T++){let p;if(e.hasProperty("POSITION"))p=e.getProperty("POSITION",te.FLOAT,3,T,o);else if(e.hasProperty("POSITION_QUANTIZED")){p=e.getProperty("POSITION_QUANTIZED",te.UNSIGNED_SHORT,3,T,o);const I=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",te.FLOAT,3,m);if(!I)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const x=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",te.FLOAT,3,_);if(!x)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const O=65535;for(let M=0;M<3;M++)p[M]=p[M]/O*x[M]+I[M]}if(!p)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(o.copy(p),u.translation=o,t.normalUp=e.getProperty("NORMAL_UP",te.FLOAT,3,T,f),t.normalRight=e.getProperty("NORMAL_RIGHT",te.FLOAT,3,T,d),t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",te.UNSIGNED_SHORT,2,f),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",te.UNSIGNED_SHORT,2,d),t.octNormalUp)throw t.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");t.eastNorthUp?(be.WGS84.eastNorthUpToFixedFrame(o,h),h.getRotationMatrix3(a)):a.identity()}c.fromMatrix3(a),u.rotation=c,l.set(1,1,1);const A=e.getProperty("SCALE",te.FLOAT,1,T);Number.isFinite(A)&&l.multiplyByScalar(A);const y=e.getProperty("SCALE_NON_UNIFORM",te.FLOAT,3,T,f);y&&l.scale(y),u.scale=l;let C=e.getProperty("BATCH_ID",te.UNSIGNED_SHORT,1,T);C===void 0&&(C=T);const b=new q().fromQuaternion(u.rotation);h.identity(),h.translate(u.translation),h.multiplyRight(b),h.scale(u.scale);const S=h.clone();i[T]={modelMatrix:S,batchId:C}}t.instances=i}async function Cz(t,e,n,r,s,i){n=Zh(t,e,n);const o=new DataView(e);for(t.tilesLength=o.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const a={};t.tiles.push(a),n=await i(e,n,r,s,a)}return n}async function Bz(t,e,n,r){t.rotateYtoZ=!0,t.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y";const{parse:s}=r;t.gltf=await s(e,Ac,n,r),t.gpuMemoryUsageInBytes=Ew(t.gltf)}async function Hw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};switch(s.byteOffset=e,s.type=kj(t,e),s.type){case sa.COMPOSITE:return await Cz(s,t,e,n,r,Hw);case sa.BATCHED_3D_MODEL:return await _z(s,t,e,n,r);case sa.GLTF:return await Bz(s,t,n,r);case sa.INSTANCED_3D_MODEL:return await Ez(s,t,e,n,r);case sa.POINT_CLOUD:return await cz(s,t,e,n,r);default:throw new Error("3DTileLoader: unknown type ".concat(s.type))}}const bz=1952609651,Sz=1;async function wz(t,e,n){if(new Uint32Array(t.slice(0,4))[0]!==bz)throw new Error("Wrong subtree file magic number");if(new Uint32Array(t.slice(4,8))[0]!==Sz)throw new Error("Wrong subtree file verson, must be 1");const i=gT(t.slice(8,16)),o=new Uint8Array(t,24,i),c=new TextDecoder("utf8").decode(o),l=JSON.parse(c),u=gT(t.slice(16,24));let h=new ArrayBuffer(0);return u&&(h=t.slice(24+i)),"bufferView"in l.tileAvailability&&(l.tileAvailability.explicitBitstream=await Gd(l,"tileAvailability",h,n)),"bufferView"in l.contentAvailability&&(l.contentAvailability.explicitBitstream=await Gd(l,"contentAvailability",h,n)),"bufferView"in l.childSubtreeAvailability&&(l.childSubtreeAvailability.explicitBitstream=await Gd(l,"childSubtreeAvailability",h,n)),l}function Iz(t,e){if(e.startsWith("http")){const i=new URL(t,e);return decodeURI(i.toString())}const r="http://".concat(e),s=new URL(t,r);return"/".concat(s.host).concat(s.pathname)}async function Gd(t,e,n,r){const s=t[e].bufferView,i=t.bufferViews[s],o=t.buffers[i.buffer];if(!(r!=null&&r.url)||!r.fetch)throw new Error("Url is not provided");if(!r.fetch)throw new Error("fetch is not provided");if(o.uri){const a=Iz(o.uri,r==null?void 0:r.url),l=await(await r.fetch(a)).arrayBuffer();return new Uint8Array(l,i.byteOffset,i.byteLength)}return new Uint8Array(n,i.byteOffset,i.byteLength)}function gT(t){const e=new DataView(t),n=e.getUint32(0,!0),r=e.getUint32(4,!0);return n+2**32*r}const Vw={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:Pw,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:wz,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var un=null;try{un=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function fe(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}fe.prototype.__isLong__;Object.defineProperty(fe.prototype,"__isLong__",{value:!0});function ct(t){return(t&&t.__isLong__)===!0}function mT(t){var e=Math.clz32(t&-t);return t?31-e:e}fe.isLong=ct;var pT={},AT={};function oi(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=AT[t],r)?r:(n=ie(t,0,!0),s&&(AT[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=pT[t],r)?r:(n=ie(t,t<0?-1:0,!1),s&&(pT[t]=n),n))}fe.fromInt=oi;function hn(t,e){if(isNaN(t))return e?br:In;if(e){if(t<0)return br;if(t>=jw)return Xw}else{if(t<=-yT)return bt;if(t+1>=yT)return Jw}return t<0?hn(-t,e).neg():ie(t%Eo|0,t/Eo|0,e)}fe.fromNumber=hn;function ie(t,e,n){return new fe(t,e,n)}fe.fromBits=ie;var Ah=Math.pow;function sA(t,e,n){if(t.length===0)throw Error("empty string");if(typeof e=="number"?(n=e,e=!1):e=!!e,t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e?br:In;if(n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return sA(t.substring(1),e,n).neg();for(var s=hn(Ah(n,8)),i=In,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+a),n);if(a<8){var l=hn(Ah(n,a));i=i.mul(l).add(hn(c))}else i=i.mul(s),i=i.add(hn(c))}return i.unsigned=e,i}fe.fromString=sA;function Nn(t,e){return typeof t=="number"?hn(t,e):typeof t=="string"?sA(t,e):ie(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}fe.fromValue=Nn;var _T=65536,Mz=1<<24,Eo=_T*_T,jw=Eo*Eo,yT=jw/2,ET=oi(Mz),In=oi(0);fe.ZERO=In;var br=oi(0,!0);fe.UZERO=br;var Ji=oi(1);fe.ONE=Ji;var zw=oi(1,!0);fe.UONE=zw;var Hm=oi(-1);fe.NEG_ONE=Hm;var Jw=ie(-1,2147483647,!1);fe.MAX_VALUE=Jw;var Xw=ie(-1,-1,!0);fe.MAX_UNSIGNED_VALUE=Xw;var bt=ie(0,-2147483648,!1);fe.MIN_VALUE=bt;var D=fe.prototype;D.toInt=function(){return this.unsigned?this.low>>>0:this.low};D.toNumber=function(){return this.unsigned?(this.high>>>0)*Eo+(this.low>>>0):this.high*Eo+(this.low>>>0)};D.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(bt)){var n=hn(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=hn(Ah(e,6),this.unsigned),o=this,a="";;){var c=o.div(i),l=o.sub(c.mul(i)).toInt()>>>0,u=l.toString(e);if(o=c,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};D.getHighBits=function(){return this.high};D.getHighBitsUnsigned=function(){return this.high>>>0};D.getLowBits=function(){return this.low};D.getLowBitsUnsigned=function(){return this.low>>>0};D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(bt)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};D.isZero=function(){return this.high===0&&this.low===0};D.eqz=D.isZero;D.isNegative=function(){return!this.unsigned&&this.high<0};D.isPositive=function(){return this.unsigned||this.high>=0};D.isOdd=function(){return(this.low&1)===1};D.isEven=function(){return(this.low&1)===0};D.equals=function(e){return ct(e)||(e=Nn(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};D.eq=D.equals;D.notEquals=function(e){return!this.eq(e)};D.neq=D.notEquals;D.ne=D.notEquals;D.lessThan=function(e){return this.comp(e)<0};D.lt=D.lessThan;D.lessThanOrEqual=function(e){return this.comp(e)<=0};D.lte=D.lessThanOrEqual;D.le=D.lessThanOrEqual;D.greaterThan=function(e){return this.comp(e)>0};D.gt=D.greaterThan;D.greaterThanOrEqual=function(e){return this.comp(e)>=0};D.gte=D.greaterThanOrEqual;D.ge=D.greaterThanOrEqual;D.compare=function(e){if(ct(e)||(e=Nn(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};D.comp=D.compare;D.negate=function(){return!this.unsigned&&this.eq(bt)?bt:this.not().add(Ji)};D.neg=D.negate;D.add=function(e){ct(e)||(e=Nn(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,l=e.low&65535,u=0,h=0,f=0,d=0;return d+=i+l,f+=d>>>16,d&=65535,f+=s+c,h+=f>>>16,f&=65535,h+=r+a,u+=h>>>16,h&=65535,u+=n+o,u&=65535,ie(f<<16|d,u<<16|h,this.unsigned)};D.subtract=function(e){return ct(e)||(e=Nn(e)),this.add(e.neg())};D.sub=D.subtract;D.multiply=function(e){if(this.isZero())return this;if(ct(e)||(e=Nn(e)),un){var n=un.mul(this.low,this.high,e.low,e.high);return ie(n,un.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?br:In;if(this.eq(bt))return e.isOdd()?bt:In;if(e.eq(bt))return this.isOdd()?bt:In;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(ET)&&e.lt(ET))return hn(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,l=e.low>>>16,u=e.low&65535,h=0,f=0,d=0,m=0;return m+=o*u,d+=m>>>16,m&=65535,d+=i*u,f+=d>>>16,d&=65535,d+=o*l,f+=d>>>16,d&=65535,f+=s*u,h+=f>>>16,f&=65535,f+=i*l,h+=f>>>16,f&=65535,f+=o*c,h+=f>>>16,f&=65535,h+=r*u+s*l+i*c+o*a,h&=65535,ie(d<<16|m,h<<16|f,this.unsigned)};D.mul=D.multiply;D.divide=function(e){if(ct(e)||(e=Nn(e)),e.isZero())throw Error("division by zero");if(un){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?un.div_u:un.div_s)(this.low,this.high,e.low,e.high);return ie(n,un.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?br:In;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return br;if(e.gt(this.shru(1)))return zw;i=br}else{if(this.eq(bt)){if(e.eq(Ji)||e.eq(Hm))return bt;if(e.eq(bt))return Ji;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(In)?e.isNegative()?Ji:Hm:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(bt))return this.unsigned?br:In;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=In}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),c=a<=48?1:Ah(2,a-48),l=hn(r),u=l.mul(e);u.isNegative()||u.gt(s);)r-=c,l=hn(r,this.unsigned),u=l.mul(e);l.isZero()&&(l=Ji),i=i.add(l),s=s.sub(u)}return i};D.div=D.divide;D.modulo=function(e){if(ct(e)||(e=Nn(e)),un){var n=(this.unsigned?un.rem_u:un.rem_s)(this.low,this.high,e.low,e.high);return ie(n,un.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};D.mod=D.modulo;D.rem=D.modulo;D.not=function(){return ie(~this.low,~this.high,this.unsigned)};D.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};D.clz=D.countLeadingZeros;D.countTrailingZeros=function(){return this.low?mT(this.low):mT(this.high)+32};D.ctz=D.countTrailingZeros;D.and=function(e){return ct(e)||(e=Nn(e)),ie(this.low&e.low,this.high&e.high,this.unsigned)};D.or=function(e){return ct(e)||(e=Nn(e)),ie(this.low|e.low,this.high|e.high,this.unsigned)};D.xor=function(e){return ct(e)||(e=Nn(e)),ie(this.low^e.low,this.high^e.high,this.unsigned)};D.shiftLeft=function(e){return ct(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ie(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):ie(0,this.low<<e-32,this.unsigned)};D.shl=D.shiftLeft;D.shiftRight=function(e){return ct(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ie(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):ie(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};D.shr=D.shiftRight;D.shiftRightUnsigned=function(e){return ct(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ie(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?ie(this.high,0,this.unsigned):ie(this.high>>>e-32,0,this.unsigned)};D.shru=D.shiftRightUnsigned;D.shr_u=D.shiftRightUnsigned;D.rotateLeft=function(e){var n;return ct(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?ie(this.high,this.low,this.unsigned):e<32?(n=32-e,ie(this.low<<e|this.high>>>n,this.high<<e|this.low>>>n,this.unsigned)):(e-=32,n=32-e,ie(this.high<<e|this.low>>>n,this.low<<e|this.high>>>n,this.unsigned))};D.rotl=D.rotateLeft;D.rotateRight=function(e){var n;return ct(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?ie(this.high,this.low,this.unsigned):e<32?(n=32-e,ie(this.high<<n|this.low>>>e,this.low<<n|this.high>>>e,this.unsigned)):(e-=32,n=32-e,ie(this.low<<n|this.high>>>e,this.high<<n|this.low>>>e,this.unsigned))};D.rotr=D.rotateRight;D.toSigned=function(){return this.unsigned?ie(this.low,this.high,!1):this};D.toUnsigned=function(){return this.unsigned?this:ie(this.low,this.high,!0)};D.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};D.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};D.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};fe.fromBytes=function(e,n,r){return r?fe.fromBytesLE(e,n):fe.fromBytesBE(e,n)};fe.fromBytesLE=function(e,n){return new fe(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};fe.fromBytesBE=function(e,n){return new fe(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const Rz=16;function $w(t){t==="X"&&(t="");const e=t.padEnd(Rz,"0");return fe.fromString(e,!0,16)}function xz(t){if(t.isZero())return"X";let e=t.countTrailingZeros();const n=e%4;e=(e-n)/4;const r=e;e*=4;const i=t.shiftRightUnsigned(e).toString(16).replace(/0+$/,"");return Array(17-r-i.length).join("0")+i}function Oz(t,e){const n=Lz(t).shiftRightUnsigned(2);return t.add(fe.fromNumber(2*e+1-4).multiply(n))}function Lz(t){return t.and(t.not().add(1))}const Pz=3,Fz=30,Dz=2*Fz+1,TT=180/Math.PI;function Nz(t){if(t.length===0)throw new Error("Invalid Hilbert quad key ".concat(t));const e=t.split("/"),n=parseInt(e[0],10),r=e[1],s=r.length;let i=0;const o=[0,0];for(let a=s-1;a>=0;a--){i=s-a;const c=r[a];let l=0,u=0;c==="1"?u=1:c==="2"?(l=1,u=1):c==="3"&&(l=1);const h=Math.pow(2,i-1);Gz(h,o,l,u),o[0]+=h*l,o[1]+=h*u}if(n%2===1){const a=o[0];o[0]=o[1],o[1]=a}return{face:n,ij:o,level:i}}function Uz(t){if(t.isZero())return"";let e=t.toString(2);for(;e.length<Pz+Dz;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),s=e.substring(3,n),i=s.length/2,o=fe.fromString(r,!0,2).toString(10);let a="";if(i!==0)for(a=fe.fromString(s,!0,2).toString(4);a.length<i;)a="0"+a;return"".concat(o,"/").concat(a)}function Ww(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function vT(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function Kw(t){return[vT(t[0]),vT(t[1])]}function Yw(t,e){let[n,r]=e;switch(t){case 0:return[1,n,r];case 1:return[-n,1,r];case 2:return[-n,-r,1];case 3:return[-1,-r,-n];case 4:return[r,-1,-n];case 5:return[r,n,-1];default:throw new Error("Invalid face")}}function Qw(t){let[e,n,r]=t;const s=Math.atan2(r,Math.sqrt(e*e+n*n));return[Math.atan2(n,e)*TT,s*TT]}function Gz(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}function kz(t){const e=Ww(t.ij,t.level,[.5,.5]),n=Kw(e),r=Yw(t.face,n);return Qw(r)}const Hz=100;function CT(t){const{face:e,ij:n,level:r}=t,s=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(Hz*Math.pow(2,-r))),o=new Float64Array(4*i*2+2);let a=0,c=0;for(let l=0;l<4;l++){const u=s[l].slice(0),h=s[l+1],f=(h[0]-u[0])/i,d=(h[1]-u[1])/i;for(let m=0;m<i;m++){u[0]+=f,u[1]+=d;const _=Ww(n,r,u),T=Kw(_),p=Yw(e,T),A=Qw(p);Math.abs(A[1])>89.999&&(A[0]=c);const y=A[0]-c;A[0]+=y>180?-360:y<-180?360:0,o[a++]=A[0],o[a++]=A[1],c=A[0]}}return o[a++]=o[0],o[a++]=o[1],o}function iA(t){const e=Vz(t);return Nz(e)}function Vz(t){if(t.indexOf("/")>0)return t;const e=$w(t);return Uz(e)}function jz(t){const e=iA(t);return kz(e)}function zz(t){let e;if(t.face===2||t.face===5){let n=null,r=0;for(let s=0;s<4;s++){const i="".concat(t.face,"/").concat(s),o=iA(i),a=CT(o);(typeof n>"u"||n===null)&&(n=new Float64Array(4*a.length)),n.set(a,r),r+=a.length}e=BT(n)}else{const n=CT(t);e=BT(n)}return e}function BT(t){if(t.length%2!==0)throw new Error("Invalid corners");const e=[],n=[];for(let r=0;r<t.length;r+=2)e.push(t[r]),n.push(t[r+1]);return e.sort((r,s)=>r-s),n.sort((r,s)=>r-s),{west:e[0],east:e[e.length-1],north:n[n.length-1],south:n[0]}}function Jz(t,e){const n=(e==null?void 0:e.minimumHeight)||0,r=(e==null?void 0:e.maximumHeight)||0,s=iA(t),i=zz(s),o=i.west,a=i.south,c=i.east,l=i.north,u=[];return u.push(new w(o,l,n)),u.push(new w(c,l,n)),u.push(new w(c,a,n)),u.push(new w(o,a,n)),u.push(new w(o,l,r)),u.push(new w(c,l,r)),u.push(new w(c,a,r)),u.push(new w(o,a,r)),u}function qw(t){const e=t.token,n={minimumHeight:t.minimumHeight,maximumHeight:t.maximumHeight},r=Jz(e,n),s=jz(e),i=s[0],o=s[1],a=be.WGS84.cartographicToCartesian([i,o,n.maximumHeight]),c=new w(a[0],a[1],a[2]);r.push(c);const l=A4(r);return[...l.center,...l.halfAxes]}const Xz=4,$z=8,Wz={QUADTREE:Xz,OCTREE:$z};function Kz(t,e,n){if(t!=null&&t.box){const r=$w(t.s2VolumeInfo.token),s=Oz(r,e),i=xz(s),o={...t.s2VolumeInfo};switch(o.token=i,n){case"OCTREE":const l=t.s2VolumeInfo,u=l.maximumHeight-l.minimumHeight,h=u/2,f=l.minimumHeight+u/2;l.minimumHeight=f-h,l.maximumHeight=f+h;break}return{box:qw(o),s2VolumeInfo:o}}}async function Zw(t){const{options:e,parentData:n={mortonIndex:0,x:0,y:0,z:0},childIndex:r=0,globalData:s={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:i}=t;let{subtree:o,level:a=0}=t;const{subdivisionScheme:c,subtreeLevels:l,maximumLevel:u,contentUrlTemplate:h,subtreesUriTemplate:f,basePath:d}=e,m={children:[],lodMetricValue:0,contentUrl:""},_=Wz[c],T=r&1,p=r>>1&1,A=r>>2&1,y=(_**a-1)/(_-1);let C=Ms(n.mortonIndex,r),b=y+C,S=Ms(n.x,T),I=Ms(n.y,p),x=Ms(n.z,A),O=!1;a+1>l&&(O=kd(o.childSubtreeAvailability,C));const M=Ms(s.x,S),U=Ms(s.y,I),J=Ms(s.z,x),W=a+s.level;if(O){const G="".concat(d,"/").concat(f),X=Vm(G,W,M,U,J);o=await ar(X,Vw),s.mortonIndex=C,s.x=S,s.y=I,s.z=x,s.level=a,C=0,b=0,S=0,I=0,x=0,a=0}if(!kd(o.tileAvailability,b)||a>u)return m;kd(o.contentAvailability,b)&&(m.contentUrl=Vm(h,W,M,U,J));const Yt=a+1,xt={mortonIndex:C,x:S,y:I,z:x};for(let G=0;G<_;G++){const X=Kz(i,G,c),K=await Zw({subtree:o,options:e,parentData:xt,childIndex:G,level:Yt,globalData:s,s2VolumeBox:X});if(K.contentUrl||K.children.length){const ue=W+1,Gn=Yz(K,ue,{childTileX:S,childTileY:I,childTileZ:x},e,i);m.children.push(Gn)}}return m}function kd(t,e){return"constant"in t?!!t.constant:t.explicitBitstream?Zz(e,t.explicitBitstream):!1}function Yz(t,e,n,r,s){const{basePath:i,refine:o,getRefine:a,lodMetricType:c,getTileType:l,rootLodMetricValue:u,rootBoundingVolume:h}=r,f=t.contentUrl&&t.contentUrl.replace("".concat(i,"/"),""),d=u/2**e,m=s!=null&&s.box?{box:s.box}:h,_=Qz(e,m,n);return{children:t.children,contentUrl:t.contentUrl,content:{uri:f},id:t.contentUrl,refine:a(o),type:l(t),lodMetricType:c,lodMetricValue:d,geometricError:d,transform:t.transform,boundingVolume:_}}function Qz(t,e,n){if(e.region){const{childTileX:r,childTileY:s,childTileZ:i}=n,[o,a,c,l,u,h]=e.region,f=2**t,d=(c-o)/f,m=(l-a)/f,_=(h-u)/f,[T,p]=[o+d*r,o+d*(r+1)],[A,y]=[a+m*s,a+m*(s+1)],[C,b]=[u+_*i,u+_*(i+1)];return{region:[T,A,p,y,C,b]}}if(e.box)return e;throw new Error("Unsupported bounding volume type ".concat(e))}function Ms(t,e){return parseInt(t.toString(2)+e.toString(2),2)}function Vm(t,e,n,r,s){const i=qz({level:e,x:n,y:r,z:s});return t.replace(/{level}|{x}|{y}|{z}/gi,o=>i[o])}function qz(t){const e={};for(const n in t)e["{".concat(n,"}")]=t[n];return e}function Zz(t,e){const n=Math.floor(t/8),r=t%8;return(e[n]>>r&1)===1}function oA(t){if(!t.contentUrl)return no.EMPTY;const n=t.contentUrl.split("?")[0].split(".").pop();switch(n){case"pnts":return no.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return no.SCENEGRAPH;default:return n}}function aA(t){switch(t){case"REPLACE":case"replace":return Mr.REPLACE;case"ADD":case"add":return Mr.ADD;default:return t}}function jm(t,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const r=new URL(t,"".concat(e,"/"));return decodeURI(r.toString())}else if(t.startsWith("/"))return t;return"".concat(e,"/").concat(t)}function bT(t,e){if(!t)return null;if(t.content){const n=t.content.uri||t.content.url;t.contentUrl=jm(n,e.basePath)}return t.id=t.contentUrl,t.lodMetricType=Qh.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=oA(t),t.refine=aA(t.refine),t}async function e5(t,e){const n=t.basePath;let r;const s=wT(t==null?void 0:t.root);s&&t.root?r=await ST(t.root,t,s,e):r=bT(t.root,t);const i=[];for(i.push(r);i.length>0;){const a=(i.pop()||{}).children||[];for(let c of a){const l=wT(c);l?c=await ST(c,t,l,e):bT(c,{basePath:n}),i.push(c)}}return r}async function ST(t,e,n,r){var s,i;const o=e.basePath,{subdivisionScheme:a,maximumLevel:c,subtreeLevels:l,subtrees:{uri:u}}=n,h=Vm(u,0,0,0,0),f=jm(h,o),d=await ar(f,Vw,r),m=jm(t.content.uri,o),_=e==null||(s=e.root)===null||s===void 0?void 0:s.refine,T=t.geometricError,p=(i=t.boundingVolume.extensions)===null||i===void 0?void 0:i["3DTILES_bounding_volume_S2"];if(p){const b={box:qw(p),s2VolumeInfo:p};t.boundingVolume=b}const A=t.boundingVolume,y={contentUrlTemplate:m,subtreesUriTemplate:u,subdivisionScheme:a,subtreeLevels:l,maximumLevel:c,refine:_,basePath:o,lodMetricType:Qh.GEOMETRIC_ERROR,rootLodMetricValue:T,rootBoundingVolume:A,getTileType:oA,getRefine:aA};return await t5(t,d,y)}async function t5(t,e,n){if(!t)return null;t.lodMetricType=Qh.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform;const{children:r,contentUrl:s}=await Zw({subtree:e,options:n,s2VolumeBox:t});return s&&(t.contentUrl=s,t.content={uri:s.replace("".concat(n.basePath,"/"),"")}),t.refine=aA(t.refine),t.type=oA(t),t.children=r,t.id=t.contentUrl,t}function wT(t){var e;return(t==null||(e=t.extensions)===null||e===void 0?void 0:e["3DTILES_implicit_tiling"])||(t==null?void 0:t.implicitTiling)}const eI={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:Pw,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:i5,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function n5(t){return t0(t.url)}async function r5(t,e,n){const r={content:{featureIds:null}};return await Hw(t,0,e,n,r.content),r.content}async function s5(t,e,n){var r;const s=JSON.parse(new TextDecoder().decode(t));return s.loader=e.loader||eI,s.url=n.url,s.queryString=n.queryString,s.basePath=n5(s),s.root=await e5(s,e),s.type=en.TILES3D,s.lodMetricType=Qh.GEOMETRIC_ERROR,s.lodMetricValue=((r=s.root)===null||r===void 0?void 0:r.lodMetricValue)||0,s}async function i5(t,e,n){const r=e["3d-tiles"]||{};let s;return r.isTileset==="auto"?s=n.url&&n.url.indexOf(".json")!==-1:s=r.isTileset,s?t=await s5(t,e,n):t=await r5(t,e,n),t}const IT=[0],o5={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:eI,onTilesetLoad:{type:"function",value:t=>{}},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:(t,e,n)=>{}},_getMeshColor:{type:"function",value:t=>[255,255,255]}};class _h extends ZS{constructor(...e){super(...e),g(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&se.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){var e,n;return!!(!((e=this.state)===null||e===void 0||(n=e.tileset3d)===null||n===void 0)&&n.isLoaded()&&super.isLoaded)}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({props:e,oldProps:n,changeFlags:r}){if(e.data&&e.data!==n.data&&this._loadTileset(e.data),r.viewportChanged){const{activeViewports:s}=this.state;Object.keys(s).length&&(this._updateTileset(s),this.state.lastUpdatedViewports=s,this.state.activeViewports={})}if(r.propsChanged){const{layerMap:s}=this.state;for(const i in s)s[i].needsUpdate=!0}}activateViewport(e){const{activeViewports:n,lastUpdatedViewports:r}=this.state;this.internalState.viewport=e,n[e.id]=e;const s=r==null?void 0:r[e.id];(!s||!e.equals(s))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:e,sourceLayer:n}){const r=n&&n.props.tile;return e.picked&&(e.object=r),e.sourceTile=r,e}filterSubLayer({layer:e,viewport:n}){const{tile:r}=e.props,{id:s}=n;return r.selected&&r.viewportIds.includes(s)}_updateAutoHighlight(e){const n=e.sourceTile,r=this.state.layerMap[n==null?void 0:n.id];r&&r.layer&&r.layer.updateAutoHighlight(e)}async _loadTileset(e){const{loadOptions:n={}}=this.props;let r=this.props.loader||this.props.loaders;Array.isArray(r)&&(r=r[0]);const s={loadOptions:{...n}};let i=e;if(r.preload){const c=await r.preload(e,n);c.url&&(i=c.url),c.headers&&(s.loadOptions.fetch={...s.loadOptions.fetch,headers:c.headers}),Object.assign(s,c)}const o=await ar(i,r,s.loadOptions),a=new Gj(o,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...s});this.setState({tileset3d:a,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(a)}_onTileLoad(e){const{lastUpdatedViewports:n}=this.state;this.props.onTileLoad(e),this._updateTileset(n),this.setNeedsUpdate()}_onTileUnload(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}_updateTileset(e){if(!e)return;const{tileset3d:n}=this.state,{timeline:r}=this.context,s=Object.keys(e).length;!r||!s||!n||n.selectTiles(Object.values(e)).then(i=>{this.state.frameNumber!==i&&this.setState({frameNumber:i})})}_getSubLayer(e,n){if(!e.content)return null;switch(e.type){case no.POINTCLOUD:return this._makePointCloudLayer(e,n);case no.SCENEGRAPH:return this._make3DModelLayer(e);case no.MESH:return this._makeSimpleMeshLayer(e,n);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}_makePointCloudLayer(e,n){const{attributes:r,pointCount:s,constantRGBA:i,cartographicOrigin:o,modelMatrix:a}=e.content,{positions:c,normals:l,colors:u}=r;if(!c)return null;const h=n&&n.props.data||{header:{vertexCount:s},attributes:{POSITION:c,NORMAL:l,COLOR_0:u}},{pointSize:f,getPointColor:d}=this.props,m=this.getSubLayerClass("pointcloud",j0);return new m({pointSize:f},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),tile:e,data:h,coordinateSystem:ee.METER_OFFSETS,coordinateOrigin:o,modelMatrix:a,getColor:i||d,_offset:0})}_make3DModelLayer(e){const{gltf:n,instances:r,cartographicOrigin:s,modelMatrix:i}=e.content,o=this.getSubLayerClass("scenegraph",Z0);return new o({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),tile:e,data:r||IT,scenegraph:n,coordinateSystem:ee.METER_OFFSETS,coordinateOrigin:s,modelMatrix:i,getTransformMatrix:a=>a.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(e,n){const r=e.content,{attributes:s,indices:i,modelMatrix:o,cartographicOrigin:a,coordinateSystem:c=ee.METER_OFFSETS,material:l,featureIds:u}=r,{_getMeshColor:h}=this.props,f=n&&n.props.mesh||new Ua({drawMode:4,attributes:a5(s),indices:i}),d=this.getSubLayerClass("mesh",eA);return new d(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),tile:e,mesh:f,data:IT,getColor:h(e),pbrMaterial:l,modelMatrix:o,coordinateOrigin:a,coordinateSystem:c,featureIds:u,_offset:0})}renderLayers(){const{tileset3d:e,layerMap:n}=this.state;return e?e.tiles.map(r=>{const s=n[r.id]=n[r.id]||{tile:r};let{layer:i}=s;return r.selected&&(i?s.needsUpdate&&(i=this._getSubLayer(r,i),s.needsUpdate=!1):i=this._getSubLayer(r)),s.layer=i,i}).filter(Boolean):null}}g(_h,"defaultProps",o5);g(_h,"layerName","Tile3DLayer");function a5(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}async function Dc(t,e,n,r){return r._parse(t,e,n,r)}function $e(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const tI=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),MT=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);MT&&parseFloat(MT[1]);const c5="latest";function l5(){var t;return(t=globalThis._loadersgl_)!==null&&t!==void 0&&t.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},typeof __VERSION__>"u"?(console.warn("loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN."),globalThis._loadersgl_.version=c5):globalThis._loadersgl_.version=__VERSION__),globalThis._loadersgl_.version}const u5=l5();function h5(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Nc=typeof process!="object"||String(process)!=="[object process]"||process.browser,cA=typeof importScripts=="function",RT=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);RT&&parseFloat(RT[1]);const Hd={};async function Js(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return e&&(t=f5(t,e,n,r)),Hd[t]=Hd[t]||d5(t),await Hd[t]}function f5(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!n.useLocalLibraries&&t.startsWith("http"))return t;r=r||t;const s=n.modules||{};return s[r]?s[r]:Nc?n.CDN?(h5(n.CDN.startsWith("http")),`${n.CDN}/${e}@${u5}/dist/libs/${r}`):cA?`../src/libs/${r}`:`modules/${e}/src/libs/${r}`:`modules/${e}/dist/libs/${r}`}async function d5(t){if(t.endsWith("wasm"))return await m5(t);if(!Nc)try{return Nx&&void 0}catch(n){return console.error(n),null}if(cA)return importScripts(t);const e=await p5(t);return g5(e,t)}function g5(t,e){if(!Nc)return;if(cA)return eval.call(globalThis,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}async function m5(t){return await(await fetch(t)).arrayBuffer()}async function p5(t){return await(await fetch(t)).text()}function A5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?xT(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?xT(t,0,e):""}function xT(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let s="";for(let i=0;i<n;i++)s+=String.fromCharCode(r.getUint8(e+i));return s}function _5(t){try{return JSON.parse(t)}catch{throw new Error(`Failed to parse JSON from data starting with "${A5(t)}"`)}}function lA(t,e,n){const r=n!==void 0?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function Uc(t,e){return $e(t>=0),$e(e>0),t+(e-1)&~(e-1)}function y5(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const s=t.byteOffset,i=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,s,i)}return e.set(r,n),n+Uc(r.byteLength,4)}function E5(){var t;if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();const e=(t=window.location)===null||t===void 0?void 0:t.pathname;return(e==null?void 0:e.slice(0,e.lastIndexOf("/")+1))||""}function T5(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}function v5(){const t=[];for(let s=0;s<arguments.length;s++)t[s]=s<0||arguments.length<=s?void 0:arguments[s];let e="",n=!1,r;for(let s=t.length-1;s>=-1&&!n;s--){let i;s>=0?i=t[s]:(r===void 0&&(r=E5()),i=r),i.length!==0&&(e=`${i}/${e}`,n=i.charCodeAt(0)===va)}return e=C5(e,!n),n?`/${e}`:e.length>0?e:"."}const va=47,Vd=46;function C5(t,e){let n="",r=-1,s=0,i,o=!1;for(let a=0;a<=t.length;++a){if(a<t.length)i=t.charCodeAt(a);else{if(i===va)break;i=va}if(i===va){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(n.length<2||!o||n.charCodeAt(n.length-1)!==Vd||n.charCodeAt(n.length-2)!==Vd){if(n.length>2){const c=n.length-1;let l=c;for(;l>=0&&n.charCodeAt(l)!==va;--l);if(l!==c){n=l===-1?"":n.slice(0,l),r=a,s=0,o=!1;continue}}else if(n.length===2||n.length===1){n="",r=a,s=0,o=!1;continue}}e&&(n.length>0?n+="/..":n="..",o=!0)}else{const c=t.slice(r+1,a);n.length>0?n+=`/${c}`:n=c,o=!1}r=a,s=0}else i===Vd&&s!==-1?++s:s=-1}return n}const B5=1/Math.PI*180,b5=1/180*Math.PI,S5={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...S5}};const ze=globalThis.mathgl.config;function w5(t,{precision:e=ze.precision}={}){return t=L5(t),"".concat(parseFloat(t.toPrecision(e)))}function ei(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function I5(t){return R5(t)}function M5(t){return x5(t)}function R5(t,e){return uA(t,n=>n*b5,e)}function x5(t,e){return uA(t,n=>n*B5,e)}function O5(t,e,n){return uA(t,r=>Math.max(e,Math.min(n,r)))}function gs(t,e,n){const r=ze.EPSILON;n&&(ze.EPSILON=n);try{if(t===e)return!0;if(ei(t)&&ei(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!gs(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=ze.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{ze.EPSILON=r}}function L5(t){return Math.round(t/ze.EPSILON)*ze.EPSILON}function P5(t){return t.clone?t.clone():new Array(t.length)}function uA(t,e,n){if(ei(t)){const r=t;n=n||P5(r);for(let s=0;s<n.length&&s<r.length;++s){const i=typeof t=="number"?t:t[s];n[s]=e(i,s,n)}return n}return e(t)}function F5(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class hA extends F5(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:ei(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ze)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+w5(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!gs(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let s=0;s<this.ELEMENTS;++s){const i=e[s],o=typeof n=="number"?n:n[s];this[s]=i+r*(o-i)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(ze.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function D5(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ce(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(JSON.stringify(t)));return t}function Ha(t,e,n=""){if(ze.debug&&!D5(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}function Sn(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}class fA extends hA{get x(){return this[0]}set x(e){this[0]=ce(e)}get y(){return this[1]}set y(e){this[1]=ce(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const s=this[r]-e[r];n+=s*s}return ce(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return ce(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Sn(e>=0&&e<this.ELEMENTS,"index is out of range"),ce(this[e])}setComponent(e,n){return Sn(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const Va=1e-6;let Dn=typeof Float32Array<"u"?Float32Array:Array;function N5(){const t=new Dn(2);return Dn!=Float32Array&&(t[0]=0,t[1]=0),t}function U5(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t}function G5(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s+n[4],t[1]=n[1]*r+n[3]*s+n[5],t}function nI(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[3]*s+n[6],t[1]=n[1]*r+n[4]*s+n[7],t}function rI(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[4]*s+n[12],t[1]=n[1]*r+n[5]*s+n[13],t}(function(){const t=N5();return function(e,n,r,s,i,o){let a,c;for(n||(n=2),r||(r=0),s?c=Math.min(s*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],i(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function sI(t,e,n){const r=e[0],s=e[1],i=n[3]*r+n[7]*s||1;return t[0]=(n[0]*r+n[4]*s)/i,t[1]=(n[1]*r+n[5]*s)/i,t}function iI(t,e,n){const r=e[0],s=e[1],i=e[2],o=n[3]*r+n[7]*s+n[11]*i||1;return t[0]=(n[0]*r+n[4]*s+n[8]*i)/o,t[1]=(n[1]*r+n[5]*s+n[9]*i)/o,t[2]=(n[2]*r+n[6]*s+n[10]*i)/o,t}function k5(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t}function H5(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t[3]=e[3],t}function oI(t,e,n){const r=e[0],s=e[1],i=e[2];return t[0]=n[0]*r+n[3]*s+n[6]*i,t[1]=n[1]*r+n[4]*s+n[7]*i,t[2]=n[2]*r+n[5]*s+n[8]*i,t[3]=e[3],t}class dA extends fA{constructor(e=0,n=0){super(2),ei(e)&&arguments.length===1?this.copy(e):(ze.debug&&(ce(e),ce(n)),this[0]=e,this[1]=n)}set(e,n){return this[0]=e,this[1]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return ze.debug&&(ce(e.x),ce(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return rI(this,this,e),this.check()}transformAsVector(e){return sI(this,this,e),this.check()}transformByMatrix3(e){return nI(this,this,e),this.check()}transformByMatrix2x3(e){return G5(this,this,e),this.check()}transformByMatrix2(e){return U5(this,this,e),this.check()}}function aI(){const t=new Dn(3);return Dn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function cI(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function OT(t,e,n){const r=new Dn(3);return r[0]=t,r[1]=e,r[2]=n,r}function V5(t,e){const n=e[0],r=e[1],s=e[2];let i=n*n+r*r+s*s;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function gA(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Iu(t,e,n){const r=e[0],s=e[1],i=e[2],o=n[0],a=n[1],c=n[2];return t[0]=s*c-i*a,t[1]=i*o-r*c,t[2]=r*a-s*o,t}function mA(t,e,n){const r=e[0],s=e[1],i=e[2];let o=n[3]*r+n[7]*s+n[11]*i+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/o,t[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/o,t[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/o,t}function lI(t,e,n){const r=e[0],s=e[1],i=e[2];return t[0]=r*n[0]+s*n[3]+i*n[6],t[1]=r*n[1]+s*n[4]+i*n[7],t[2]=r*n[2]+s*n[5]+i*n[8],t}function uI(t,e,n){const r=n[0],s=n[1],i=n[2],o=n[3],a=e[0],c=e[1],l=e[2];let u=s*l-i*c,h=i*a-r*l,f=r*c-s*a,d=s*f-i*h,m=i*u-r*f,_=r*h-s*u;const T=o*2;return u*=T,h*=T,f*=T,d*=2,m*=2,_*=2,t[0]=a+u+d,t[1]=c+h+m,t[2]=l+f+_,t}function j5(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function z5(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function J5(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function X5(t,e){const n=t[0],r=t[1],s=t[2],i=e[0],o=e[1],a=e[2],c=Math.sqrt((n*n+r*r+s*s)*(i*i+o*o+a*a)),l=c&&gA(t,e)/c;return Math.acos(Math.min(Math.max(l,-1),1))}const $5=cI;(function(){const t=aI();return function(e,n,r,s,i,o){let a,c;for(n||(n=3),r||(r=0),s?c=Math.min(s*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],i(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const jd=[0,0,0];let kl;class L extends fA{static get ZERO(){return kl||(kl=new L(0,0,0),Object.freeze(kl)),kl}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&ei(e)?this.copy(e):(ze.debug&&(ce(e),ce(n),ce(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return ze.debug&&(ce(e.x),ce(e.y),ce(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ce(e)}angle(e){return X5(this,e)}cross(e){return Iu(this,this,e),this.check()}rotateX({radians:e,origin:n=jd}){return j5(this,this,n,e),this.check()}rotateY({radians:e,origin:n=jd}){return z5(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=jd}){return J5(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return mA(this,this,e),this.check()}transformAsVector(e){return iI(this,this,e),this.check()}transformByMatrix3(e){return lI(this,this,e),this.check()}transformByMatrix2(e){return k5(this,this,e),this.check()}transformByQuaternion(e){return uI(this,this,e),this.check()}}let Hl;class pA extends fA{static get ZERO(){return Hl||(Hl=new pA(0,0,0,0),Object.freeze(Hl)),Hl}constructor(e=0,n=0,r=0,s=0){super(-0,-0,-0,-0),ei(e)&&arguments.length===1?this.copy(e):(ze.debug&&(ce(e),ce(n),ce(r),ce(s)),this[0]=e,this[1]=n,this[2]=r,this[3]=s)}set(e,n,r,s){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return ze.debug&&(ce(e.x),ce(e.y),ce(e.z),ce(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=ce(e)}get w(){return this[3]}set w(e){this[3]=ce(e)}transform(e){return mA(this,this,e),this.check()}transformByMatrix3(e){return oI(this,this,e),this.check()}transformByMatrix2(e){return H5(this,this,e),this.check()}transformByQuaternion(e){return uI(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class hI extends hA{toString(){let e="[";if(ze.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=ce(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)n[s]=this[r+s];return n}setColumn(e,n){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=n[s];return this}}function W5(){const t=new Dn(9);return Dn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function K5(t,e){if(t===e){const n=e[1],r=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Y5(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=u*o-a*l,f=-u*i+a*c,d=l*i-o*c;let m=n*h+r*f+s*d;return m?(m=1/m,t[0]=h*m,t[1]=(-u*r+s*l)*m,t[2]=(a*r-s*o)*m,t[3]=f*m,t[4]=(u*n-s*c)*m,t[5]=(-a*n+s*i)*m,t[6]=d*m,t[7]=(-l*n+r*c)*m,t[8]=(o*n-r*i)*m,t):null}function Q5(t){const e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],o=t[5],a=t[6],c=t[7],l=t[8];return e*(l*i-o*c)+n*(-l*s+o*a)+r*(c*s-i*a)}function LT(t,e,n){const r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=n[0],d=n[1],m=n[2],_=n[3],T=n[4],p=n[5],A=n[6],y=n[7],C=n[8];return t[0]=f*r+d*o+m*l,t[1]=f*s+d*a+m*u,t[2]=f*i+d*c+m*h,t[3]=_*r+T*o+p*l,t[4]=_*s+T*a+p*u,t[5]=_*i+T*c+p*h,t[6]=A*r+y*o+C*l,t[7]=A*s+y*a+C*u,t[8]=A*i+y*c+C*h,t}function q5(t,e,n){const r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=n[0],d=n[1];return t[0]=r,t[1]=s,t[2]=i,t[3]=o,t[4]=a,t[5]=c,t[6]=f*r+d*o+l,t[7]=f*s+d*a+u,t[8]=f*i+d*c+h,t}function Z5(t,e,n){const r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*r+f*o,t[1]=d*s+f*a,t[2]=d*i+f*c,t[3]=d*o-f*r,t[4]=d*a-f*s,t[5]=d*c-f*i,t[6]=l,t[7]=u,t[8]=h,t}function PT(t,e,n){const r=n[0],s=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function eJ(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],o=n+n,a=r+r,c=s+s,l=n*o,u=r*o,h=r*a,f=s*o,d=s*a,m=s*c,_=i*o,T=i*a,p=i*c;return t[0]=1-h-m,t[3]=u-p,t[6]=f+T,t[1]=u+p,t[4]=1-l-m,t[7]=d-_,t[2]=f-T,t[5]=d+_,t[8]=1-l-h,t}var zm;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(zm||(zm={}));const tJ=Object.freeze([1,0,0,0,1,0,0,0,1]);class Le extends hI{static get IDENTITY(){return rJ()}static get ZERO(){return nJ()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return zm}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(tJ)}fromObject(e){return this.check()}fromQuaternion(e){return eJ(this,e),this.check()}set(e,n,r,s,i,o,a,c,l){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=i,this[5]=o,this[6]=a,this[7]=c,this[8]=l,this.check()}setRowMajor(e,n,r,s,i,o,a,c,l){return this[0]=e,this[1]=s,this[2]=a,this[3]=n,this[4]=i,this[5]=c,this[6]=r,this[7]=o,this[8]=l,this.check()}determinant(){return Q5(this)}transpose(){return K5(this,this),this.check()}invert(){return Y5(this,this),this.check()}multiplyLeft(e){return LT(this,e,this),this.check()}multiplyRight(e){return LT(this,this,e),this.check()}rotate(e){return Z5(this,this,e),this.check()}scale(e){return Array.isArray(e)?PT(this,this,e):PT(this,this,[e,e]),this.check()}translate(e){return q5(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=nI(n||[-0,-0],e,this);break;case 3:r=lI(n||[-0,-0,-0],e,this);break;case 4:r=oI(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Ha(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let Vl,jl=null;function nJ(){return Vl||(Vl=new Le([0,0,0,0,0,0,0,0,0]),Object.freeze(Vl)),Vl}function rJ(){return jl||(jl=new Le,Object.freeze(jl)),jl}function sJ(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function iJ(t,e){if(t===e){const n=e[1],r=e[2],s=e[3],i=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=s,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function oJ(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=e[9],f=e[10],d=e[11],m=e[12],_=e[13],T=e[14],p=e[15],A=n*a-r*o,y=n*c-s*o,C=n*l-i*o,b=r*c-s*a,S=r*l-i*a,I=s*l-i*c,x=u*_-h*m,O=u*T-f*m,M=u*p-d*m,U=h*T-f*_,J=h*p-d*_,W=f*p-d*T;let H=A*W-y*J+C*U+b*M-S*O+I*x;return H?(H=1/H,t[0]=(a*W-c*J+l*U)*H,t[1]=(s*J-r*W-i*U)*H,t[2]=(_*I-T*S+p*b)*H,t[3]=(f*S-h*I-d*b)*H,t[4]=(c*M-o*W-l*O)*H,t[5]=(n*W-s*M+i*O)*H,t[6]=(T*C-m*I-p*y)*H,t[7]=(u*I-f*C+d*y)*H,t[8]=(o*J-a*M+l*x)*H,t[9]=(r*M-n*J-i*x)*H,t[10]=(m*S-_*C+p*A)*H,t[11]=(h*C-u*S-d*A)*H,t[12]=(a*O-o*U-c*x)*H,t[13]=(n*U-r*O+s*x)*H,t[14]=(_*y-m*b-T*A)*H,t[15]=(u*b-h*y+f*A)*H,t):null}function aJ(t){const e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],o=t[5],a=t[6],c=t[7],l=t[8],u=t[9],h=t[10],f=t[11],d=t[12],m=t[13],_=t[14],T=t[15],p=e*o-n*i,A=e*a-r*i,y=n*a-r*o,C=l*m-u*d,b=l*_-h*d,S=u*_-h*m,I=e*S-n*b+r*C,x=i*S-o*b+a*C,O=l*y-u*A+h*p,M=d*y-m*A+_*p;return c*I-s*x+T*O-f*M}function FT(t,e,n){const r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=e[9],d=e[10],m=e[11],_=e[12],T=e[13],p=e[14],A=e[15];let y=n[0],C=n[1],b=n[2],S=n[3];return t[0]=y*r+C*a+b*h+S*_,t[1]=y*s+C*c+b*f+S*T,t[2]=y*i+C*l+b*d+S*p,t[3]=y*o+C*u+b*m+S*A,y=n[4],C=n[5],b=n[6],S=n[7],t[4]=y*r+C*a+b*h+S*_,t[5]=y*s+C*c+b*f+S*T,t[6]=y*i+C*l+b*d+S*p,t[7]=y*o+C*u+b*m+S*A,y=n[8],C=n[9],b=n[10],S=n[11],t[8]=y*r+C*a+b*h+S*_,t[9]=y*s+C*c+b*f+S*T,t[10]=y*i+C*l+b*d+S*p,t[11]=y*o+C*u+b*m+S*A,y=n[12],C=n[13],b=n[14],S=n[15],t[12]=y*r+C*a+b*h+S*_,t[13]=y*s+C*c+b*f+S*T,t[14]=y*i+C*l+b*d+S*p,t[15]=y*o+C*u+b*m+S*A,t}function cJ(t,e,n){const r=n[0],s=n[1],i=n[2];let o,a,c,l,u,h,f,d,m,_,T,p;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*i+e[12],t[13]=e[1]*r+e[5]*s+e[9]*i+e[13],t[14]=e[2]*r+e[6]*s+e[10]*i+e[14],t[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(o=e[0],a=e[1],c=e[2],l=e[3],u=e[4],h=e[5],f=e[6],d=e[7],m=e[8],_=e[9],T=e[10],p=e[11],t[0]=o,t[1]=a,t[2]=c,t[3]=l,t[4]=u,t[5]=h,t[6]=f,t[7]=d,t[8]=m,t[9]=_,t[10]=T,t[11]=p,t[12]=o*r+u*s+m*i+e[12],t[13]=a*r+h*s+_*i+e[13],t[14]=c*r+f*s+T*i+e[14],t[15]=l*r+d*s+p*i+e[15]),t}function lJ(t,e,n){const r=n[0],s=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function uJ(t,e,n,r){let s=r[0],i=r[1],o=r[2],a=Math.sqrt(s*s+i*i+o*o),c,l,u,h,f,d,m,_,T,p,A,y,C,b,S,I,x,O,M,U,J,W,H,Ce;return a<Va?null:(a=1/a,s*=a,i*=a,o*=a,l=Math.sin(n),c=Math.cos(n),u=1-c,h=e[0],f=e[1],d=e[2],m=e[3],_=e[4],T=e[5],p=e[6],A=e[7],y=e[8],C=e[9],b=e[10],S=e[11],I=s*s*u+c,x=i*s*u+o*l,O=o*s*u-i*l,M=s*i*u-o*l,U=i*i*u+c,J=o*i*u+s*l,W=s*o*u+i*l,H=i*o*u-s*l,Ce=o*o*u+c,t[0]=h*I+_*x+y*O,t[1]=f*I+T*x+C*O,t[2]=d*I+p*x+b*O,t[3]=m*I+A*x+S*O,t[4]=h*M+_*U+y*J,t[5]=f*M+T*U+C*J,t[6]=d*M+p*U+b*J,t[7]=m*M+A*U+S*J,t[8]=h*W+_*H+y*Ce,t[9]=f*W+T*H+C*Ce,t[10]=d*W+p*H+b*Ce,t[11]=m*W+A*H+S*Ce,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function hJ(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[4],o=e[5],a=e[6],c=e[7],l=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*s+l*r,t[5]=o*s+u*r,t[6]=a*s+h*r,t[7]=c*s+f*r,t[8]=l*s-i*r,t[9]=u*s-o*r,t[10]=h*s-a*r,t[11]=f*s-c*r,t}function fJ(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],o=e[1],a=e[2],c=e[3],l=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s-l*r,t[1]=o*s-u*r,t[2]=a*s-h*r,t[3]=c*s-f*r,t[8]=i*r+l*s,t[9]=o*r+u*s,t[10]=a*r+h*s,t[11]=c*r+f*s,t}function dJ(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],o=e[1],a=e[2],c=e[3],l=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s+l*r,t[1]=o*s+u*r,t[2]=a*s+h*r,t[3]=c*s+f*r,t[4]=l*s-i*r,t[5]=u*s-o*r,t[6]=h*s-a*r,t[7]=f*s-c*r,t}function gJ(t,e){const n=e[0],r=e[1],s=e[2],i=e[4],o=e[5],a=e[6],c=e[8],l=e[9],u=e[10];return t[0]=Math.sqrt(n*n+r*r+s*s),t[1]=Math.sqrt(i*i+o*o+a*a),t[2]=Math.sqrt(c*c+l*l+u*u),t}function mJ(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],o=n+n,a=r+r,c=s+s,l=n*o,u=r*o,h=r*a,f=s*o,d=s*a,m=s*c,_=i*o,T=i*a,p=i*c;return t[0]=1-h-m,t[1]=u+p,t[2]=f-T,t[3]=0,t[4]=u-p,t[5]=1-l-m,t[6]=d+_,t[7]=0,t[8]=f+T,t[9]=d-_,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pJ(t,e,n,r,s,i,o){const a=1/(n-e),c=1/(s-r),l=1/(i-o);return t[0]=i*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(s+r)*c,t[10]=(o+i)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*l,t[15]=0,t}function AJ(t,e,n,r,s){const i=1/Math.tan(e/2);if(t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0){const o=1/(r-s);t[10]=(s+r)*o,t[14]=2*s*r*o}else t[10]=-1,t[14]=-2*r;return t}const _J=AJ;function yJ(t,e,n,r,s,i,o){const a=1/(e-n),c=1/(r-s),l=1/(i-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*a,t[13]=(s+r)*c,t[14]=(o+i)*l,t[15]=1,t}const EJ=yJ;function TJ(t,e,n,r){let s,i,o,a,c,l,u,h,f,d;const m=e[0],_=e[1],T=e[2],p=r[0],A=r[1],y=r[2],C=n[0],b=n[1],S=n[2];return Math.abs(m-C)<Va&&Math.abs(_-b)<Va&&Math.abs(T-S)<Va?sJ(t):(h=m-C,f=_-b,d=T-S,s=1/Math.sqrt(h*h+f*f+d*d),h*=s,f*=s,d*=s,i=A*d-y*f,o=y*h-p*d,a=p*f-A*h,s=Math.sqrt(i*i+o*o+a*a),s?(s=1/s,i*=s,o*=s,a*=s):(i=0,o=0,a=0),c=f*a-d*o,l=d*i-h*a,u=h*o-f*i,s=Math.sqrt(c*c+l*l+u*u),s?(s=1/s,c*=s,l*=s,u*=s):(c=0,l=0,u=0),t[0]=i,t[1]=c,t[2]=h,t[3]=0,t[4]=o,t[5]=l,t[6]=f,t[7]=0,t[8]=a,t[9]=u,t[10]=d,t[11]=0,t[12]=-(i*m+o*_+a*T),t[13]=-(c*m+l*_+u*T),t[14]=-(h*m+f*_+d*T),t[15]=1,t)}function vJ(){const t=new Dn(4);return Dn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function CJ(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function BJ(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function bJ(t){const e=t[0],n=t[1],r=t[2],s=t[3];return Math.sqrt(e*e+n*n+r*r+s*s)}function SJ(t){const e=t[0],n=t[1],r=t[2],s=t[3];return e*e+n*n+r*r+s*s}function wJ(t,e){const n=e[0],r=e[1],s=e[2],i=e[3];let o=n*n+r*r+s*s+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=s*o,t[3]=i*o,t}function IJ(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function MJ(t,e,n,r){const s=e[0],i=e[1],o=e[2],a=e[3];return t[0]=s+r*(n[0]-s),t[1]=i+r*(n[1]-i),t[2]=o+r*(n[2]-o),t[3]=a+r*(n[3]-a),t}function RJ(t,e,n){const r=e[0],s=e[1],i=e[2],o=e[3];return t[0]=n[0]*r+n[4]*s+n[8]*i+n[12]*o,t[1]=n[1]*r+n[5]*s+n[9]*i+n[13]*o,t[2]=n[2]*r+n[6]*s+n[10]*i+n[14]*o,t[3]=n[3]*r+n[7]*s+n[11]*i+n[15]*o,t}function xJ(t,e,n){const r=e[0],s=e[1],i=e[2],o=n[0],a=n[1],c=n[2],l=n[3],u=l*r+a*i-c*s,h=l*s+c*r-o*i,f=l*i+o*s-a*r,d=-o*r-a*s-c*i;return t[0]=u*l+d*-o+h*-c-f*-a,t[1]=h*l+d*-a+f*-o-u*-c,t[2]=f*l+d*-c+u*-a-h*-o,t[3]=e[3],t}(function(){const t=vJ();return function(e,n,r,s,i,o){let a,c;for(n||(n=4),r||(r=0),s?c=Math.min(s*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],i(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Jm;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Jm||(Jm={}));const OJ=45*Math.PI/180,LJ=1,zd=.1,Jd=500,PJ=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class To extends hI{static get IDENTITY(){return DJ()}static get ZERO(){return FJ()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Jm}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,s,i,o,a,c,l,u,h,f,d,m,_,T){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=i,this[5]=o,this[6]=a,this[7]=c,this[8]=l,this[9]=u,this[10]=h,this[11]=f,this[12]=d,this[13]=m,this[14]=_,this[15]=T,this.check()}setRowMajor(e,n,r,s,i,o,a,c,l,u,h,f,d,m,_,T){return this[0]=e,this[1]=i,this[2]=l,this[3]=d,this[4]=n,this[5]=o,this[6]=u,this[7]=m,this[8]=r,this[9]=a,this[10]=h,this[11]=_,this[12]=s,this[13]=c,this[14]=f,this[15]=T,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(PJ)}fromObject(e){return this.check()}fromQuaternion(e){return mJ(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:s,top:i,near:o=zd,far:a=Jd}=e;return a===1/0?NJ(this,n,r,s,i,o):pJ(this,n,r,s,i,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:s=[0,1,0]}=e;return TJ(this,n,r,s),this.check()}ortho(e){const{left:n,right:r,bottom:s,top:i,near:o=zd,far:a=Jd}=e;return EJ(this,n,r,s,i,o,a),this.check()}orthographic(e){const{fovy:n=OJ,aspect:r=LJ,focalDistance:s=1,near:i=zd,far:o=Jd}=e;DT(n);const a=n/2,c=s*Math.tan(a),l=c*r;return this.ortho({left:-l,right:l,bottom:-c,top:c,near:i,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:s=.1,far:i=500}=e;return DT(n),_J(this,n,r,s,i),this.check()}determinant(){return aJ(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*i,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*i,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=this[4]*s,e[4]=this[5]*i,e[5]=this[6]*o,e[6]=this[8]*s,e[7]=this[9]*i,e[8]=this[10]*o,e}transpose(){return iJ(this,this),this.check()}invert(){return oJ(this,this),this.check()}multiplyLeft(e){return FT(this,e,this),this.check()}multiplyRight(e){return FT(this,this,e),this.check()}rotateX(e){return hJ(this,this,e),this.check()}rotateY(e){return fJ(this,this,e),this.check()}rotateZ(e){return dJ(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return uJ(this,this,e,n),this.check()}scale(e){return lJ(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return cJ(this,this,e),this.check()}transform(e,n){return e.length===4?(n=RJ(n||[-0,-0,-0,-0],e,this),Ha(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let s;switch(r){case 2:s=rI(n||[-0,-0],e,this);break;case 3:s=mA(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Ha(s,e.length),s}transformAsVector(e,n){let r;switch(e.length){case 2:r=sI(n||[-0,-0],e,this);break;case 3:r=iI(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Ha(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let zl,Jl;function FJ(){return zl||(zl=new To([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(zl)),zl}function DJ(){return Jl||(Jl=new To,Object.freeze(Jl)),Jl}function DT(t){if(t>Math.PI*2)throw Error("expected radians")}function NJ(t,e,n,r,s,i){const o=2*i/(n-e),a=2*i/(s-r),c=(n+e)/(n-e),l=(s+r)/(s-r),u=-1,h=-1,f=-2*i;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=c,t[9]=l,t[10]=u,t[11]=h,t[12]=0,t[13]=0,t[14]=f,t[15]=0,t}function NT(){const t=new Dn(4);return Dn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function UJ(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function fI(t,e,n){n=n*.5;const r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function UT(t,e,n){const r=e[0],s=e[1],i=e[2],o=e[3],a=n[0],c=n[1],l=n[2],u=n[3];return t[0]=r*u+o*a+s*l-i*c,t[1]=s*u+o*c+i*a-r*l,t[2]=i*u+o*l+r*c-s*a,t[3]=o*u-r*a-s*c-i*l,t}function GJ(t,e,n){n*=.5;const r=e[0],s=e[1],i=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*a,t[1]=s*c+i*a,t[2]=i*c-s*a,t[3]=o*c-r*a,t}function kJ(t,e,n){n*=.5;const r=e[0],s=e[1],i=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c-i*a,t[1]=s*c+o*a,t[2]=i*c+r*a,t[3]=o*c-s*a,t}function HJ(t,e,n){n*=.5;const r=e[0],s=e[1],i=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+s*a,t[1]=s*c-r*a,t[2]=i*c+o*a,t[3]=o*c-i*a,t}function VJ(t,e){const n=e[0],r=e[1],s=e[2];return t[0]=n,t[1]=r,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-s*s)),t}function Mu(t,e,n,r){const s=e[0],i=e[1],o=e[2],a=e[3];let c=n[0],l=n[1],u=n[2],h=n[3],f,d,m,_,T;return f=s*c+i*l+o*u+a*h,f<0&&(f=-f,c=-c,l=-l,u=-u,h=-h),1-f>Va?(d=Math.acos(f),T=Math.sin(d),m=Math.sin((1-r)*d)/T,_=Math.sin(r*d)/T):(m=1-r,_=r),t[0]=m*s+_*c,t[1]=m*i+_*l,t[2]=m*o+_*u,t[3]=m*a+_*h,t}function jJ(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],o=n*n+r*r+s*s+i*i,a=o?1/o:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-s*a,t[3]=i*a,t}function zJ(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function dI(t,e){const n=e[0]+e[4]+e[8];let r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);const i=(s+1)%3,o=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[i*3+i]-e[o*3+o]+1),t[s]=.5*r,r=.5/r,t[3]=(e[i*3+o]-e[o*3+i])*r,t[i]=(e[i*3+s]+e[s*3+i])*r,t[o]=(e[o*3+s]+e[s*3+o])*r}return t}const JJ=CJ,XJ=BJ,$J=IJ,WJ=MJ,KJ=bJ,YJ=SJ,gI=wJ,QJ=function(){const t=aI(),e=OT(1,0,0),n=OT(0,1,0);return function(r,s,i){const o=gA(s,i);return o<-.999999?(Iu(t,e,s),$5(t)<1e-6&&Iu(t,n,s),V5(t,t),fI(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Iu(t,s,i),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,gI(r,r))}}();(function(){const t=NT(),e=NT();return function(n,r,s,i,o,a){return Mu(t,r,o,a),Mu(e,s,i,a),Mu(n,t,e,2*a*(1-a)),n}})();(function(){const t=W5();return function(e,n,r,s){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],gI(e,dI(e,t))}})();const qJ=[0,0,0,1];class Xm extends hA{constructor(e=0,n=0,r=0,s=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,s)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,s){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return dI(this,e),this.check()}fromAxisRotation(e,n){return fI(this,e,n),this.check()}identity(){return UJ(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=ce(e)}get y(){return this[1]}set y(e){this[1]=ce(e)}get z(){return this[2]}set z(e){this[2]=ce(e)}get w(){return this[3]}set w(e){this[3]=ce(e)}len(){return KJ(this)}lengthSquared(){return YJ(this)}dot(e){return $J(this,e)}rotationTo(e,n){return QJ(this,e,n),this.check()}add(e){return JJ(this,this,e),this.check()}calculateW(){return VJ(this,this),this.check()}conjugate(){return zJ(this,this),this.check()}invert(){return jJ(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(WJ(this,e,n,r),this.check())}multiplyRight(e){return UT(this,this,e),this.check()}multiplyLeft(e){return UT(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return GJ(this,this,e),this.check()}rotateY(e){return kJ(this,this,e),this.check()}rotateZ(e){return HJ(this,this,e),this.check()}scale(e){return XJ(this,this,e),this.check()}slerp(e,n,r){let s,i,o;switch(arguments.length){case 1:({start:s=qJ,target:i,ratio:o}=e);break;case 2:s=this,i=e,o=n;break;default:s=e,i=n,o=r}return Mu(this,s,i,o),this.check()}transformVector4(e,n=new pA){return xJ(n,e,this),Ha(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const ZJ=.1,eX=1e-12,mI=1e-15,tX=1e-20,nX=6378137,rX=6378137,sX=6356752314245179e-9;function ef(t){return t}new L;function iX(t,e=[],n=ef){return"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):"x"in t?(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function oX(t,e=[]){return iX(t,e,ze._cartographicRadians?ef:I5)}function aX(t,e,n=ef){return"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):"x"in e?(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function cX(t,e){return aX(t,e,ze._cartographicRadians?ef:M5)}const GT=1e-14,lX=new L,kT={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Xd={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},oa={east:new L,north:new L,up:new L,west:new L,south:new L,down:new L},uX=new L,hX=new L,fX=new L;function HT(t,e,n,r,s,i){const o=kT[e]&&kT[e][n];Sn(o&&(!r||r===o));let a,c,l;const u=lX.copy(s);if(gs(u.x,0,GT)&&gs(u.y,0,GT)){const f=Math.sign(u.z);a=uX.fromArray(Xd[e]),e!=="east"&&e!=="west"&&a.scale(f),c=hX.fromArray(Xd[n]),n!=="east"&&n!=="west"&&c.scale(f),l=fX.fromArray(Xd[r]),r!=="east"&&r!=="west"&&l.scale(f)}else{const{up:f,east:d,north:m}=oa;d.set(-u.y,u.x,0).normalize(),t.geodeticSurfaceNormal(u,f),m.copy(f).cross(d);const{down:_,west:T,south:p}=oa;_.copy(f).scale(-1),T.copy(d).scale(-1),p.copy(m).scale(-1),a=oa[e],c=oa[n],l=oa[r]}return i[0]=a.x,i[1]=a.y,i[2]=a.z,i[3]=0,i[4]=c.x,i[5]=c.y,i[6]=c.z,i[7]=0,i[8]=l.x,i[9]=l.y,i[10]=l.z,i[11]=0,i[12]=u.x,i[13]=u.y,i[14]=u.z,i[15]=1,i}const vi=new L,dX=new L,gX=new L;function mX(t,e,n=[]){const{oneOverRadii:r,oneOverRadiiSquared:s,centerToleranceSquared:i}=e;vi.from(t);const o=vi.x,a=vi.y,c=vi.z,l=r.x,u=r.y,h=r.z,f=o*o*l*l,d=a*a*u*u,m=c*c*h*h,_=f+d+m,T=Math.sqrt(1/_);if(!Number.isFinite(T))return;const p=dX;if(p.copy(t).scale(T),_<i)return p.to(n);const A=s.x,y=s.y,C=s.z,b=gX;b.set(p.x*A*2,p.y*y*2,p.z*C*2);let S=(1-T)*vi.len()/(.5*b.len()),I=0,x,O,M,U;do{S-=I,x=1/(1+S*A),O=1/(1+S*y),M=1/(1+S*C);const J=x*x,W=O*O,H=M*M,Ce=J*x,Yt=W*O,xt=H*M;U=f*J+d*W+m*H-1;const X=-2*(f*Ce*A+d*Yt*y+m*xt*C);I=U/X}while(Math.abs(U)>eX);return vi.scale([x,O,M]).to(n)}const Xl=new L,VT=new L,pX=new L,Tn=new L,AX=new L,$l=new L;class yh{constructor(e=0,n=0,r=0){g(this,"radii",void 0),g(this,"radiiSquared",void 0),g(this,"radiiToTheFourth",void 0),g(this,"oneOverRadii",void 0),g(this,"oneOverRadiiSquared",void 0),g(this,"minimumRadius",void 0),g(this,"maximumRadius",void 0),g(this,"centerToleranceSquared",ZJ),g(this,"squaredXOverSquaredZ",void 0),Sn(e>=0),Sn(n>=0),Sn(r>=0),this.radii=new L(e,n,r),this.radiiSquared=new L(e*e,n*n,r*r),this.radiiToTheFourth=new L(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new L(e===0?0:1/e,n===0?0:1/n,r===0?0:1/r),this.oneOverRadiiSquared=new L(e===0?0:1/(e*e),n===0?0:1/(n*n),r===0?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||!!(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,n=[0,0,0]){const r=VT,s=pX,[,,i]=e;this.geodeticSurfaceNormalCartographic(e,r),s.copy(this.radiiSquared).scale(r);const o=Math.sqrt(r.dot(s));return s.scale(1/o),r.scale(i),s.add(r),s.to(n)}cartesianToCartographic(e,n=[0,0,0]){$l.from(e);const r=this.scaleToGeodeticSurface($l,Tn);if(!r)return;const s=this.geodeticSurfaceNormal(r,VT),i=AX;i.copy($l).subtract(r);const o=Math.atan2(s.y,s.x),a=Math.asin(s.z),c=Math.sign(gA(i,$l))*cI(i);return cX([o,a,c],n)}eastNorthUpToFixedFrame(e,n=new To){return HT(this,"east","north","up",e,n)}localFrameToFixedFrame(e,n,r,s,i=new To){return HT(this,e,n,r,s,i)}geocentricSurfaceNormal(e,n=[0,0,0]){return Xl.from(e).normalize().to(n)}geodeticSurfaceNormalCartographic(e,n=[0,0,0]){const r=oX(e),s=r[0],i=r[1],o=Math.cos(i);return Xl.set(o*Math.cos(s),o*Math.sin(s),Math.sin(i)).normalize(),Xl.to(n)}geodeticSurfaceNormal(e,n=[0,0,0]){return Xl.from(e).scale(this.oneOverRadiiSquared).normalize().to(n)}scaleToGeodeticSurface(e,n){return mX(e,this,n)}scaleToGeocentricSurface(e,n=[0,0,0]){Tn.from(e);const r=Tn.x,s=Tn.y,i=Tn.z,o=this.oneOverRadiiSquared,a=1/Math.sqrt(r*r*o.x+s*s*o.y+i*i*o.z);return Tn.multiplyScalar(a).to(n)}transformPositionToScaledSpace(e,n=[0,0,0]){return Tn.from(e).scale(this.oneOverRadii).to(n)}transformPositionFromScaledSpace(e,n=[0,0,0]){return Tn.from(e).scale(this.radii).to(n)}getSurfaceNormalIntersectionWithZAxis(e,n=0,r=[0,0,0]){Sn(gs(this.radii.x,this.radii.y,mI)),Sn(this.radii.z>0),Tn.from(e);const s=Tn.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(s)>=this.radii.z-n))return Tn.set(0,0,s).to(r)}}g(yh,"WGS84",new yh(nX,rX,sX));const kt={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};new L;new L;const aa=new L,jT=new L;class AA{constructor(e=[0,0,0],n=0){g(this,"center",void 0),g(this,"radius",void 0),this.radius=-0,this.center=new L,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=aa.from(n),this.center=new L().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new AA(this.center,this.radius)}union(e){const n=this.center,r=this.radius,s=e.center,i=e.radius,o=aa.copy(s).subtract(n),a=o.magnitude();if(r>=a+i)return this.clone();if(i>=a+r)return e.clone();const c=(r+a+i)*.5;return jT.copy(o).scale((-r+c)/a).add(n),this.center.copy(jT),this.radius=c,this}expand(e){const r=aa.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=gJ(aa,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=aa.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,i=e.normal.dot(n)+e.distance;return i<-r?kt.OUTSIDE:i<r?kt.INTERSECTING:kt.INSIDE}}const _X=new L,yX=new L,Wl=new L,Kl=new L,Yl=new L,EX=new L,TX=new L,gr={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class _A{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){g(this,"center",void 0),g(this,"halfAxes",void 0),this.center=new L().from(e),this.halfAxes=new Le(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new L(e).len(),new L(n).len(),new L(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),s=new L(e).normalize(),i=new L(n).normalize(),o=new L(r).normalize();return new Xm().fromMatrix3(new Le([...s,...i,...o]))}fromCenterHalfSizeQuaternion(e,n,r){const s=new Xm(r),i=new Le().fromQuaternion(s);return i[0]=i[0]*n[0],i[1]=i[1]*n[0],i[2]=i[2]*n[0],i[3]=i[3]*n[1],i[4]=i[4]*n[1],i[5]=i[5]*n[1],i[6]=i[6]*n[2],i[7]=i[7]*n[2],i[8]=i[8]*n[2],this.center=new L().from(e),this.halfAxes=i,this}clone(){return new _A(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new AA){const n=this.halfAxes,r=n.getColumn(0,Wl),s=n.getColumn(1,Kl),i=n.getColumn(2,Yl),o=_X.copy(r).add(s).add(i);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,s=this.halfAxes,i=r.x,o=r.y,a=r.z,c=Math.abs(i*s[gr.COLUMN0ROW0]+o*s[gr.COLUMN0ROW1]+a*s[gr.COLUMN0ROW2])+Math.abs(i*s[gr.COLUMN1ROW0]+o*s[gr.COLUMN1ROW1]+a*s[gr.COLUMN1ROW2])+Math.abs(i*s[gr.COLUMN2ROW0]+o*s[gr.COLUMN2ROW1]+a*s[gr.COLUMN2ROW2]),l=r.dot(n)+e.distance;return l<=-c?kt.OUTSIDE:l>=c?kt.INSIDE:kt.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=yX.from(e).subtract(this.center),r=this.halfAxes,s=r.getColumn(0,Wl),i=r.getColumn(1,Kl),o=r.getColumn(2,Yl),a=s.magnitude(),c=i.magnitude(),l=o.magnitude();s.normalize(),i.normalize(),o.normalize();let u=0,h;return h=Math.abs(n.dot(s))-a,h>0&&(u+=h*h),h=Math.abs(n.dot(i))-c,h>0&&(u+=h*h),h=Math.abs(n.dot(o))-l,h>0&&(u+=h*h),u}computePlaneDistances(e,n,r=[-0,-0]){let s=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,c=a.getColumn(0,Wl),l=a.getColumn(1,Kl),u=a.getColumn(2,Yl),h=EX.copy(c).add(l).add(u).add(o),f=TX.copy(h).subtract(e);let d=n.dot(f);return s=Math.min(d,s),i=Math.max(d,i),h.copy(o).add(c).add(l).subtract(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),h.copy(o).add(c).subtract(l).add(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),h.copy(o).add(c).subtract(l).subtract(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),o.copy(h).subtract(c).add(l).add(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),o.copy(h).subtract(c).add(l).subtract(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),o.copy(h).subtract(c).subtract(l).add(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),o.copy(h).subtract(c).subtract(l).subtract(u),f.copy(h).subtract(e),d=n.dot(f),s=Math.min(d,s),i=Math.max(d,i),r[0]=s,r[1]=i,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,Wl);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,Kl);r.transformAsPoint(e);const s=this.halfAxes.getColumn(2,Yl);return s.transformAsPoint(e),this.halfAxes=new Le([...n,...r,...s]),this}getTransform(){throw new Error("not implemented")}}const zT=new L,JT=new L;class Eh{constructor(e=[0,0,1],n=0){g(this,"normal",void 0),g(this,"distance",void 0),this.normal=new L,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return Sn(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=zT.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,s){return this.normal.set(e,n,r),Sn(gs(this.normal.len(),1)),this.distance=s,this}clone(){return new Eh(this.normal,this.distance)}equals(e){return gs(this.distance,e.distance)&&gs(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=JT.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){const r=zT.from(e),s=this.getPointDistance(r),i=JT.copy(this.normal).scale(s);return r.subtract(i).to(n)}}const XT=[new L([1,0,0]),new L([0,1,0]),new L([0,0,1])],$T=new L,vX=new L;class rs{constructor(e=[]){g(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*XT.length;const n=e.center,r=e.radius;let s=0;for(const i of XT){let o=this.planes[s],a=this.planes[s+1];o||(o=this.planes[s]=new Eh),a||(a=this.planes[s+1]=new Eh);const c=$T.copy(i).scale(-r).add(n);o.fromPointNormal(c,i);const l=$T.copy(i).scale(r).add(n),u=vX.copy(i).negate();a.fromPointNormal(l,u),s+=2}return this}computeVisibility(e){let n=kt.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case kt.OUTSIDE:return kt.OUTSIDE;case kt.INTERSECTING:n=kt.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(Sn(Number.isFinite(n),"parentPlaneMask is required."),n===rs.MASK_OUTSIDE||n===rs.MASK_INSIDE)return n;let r=rs.MASK_INSIDE;const s=this.planes;for(let i=0;i<this.planes.length;++i){const o=i<31?1<<i:0;if(i<31&&!(n&o))continue;const a=s[i],c=e.intersectPlane(a);if(c===kt.OUTSIDE)return rs.MASK_OUTSIDE;c===kt.INTERSECTING&&(r|=o)}return r}}g(rs,"MASK_OUTSIDE",4294967295);g(rs,"MASK_INSIDE",0);g(rs,"MASK_INDETERMINATE",2147483647);new L;new L;new L;new L;new L;new L;new L;new L;new L;new L;new L;new L;new L;new L;new L;new L;new L;const Wn=new Le,CX=new Le,BX=new Le,Ql=new Le,WT=new Le;function bX(t,e={}){const n=tX,r=10;let s=0,i=0;const o=CX,a=BX;o.identity(),a.copy(t);const c=n*SX(a);for(;i<r&&wX(a)>c;)IX(a,Ql),WT.copy(Ql).transpose(),a.multiplyRight(Ql),a.multiplyLeft(WT),o.multiplyRight(Ql),++s>2&&(++i,s=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function SX(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const $m=[1,0,0],Wm=[2,2,1];function wX(t){let e=0;for(let n=0;n<3;++n){const r=t[Wn.getElementIndex(Wm[n],$m[n])];e+=2*r*r}return Math.sqrt(e)}function IX(t,e){const n=mI;let r=0,s=1;for(let l=0;l<3;++l){const u=Math.abs(t[Wn.getElementIndex(Wm[l],$m[l])]);u>r&&(s=l,r=u)}const i=$m[s],o=Wm[s];let a=1,c=0;if(Math.abs(t[Wn.getElementIndex(o,i)])>n){const l=t[Wn.getElementIndex(o,o)],u=t[Wn.getElementIndex(i,i)],h=t[Wn.getElementIndex(o,i)],f=(l-u)/2/h;let d;f<0?d=-1/(-f+Math.sqrt(1+f*f)):d=1/(f+Math.sqrt(1+f*f)),a=1/Math.sqrt(1+d*d),c=d*a}return Le.IDENTITY.to(e),e[Wn.getElementIndex(i,i)]=e[Wn.getElementIndex(o,o)]=a,e[Wn.getElementIndex(o,i)]=c,e[Wn.getElementIndex(i,o)]=-c,e}const Kr=new L,MX=new L,RX=new L,xX=new L,OX=new L,LX=new Le,PX={diagonal:new Le,unitary:new Le};function FX(t,e=new _A){if(!t||t.length===0)return e.halfAxes=new Le([0,0,0,0,0,0,0,0,0]),e.center=new L,e;const n=t.length,r=new L(0,0,0);for(const O of t)r.add(O);const s=1/n;r.multiplyByScalar(s);let i=0,o=0,a=0,c=0,l=0,u=0;for(const O of t){const M=Kr.copy(O).subtract(r);i+=M.x*M.x,o+=M.x*M.y,a+=M.x*M.z,c+=M.y*M.y,l+=M.y*M.z,u+=M.z*M.z}i*=s,o*=s,a*=s,c*=s,l*=s,u*=s;const h=LX;h[0]=i,h[1]=o,h[2]=a,h[3]=o,h[4]=c,h[5]=l,h[6]=a,h[7]=l,h[8]=u;const{unitary:f}=bX(h,PX),d=e.halfAxes.copy(f);let m=d.getColumn(0,RX),_=d.getColumn(1,xX),T=d.getColumn(2,OX),p=-Number.MAX_VALUE,A=-Number.MAX_VALUE,y=-Number.MAX_VALUE,C=Number.MAX_VALUE,b=Number.MAX_VALUE,S=Number.MAX_VALUE;for(const O of t)Kr.copy(O),p=Math.max(Kr.dot(m),p),A=Math.max(Kr.dot(_),A),y=Math.max(Kr.dot(T),y),C=Math.min(Kr.dot(m),C),b=Math.min(Kr.dot(_),b),S=Math.min(Kr.dot(T),S);m=m.multiplyByScalar(.5*(C+p)),_=_.multiplyByScalar(.5*(b+A)),T=T.multiplyByScalar(.5*(S+y)),e.center.copy(m).add(_).add(T);const I=MX.set(p-C,A-b,y-S).multiplyByScalar(.5),x=new Le([I[0],0,0,0,I[1],0,0,0,I[2]]);return e.halfAxes.multiplyRight(x),e}let KT=function(t){return t[t.ADD=1]="ADD",t[t.REPLACE=2]="REPLACE",t}({}),ql=function(t){return t.EMPTY="empty",t.SCENEGRAPH="scenegraph",t.POINTCLOUD="pointcloud",t.MESH="mesh",t}({}),DX=function(t){return t.I3S="I3S",t.TILES3D="TILES3D",t}({}),tf=function(t){return t.GEOMETRIC_ERROR="geometricError",t.MAX_SCREEN_THRESHOLD="maxScreenThreshold",t}({});const pI=typeof __VERSION__<"u"?__VERSION__:"latest",ca={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function AI(t,e,n){$e(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),s=new Uint8Array(t,e,n);return r.decode(s)}function NX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=new DataView(t);return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}const UX=typeof __VERSION__<"u"?__VERSION__:"latest",GX={draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},kX={name:"Draco",id:"draco",module:"draco",version:UX,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:GX};function HX(t){switch(t.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}function VX(t){let e=1/0,n=1/0,r=1/0,s=-1/0,i=-1/0,o=-1/0;const a=t.POSITION?t.POSITION.value:[],c=a&&a.length;for(let l=0;l<c;l+=3){const u=a[l],h=a[l+1],f=a[l+2];e=u<e?u:e,n=h<n?h:n,r=f<r?f:r,s=u>s?u:s,i=h>i?h:i,o=f>o?f:o}return[[e,n,r],[s,i,o]]}function jX(t,e,n){const r=HX(e.value),s=n||zX(e);return{name:t,type:{type:"fixed-size-list",listSize:e.size,children:[{name:"value",type:r}]},nullable:!1,metadata:s}}function zX(t){const e={};return"byteOffset"in t&&(e.byteOffset=t.byteOffset.toString(10)),"byteStride"in t&&(e.byteStride=t.byteStride.toString(10)),"normalized"in t&&(e.normalized=t.normalized.toString()),e}function JX(t,e,n){const r=_I(e.metadata),s=[],i=XX(e.attributes);for(const o in t){const a=t[o],c=YT(o,a,i[o]);s.push(c)}if(n){const o=YT("indices",n);s.push(o)}return{fields:s,metadata:r}}function XX(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}function YT(t,e,n){const r=n?_I(n.metadata):void 0;return jX(t,e,r)}function _I(t){Object.entries(t);const e={};for(const n in t)e[`${n}.string`]=JSON.stringify(t[n]);return e}const QT={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},$X={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},WX=4;class KX{constructor(e){this.draco=void 0,this.decoder=void 0,this.metadataQuerier=void 0,this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);const s=this.decoder.GetEncodedGeometryType(r),i=s===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(s){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(r,i);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(r,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!i.ptr){const f=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(f)}const a=this._getDracoLoaderData(i,s,n),c=this._getMeshData(i,a,n),l=VX(c.attributes),u=JX(c.attributes,a,c.indices);return{loader:"draco",loaderData:a,header:{vertexCount:i.num_points(),boundingBox:l},...c,schema:u}}finally{this.draco.destroy(r),i&&this.draco.destroy(i)}}_getDracoLoaderData(e,n,r){const s=this._getTopLevelMetadata(e),i=this._getDracoAttributes(e,r);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:s,attributes:i}}_getDracoAttributes(e,n){const r={};for(let s=0;s<e.num_attributes();s++){const i=this.decoder.GetAttribute(e,s),o=this._getAttributeMetadata(e,s);r[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:s,metadata:o};const a=this._getQuantizationTransform(i,n);a&&(r[i.unique_id()].quantization_transform=a);const c=this._getOctahedronTransform(i,n);c&&(r[i.unique_id()].octahedron_transform=c)}return r}_getMeshData(e,n,r){const s=this._getMeshAttributes(n,e,r);if(!s.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(r.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:s,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:s,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:s}}_getMeshAttributes(e,n,r){const s={};for(const i of Object.values(e.attributes)){const o=this._deduceAttributeName(i,r);i.name=o;const{value:a,size:c}=this._getAttributeValues(n,i);s[o]={value:a,size:c,byteOffset:i.byte_offset,byteStride:i.byte_stride,normalized:i.normalized}}return s}_getTriangleListIndices(e){const r=e.num_faces()*3,s=r*WX,i=this.draco._malloc(s);try{return this.decoder.GetTrianglesUInt32Array(e,s,i),new Uint32Array(this.draco.HEAPF32.buffer,i,r).slice()}finally{this.draco._free(i)}}_getTriangleStripIndices(e){const n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),qX(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){const r=$X[n.data_type],s=n.num_components,o=e.num_points()*s,a=o*r.BYTES_PER_ELEMENT,c=YX(this.draco,r);let l;const u=this.draco._malloc(a);try{const h=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,h,c,a,u),l=new r(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:l,size:s}}_deduceAttributeName(e,n){const r=e.unique_id;for(const[o,a]of Object.entries(n.extraAttributes||{}))if(a===r)return o;const s=e.attribute_type;for(const o in QT)if(this.draco[o]===s)return QT[o];const i=n.attributeNameEntry||"name";return e.metadata[i]?e.metadata[i].string:`CUSTOM_ATTRIBUTE_${r}`}_getTopLevelMetadata(e){const n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){const r=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const n={},r=this.metadataQuerier.NumEntries(e);for(let s=0;s<r;s++){const i=this.metadataQuerier.GetEntryName(e,s);n[i]=this._getDracoMetadataField(e,i)}return n}_getDracoMetadataField(e,n){const r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,r);const s=QX(r);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:s}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){const{quantizedAttributes:n=[],octahedronAttributes:r=[]}=e,s=[...n,...r];for(const i of s)this.decoder.SkipAttributeTransform(this.draco[i])}_getQuantizationTransform(e,n){const{quantizedAttributes:r=[]}=n,s=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(s)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,n){const{octahedronAttributes:r=[]}=n,s=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(s)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}function YX(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function QX(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}function qX(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}const ZX="1.5.6",e$="1.4.1",$d=`https://www.gstatic.com/draco/versioned/decoders/${ZX}`,Tt={DECODER:"draco_wasm_wrapper.js",DECODER_WASM:"draco_decoder.wasm",FALLBACK_DECODER:"draco_decoder.js",ENCODER:"draco_encoder.js"},Wd={[Tt.DECODER]:`${$d}/${Tt.DECODER}`,[Tt.DECODER_WASM]:`${$d}/${Tt.DECODER_WASM}`,[Tt.FALLBACK_DECODER]:`${$d}/${Tt.FALLBACK_DECODER}`,[Tt.ENCODER]:`https://raw.githubusercontent.com/google/draco/${e$}/javascript/${Tt.ENCODER}`};let la;async function t$(t){const e=t.modules||{};return e.draco3d?la=la||e.draco3d.createDecoderModule({}).then(n=>({draco:n})):la=la||n$(t),await la}async function n$(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await Js(Wd[Tt.FALLBACK_DECODER],"draco",t,Tt.FALLBACK_DECODER);break;case"wasm":default:[e,n]=await Promise.all([await Js(Wd[Tt.DECODER],"draco",t,Tt.DECODER),await Js(Wd[Tt.DECODER_WASM],"draco",t,Tt.DECODER_WASM)])}return e=e||globalThis.DracoDecoderModule,await r$(e,n)}function r$(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t({...n,onModuleLoaded:s=>r({draco:s})})})}const yI={...kX,parse:s$};async function s$(t,e){const{draco:n}=await t$(e),r=new KX(n);try{return r.parseSync(t,e==null?void 0:e.draco)}finally{r.destroy()}}const i$={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Ne={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},ne={...i$,...Ne},Kd={[Ne.DOUBLE]:Float64Array,[Ne.FLOAT]:Float32Array,[Ne.UNSIGNED_SHORT]:Uint16Array,[Ne.UNSIGNED_INT]:Uint32Array,[Ne.UNSIGNED_BYTE]:Uint8Array,[Ne.BYTE]:Int8Array,[Ne.SHORT]:Int16Array,[Ne.INT]:Int32Array},o$={DOUBLE:Ne.DOUBLE,FLOAT:Ne.FLOAT,UNSIGNED_SHORT:Ne.UNSIGNED_SHORT,UNSIGNED_INT:Ne.UNSIGNED_INT,UNSIGNED_BYTE:Ne.UNSIGNED_BYTE,BYTE:Ne.BYTE,SHORT:Ne.SHORT,INT:Ne.INT},Yd="Failed to convert GL type";class rr{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const n in Kd)if(Kd[n]===e)return n;throw new Error(Yd)}static fromName(e){const n=o$[e];if(!n)throw new Error(Yd);return n}static getArrayType(e){switch(e){case Ne.UNSIGNED_SHORT_5_6_5:case Ne.UNSIGNED_SHORT_4_4_4_4:case Ne.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const n=Kd[e];if(!n)throw new Error(Yd);return n}}static getByteSize(e){return rr.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return!!rr.getArrayType(e)}static createTypedArray(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0;s===void 0&&(s=(n.byteLength-r)/rr.getByteSize(e));const i=rr.getArrayType(e);return new i(n,r,s)}}function a$(t,e){if(!t)throw new Error(`math.gl assertion failed. ${e}`)}function c$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=t>>11&31,r=t>>5&63,s=t&31;return e[0]=n<<3,e[1]=r<<2,e[2]=s<<3,e}new dA;new L;new dA;new dA;function qT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return O5(t,0,e)/e*2-1}function ZT(t){return t<0?-1:1}function l$(t,e,n,r){if(a$(r),t<0||t>n||e<0||e>n)throw new Error(`x and y must be unsigned normalized integers between 0 and ${n}`);if(r.x=qT(t,n),r.y=qT(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const s=r.x;r.x=(1-Math.abs(r.y))*ZT(s),r.y=(1-Math.abs(s))*ZT(r.y)}return r.normalize()}function u$(t,e,n){return l$(t,e,255,n)}function ev(t){return(t%1+1)%1}class yA{constructor(e,n){this.json=void 0,this.buffer=void 0,this.featuresLength=0,this._cachedTypedArrays={},this.json=e,this.buffer=n}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return!!this.json[e]}getGlobalProperty(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ne.UNSIGNED_INT,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=this.json[e];return s&&Number.isFinite(s.byteOffset)?this._getTypedArrayFromBinary(e,n,r,1,s.byteOffset):s}getPropertyArray(e,n,r){const s=this.json[e];return s&&Number.isFinite(s.byteOffset)?("componentType"in s&&(n=rr.fromName(s.componentType)),this._getTypedArrayFromBinary(e,n,r,this.featuresLength,s.byteOffset)):this._getTypedArrayFromArray(e,n,s)}getProperty(e,n,r,s,i){const o=this.json[e];if(!o)return o;const a=this.getPropertyArray(e,n,r);if(r===1)return a[s];for(let c=0;c<r;++c)i[c]=a[r*s+c];return i}_getTypedArrayFromBinary(e,n,r,s,i){const o=this._cachedTypedArrays;let a=o[e];return a||(a=rr.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+i,s*r),o[e]=a),a}_getTypedArrayFromArray(e,n,r){const s=this._cachedTypedArrays;let i=s[e];return i||(i=rr.createTypedArray(n,r),s[e]=i),i}}const h$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},f$={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},d$={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};function g$(t,e,n,r){const{componentType:s}=t;$e(t.componentType);const i=typeof s=="string"?rr.fromName(s):s,o=h$[t.type],a=f$[t.type],c=d$[t.type];return n+=t.byteOffset,{values:rr.createTypedArray(i,e,n,o*r),type:i,size:o,unpacker:a,packer:c}}const Zn=t=>t!==void 0;function m$(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const s=e.HIERARCHY;return s&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=s,r=s),r?p$(r,n):null}function p$(t,e){let n,r,s;const i=t.instancesLength,o=t.classes;let a=t.classIds,c=t.parentCounts,l=t.parentIds,u=i;Zn(a.byteOffset)&&(a.componentType=defaultValue(a.componentType,GL.UNSIGNED_SHORT),a.type=AttributeType.SCALAR,s=getBinaryAccessor(a),a=s.createArrayBufferView(e.buffer,e.byteOffset+a.byteOffset,i));let h;if(Zn(c))for(Zn(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,s=getBinaryAccessor(c),c=s.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,i)),h=new Uint16Array(i),u=0,n=0;n<i;++n)h[n]=u,u+=c[n];Zn(l)&&Zn(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,s=getBinaryAccessor(l),l=s.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,u));const f=o.length;for(n=0;n<f;++n){const T=o[n].length,p=o[n].instances,A=getBinaryProperties(T,p,e);o[n].instances=combine(A,p)}const d=new Array(f).fill(0),m=new Uint16Array(i);for(n=0;n<i;++n)r=a[n],m[n]=d[r],++d[r];const _={classes:o,classIds:a,classIndexes:m,parentCounts:c,parentIndexes:h,parentIds:l};return y$(_),_}function ua(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?A$(t,e,n):_$(t,e,n)}function A$(t,e,n){const r=t.classIds,s=t.parentCounts,i=t.parentIds,o=t.parentIndexes,a=r.length,c=scratchVisited;c.length=Math.max(c.length,a);const l=++marker,u=scratchStack;for(u.length=0,u.push(e);u.length>0;){if(e=u.pop(),c[e]===l)continue;c[e]=l;const h=n(t,e);if(Zn(h))return h;const f=s[e],d=o[e];for(let m=0;m<f;++m){const _=i[d+m];_!==e&&u.push(_)}}return null}function _$(t,e,n){let r=!0;for(;r;){const s=n(t,e);if(Zn(s))return s;const i=t.parentIds[e];r=i!==e,e=i}throw new Error("traverseHierarchySingleParent")}function y$(t){const n=t.classIds.length;for(let r=0;r<n;++r)EI(t,r,stack)}function EI(t,e,n){const r=t.parentCounts,s=t.parentIds,i=t.parentIndexes,a=t.classIds.length;if(!Zn(s))return;assert(e<a,`Parent index ${e} exceeds the total number of instances: ${a}`),assert(n.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),n.push(e);const c=Zn(r)?r[e]:1,l=Zn(r)?i[e]:e;for(let u=0;u<c;++u){const h=s[l+u];h!==e&&EI(t,h,n)}n.pop(e)}function Et(t){return t!=null}const Zl=(t,e)=>t,E$={HIERARCHY:!0,extensions:!0,extras:!0};class TI{constructor(e,n,r){var s;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.json=void 0,this.binary=void 0,this.featureCount=void 0,this._extensions=void 0,this._properties=void 0,this._binaryProperties=void 0,this._hierarchy=void 0,$e(r>=0),this.json=e||{},this.binary=n,this.featureCount=r,this._extensions=((s=this.json)===null||s===void 0?void 0:s.extensions)||{},this._properties={};for(const o in this.json)E$[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=m$(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,n){if(this._checkBatchId(e),$e(typeof n=="string",n),this._hierarchy){const r=ua(this._hierarchy,e,(s,i)=>{const o=s.classIds[i];return s.classes[o].name===n});return Et(r)}return!1}isExactClass(e,n){return $e(typeof n=="string",n),this.getExactClassName(e)===n}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const n=this._hierarchy.classIds[e];return this._hierarchy.classes[n].name}}hasProperty(e,n){return this._checkBatchId(e),$e(typeof n=="string",n),Et(this._properties[n])||this._hasPropertyInHierarchy(e,n)}getPropertyNames(e,n){this._checkBatchId(e),n=Et(n)?n:[],n.length=0;const r=Object.keys(this._properties);return n.push(...r),this._hierarchy&&this._getPropertyNamesInHierarchy(e,n),n}getProperty(e,n){if(this._checkBatchId(e),$e(typeof n=="string",n),this._binaryProperties){const s=this._binaryProperties[n];if(Et(s))return this._getBinaryProperty(s,e)}const r=this._properties[n];if(Et(r))return Zl(r[e]);if(this._hierarchy){const s=this._getHierarchyProperty(e,n);if(Et(s))return s}}setProperty(e,n,r){const s=this.featureCount;if(this._checkBatchId(e),$e(typeof n=="string",n),this._binaryProperties){const o=this._binaryProperties[n];if(o){this._setBinaryProperty(o,e,r);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,n,r))return;let i=this._properties[n];Et(i)||(this._properties[n]=new Array(s),i=this._properties[n]),i[e]=Zl(r)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,n){return e.unpack(e.typedArray,n)}_setBinaryProperty(e,n,r){e.pack(r,e.typedArray,n)}_initializeBinaryProperties(){let e=null;for(const n in this._properties){const r=this._properties[n],s=this._initializeBinaryProperty(n,r);s&&(e=e||{},e[n]=s)}return e}_initializeBinaryProperty(e,n){if("byteOffset"in n){const r=n;$e(this.binary,`Property ${e} requires a batch table binary.`),$e(r.type,`Property ${e} requires a type.`);const s=g$(r,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:s.values,componentCount:s.size,unpack:s.unpacker,pack:s.packer}}return null}_hasPropertyInHierarchy(e,n){if(!this._hierarchy)return!1;const r=ua(this._hierarchy,e,(s,i)=>{const o=s.classIds[i],a=s.classes[o].instances;return Et(a[n])});return Et(r)}_getPropertyNamesInHierarchy(e,n){ua(this._hierarchy,e,(r,s)=>{const i=r.classIds[s],o=r.classes[i].instances;for(const a in o)o.hasOwnProperty(a)&&n.indexOf(a)===-1&&n.push(a)})}_getHierarchyProperty(e,n){return ua(this._hierarchy,e,(r,s)=>{const i=r.classIds[s],o=r.classes[i],a=r.classIndexes[s],c=o.instances[n];return Et(c)?Et(c.typedArray)?this._getBinaryProperty(c,a):Zl(c[a]):null})}_setHierarchyProperty(e,n,r,s){const i=ua(this._hierarchy,n,(o,a)=>{const c=o.classIds[a],l=o.classes[c],u=o.classIndexes[a],h=l.instances[r];return Et(h)?($e(a===n,`Inherited property "${r}" is read-only.`),Et(h.typedArray)?this._setBinaryProperty(h,u,s):h[u]=Zl(s),!0):!1});return Et(i)}}const Qd=4;function nf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=Qd,t.version=r.getUint32(n,!0),n+=Qd,t.byteLength=r.getUint32(n,!0),n+=Qd,t.version!==1)throw new Error(`3D Tile Version ${t.version} not supported`);return n}const Ci=4,tv="b3dm tile in legacy format.";function EA(t,e,n){const r=new DataView(e);let s;t.header=t.header||{};let i=r.getUint32(n,!0);n+=Ci;let o=r.getUint32(n,!0);n+=Ci;let a=r.getUint32(n,!0);n+=Ci;let c=r.getUint32(n,!0);return n+=Ci,a>=570425344?(n-=Ci*2,s=i,a=o,c=0,i=0,o=0,console.warn(tv)):c>=570425344&&(n-=Ci,s=a,a=i,c=o,i=0,o=0,console.warn(tv)),t.header.featureTableJsonByteLength=i,t.header.featureTableBinaryByteLength=o,t.header.batchTableJsonByteLength=a,t.header.batchTableBinaryByteLength=c,t.header.batchLength=s,n}function TA(t,e,n,r){return n=T$(t,e,n),n=v$(t,e,n),n}function T$(t,e,n,r){const{featureTableJsonByteLength:s,featureTableBinaryByteLength:i,batchLength:o}=t.header||{};if(t.featureTableJson={BATCH_LENGTH:o||0},s&&s>0){const a=AI(e,n,s);t.featureTableJson=JSON.parse(a)}return n+=s||0,t.featureTableBinary=new Uint8Array(e,n,i),n+=i||0,n}function v$(t,e,n,r){const{batchTableJsonByteLength:s,batchTableBinaryByteLength:i}=t.header||{};if(s&&s>0){const o=AI(e,n,s);t.batchTableJson=JSON.parse(o),n+=s,i&&i>0&&(t.batchTableBinary=new Uint8Array(e,n,i),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=i)}return n}function vI(t,e,n){if(!e&&(!t||!t.batchIds||!n))return null;const{batchIds:r,isRGB565:s,pointCount:i=0}=t;if(r&&n){const o=new Uint8ClampedArray(i*3);for(let a=0;a<i;a++){const c=r[a],u=n.getProperty(c,"dimensions").map(h=>h*255);o[a*3]=u[0],o[a*3+1]=u[1],o[a*3+2]=u[2]}return{type:ne.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(e&&s){const o=new Uint8ClampedArray(i*3);for(let a=0;a<i;a++){const c=c$(e[a]);o[a*3]=c[0],o[a*3+1]=c[1],o[a*3+2]=c[2]}return{type:ne.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}return e&&e.length===i*3?{type:ne.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:ne.UNSIGNED_BYTE,value:e||new Uint8ClampedArray,size:4,normalized:!0}}const nv=new L;function C$(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array((t.pointsLength||0)*3);for(let r=0;r<(t.pointsLength||0);r++)u$(e[r*2],e[r*2+1],nv),nv.toArray(n,r*3);return{type:ne.FLOAT,size:2,value:n}}return{type:ne.FLOAT,size:2,value:e}}function B$(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,b$(t,e)):{type:ne.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function b$(t,e){const n=new L,r=new Float32Array(t.pointCount*3);for(let s=0;s<t.pointCount;s++)n.set(e[s*3],e[s*3+1],e[s*3+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,s*3);return r}async function S$(t,e,n,r,s){n=nf(t,e,n),n=EA(t,e,n),n=TA(t,e,n),w$(t);const{featureTable:i,batchTable:o}=I$(t);return await L$(t,i,o,r,s),M$(t,i,r),R$(t,i,o),x$(t,i),n}function w$(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function I$(t){const e=new yA(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",ne.FLOAT,3);const r=O$(t,e);return{featureTable:e,batchTable:r}}function M$(t,e,n){if(t.attributes=t.attributes||{positions:null,colors:null,normals:null,batchIds:null},!t.attributes.positions){if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",ne.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",ne.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",ne.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",ne.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=B$(t,r,n)}}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function R$(t,e,n){if(t.attributes=t.attributes||{positions:null,colors:null,normals:null,batchIds:null},!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",ne.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",ne.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",ne.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=vI(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",ne.UNSIGNED_BYTE,4))}function x$(t,e){if(t.attributes=t.attributes||{positions:null,colors:null,normals:null,batchIds:null},!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",ne.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",ne.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=C$(t,n)}}function O$(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",ne.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:s,batchTableBinary:i}=t;n=new TI(s,i,r)}return n}async function L$(t,e,n,r,s){let i,o,a;const c=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];c&&(a=c.properties);const l=e.getExtension("3DTILES_draco_point_compression");if(l){o=l.properties;const h=l.byteOffset,f=l.byteLength;if(!o||!Number.isFinite(h)||!f)throw new Error("Draco properties, byteOffset, and byteLength must be defined");i=(t.featureTableBinary||[]).slice(h,h+f),t.hasPositions=Number.isFinite(o.POSITION),t.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),t.hasNormals=Number.isFinite(o.NORMAL),t.hasBatchIds=Number.isFinite(o.BATCH_ID),t.isTranslucent=Number.isFinite(o.RGBA)}if(!i)return!0;const u={buffer:i,properties:{...o,...a},featureTableProperties:o,batchTableProperties:a,dequantizeInShader:!1};return await P$(t,u,r,s)}async function P$(t,e,n,r){if(!r)return;const s={...n,draco:{...n==null?void 0:n.draco,extraAttributes:e.batchTableProperties||{}}};delete s["3d-tiles"];const i=await Dc(e.buffer,yI,s,r),o=i.attributes.POSITION&&i.attributes.POSITION.value,a=i.attributes.COLOR_0&&i.attributes.COLOR_0.value,c=i.attributes.NORMAL&&i.attributes.NORMAL.value,l=i.attributes.BATCH_ID&&i.attributes.BATCH_ID.value,u=o&&i.attributes.POSITION.value.quantization,h=c&&i.attributes.NORMAL.value.quantization;if(u){const d=i.POSITION.data.quantization,m=d.range;t.quantizedVolumeScale=new L(m,m,m),t.quantizedVolumeOffset=new L(d.minValues),t.quantizedRange=(1<<d.quantizationBits)-1,t.isQuantizedDraco=!0}h&&(t.octEncodedRange=(1<<i.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const f={};if(e.batchTableProperties)for(const d of Object.keys(e.batchTableProperties))i.attributes[d]&&i.attributes[d].value&&(f[d.toLowerCase()]=i.attributes[d].value);t.attributes={positions:o,colors:vI(t,a,void 0),normals:c,batchIds:l,...f}}const F$=typeof __VERSION__<"u"?__VERSION__:"latest";var qd;const D$=(qd=globalThis.loaders)===null||qd===void 0?void 0:qd.parseImageNode,Km=typeof Image<"u",Ym=typeof ImageBitmap<"u",N$=!!D$,Qm=tI?!0:N$;function U$(t){switch(t){case"auto":return Ym||Km||Qm;case"imagebitmap":return Ym;case"image":return Km;case"data":return Qm;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function G$(){if(Ym)return"imagebitmap";if(Km)return"image";if(Qm)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function k$(t){const e=H$(t);if(!e)throw new Error("Not an image");return e}function CI(t){switch(k$(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function H$(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const V$=/^data:image\/svg\+xml/,j$=/\.svg((\?|#).*)?$/;function vA(t){return t&&(V$.test(t)||j$.test(t))}function z$(t,e){if(vA(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(i){throw new Error(i.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return BI(t,e)}function BI(t,e){if(vA(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function bI(t,e,n){const r=z$(t,n),s=self.URL||self.webkitURL,i=typeof r!="string"&&s.createObjectURL(r);try{return await J$(i||r,e)}finally{i&&s.revokeObjectURL(i)}}async function J$(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,s)=>{try{n.onload=()=>r(n),n.onerror=i=>{const o=i instanceof Error?i.message:"error";s(new Error(o))}}catch(i){s(i)}})}const X$={};let rv=!0;async function $$(t,e,n){let r;vA(n)?r=await bI(t,e,n):r=BI(t,n);const s=e&&e.imagebitmap;return await W$(r,s)}async function W$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((K$(e)||!rv)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),rv=!1}return await createImageBitmap(t)}function K$(t){for(const e in t||X$)return!1;return!0}function Y$(t){return!eW(t,"ftyp",4)||!(t[8]&96)?null:Q$(t)}function Q$(t){switch(q$(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function q$(t,e,n){return String.fromCharCode(...t.slice(e,n))}function Z$(t){return[...t].map(e=>e.charCodeAt(0))}function eW(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=Z$(e);for(let s=0;s<r.length;++s)if(r[s]!==t[s+n])return!1;return!0}const er=!1,ja=!0;function CA(t){const e=Gc(t);return nW(e)||iW(e)||rW(e)||sW(e)||tW(e)}function tW(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=Y$(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function nW(t){const e=Gc(t);return e.byteLength>=24&&e.getUint32(0,er)===2303741511?{mimeType:"image/png",width:e.getUint32(16,er),height:e.getUint32(20,er)}:null}function rW(t){const e=Gc(t);return e.byteLength>=10&&e.getUint32(0,er)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,ja),height:e.getUint16(8,ja)}:null}function sW(t){const e=Gc(t);return e.byteLength>=14&&e.getUint16(0,er)===16973&&e.getUint32(2,ja)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,ja),height:e.getUint32(22,ja)}:null}function iW(t){const e=Gc(t);if(!(e.byteLength>=3&&e.getUint16(0,er)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:s}=oW();let i=2;for(;i+9<e.byteLength;){const o=e.getUint16(i,er);if(s.has(o))return{mimeType:"image/jpeg",height:e.getUint16(i+5,er),width:e.getUint16(i+7,er)};if(!r.has(o))return null;i+=2,i+=e.getUint16(i,er)}return null}function oW(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Gc(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function aW(t,e){var n;const{mimeType:r}=CA(t)||{},s=(n=globalThis.loaders)===null||n===void 0?void 0:n.parseImageNode;return $e(s),await s(t,r)}async function cW(t,e,n){e=e||{};const s=(e.image||{}).type||"auto",{url:i}=n||{},o=lW(s);let a;switch(o){case"imagebitmap":a=await $$(t,e,i);break;case"image":a=await bI(t,e,i);break;case"data":a=await aW(t);break;default:$e(!1)}return s==="data"&&(a=CI(a)),a}function lW(t){switch(t){case"auto":case"data":return G$();default:return U$(t),t}}const uW=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],hW=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],fW={image:{type:"auto",decode:!0}},dW={id:"image",module:"images",name:"Images",version:F$,mimeTypes:hW,extensions:uW,parse:cW,tests:[t=>!!CA(new DataView(t))],options:fW},Zd={};function gW(t){if(Zd[t]===void 0){const e=tI?pW(t):mW(t);Zd[t]=e}return Zd[t]}function mW(t){var e,n;const r=["image/png","image/jpeg","image/gif"],s=((e=globalThis.loaders)===null||e===void 0?void 0:e.imageFormatsNode)||r;return!!((n=globalThis.loaders)===null||n===void 0?void 0:n.parseImageNode)&&s.includes(t)}function pW(t){switch(t){case"image/avif":case"image/webp":return AW(t);default:return!0}}function AW(t){try{return document.createElement("canvas").toDataURL(t).indexOf(`data:${t}`)===0}catch{return!1}}function jt(t,e){if(!t)throw new Error(e||"assert failed: gltf")}const SI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},wI={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},_W=1.33,sv=["SCALAR","VEC2","VEC3","VEC4"],yW=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],EW=new Map(yW),TW={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},vW={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},CW={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function II(t){return sv[t-1]||sv[0]}function BA(t){const e=EW.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function bA(t,e){const n=CW[t.componentType],r=TW[t.type],s=vW[t.componentType],i=t.count*r,o=t.count*r*s;jt(o>=0&&o<=e.byteLength);const a=wI[t.componentType],c=SI[t.type];return{ArrayType:n,length:i,byteLength:o,componentByteSize:a,numberOfComponentsInElement:c}}function MI(t){let{images:e,bufferViews:n}=t;e=e||[],n=n||[];const r=e.map(o=>o.bufferView);n=n.filter(o=>!r.includes(o));const s=n.reduce((o,a)=>o+a.byteLength,0),i=e.reduce((o,a)=>{const{width:c,height:l}=a.image;return o+c*l},0);return s+Math.ceil(4*i*_W)}function BW(t,e,n){const r=t.bufferViews[n];jt(r);const s=r.buffer,i=e[s];jt(i);const o=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,r.byteLength)}function bW(t,e,n){var r,s;const i=typeof n=="number"?(r=t.accessors)===null||r===void 0?void 0:r[n]:n;if(!i)throw new Error(`No gltf accessor ${JSON.stringify(n)}`);const o=(s=t.bufferViews)===null||s===void 0?void 0:s[i.bufferView||0];if(!o)throw new Error(`No gltf buffer view for accessor ${o}`);const{arrayBuffer:a,byteOffset:c}=e[o.buffer],l=(c||0)+(i.byteOffset||0)+(o.byteOffset||0),{ArrayType:u,length:h,componentByteSize:f,numberOfComponentsInElement:d}=bA(i,o),m=f*d,_=o.byteStride||m;if(typeof o.byteStride>"u"||o.byteStride===m)return new u(a,l,h);const T=new u(h);for(let p=0;p<i.count;p++){const A=new u(a,l+p*_,d);T.set(A,p*d)}return T}function SW(){return{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]}}class lt{constructor(e){this.gltf=void 0,this.sourceBuffers=void 0,this.byteLength=void 0,this.gltf={json:(e==null?void 0:e.json)||SW(),buffers:(e==null?void 0:e.buffers)||[],images:(e==null?void 0:e.images)||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}hasExtension(e){const n=this.getUsedExtensions().find(s=>s===e),r=this.getRequiredExtensions().find(s=>s===e);return typeof n=="string"||typeof r=="string"}getExtension(e){const n=this.getUsedExtensions().find(s=>s===e),r=this.json.extensions||{};return n?r[e]:null}getRequiredExtension(e){return this.getRequiredExtensions().find(r=>r===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];if(!r)throw new Error(`glTF file error: Could not find ${e}[${n}]`);return r}getTypedArrayForBufferView(e){e=this.getBufferView(e);const n=e.buffer,r=this.gltf.buffers[n];jt(r);const s=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,s,e.byteLength)}getTypedArrayForAccessor(e){const n=this.getAccessor(e);return bW(this.gltf.json,this.gltf.buffers,n)}getTypedArrayForImageData(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),s=this.getBuffer(n.buffer).data,i=n.byteOffset||0;return new Uint8Array(s,i,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,r){return e.extensions=e.extensions||{},e.extensions[n]=r,this.registerUsedExtension(n),this}setObjectExtension(e,n,r){const s=e.extensions||{};s[n]=r}removeObjectExtension(e,n){const r=(e==null?void 0:e.extensions)||{};if(r[n]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const s=this.json.extensionsRemoved;s.includes(n)||s.push(n)}delete r[n]}addExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return jt(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return jt(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){var n;if((n=this.json.extensions)!==null&&n!==void 0&&n[e]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const r=this.json.extensionsRemoved;r.includes(e)||r.push(e)}this.json.extensions&&delete this.json.extensions[e],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){const{meshIndex:n,matrix:r}=e;this.json.nodes=this.json.nodes||[];const s={mesh:n};return r&&(s.matrix=r),this.json.nodes.push(s),this.json.nodes.length-1}addMesh(e){const{attributes:n,indices:r,material:s,mode:i=4}=e,a={primitives:[{attributes:this._addAttributes(n),mode:i}]};if(r){const c=this._addIndices(r);a.primitives[0].indices=c}return Number.isFinite(s)&&(a.primitives[0].material=s),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const r={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(e,n){const r=CA(e),s=n||(r==null?void 0:r.mimeType),o={bufferView:this.addBufferView(e),mimeType:s};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.byteLength;const s=e.byteLength;jt(Number.isFinite(s)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:n,byteOffset:r,byteLength:s};return this.byteLength+=Uc(s,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,n){const r={bufferView:e,type:II(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3};const r=this.addBufferView(e);let s={min:n.min,max:n.max};(!s.min||!s.max)&&(s=this._getAccessorMinMax(e,n.size));const i={size:n.size,componentType:BA(e),count:Math.round(e.length/n.size),min:s.min,max:s.max};return this.addAccessor(r,Object.assign(i,n))}addTexture(e){const{imageIndex:n}=e,r={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,n;this.gltf.buffers=[];const r=this.byteLength,s=new ArrayBuffer(r),i=new Uint8Array(s);let o=0;for(const a of this.sourceBuffers||[])o=y5(a,i,o);(e=this.json)!==null&&e!==void 0&&(n=e.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=s,this.sourceBuffers=[s]}_removeStringFromArray(e,n){let r=!0;for(;r;){const s=e.indexOf(n);s>-1?e.splice(s,1):r=!1}}_addAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={};for(const r in e){const s=e[r],i=this._getGltfAttributeName(r),o=this.addBinaryBuffer(s.value,s);n[i]=o}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,n){const r={min:null,max:null};if(e.length<n)return r;r.min=[],r.max=[];const s=e.subarray(0,n);for(const i of s)r.min.push(i),r.max.push(i);for(let i=n;i<e.length;i+=n)for(let o=0;o<n;o++)r.min[0+o]=Math.min(r.min[0+o],e[i+o]),r.max[0+o]=Math.max(r.max[0+o],e[i+o]);return r}}const RI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},wW={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},xI={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function SA(t,e){return xI[e]*RI[t]}function rf(t,e,n,r){if(n!=="UINT8"&&n!=="UINT16"&&n!=="UINT32"&&n!=="UINT64")return null;const s=t.getTypedArrayForBufferView(e),i=sf(s,"SCALAR",n,r+1);return i instanceof BigInt64Array||i instanceof BigUint64Array?null:i}function sf(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=RI[e],i=wW[n],o=xI[n],a=r*s,c=a*o;let l=t.buffer,u=t.byteOffset;return u%o!==0&&(l=new Uint8Array(l).slice(u,u+c).buffer,u=0),new i(l,u,a)}function wA(t,e,n){var r,s;const i=`TEXCOORD_${e.texCoord||0}`,o=n.attributes[i],a=t.getTypedArrayForAccessor(o),c=t.gltf.json,l=e.index,u=(r=c.textures)===null||r===void 0||(s=r[l])===null||s===void 0?void 0:s.source;if(typeof u<"u"){var h,f,d;const m=(h=c.images)===null||h===void 0||(f=h[u])===null||f===void 0?void 0:f.mimeType,_=(d=t.gltf.images)===null||d===void 0?void 0:d[u];if(_&&typeof _.width<"u"){const T=[];for(let p=0;p<a.length;p+=2){const A=IW(_,m,a,p,e.channels);T.push(A)}return T}}return[]}function OI(t,e,n,r,s){if(!(n!=null&&n.length))return;const i=[];for(const u of n){let h=r.findIndex(f=>f===u);h===-1&&(h=r.push(u)-1),i.push(h)}const o=new Uint32Array(i),a=t.gltf.buffers.push({arrayBuffer:o.buffer,byteOffset:o.byteOffset,byteLength:o.byteLength})-1,c=t.addBufferView(o,a,0),l=t.addAccessor(c,{size:1,componentType:BA(o),count:o.length});s.attributes[e]=l}function IW(t,e,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[0];const i={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},o=n[r],a=n[r+1];let c=1;e&&(e.indexOf("image/jpeg")!==-1||e.indexOf("image/png")!==-1)&&(c=4);const l=MW(o,a,t,c);let u=0;for(const h of s){const f=typeof h=="number"?Object.values(i)[h]:i[h],d=l+f.offset,m=CI(t);if(m.data.length<=d)throw new Error(`${m.data.length} <= ${d}`);const _=m.data[d];u|=_<<f.shift}return u}function MW(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=n.width,i=ev(t)*(s-1),o=Math.round(i),a=n.height,c=ev(e)*(a-1),l=Math.round(c),u=n.components?n.components:r;return(l*s+o)*u}function LI(t,e,n,r,s){const i=[];for(let o=0;o<e;o++){const a=n[o],c=n[o+1]-n[o];if(c+a>r)break;const l=a/s,u=c/s;i.push(t.slice(l,l+u))}return i}function PI(t,e,n){const r=[];for(let s=0;s<e;s++){const i=s*n;r.push(t.slice(i,i+n))}return r}function FI(t,e,n,r){if(n)throw new Error("Not implemented - arrayOffsets for strings is specified");if(r){const s=[],i=new TextDecoder("utf8");let o=0;for(let a=0;a<t;a++){const c=r[a+1]-r[a];if(c+o<=e.length){const l=e.subarray(o,c+o),u=i.decode(l);s.push(u),o+=c}}return s}return[]}const DI="EXT_mesh_features",RW=DI;async function xW(t,e){const n=new lt(t);OW(n,e)}function OW(t,e){const n=t.gltf.json;if(n.meshes)for(const r of n.meshes)for(const s of r.primitives)LW(t,s,e)}function LW(t,e,n){var r,s;if(!(n!=null&&(r=n.gltf)!==null&&r!==void 0&&r.loadBuffers))return;const i=(s=e.extensions)===null||s===void 0?void 0:s[DI],o=i==null?void 0:i.featureIds;if(o)for(const c of o){var a;let l;if(typeof c.attribute<"u"){const u=`_FEATURE_ID_${c.attribute}`,h=e.attributes[u];l=t.getTypedArrayForAccessor(h)}else typeof c.texture<"u"&&n!==null&&n!==void 0&&(a=n.gltf)!==null&&a!==void 0&&a.loadImages?l=wA(t,c.texture,e):l=[];c.data=l}}const PW=Object.freeze(Object.defineProperty({__proto__:null,decode:xW,name:RW},Symbol.toStringTag,{value:"Module"})),IA="EXT_structural_metadata",FW=IA;async function DW(t,e){const n=new lt(t);NW(n,e)}function NW(t,e){var n,r;if(!((n=e.gltf)!==null&&n!==void 0&&n.loadBuffers))return;const s=t.getExtension(IA);s&&((r=e.gltf)!==null&&r!==void 0&&r.loadImages&&UW(t,s),GW(t,s))}function UW(t,e){const n=e.propertyTextures,r=t.gltf.json;if(n&&r.meshes)for(const s of r.meshes)for(const i of s.primitives)HW(t,n,i,e)}function GW(t,e){const n=e.schema;if(!n)return;const r=n.classes,s=e.propertyTables;if(r&&s)for(const i in r){const o=kW(s,i);o&&jW(t,n,o)}}function kW(t,e){for(const n of t)if(n.class===e)return n;return null}function HW(t,e,n,r){var s;if(!e)return;const i=(s=n.extensions)===null||s===void 0?void 0:s[IA],o=i==null?void 0:i.propertyTextures;if(o)for(const a of o){const c=e[a];VW(t,c,n,r)}}function VW(t,e,n,r){if(!e.properties)return;r.dataAttributeNames||(r.dataAttributeNames=[]);const s=e.class;for(const o in e.properties){var i;const a=`${s}_${o}`,c=(i=e.properties)===null||i===void 0?void 0:i[o];if(!c)continue;c.data||(c.data=[]);const l=c.data,u=wA(t,c,n);u!==null&&(OI(t,a,u,l,n),c.data=l,r.dataAttributeNames.push(a))}}function jW(t,e,n){var r;const s=(r=e.classes)===null||r===void 0?void 0:r[n.class];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);const i=n.count;for(const a in s.properties){var o;const c=s.properties[a],l=(o=n.properties)===null||o===void 0?void 0:o[a];if(l){const u=zW(t,e,c,i,l);l.data=u}}}function zW(t,e,n,r,s){let i=[];const o=s.values,a=t.getTypedArrayForBufferView(o),c=JW(t,n,s,r),l=XW(t,s,r);switch(n.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":{i=$W(n,r,a,c);break}case"BOOLEAN":throw new Error(`Not implemented - classProperty.type=${n.type}`);case"STRING":{i=FI(r,a,c,l);break}case"ENUM":{i=WW(e,n,r,a,c);break}default:throw new Error(`Unknown classProperty type ${n.type}`)}return i}function JW(t,e,n,r){return e.array&&typeof e.count>"u"&&typeof n.arrayOffsets<"u"?rf(t,n.arrayOffsets,n.arrayOffsetType||"UINT32",r):null}function XW(t,e,n){return typeof e.stringOffsets<"u"?rf(t,e.stringOffsets,e.stringOffsetType||"UINT32",n):null}function $W(t,e,n,r){const s=t.array,i=t.count,o=SA(t.type,t.componentType),a=n.byteLength/o;let c;return t.componentType?c=sf(n,t.type,t.componentType,a):c=n,s?r?LI(c,e,r,n.length,o):i?PI(c,e,i):[]:c}function WW(t,e,n,r,s){var i;const o=e.enumType;if(!o)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");const a=(i=t.enums)===null||i===void 0?void 0:i[o];if(!a)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${o}`);const c=a.valueType||"UINT16",l=SA(e.type,c),u=r.byteLength/l;let h=sf(r,e.type,c,u);if(h||(h=r),e.array){if(s)return KW({valuesData:h,numberOfElements:n,arrayOffsets:s,valuesDataBytesLength:r.length,elementSize:l,enumEntry:a});const f=e.count;return f?YW(h,n,f,a):[]}return MA(h,0,n,a)}function KW(t){const{valuesData:e,numberOfElements:n,arrayOffsets:r,valuesDataBytesLength:s,elementSize:i,enumEntry:o}=t,a=[];for(let c=0;c<n;c++){const l=r[c],u=r[c+1]-r[c];if(u+l>s)break;const h=l/i,f=u/i,d=MA(e,h,f,o);a.push(d)}return a}function YW(t,e,n,r){const s=[];for(let i=0;i<e;i++){const o=n*i,a=MA(t,o,n,r);s.push(a)}return s}function MA(t,e,n,r){const s=[];for(let i=0;i<n;i++)if(t instanceof BigInt64Array||t instanceof BigUint64Array)s.push("");else{const o=t[e+i],a=QW(r,o);a?s.push(a.name):s.push("")}return s}function QW(t,e){for(const n of t.values)if(n.value===e)return n;return null}const qW=Object.freeze(Object.defineProperty({__proto__:null,decode:DW,name:FW},Symbol.toStringTag,{value:"Module"})),NI="EXT_feature_metadata",ZW=NI;async function eK(t,e){const n=new lt(t);tK(n,e)}function tK(t,e){var n,r;if(!((n=e.gltf)!==null&&n!==void 0&&n.loadBuffers))return;const s=t.getExtension(NI);s&&((r=e.gltf)!==null&&r!==void 0&&r.loadImages&&nK(t,s),rK(t,s))}function nK(t,e){const n=e.schema;if(!n)return;const r=n.classes,{featureTextures:s}=e;if(r&&s)for(const i in r){const o=r[i],a=iK(s,i);a&&aK(t,a,o)}}function rK(t,e){const n=e.schema;if(!n)return;const r=n.classes,s=e.featureTables;if(r&&s)for(const i in r){const o=sK(s,i);o&&oK(t,n,o)}}function sK(t,e){for(const n in t){const r=t[n];if(r.class===e)return r}return null}function iK(t,e){for(const n in t){const r=t[n];if(r.class===e)return r}return null}function oK(t,e,n){var r;if(!n.class)return;const s=(r=e.classes)===null||r===void 0?void 0:r[n.class];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);const i=n.count;for(const a in s.properties){var o;const c=s.properties[a],l=(o=n.properties)===null||o===void 0?void 0:o[a];if(l){const u=cK(t,e,c,i,l);l.data=u}}}function aK(t,e,n){const r=e.class;for(const i in n.properties){var s;const o=e==null||(s=e.properties)===null||s===void 0?void 0:s[i];if(o){const a=dK(t,o,r);o.data=a}}}function cK(t,e,n,r,s){let i=[];const o=s.bufferView,a=t.getTypedArrayForBufferView(o),c=lK(t,n,s,r),l=uK(t,n,s,r);return n.type==="STRING"||n.componentType==="STRING"?i=FI(r,a,c,l):hK(n)&&(i=fK(n,r,a,c)),i}function lK(t,e,n,r){return e.type==="ARRAY"&&typeof e.componentCount>"u"&&typeof n.arrayOffsetBufferView<"u"?rf(t,n.arrayOffsetBufferView,n.offsetType||"UINT32",r):null}function uK(t,e,n,r){return typeof n.stringOffsetBufferView<"u"?rf(t,n.stringOffsetBufferView,n.offsetType||"UINT32",r):null}function hK(t){const e=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return e.includes(t.type)||typeof t.componentType<"u"&&e.includes(t.componentType)}function fK(t,e,n,r){const s=t.type==="ARRAY",i=t.componentCount,o="SCALAR",a=t.componentType||t.type,c=SA(o,a),l=n.byteLength/c,u=sf(n,o,a,l);return s?r?LI(u,e,r,n.length,c):i?PI(u,e,i):[]:u}function dK(t,e,n){const r=t.gltf.json;if(!r.meshes)return[];const s=[];for(const i of r.meshes)for(const o of i.primitives)gK(t,n,e,s,o);return s}function gK(t,e,n,r,s){const i={channels:n.channels,...n.texture},o=wA(t,i,s);o&&OI(t,e,o,r,s)}const mK=Object.freeze(Object.defineProperty({__proto__:null,decode:eK,name:ZW},Symbol.toStringTag,{value:"Module"})),pK=typeof __VERSION__<"u"?__VERSION__:"latest",AK=typeof __VERSION__<"u"?__VERSION__:"latest",Th={TRANSCODER:"basis_transcoder.js",TRANSCODER_WASM:"basis_transcoder.wasm",ENCODER:"basis_encoder.js",ENCODER_WASM:"basis_encoder.wasm"};let eg;async function iv(t){const e=t.modules||{};return e.basis?e.basis:(eg=eg||_K(t),await eg)}async function _K(t){let e=null,n=null;return[e,n]=await Promise.all([await Js(Th.TRANSCODER,"textures",t),await Js(Th.TRANSCODER_WASM,"textures",t)]),e=e||globalThis.BASIS,await yK(e,n)}function yK(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(s=>{const{BasisFile:i,initializeBasis:o}=s;o(),r({BasisFile:i})})})}let tg;async function ov(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(tg=tg||EK(t),await tg)}async function EK(t){let e=null,n=null;return[e,n]=await Promise.all([await Js(Th.ENCODER,"textures",t),await Js(Th.ENCODER_WASM,"textures",t)]),e=e||globalThis.BASIS,await TK(e,n)}function TK(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(s=>{const{BasisFile:i,KTX2File:o,initializeBasis:a,BasisEncoder:c}=s;a(),r({BasisFile:i,KTX2File:o,BasisEncoder:c})})})}const Bi={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},vK=["","WEBKIT_","MOZ_"],av={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let eu=null;function CK(t){if(!eu){t=t||BK()||void 0,eu=new Set;for(const e of vK)for(const n in av)if(t&&t.getExtension(`${e}${n}`)){const r=av[n];eu.add(r)}}return eu}function BK(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}const Dt=[171,75,84,88,32,50,48,187,13,10,26,10];function bK(t){const e=new Uint8Array(t);return!(e.byteLength<Dt.length||e[0]!==Dt[0]||e[1]!==Dt[1]||e[2]!==Dt[2]||e[3]!==Dt[3]||e[4]!==Dt[4]||e[5]!==Dt[5]||e[6]!==Dt[6]||e[7]!==Dt[7]||e[8]!==Dt[8]||e[9]!==Dt[9]||e[10]!==Dt[10]||e[11]!==Dt[11])}const SK={etc1:{basisFormat:0,compressed:!0,format:Bi.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Bi.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Bi.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Bi.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Bi.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Bi.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function wK(t,e){if(e.basis.containerFormat==="auto"){if(bK(t)){const r=await ov(e);return cv(r.KTX2File,t,e)}const{BasisFile:n}=await iv(e);return ng(n,t,e)}switch(e.basis.module){case"encoder":const n=await ov(e);switch(e.basis.containerFormat){case"ktx2":return cv(n.KTX2File,t,e);case"basis":default:return ng(n.BasisFile,t,e)}case"transcoder":default:const{BasisFile:r}=await iv(e);return ng(r,t,e)}}function ng(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const s=r.getNumImages(),i=[];for(let o=0;o<s;o++){const a=r.getNumLevels(o),c=[];for(let l=0;l<a;l++)c.push(IK(r,o,l,n));i.push(c)}return i}finally{r.close(),r.delete()}}function IK(t,e,n,r){const s=t.getImageWidth(e,n),i=t.getImageHeight(e,n),o=t.getHasAlpha(),{compressed:a,format:c,basisFormat:l}=UI(r,o),u=t.getImageTranscodedSizeInBytes(e,n,l),h=new Uint8Array(u);if(!t.transcodeImage(h,e,n,l,0,0))throw new Error("failed to start Basis transcoding");return{width:s,height:i,data:h,compressed:a,format:c,hasAlpha:o}}function cv(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const s=r.getLevels(),i=[];for(let o=0;o<s;o++){i.push(MK(r,o,n));break}return[i]}finally{r.close(),r.delete()}}function MK(t,e,n){const{alphaFlag:r,height:s,width:i}=t.getImageLevelInfo(e,0,0),{compressed:o,format:a,basisFormat:c}=UI(n,r),l=t.getImageTranscodedSizeInBytes(e,0,0,c),u=new Uint8Array(l);if(!t.transcodeImage(u,e,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:i,height:s,data:u,compressed:o,levelSize:l,hasAlpha:r,format:a}}function UI(t,e){let n=t&&t.basis&&t.basis.format;return n==="auto"&&(n=GI()),typeof n=="object"&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),SK[n]}function GI(){const t=CK();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}const RK={name:"Basis",id:"basis",module:"textures",version:AK,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},xK={...RK,parse:wK},vo=!0,lv=1735152710,RA=12,vh=8,OK=1313821514,LK=5130562,PK=0,FK=0,DK=1;function NK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}function UK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=new DataView(t),{magic:s=lv}=n,i=r.getUint32(e,!1);return i===s||i===lv}function GK(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=new DataView(e),s=NK(r,n+0),i=r.getUint32(n+4,vo),o=r.getUint32(n+8,vo);switch(Object.assign(t,{header:{byteOffset:n,byteLength:o,hasBinChunk:!1},type:s,version:i,json:{},binChunks:[]}),n+=RA,t.version){case 1:return kK(t,r,n);case 2:return HK(t,r,n,{});default:throw new Error(`Invalid GLB version ${t.version}. Only supports version 1 and 2.`)}}function kK(t,e,n){$e(t.header.byteLength>RA+vh);const r=e.getUint32(n+0,vo),s=e.getUint32(n+4,vo);return n+=vh,$e(s===PK),qm(t,e,n,r),n+=r,n+=Zm(t,e,n,t.header.byteLength),n}function HK(t,e,n,r){return $e(t.header.byteLength>RA+vh),VK(t,e,n,r),n+t.header.byteLength}function VK(t,e,n,r){for(;n+8<=t.header.byteLength;){const s=e.getUint32(n+0,vo),i=e.getUint32(n+4,vo);switch(n+=vh,i){case OK:qm(t,e,n,s);break;case LK:Zm(t,e,n,s);break;case FK:r.strict||qm(t,e,n,s);break;case DK:r.strict||Zm(t,e,n,s);break}n+=Uc(s,4)}return n}function qm(t,e,n,r){const s=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(s);return t.json=JSON.parse(o),Uc(r,4)}function Zm(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),Uc(r,4)}function kI(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const r=e.baseUri||e.uri;if(!r)throw new Error(`'baseUri' must be provided to resolve relative url ${t}`);return r.substr(0,r.lastIndexOf("/")+1)+t}const jK="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",zK="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",JK=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),XK=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),$K={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},WK={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function KK(t,e,n,r,s){let i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE";const o=await YK();ZK(o,o.exports[WK[s]],t,e,n,r,o.exports[$K[i||"NONE"]])}let rg;async function YK(){return rg||(rg=QK()),rg}async function QK(){let t=jK;WebAssembly.validate(JK)&&(t=zK,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(qK(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function qK(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;++r){const s=t.charCodeAt(r);e[r]=s>96?s-71:s>64?s-65:s>47?s+4:s>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?XK[e[r]]:(e[r]-60)*64+e[++r];return e.buffer.slice(0,n)}function ZK(t,e,n,r,s,i,o){const a=t.exports.sbrk,c=r+3&-4,l=a(c*s),u=a(i.length),h=new Uint8Array(t.exports.memory.buffer);h.set(i,u);const f=e(l,r,s,u,i.length);if(f===0&&o&&o(l,c,s),n.set(h.subarray(l,l+r*s)),a(l-a(0)),f!==0)throw new Error(`Malformed buffer data: ${f}`)}const Ch="EXT_meshopt_compression",eY=Ch;async function tY(t,e){var n,r;const s=new lt(t);if(!(e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes)||!((r=e.gltf)!==null&&r!==void 0&&r.loadBuffers))return;const i=[];for(const o of t.json.bufferViews||[])i.push(nY(s,o));await Promise.all(i),s.removeExtension(Ch)}async function nY(t,e){const n=t.getObjectExtension(e,Ch);if(n){const{byteOffset:r=0,byteLength:s=0,byteStride:i,count:o,mode:a,filter:c="NONE",buffer:l}=n,u=t.gltf.buffers[l],h=new Uint8Array(u.arrayBuffer,u.byteOffset+r,s),f=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);await KK(f,o,i,h,a,c),t.removeObjectExtension(e,Ch)}}const rY=Object.freeze(Object.defineProperty({__proto__:null,decode:tY,name:eY},Symbol.toStringTag,{value:"Module"})),Mi="EXT_texture_webp",sY=Mi;function iY(t,e){const n=new lt(t);if(!gW("image/webp")){if(n.getRequiredExtensions().includes(Mi))throw new Error(`gltf: Required extension ${Mi} not supported by browser`);return}const{json:r}=n;for(const s of r.textures||[]){const i=n.getObjectExtension(s,Mi);i&&(s.source=i.source),n.removeObjectExtension(s,Mi)}n.removeExtension(Mi)}const oY=Object.freeze(Object.defineProperty({__proto__:null,name:sY,preprocess:iY},Symbol.toStringTag,{value:"Module"})),Ru="KHR_texture_basisu",aY=Ru;function cY(t,e){const n=new lt(t),{json:r}=n;for(const s of r.textures||[]){const i=n.getObjectExtension(s,Ru);i&&(s.source=i.source,n.removeObjectExtension(s,Ru))}n.removeExtension(Ru)}const lY=Object.freeze(Object.defineProperty({__proto__:null,name:aY,preprocess:cY},Symbol.toStringTag,{value:"Module"}));function uY(t){const e={};for(const n in t){const r=t[n];if(n!=="indices"){const s=HI(r);e[n]=s}}return e}function HI(t){const{buffer:e,size:n,count:r}=hY(t);return{value:e,size:n,byteOffset:0,count:r,type:II(n),componentType:BA(e)}}function hY(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=fY(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}function fY(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?Array.isArray(t)?new e(t):n&&!(t instanceof e)?new e(t):t:null}const _s="KHR_draco_mesh_compression",dY=_s;function gY(t,e,n){const r=new lt(t);for(const s of VI(r))r.getObjectExtension(s,_s)}async function mY(t,e,n){var r;if(!(e!=null&&(r=e.gltf)!==null&&r!==void 0&&r.decompressMeshes))return;const s=new lt(t),i=[];for(const o of VI(s))s.getObjectExtension(o,_s)&&i.push(AY(s,o,e,n));await Promise.all(i),s.removeExtension(_s)}function pY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new lt(t);for(const r of n.json.meshes||[])_Y(r,e),n.addRequiredExtension(_s)}async function AY(t,e,n,r){const s=t.getObjectExtension(e,_s);if(!s)return;const i=t.getTypedArrayForBufferView(s.bufferView),o=lA(i.buffer,i.byteOffset),a={...n};delete a["3d-tiles"];const c=await Dc(o,yI,a,r),l=uY(c.attributes);for(const[u,h]of Object.entries(l))if(u in e.attributes){const f=e.attributes[u],d=t.getAccessor(f);d!=null&&d.min&&d!==null&&d!==void 0&&d.max&&(h.min=d.min,h.max=d.max)}e.attributes=l,c.indices&&(e.indices=HI(c.indices)),t.removeObjectExtension(e,_s),yY(e)}function _Y(t,e){var n;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!s.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=s.DracoWriter.encodeSync({attributes:t}),a=i==null||(n=i.parseSync)===null||n===void 0?void 0:n.call(i,{attributes:t}),c=s._addFauxAttributes(a.attributes),l=s.addBufferView(o);return{primitives:[{attributes:c,mode:r,extensions:{[_s]:{bufferView:l,attributes:c}}}]}}function yY(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*VI(t){for(const e of t.json.meshes||[])for(const n of e.primitives)yield n}const EY=Object.freeze(Object.defineProperty({__proto__:null,decode:mY,encode:pY,name:dY,preprocess:gY},Symbol.toStringTag,{value:"Module"})),xA="KHR_texture_transform",TY=xA,tu=new L,vY=new Le,CY=new Le;async function BY(t,e){var n;if(!new lt(t).hasExtension(xA)||!((n=e.gltf)!==null&&n!==void 0&&n.loadBuffers))return;const i=t.json.materials||[];for(let o=0;o<i.length;o++)bY(o,t)}function bY(t,e){var n,r,s;const i=[],o=(n=e.json.materials)===null||n===void 0?void 0:n[t],a=o==null||(r=o.pbrMetallicRoughness)===null||r===void 0?void 0:r.baseColorTexture;a&&ha(e,t,a,i);const c=o==null?void 0:o.emissiveTexture;c&&ha(e,t,c,i);const l=o==null?void 0:o.normalTexture;l&&ha(e,t,l,i);const u=o==null?void 0:o.occlusionTexture;u&&ha(e,t,u,i);const h=o==null||(s=o.pbrMetallicRoughness)===null||s===void 0?void 0:s.metallicRoughnessTexture;h&&ha(e,t,h,i)}function ha(t,e,n,r){const s=SY(n,r);if(!s)return;const i=t.json.meshes||[];for(const o of i)for(const a of o.primitives){const c=a.material;Number.isFinite(c)&&e===c&&wY(t,a,s)}}function SY(t,e){var n;const r=(n=t.extensions)===null||n===void 0?void 0:n[xA],{texCoord:s=0}=t,{texCoord:i=s}=r;if(!(e.findIndex(a=>{let[c,l]=a;return c===s&&l===i})!==-1)){const a=RY(r);return s!==i&&(t.texCoord=i),e.push([s,i]),{originalTexCoord:s,texCoord:i,matrix:a}}return null}function wY(t,e,n){const{originalTexCoord:r,texCoord:s,matrix:i}=n,o=e.attributes[`TEXCOORD_${r}`];if(Number.isFinite(o)){var a;const l=(a=t.json.accessors)===null||a===void 0?void 0:a[o];if(l&&l.bufferView){var c;const u=(c=t.json.bufferViews)===null||c===void 0?void 0:c[l.bufferView];if(u){const{arrayBuffer:h,byteOffset:f}=t.buffers[u.buffer],d=(f||0)+(l.byteOffset||0)+(u.byteOffset||0),{ArrayType:m,length:_}=bA(l,u),T=wI[l.componentType],p=SI[l.type],A=u.byteStride||T*p,y=new Float32Array(_);for(let C=0;C<l.count;C++){const b=new m(h,d+C*A,2);tu.set(b[0],b[1],1),tu.transformByMatrix3(i),y.set([tu[0],tu[1]],C*p)}r===s?IY(l,u,t.buffers,y):MY(s,l,e,t,y)}}}}function IY(t,e,n,r){t.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),e.buffer=n.length-1,e.byteLength=r.buffer.byteLength,e.byteOffset=0,delete e.byteStride}function MY(t,e,n,r,s){r.buffers.push({arrayBuffer:s.buffer,byteOffset:0,byteLength:s.buffer.byteLength});const i=r.json.bufferViews;if(!i)return;i.push({buffer:r.buffers.length-1,byteLength:s.buffer.byteLength,byteOffset:0});const o=r.json.accessors;o&&(o.push({bufferView:(i==null?void 0:i.length)-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),n.attributes[`TEXCOORD_${t}`]=o.length-1)}function RY(t){const{offset:e=[0,0],rotation:n=0,scale:r=[1,1]}=t,s=new Le().set(1,0,0,0,1,0,e[0],e[1],1),i=vY.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),o=CY.set(r[0],0,0,0,r[1],0,0,0,1);return s.multiplyRight(i).multiplyRight(o)}const xY=Object.freeze(Object.defineProperty({__proto__:null,decode:BY,name:TY},Symbol.toStringTag,{value:"Module"})),Gs="KHR_lights_punctual",OY=Gs;async function LY(t){const e=new lt(t),{json:n}=e,r=e.getExtension(Gs);r&&(e.json.lights=r.lights,e.removeExtension(Gs));for(const s of n.nodes||[]){const i=e.getObjectExtension(s,Gs);i&&(s.light=i.light),e.removeObjectExtension(s,Gs)}}async function PY(t){const e=new lt(t),{json:n}=e;if(n.lights){const r=e.addExtension(Gs);jt(!r.lights),r.lights=n.lights,delete n.lights}if(e.json.lights){for(const r of e.json.lights){const s=r.node;e.addObjectExtension(s,Gs,r)}delete e.json.lights}}const FY=Object.freeze(Object.defineProperty({__proto__:null,decode:LY,encode:PY,name:OY},Symbol.toStringTag,{value:"Module"})),_c="KHR_materials_unlit",DY=_c;async function NY(t){const e=new lt(t),{json:n}=e;for(const r of n.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,_c);e.removeExtension(_c)}function UY(t){const e=new lt(t),{json:n}=e;if(e.materials)for(const r of n.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,_c,{}),e.addExtension(_c))}const GY=Object.freeze(Object.defineProperty({__proto__:null,decode:NY,encode:UY,name:DY},Symbol.toStringTag,{value:"Module"})),Ca="KHR_techniques_webgl",kY=Ca;async function HY(t){const e=new lt(t),{json:n}=e,r=e.getExtension(Ca);if(r){const s=jY(r,e);for(const i of n.materials||[]){const o=e.getObjectExtension(i,Ca);o&&(i.technique=Object.assign({},o,s[o.technique]),i.technique.values=zY(i.technique,e)),e.removeObjectExtension(i,Ca)}e.removeExtension(Ca)}}async function VY(t,e){}function jY(t,e){const{programs:n=[],shaders:r=[],techniques:s=[]}=t,i=new TextDecoder;return r.forEach(o=>{if(Number.isFinite(o.bufferView))o.code=i.decode(e.getTypedArrayForBufferView(o.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(o=>{o.fragmentShader=r[o.fragmentShader],o.vertexShader=r[o.vertexShader]}),s.forEach(o=>{o.program=n[o.program]}),s}function zY(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(r=>{t.uniforms[r].value&&!(r in n)&&(n[r]=t.uniforms[r].value)}),Object.keys(n).forEach(r=>{typeof n[r]=="object"&&n[r].index!==void 0&&(n[r].texture=e.getTexture(n[r].index))}),n}const JY=Object.freeze(Object.defineProperty({__proto__:null,decode:HY,encode:VY,name:kY},Symbol.toStringTag,{value:"Module"})),jI=[qW,PW,rY,oY,lY,EY,FY,GY,JY,xY,mK];function XY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=jI.filter(i=>zI(i.name,e));for(const i of r){var s;(s=i.preprocess)===null||s===void 0||s.call(i,t,e,n)}}async function $Y(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=jI.filter(i=>zI(i.name,e));for(const i of r){var s;await((s=i.decode)===null||s===void 0?void 0:s.call(i,t,e,n))}}function zI(t,e){var n;const r=(e==null||(n=e.gltf)===null||n===void 0?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}const sg="KHR_binary_glTF";function WY(t){const e=new lt(t),{json:n}=e;for(const r of n.images||[]){const s=e.getObjectExtension(r,sg);s&&Object.assign(r,s),e.removeObjectExtension(r,sg)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(sg)}const uv={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},KY={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class YY{constructor(){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}},this.json=void 0}normalize(e,n){this.json=e.json;const r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn(`glTF: Unknown version ${r.asset.version}`);return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),WY(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const n in uv)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){const r=e[n];if(!(!r||Array.isArray(r))){e[n]=[];for(const s in r){const i=r[s];i.id=i.id||s;const o=e[n].length;e[n].push(i),this.idToIndexMap[n][s]=o}}}_convertObjectIdsToArrayIndices(e){for(const n in uv)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const n of e.textures)this._convertTextureIds(n);for(const n of e.meshes)this._convertMeshIds(n);for(const n of e.nodes)this._convertNodeIds(n);for(const n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const n of e.primitives){const{attributes:r,indices:s,material:i}=n;for(const o in r)r[o]=this._convertIdToIndex(r[o],"accessor");s&&(n.indices=this._convertIdToIndex(s,"accessor")),i&&(n.material=this._convertIdToIndex(i,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,"node"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(e,n){e[n]||(console.warn(`gltf v1: json doesn't contain attribute ${n}`),e[n]=[]);for(const r of e[n])for(const s in r){const i=r[s],o=this._convertIdToIndex(i,s);r[s]=o}}_convertIdToIndex(e,n){const r=KY[n];if(r in this.idToIndexMap){const s=this.idToIndexMap[r][e];if(!Number.isFinite(s))throw new Error(`gltf v1: failed to resolve ${n} with id ${e}`);return s}return e}_updateObjects(e){for(const n of this.json.buffers)delete n.type}_updateMaterial(e){for(const i of e.materials){var n,r,s;i.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const o=((n=i.values)===null||n===void 0?void 0:n.tex)||((r=i.values)===null||r===void 0?void 0:r.texture2d_0)||((s=i.values)===null||s===void 0?void 0:s.diffuseTex),a=e.textures.findIndex(c=>c.id===o);a!==-1&&(i.pbrMetallicRoughness.baseColorTexture={index:a})}}}function QY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new YY().normalize(t,e)}async function qY(t,e){var n,r,s;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return ZY(t,e,i,o),QY(t,{normalize:o==null||(n=o.gltf)===null||n===void 0?void 0:n.normalize}),XY(t,o,a),o!=null&&(r=o.gltf)!==null&&r!==void 0&&r.loadBuffers&&t.json.buffers&&await e7(t,o,a),o!=null&&(s=o.gltf)!==null&&s!==void 0&&s.loadImages&&await t7(t,o,a),await $Y(t,o,a),t}function ZY(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!UK(e,n,r)&&(e=new TextDecoder().decode(e)),typeof e=="string")t.json=_5(e);else if(e instanceof ArrayBuffer){const o={};n=GK(o,e,n,r.glb),jt(o.type==="glTF",`Invalid GLB magic string ${o.type}`),t._glb=o,t.json=o.json}else jt(!1,"GLTF: must be ArrayBuffer or string");const s=t.json.buffers||[];if(t.buffers=new Array(s.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:o}=t._glb;t.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}const i=t.json.images||[];t.images=new Array(i.length).fill({})}async function e7(t,e,n){const r=t.json.buffers||[];for(let o=0;o<r.length;++o){const a=r[o];if(a.uri){var s,i;const{fetch:c}=n;jt(c);const l=kI(a.uri,e),u=await(n==null||(s=n.fetch)===null||s===void 0?void 0:s.call(n,l)),h=await(u==null||(i=u.arrayBuffer)===null||i===void 0?void 0:i.call(u));t.buffers[o]={arrayBuffer:h,byteOffset:0,byteLength:h.byteLength},delete a.uri}else t.buffers[o]===null&&(t.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}async function t7(t,e,n){const r=n7(t),s=t.json.images||[],i=[];for(const o of r)i.push(r7(t,s[o],o,e,n));return await Promise.all(i)}function n7(t){const e=new Set,n=t.json.textures||[];for(const r of n)r.source!==void 0&&e.add(r.source);return Array.from(e).sort()}async function r7(t,e,n,r,s){let i;if(e.uri&&!e.hasOwnProperty("bufferView")){const a=kI(e.uri,r),{fetch:c}=s;i=await(await c(a)).arrayBuffer(),e.bufferView={data:i}}if(Number.isFinite(e.bufferView)){const a=BW(t.json,t.buffers,e.bufferView);i=lA(a.buffer,a.byteOffset,a.byteLength)}jt(i,"glTF image has no data");let o=await Dc(i,[dW,xK],{...r,mimeType:e.mimeType,basis:r.basis||{format:GI()}},s);o&&o[0]&&(o={compressed:!0,mipmaps:!1,width:o[0].width,height:o[0].height,data:o[0]}),t.images=t.images||[],t.images[n]=o}const Bh={name:"glTF",id:"gltf",module:"gltf",version:pK,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:s7,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}};async function s7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;e={...Bh.options,...e},e.gltf={...Bh.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await qY({},t,r,e,n)}const i7={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},o7={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},nn={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},a7={magFilter:nn.TEXTURE_MAG_FILTER,minFilter:nn.TEXTURE_MIN_FILTER,wrapS:nn.TEXTURE_WRAP_S,wrapT:nn.TEXTURE_WRAP_T},c7={[nn.TEXTURE_MAG_FILTER]:nn.LINEAR,[nn.TEXTURE_MIN_FILTER]:nn.NEAREST_MIPMAP_LINEAR,[nn.TEXTURE_WRAP_S]:nn.REPEAT,[nn.TEXTURE_WRAP_T]:nn.REPEAT};function l7(){return{id:"default-sampler",parameters:c7}}function u7(t){return o7[t]}function h7(t){return i7[t]}class f7{constructor(){this.baseUri="",this.jsonUnprocessed=void 0,this.json=void 0,this.buffers=[],this.images=[]}postProcess(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{json:r,buffers:s=[],images:i=[]}=e,{baseUri:o=""}=e;return jt(r),this.baseUri=o,this.buffers=s,this.images=i,this.jsonUnprocessed=r,this.json=this._resolveTree(e.json,n),this.json}_resolveTree(e){const n={...e};return this.json=n,e.bufferViews&&(n.bufferViews=e.bufferViews.map((r,s)=>this._resolveBufferView(r,s))),e.images&&(n.images=e.images.map((r,s)=>this._resolveImage(r,s))),e.samplers&&(n.samplers=e.samplers.map((r,s)=>this._resolveSampler(r,s))),e.textures&&(n.textures=e.textures.map((r,s)=>this._resolveTexture(r,s))),e.accessors&&(n.accessors=e.accessors.map((r,s)=>this._resolveAccessor(r,s))),e.materials&&(n.materials=e.materials.map((r,s)=>this._resolveMaterial(r,s))),e.meshes&&(n.meshes=e.meshes.map((r,s)=>this._resolveMesh(r,s))),e.nodes&&(n.nodes=e.nodes.map((r,s)=>this._resolveNode(r,s)),n.nodes=n.nodes.map((r,s)=>this._resolveNodeChildren(r))),e.skins&&(n.skins=e.skins.map((r,s)=>this._resolveSkin(r,s))),e.scenes&&(n.scenes=e.scenes.map((r,s)=>this._resolveScene(r,s))),typeof this.json.scene=="number"&&n.scenes&&(n.scene=n.scenes[this.json.scene]),n}getScene(e){return this._get(this.json.scenes,e)}getNode(e){return this._get(this.json.nodes,e)}getSkin(e){return this._get(this.json.skins,e)}getMesh(e){return this._get(this.json.meshes,e)}getMaterial(e){return this._get(this.json.materials,e)}getAccessor(e){return this._get(this.json.accessors,e)}getCamera(e){return this._get(this.json.cameras,e)}getTexture(e){return this._get(this.json.textures,e)}getSampler(e){return this._get(this.json.samplers,e)}getImage(e){return this._get(this.json.images,e)}getBufferView(e){return this._get(this.json.bufferViews,e)}getBuffer(e){return this._get(this.json.buffers,e)}_get(e,n){if(typeof n=="object")return n;const r=e&&e[n];return r||console.warn(`glTF file error: Could not find ${e}[${n}]`),r}_resolveScene(e,n){return{...e,id:e.id||`scene-${n}`,nodes:(e.nodes||[]).map(r=>this.getNode(r))}}_resolveNode(e,n){const r={...e,id:(e==null?void 0:e.id)||`node-${n}`};return e.mesh!==void 0&&(r.mesh=this.getMesh(e.mesh)),e.camera!==void 0&&(r.camera=this.getCamera(e.camera)),e.skin!==void 0&&(r.skin=this.getSkin(e.skin)),e.meshes!==void 0&&e.meshes.length&&(r.mesh=e.meshes.reduce((s,i)=>{const o=this.getMesh(i);return s.id=o.id,s.primitives=s.primitives.concat(o.primitives),s},{primitives:[]})),r}_resolveNodeChildren(e){return e.children&&(e.children=e.children.map(n=>this.getNode(n))),e}_resolveSkin(e,n){const r=typeof e.inverseBindMatrices=="number"?this.getAccessor(e.inverseBindMatrices):void 0;return{...e,id:e.id||`skin-${n}`,inverseBindMatrices:r}}_resolveMesh(e,n){const r={...e,id:e.id||`mesh-${n}`,primitives:[]};return e.primitives&&(r.primitives=e.primitives.map(s=>{const i={...s,attributes:{},indices:void 0,material:void 0},o=s.attributes;for(const a in o)i.attributes[a]=this.getAccessor(o[a]);return s.indices!==void 0&&(i.indices=this.getAccessor(s.indices)),s.material!==void 0&&(i.material=this.getMaterial(s.material)),i})),r}_resolveMaterial(e,n){const r={...e,id:e.id||`material-${n}`};if(r.normalTexture&&(r.normalTexture={...r.normalTexture},r.normalTexture.texture=this.getTexture(r.normalTexture.index)),r.occlusionTexture&&(r.occlusionTexture={...r.occlusionTexture},r.occlusionTexture.texture=this.getTexture(r.occlusionTexture.index)),r.emissiveTexture&&(r.emissiveTexture={...r.emissiveTexture},r.emissiveTexture.texture=this.getTexture(r.emissiveTexture.index)),r.emissiveFactor||(r.emissiveFactor=r.emissiveTexture?[1,1,1]:[0,0,0]),r.pbrMetallicRoughness){r.pbrMetallicRoughness={...r.pbrMetallicRoughness};const s=r.pbrMetallicRoughness;s.baseColorTexture&&(s.baseColorTexture={...s.baseColorTexture},s.baseColorTexture.texture=this.getTexture(s.baseColorTexture.index)),s.metallicRoughnessTexture&&(s.metallicRoughnessTexture={...s.metallicRoughnessTexture},s.metallicRoughnessTexture.texture=this.getTexture(s.metallicRoughnessTexture.index))}return r}_resolveAccessor(e,n){const r=u7(e.componentType),s=h7(e.type),i=r*s,o={...e,id:e.id||`accessor-${n}`,bytesPerComponent:r,components:s,bytesPerElement:i,value:void 0,bufferView:void 0,sparse:void 0};if(e.bufferView!==void 0&&(o.bufferView=this.getBufferView(e.bufferView)),o.bufferView){const a=o.bufferView.buffer,{ArrayType:c,byteLength:l}=bA(o,o.bufferView),u=(o.bufferView.byteOffset||0)+(o.byteOffset||0)+a.byteOffset;let h=a.arrayBuffer.slice(u,u+l);o.bufferView.byteStride&&(h=this._getValueFromInterleavedBuffer(a,u,o.bufferView.byteStride,o.bytesPerElement,o.count)),o.value=new c(h)}return o}_getValueFromInterleavedBuffer(e,n,r,s,i){const o=new Uint8Array(i*s);for(let a=0;a<i;a++){const c=n+a*r;o.set(new Uint8Array(e.arrayBuffer.slice(c,c+s)),a*s)}return o.buffer}_resolveTexture(e,n){return{...e,id:e.id||`texture-${n}`,sampler:typeof e.sampler=="number"?this.getSampler(e.sampler):l7(),source:typeof e.source=="number"?this.getImage(e.source):void 0}}_resolveSampler(e,n){const r={id:e.id||`sampler-${n}`,...e,parameters:{}};for(const s in r){const i=this._enumSamplerParameter(s);i!==void 0&&(r.parameters[i]=r[s])}return r}_enumSamplerParameter(e){return a7[e]}_resolveImage(e,n){const r={...e,id:e.id||`image-${n}`,image:null,bufferView:e.bufferView!==void 0?this.getBufferView(e.bufferView):void 0},s=this.images[n];return s&&(r.image=s),r}_resolveBufferView(e,n){const r=e.buffer,s=this.buffers[r].arrayBuffer;let i=this.buffers[r].byteOffset||0;return e.byteOffset&&(i+=e.byteOffset),{id:`bufferView-${n}`,...e,buffer:this.buffers[r],data:new Uint8Array(s,i,e.byteLength)}}_resolveCamera(e,n){const r={...e,id:e.id||`camera-${n}`};return r.perspective,r.orthographic,r}}function JI(t,e){return new f7().postProcess(t,e)}const ep={URI:0,EMBEDDED:1};function XI(t,e,n,r){t.rotateYtoZ=!0;const s=(t.byteOffset||0)+(t.byteLength||0)-n;if(s===0)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r!=null&&r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=lA(e,n,s),t.gltfByteOffset=0,t.gltfByteLength=s,n%4===0||console.warn(`${t.type}: embedded glb is not aligned to a 4-byte boundary.`),(t.byteOffset||0)+(t.byteLength||0)}async function $I(t,e,n,r){const s=(n==null?void 0:n["3d-tiles"])||{};if(d7(t,e),s.loadGLTF){if(!r)return;if(t.gltfUrl){const{fetch:i}=r,o=await i(t.gltfUrl,n);t.gltfArrayBuffer=await o.arrayBuffer(),t.gltfByteOffset=0}if(t.gltfArrayBuffer){const i=await Dc(t.gltfArrayBuffer,Bh,n,r);t.gltf=JI(i),t.gpuMemoryUsageInBytes=MI(t.gltf),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength}}}function d7(t,e,n){switch(e){case ep.URI:if(t.gltfArrayBuffer){const r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),i=new TextDecoder().decode(r);t.gltfUrl=i.replace(/[\s\0]+$/,"")}delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case ep.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function g7(t,e,n,r,s){var i;n=m7(t,e,n,r),await $I(t,ep.EMBEDDED,r,s);const o=t==null||(i=t.gltf)===null||i===void 0?void 0:i.extensions;return o&&o.CESIUM_RTC&&(t.rtcCenter=o.CESIUM_RTC.center),n}function m7(t,e,n,r,s){n=nf(t,e,n),n=EA(t,e,n),n=TA(t,e,n),n=XI(t,e,n,r);const i=new yA(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=i.getGlobalProperty("RTC_CENTER",ne.FLOAT,3),n}async function p7(t,e,n,r,s){return n=A7(t,e,n,r),await $I(t,t.gltfFormat||0,r,s),n}function A7(t,e,n,r,s){var i;if(n=nf(t,e,n),t.version!==1)throw new Error(`Instanced 3D Model version ${t.version} is not supported`);n=EA(t,e,n);const o=new DataView(e);if(t.gltfFormat=o.getUint32(n,!0),n+=4,n=TA(t,e,n),n=XI(t,e,n,r),!(t!=null&&(i=t.header)!==null&&i!==void 0&&i.featureTableJsonByteLength)||t.header.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const a=new yA(t.featureTableJson,t.featureTableBinary),c=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=c,!Number.isFinite(c))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=a.getGlobalProperty("RTC_CENTER",ne.FLOAT,3);const l=new TI(t.batchTableJson,t.batchTableBinary,c);return _7(t,a,l,c),n}function _7(t,e,n,r){const s=new Array(r),i=new L;new L,new L,new L;const o=new Le,a=new Xm,c=new L,l={},u=new To,h=[],f=[],d=[],m=[];for(let _=0;_<r;_++){let T;if(e.hasProperty("POSITION"))T=e.getProperty("POSITION",ne.FLOAT,3,_,i);else if(e.hasProperty("POSITION_QUANTIZED")){T=e.getProperty("POSITION_QUANTIZED",ne.UNSIGNED_SHORT,3,_,i);const S=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",ne.FLOAT,3);if(!S)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const I=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",ne.FLOAT,3);if(!I)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const x=65535;for(let O=0;O<3;O++)T[O]=T[O]/x*I[O]+S[O]}if(!T)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(i.copy(T),l.translation=i,t.normalUp=e.getProperty("NORMAL_UP",ne.FLOAT,3,_,h),t.normalRight=e.getProperty("NORMAL_RIGHT",ne.FLOAT,3,_,f),t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",ne.UNSIGNED_SHORT,2,_,h),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",ne.UNSIGNED_SHORT,2,_,f),t.octNormalUp)throw t.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");t.eastNorthUp?(yh.WGS84.eastNorthUpToFixedFrame(i,u),u.getRotationMatrix3(o)):o.identity()}a.fromMatrix3(o),l.rotation=a,c.set(1,1,1);const p=e.getProperty("SCALE",ne.FLOAT,1,_,d);Number.isFinite(p)&&c.multiplyByScalar(p);const A=e.getProperty("SCALE_NON_UNIFORM",ne.FLOAT,3,_,h);A&&c.scale(A),l.scale=c;let y=e.getProperty("BATCH_ID",ne.UNSIGNED_SHORT,1,_,m);y===void 0&&(y=_);const C=new To().fromQuaternion(l.rotation);u.identity(),u.translate(l.translation),u.multiplyRight(C),u.scale(l.scale);const b=u.clone();s[_]={modelMatrix:b,batchId:y}}t.instances=s}async function y7(t,e,n,r,s,i){n=nf(t,e,n);const o=new DataView(e);for(t.tilesLength=o.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&(t.byteLength||0)-n>12;){const a={shape:"tile3d"};t.tiles.push(a),n=await i(e,n,r,s,a)}return n}async function E7(t,e,n,r){var s,i;if(t.rotateYtoZ=!0,t.gltfUpAxis=n!=null&&(s=n["3d-tiles"])!==null&&s!==void 0&&s.assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",n!=null&&(i=n["3d-tiles"])!==null&&i!==void 0&&i.loadGLTF){if(!r)return e.byteLength;const o=await Dc(e,Bh,n,r);t.gltf=JI(o),t.gpuMemoryUsageInBytes=MI(t.gltf)}else t.gltfArrayBuffer=e;return e.byteLength}async function WI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{shape:"tile3d"};switch(s.byteOffset=e,s.type=NX(t,e),s.type){case ca.COMPOSITE:return await y7(s,t,e,n,r,WI);case ca.BATCHED_3D_MODEL:return await g7(s,t,e,n,r);case ca.GLTF:return await E7(s,t,n,r);case ca.INSTANCED_3D_MODEL:return await p7(s,t,e,n,r);case ca.POINT_CLOUD:return await S$(s,t,e,n,r);default:throw new Error(`3DTileLoader: unknown type ${s.type}`)}}const T7=1952609651,v7=1;async function C7(t,e,n){if(new Uint32Array(t.slice(0,4))[0]!==T7)throw new Error("Wrong subtree file magic number");if(new Uint32Array(t.slice(4,8))[0]!==v7)throw new Error("Wrong subtree file verson, must be 1");const i=hv(t.slice(8,16)),o=new Uint8Array(t,24,i),c=new TextDecoder("utf8").decode(o),l=JSON.parse(c),u=hv(t.slice(16,24));let h=new ArrayBuffer(0);if(u&&(h=t.slice(24+i)),await nu(l,l.tileAvailability,h,n),Array.isArray(l.contentAvailability))for(const f of l.contentAvailability)await nu(l,f,h,n);else await nu(l,l.contentAvailability,h,n);return await nu(l,l.childSubtreeAvailability,h,n),l}async function nu(t,e,n,r){const s=Number.isFinite(e.bitstream)?e.bitstream:e.bufferView;if(typeof s!="number")return;const i=t.bufferViews[s],o=t.buffers[i.buffer];if(!(r!=null&&r.baseUrl))throw new Error("Url is not provided");if(!r.fetch)throw new Error("fetch is not provided");if(o.uri){const a=`${(r==null?void 0:r.baseUrl)||""}/${o.uri}`,l=await(await r.fetch(a)).arrayBuffer();e.explicitBitstream=new Uint8Array(l,i.byteOffset,i.byteLength);return}e.explicitBitstream=new Uint8Array(n,i.byteOffset,i.byteLength)}function hv(t){const e=new DataView(t),n=e.getUint32(0,!0),r=e.getUint32(4,!0);return n+2**32*r}const KI={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:pI,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:C7,options:{}};function B7(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function kc(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||B7()}const ru=globalThis.window||globalThis.self||globalThis.global,fa=globalThis.process||{},YI=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";kc();function b7(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class S7{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=b7(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function w7(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function I7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function ig(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const s=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const i=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(i/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(s,");"),"background-size:".concat(i,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let bh;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(bh||(bh={}));const M7=10;function fv(t){return typeof t!="string"?t:(t=t.toUpperCase(),bh[t]||bh.WHITE)}function R7(t,e,n){if(!kc&&typeof t=="string"){if(e){const r=fv(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=fv(n);t="\x1B[".concat(r+M7,"m").concat(t,"\x1B[49m")}}return t}function x7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),s=t;for(const i of r){const o=s[i];typeof o=="function"&&(e.find(a=>i===a)||(s[i]=o.bind(t)))}}function Sh(t,e){if(!t)throw new Error(e||"Assertion failed")}function bi(){let t;if(kc()&&ru.performance){var e,n;t=ru==null||(e=ru.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in fa){var r;const s=fa==null||(r=fa.hrtime)===null||r===void 0?void 0:r.call(fa);t=s[0]*1e3+s[1]/1e6}else t=Date.now();return t}const Si={debug:kc()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},O7={enabled:!0,level:0};function on(){}const dv={},gv={once:!0};class QI{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=YI,this._startTs=bi(),this._deltaTs=bi(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new S7("__probe-".concat(this.id,"__"),O7),this.timeStamp("".concat(this.id," started")),x7(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((bi()-this._startTs).toPrecision(10))}getDelta(){return Number((bi()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Sh(e,n)}warn(e){return this._getLogFunction(0,e,Si.warn,arguments,gv)}error(e){return this._getLogFunction(0,e,Si.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Si.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Si.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,Si.debug||Si.info,arguments,gv)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||on,r&&[r],{tag:D7(n)}):on}image(e){let{logLevel:n,priority:r,image:s,message:i="",scale:o=1}=e;return this._shouldLog(n||r)?kc()?F7({image:s,message:i,scale:o}):P7():on}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||on)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const s=mv({logLevel:e,message:n,opts:r}),{collapsed:i}=r;return s.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||on)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=qI(e)}_getLogFunction(e,n,r,s,i){if(this._shouldLog(e)){i=mv({logLevel:e,message:n,args:s,opts:i}),r=r||i.method,Sh(r),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=bi();const o=i.tag||i.message;if(i.once&&o)if(!dv[o])dv[o]=bi();else return on;return n=L7(this.id,i.message,i),r.bind(console,n,...i.args)}return on}}QI.VERSION=YI;function qI(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Sh(Number.isFinite(e)&&e>=0),e}function mv(t){const{logLevel:e,message:n}=t;t.logLevel=qI(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const s=typeof t.message;return Sh(s==="string"||s==="object"),Object.assign(t,{args:r},t.opts)}function L7(t,e,n){if(typeof e=="string"){const r=n.time?I7(w7(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=R7(e,n.color,n.background)}return e}function P7(t){return console.warn("removed"),on}function F7(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const i=new Image;return i.onload=()=>{const o=ig(i,n,r);console.log(...o)},i.src=e,on}const s=e.nodeName||"";if(s.toLowerCase()==="img")return console.log(...ig(e,n,r)),on;if(s.toLowerCase()==="canvas"){const i=new Image;return i.onload=()=>console.log(...ig(i,n,r)),i.src=e.toDataURL(),on}return on}function D7(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const ZI=new QI({id:"@probe.gl/log"});/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var fn=null;try{fn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function de(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}de.prototype.__isLong__;Object.defineProperty(de.prototype,"__isLong__",{value:!0});function ut(t){return(t&&t.__isLong__)===!0}function pv(t){var e=Math.clz32(t&-t);return t?31-e:e}de.isLong=ut;var Av={},_v={};function ai(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=_v[t],r)?r:(n=oe(t,0,!0),s&&(_v[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=Av[t],r)?r:(n=oe(t,t<0?-1:0,!1),s&&(Av[t]=n),n))}de.fromInt=ai;function dn(t,e){if(isNaN(t))return e?Sr:Mn;if(e){if(t<0)return Sr;if(t>=eM)return rM}else{if(t<=-Ev)return St;if(t+1>=Ev)return nM}return t<0?dn(-t,e).neg():oe(t%Co|0,t/Co|0,e)}de.fromNumber=dn;function oe(t,e,n){return new de(t,e,n)}de.fromBits=oe;var wh=Math.pow;function OA(t,e,n){if(t.length===0)throw Error("empty string");if(typeof e=="number"?(n=e,e=!1):e=!!e,t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e?Sr:Mn;if(n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return OA(t.substring(1),e,n).neg();for(var s=dn(wh(n,8)),i=Mn,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+a),n);if(a<8){var l=dn(wh(n,a));i=i.mul(l).add(dn(c))}else i=i.mul(s),i=i.add(dn(c))}return i.unsigned=e,i}de.fromString=OA;function Un(t,e){return typeof t=="number"?dn(t,e):typeof t=="string"?OA(t,e):oe(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}de.fromValue=Un;var yv=65536,N7=1<<24,Co=yv*yv,eM=Co*Co,Ev=eM/2,Tv=ai(N7),Mn=ai(0);de.ZERO=Mn;var Sr=ai(0,!0);de.UZERO=Sr;var Xi=ai(1);de.ONE=Xi;var tM=ai(1,!0);de.UONE=tM;var tp=ai(-1);de.NEG_ONE=tp;var nM=oe(-1,2147483647,!1);de.MAX_VALUE=nM;var rM=oe(-1,-1,!0);de.MAX_UNSIGNED_VALUE=rM;var St=oe(0,-2147483648,!1);de.MIN_VALUE=St;var N=de.prototype;N.toInt=function(){return this.unsigned?this.low>>>0:this.low};N.toNumber=function(){return this.unsigned?(this.high>>>0)*Co+(this.low>>>0):this.high*Co+(this.low>>>0)};N.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(St)){var n=dn(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=dn(wh(e,6),this.unsigned),o=this,a="";;){var c=o.div(i),l=o.sub(c.mul(i)).toInt()>>>0,u=l.toString(e);if(o=c,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};N.getHighBits=function(){return this.high};N.getHighBitsUnsigned=function(){return this.high>>>0};N.getLowBits=function(){return this.low};N.getLowBitsUnsigned=function(){return this.low>>>0};N.getNumBitsAbs=function(){if(this.isNegative())return this.eq(St)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};N.isZero=function(){return this.high===0&&this.low===0};N.eqz=N.isZero;N.isNegative=function(){return!this.unsigned&&this.high<0};N.isPositive=function(){return this.unsigned||this.high>=0};N.isOdd=function(){return(this.low&1)===1};N.isEven=function(){return(this.low&1)===0};N.equals=function(e){return ut(e)||(e=Un(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};N.eq=N.equals;N.notEquals=function(e){return!this.eq(e)};N.neq=N.notEquals;N.ne=N.notEquals;N.lessThan=function(e){return this.comp(e)<0};N.lt=N.lessThan;N.lessThanOrEqual=function(e){return this.comp(e)<=0};N.lte=N.lessThanOrEqual;N.le=N.lessThanOrEqual;N.greaterThan=function(e){return this.comp(e)>0};N.gt=N.greaterThan;N.greaterThanOrEqual=function(e){return this.comp(e)>=0};N.gte=N.greaterThanOrEqual;N.ge=N.greaterThanOrEqual;N.compare=function(e){if(ut(e)||(e=Un(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};N.comp=N.compare;N.negate=function(){return!this.unsigned&&this.eq(St)?St:this.not().add(Xi)};N.neg=N.negate;N.add=function(e){ut(e)||(e=Un(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,l=e.low&65535,u=0,h=0,f=0,d=0;return d+=i+l,f+=d>>>16,d&=65535,f+=s+c,h+=f>>>16,f&=65535,h+=r+a,u+=h>>>16,h&=65535,u+=n+o,u&=65535,oe(f<<16|d,u<<16|h,this.unsigned)};N.subtract=function(e){return ut(e)||(e=Un(e)),this.add(e.neg())};N.sub=N.subtract;N.multiply=function(e){if(this.isZero())return this;if(ut(e)||(e=Un(e)),fn){var n=fn.mul(this.low,this.high,e.low,e.high);return oe(n,fn.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Sr:Mn;if(this.eq(St))return e.isOdd()?St:Mn;if(e.eq(St))return this.isOdd()?St:Mn;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Tv)&&e.lt(Tv))return dn(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,l=e.low>>>16,u=e.low&65535,h=0,f=0,d=0,m=0;return m+=o*u,d+=m>>>16,m&=65535,d+=i*u,f+=d>>>16,d&=65535,d+=o*l,f+=d>>>16,d&=65535,f+=s*u,h+=f>>>16,f&=65535,f+=i*l,h+=f>>>16,f&=65535,f+=o*c,h+=f>>>16,f&=65535,h+=r*u+s*l+i*c+o*a,h&=65535,oe(d<<16|m,h<<16|f,this.unsigned)};N.mul=N.multiply;N.divide=function(e){if(ut(e)||(e=Un(e)),e.isZero())throw Error("division by zero");if(fn){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?fn.div_u:fn.div_s)(this.low,this.high,e.low,e.high);return oe(n,fn.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Sr:Mn;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Sr;if(e.gt(this.shru(1)))return tM;i=Sr}else{if(this.eq(St)){if(e.eq(Xi)||e.eq(tp))return St;if(e.eq(St))return Xi;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(Mn)?e.isNegative()?Xi:tp:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(St))return this.unsigned?Sr:Mn;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=Mn}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),c=a<=48?1:wh(2,a-48),l=dn(r),u=l.mul(e);u.isNegative()||u.gt(s);)r-=c,l=dn(r,this.unsigned),u=l.mul(e);l.isZero()&&(l=Xi),i=i.add(l),s=s.sub(u)}return i};N.div=N.divide;N.modulo=function(e){if(ut(e)||(e=Un(e)),fn){var n=(this.unsigned?fn.rem_u:fn.rem_s)(this.low,this.high,e.low,e.high);return oe(n,fn.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};N.mod=N.modulo;N.rem=N.modulo;N.not=function(){return oe(~this.low,~this.high,this.unsigned)};N.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};N.clz=N.countLeadingZeros;N.countTrailingZeros=function(){return this.low?pv(this.low):pv(this.high)+32};N.ctz=N.countTrailingZeros;N.and=function(e){return ut(e)||(e=Un(e)),oe(this.low&e.low,this.high&e.high,this.unsigned)};N.or=function(e){return ut(e)||(e=Un(e)),oe(this.low|e.low,this.high|e.high,this.unsigned)};N.xor=function(e){return ut(e)||(e=Un(e)),oe(this.low^e.low,this.high^e.high,this.unsigned)};N.shiftLeft=function(e){return ut(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?oe(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):oe(0,this.low<<e-32,this.unsigned)};N.shl=N.shiftLeft;N.shiftRight=function(e){return ut(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?oe(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):oe(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};N.shr=N.shiftRight;N.shiftRightUnsigned=function(e){return ut(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?oe(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?oe(this.high,0,this.unsigned):oe(this.high>>>e-32,0,this.unsigned)};N.shru=N.shiftRightUnsigned;N.shr_u=N.shiftRightUnsigned;N.rotateLeft=function(e){var n;return ut(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?oe(this.high,this.low,this.unsigned):e<32?(n=32-e,oe(this.low<<e|this.high>>>n,this.high<<e|this.low>>>n,this.unsigned)):(e-=32,n=32-e,oe(this.high<<e|this.low>>>n,this.low<<e|this.high>>>n,this.unsigned))};N.rotl=N.rotateLeft;N.rotateRight=function(e){var n;return ut(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?oe(this.high,this.low,this.unsigned):e<32?(n=32-e,oe(this.high<<n|this.low>>>e,this.low<<n|this.high>>>e,this.unsigned)):(e-=32,n=32-e,oe(this.low<<n|this.high>>>e,this.high<<n|this.low>>>e,this.unsigned))};N.rotr=N.rotateRight;N.toSigned=function(){return this.unsigned?oe(this.low,this.high,!1):this};N.toUnsigned=function(){return this.unsigned?this:oe(this.low,this.high,!0)};N.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};N.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};N.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};de.fromBytes=function(e,n,r){return r?de.fromBytesLE(e,n):de.fromBytesBE(e,n)};de.fromBytesLE=function(e,n){return new de(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};de.fromBytesBE=function(e,n){return new de(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const U7=16;function sM(t){t==="X"&&(t="");const e=t.padEnd(U7,"0");return de.fromString(e,!0,16)}function G7(t){if(t.isZero())return"X";let e=t.countTrailingZeros();const n=e%4;e=(e-n)/4;const r=e;e*=4;const i=t.shiftRightUnsigned(e).toString(16).replace(/0+$/,"");return Array(17-r-i.length).join("0")+i}function k7(t,e){const n=H7(t).shiftRightUnsigned(2);return t.add(de.fromNumber(2*e+1-4).multiply(n))}function H7(t){return t.and(t.not().add(1))}const V7=3,j7=30,z7=2*j7+1,vv=180/Math.PI;function J7(t){if(t.length===0)throw new Error(`Invalid Hilbert quad key ${t}`);const e=t.split("/"),n=parseInt(e[0],10),r=e[1],s=r.length;let i=0;const o=[0,0];for(let a=s-1;a>=0;a--){i=s-a;const c=r[a];let l=0,u=0;c==="1"?u=1:c==="2"?(l=1,u=1):c==="3"&&(l=1);const h=Math.pow(2,i-1);$7(h,o,l,u),o[0]+=h*l,o[1]+=h*u}if(n%2===1){const a=o[0];o[0]=o[1],o[1]=a}return{face:n,ij:o,level:i}}function X7(t){if(t.isZero())return"";let e=t.toString(2);for(;e.length<V7+z7;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),s=e.substring(3,n),i=s.length/2,o=de.fromString(r,!0,2).toString(10);let a="";if(i!==0)for(a=de.fromString(s,!0,2).toString(4);a.length<i;)a="0"+a;return`${o}/${a}`}function iM(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function Cv(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function oM(t){return[Cv(t[0]),Cv(t[1])]}function aM(t,e){let[n,r]=e;switch(t){case 0:return[1,n,r];case 1:return[-n,1,r];case 2:return[-n,-r,1];case 3:return[-1,-r,-n];case 4:return[r,-1,-n];case 5:return[r,n,-1];default:throw new Error("Invalid face")}}function cM(t){let[e,n,r]=t;const s=Math.atan2(r,Math.sqrt(e*e+n*n));return[Math.atan2(n,e)*vv,s*vv]}function $7(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}function W7(t){const e=iM(t.ij,t.level,[.5,.5]),n=oM(e),r=aM(t.face,n);return cM(r)}const K7=100;function Bv(t){const{face:e,ij:n,level:r}=t,s=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(K7*Math.pow(2,-r))),o=new Float64Array(4*i*2+2);let a=0,c=0;for(let l=0;l<4;l++){const u=s[l].slice(0),h=s[l+1],f=(h[0]-u[0])/i,d=(h[1]-u[1])/i;for(let m=0;m<i;m++){u[0]+=f,u[1]+=d;const _=iM(n,r,u),T=oM(_),p=aM(e,T),A=cM(p);Math.abs(A[1])>89.999&&(A[0]=c);const y=A[0]-c;A[0]+=y>180?-360:y<-180?360:0,o[a++]=A[0],o[a++]=A[1],c=A[0]}}return o[a++]=o[0],o[a++]=o[1],o}function LA(t){const e=Y7(t);return J7(e)}function Y7(t){if(t.indexOf("/")>0)return t;const e=sM(t);return X7(e)}function Q7(t){const e=LA(t);return W7(e)}function q7(t){let e;if(t.face===2||t.face===5){let n=null,r=0;for(let s=0;s<4;s++){const i=`${t.face}/${s}`,o=LA(i),a=Bv(o);(typeof n>"u"||n===null)&&(n=new Float64Array(4*a.length)),n.set(a,r),r+=a.length}e=bv(n)}else{const n=Bv(t);e=bv(n)}return e}function bv(t){if(t.length%2!==0)throw new Error("Invalid corners");const e=[],n=[];for(let r=0;r<t.length;r+=2)e.push(t[r]),n.push(t[r+1]);return e.sort((r,s)=>r-s),n.sort((r,s)=>r-s),{west:e[0],east:e[e.length-1],north:n[n.length-1],south:n[0]}}function Z7(t,e){const n=(e==null?void 0:e.minimumHeight)||0,r=(e==null?void 0:e.maximumHeight)||0,s=LA(t),i=q7(s),o=i.west,a=i.south,c=i.east,l=i.north,u=[];return u.push(new L(o,l,n)),u.push(new L(c,l,n)),u.push(new L(c,a,n)),u.push(new L(o,a,n)),u.push(new L(o,l,r)),u.push(new L(c,l,r)),u.push(new L(c,a,r)),u.push(new L(o,a,r)),u}function lM(t){const e=t.token,n={minimumHeight:t.minimumHeight,maximumHeight:t.maximumHeight},r=Z7(e,n),s=Q7(e),i=s[0],o=s[1],a=yh.WGS84.cartographicToCartesian([i,o,n.maximumHeight]),c=new L(a[0],a[1],a[2]);r.push(c);const l=FX(r);return[...l.center,...l.halfAxes]}const eQ=4,tQ=8,nQ={QUADTREE:eQ,OCTREE:tQ};function rQ(t,e,n){if(t!=null&&t.box){const r=sM(t.s2VolumeInfo.token),s=k7(r,e),i=G7(s),o={...t.s2VolumeInfo};switch(o.token=i,n){case"OCTREE":const l=t.s2VolumeInfo,u=l.maximumHeight-l.minimumHeight,h=u/2,f=l.minimumHeight+u/2;l.minimumHeight=f-h,l.maximumHeight=f+h;break}return{box:lM(o),s2VolumeInfo:o}}}async function uM(t){const{implicitOptions:e,parentData:n={mortonIndex:0,x:0,y:0,z:0},childIndex:r=0,globalData:s={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:i,loaderOptions:o}=t;let{subtree:a,level:c=0}=t;const{subdivisionScheme:l,subtreeLevels:u,maximumLevel:h,contentUrlTemplate:f,subtreesUriTemplate:d,basePath:m}=e,_={children:[],lodMetricValue:0,contentUrl:""};if(!h)return ZI.once(`Missing 'maximumLevel' or 'availableLevels' property. The subtree ${f} won't be loaded...`),_;const T=c+s.level;if(T>h)return _;const p=nQ[l],A=Math.log2(p),y=r&1,C=r>>1&1,b=r>>2&1,S=(p**c-1)/(p-1);let I=Rs(n.mortonIndex,r,A),x=S+I,O=Rs(n.x,y,1),M=Rs(n.y,C,1),U=Rs(n.z,b,1),J=!1;c>=u&&(J=og(a.childSubtreeAvailability,I));const W=Rs(s.x,O,c*A),H=Rs(s.y,M,c*A),Ce=Rs(s.z,U,c*A);if(J){const K=`${m}/${d}`,ue=np(K,T,W,H,Ce);a=await ar(ue,KI,o),s.mortonIndex=I,s.x=O,s.y=M,s.z=U,s.level=c,I=0,x=0,O=0,M=0,U=0,c=0}if(!og(a.tileAvailability,x))return _;og(a.contentAvailability,x)&&(_.contentUrl=np(f,T,W,H,Ce));const G=c+1,X={mortonIndex:I,x:O,y:M,z:U};for(let K=0;K<p;K++){const ue=rQ(i,K,l),le=await uM({subtree:a,implicitOptions:e,loaderOptions:o,parentData:X,childIndex:K,level:G,globalData:{...s},s2VolumeBox:ue});if(le.contentUrl||le.children.length){const Gn=T+1,vs=sQ(le,Gn,{childTileX:O,childTileY:M,childTileZ:U},e,i);_.children.push(vs)}}return _}function og(t,e){let n;return Array.isArray(t)?(n=t[0],t.length>1&&ZI.once('Not supported extension "3DTILES_multiple_contents" has been detected')):n=t,"constant"in n?!!n.constant:n.explicitBitstream?aQ(e,n.explicitBitstream):!1}function sQ(t,e,n,r,s){const{basePath:i,refine:o,getRefine:a,lodMetricType:c,getTileType:l,rootLodMetricValue:u,rootBoundingVolume:h}=r,f=t.contentUrl&&t.contentUrl.replace(`${i}/`,""),d=u/2**e,m=s!=null&&s.box?{box:s.box}:h,_=iQ(e,m,n);return{children:t.children,contentUrl:t.contentUrl,content:{uri:f},id:t.contentUrl,refine:a(o),type:l(t),lodMetricType:c,lodMetricValue:d,geometricError:d,transform:t.transform,boundingVolume:_}}function iQ(t,e,n){if(e.region){const{childTileX:r,childTileY:s,childTileZ:i}=n,[o,a,c,l,u,h]=e.region,f=2**t,d=(c-o)/f,m=(l-a)/f,_=(h-u)/f,[T,p]=[o+d*r,o+d*(r+1)],[A,y]=[a+m*s,a+m*(s+1)],[C,b]=[u+_*i,u+_*(i+1)];return{region:[T,A,p,y,C,b]}}if(e.box)return e;throw new Error(`Unsupported bounding volume type ${e}`)}function Rs(t,e,n){return(t<<n)+e}function np(t,e,n,r,s){const i=oQ({level:e,x:n,y:r,z:s});return t.replace(/{level}|{x}|{y}|{z}/gi,o=>i[o])}function oQ(t){const e={};for(const n in t)e[`{${n}}`]=t[n];return e}function aQ(t,e){const n=Math.floor(t/8),r=t%8;return(e[n]>>r&1)===1}function PA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(!e)return ql.EMPTY;const r=e.split("?")[0].split(".").pop();switch(r){case"pnts":return ql.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return ql.SCENEGRAPH;default:return r||ql.EMPTY}}function FA(t){switch(t){case"REPLACE":case"replace":return KT.REPLACE;case"ADD":case"add":return KT.ADD;default:return t}}function rp(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const r=new URL(t,`${e}/`);return decodeURI(r.toString())}else if(t.startsWith("/"))return t;return v5(e,t)}function Sv(t,e){if(!t)return null;let n;if(t.content){var r;const i=t.content.uri||((r=t.content)===null||r===void 0?void 0:r.url);n=rp(i,e)}return{...t,id:n,contentUrl:n,lodMetricType:tf.GEOMETRIC_ERROR,lodMetricValue:t.geometricError,transformMatrix:t.transform,type:PA(t,n),refine:FA(t.refine)}}async function cQ(t,e,n){let r=null;const s=Iv(t.root);s&&t.root?r=await wv(t.root,t,e,s,n):r=Sv(t.root,e);const i=[];for(i.push(r);i.length>0;){const o=i.pop()||{},a=o.children||[],c=[];for(const l of a){const u=Iv(l);let h;u?h=await wv(l,t,e,u,n):h=Sv(l,e),h&&(c.push(h),i.push(h))}o.children=c}return r}async function wv(t,e,n,r,s){var i,o,a;const{subdivisionScheme:c,maximumLevel:l,availableLevels:u,subtreeLevels:h,subtrees:{uri:f}}=r,d=np(f,0,0,0,0),m=rp(d,n),_=await ar(m,KI,s),T=rp((i=t.content)===null||i===void 0?void 0:i.uri,n),p=e==null||(o=e.root)===null||o===void 0?void 0:o.refine,A=t.geometricError,y=(a=t.boundingVolume.extensions)===null||a===void 0?void 0:a["3DTILES_bounding_volume_S2"];if(y){const I={box:lM(y),s2VolumeInfo:y};t.boundingVolume=I}const C=t.boundingVolume,b={contentUrlTemplate:T,subtreesUriTemplate:f,subdivisionScheme:c,subtreeLevels:h,maximumLevel:Number.isFinite(u)?u-1:l,refine:p,basePath:n,lodMetricType:tf.GEOMETRIC_ERROR,rootLodMetricValue:A,rootBoundingVolume:C,getTileType:PA,getRefine:FA};return await lQ(t,n,_,b,s)}async function lQ(t,e,n,r,s){if(!t)return null;const{children:i,contentUrl:o}=await uM({subtree:n,implicitOptions:r,loaderOptions:s});let a,c=null;return o&&(a=o,c={uri:o.replace(`${e}/`,"")}),{...t,id:a,contentUrl:a,lodMetricType:tf.GEOMETRIC_ERROR,lodMetricValue:t.geometricError,transformMatrix:t.transform,type:PA(t,a),refine:FA(t.refine),content:c||t.content,children:i}}function Iv(t){var e;return(t==null||(e=t.extensions)===null||e===void 0?void 0:e["3DTILES_implicit_tiling"])||(t==null?void 0:t.implicitTiling)}const hM={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:pI,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:uQ,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};async function uQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=e["3d-tiles"]||{};let s;return r.isTileset==="auto"?s=(n==null?void 0:n.url)&&n.url.indexOf(".json")!==-1:s=r.isTileset,s?hQ(t,e,n):fQ(t,e,n)}async function hQ(t,e,n){var r;const s=JSON.parse(new TextDecoder().decode(t)),i=(n==null?void 0:n.url)||"",o=dQ(i),a=await cQ(s,o,e||{});return{...s,shape:"tileset3d",loader:hM,url:i,queryString:(n==null?void 0:n.queryString)||"",basePath:o,root:a||s.root,type:DX.TILES3D,lodMetricType:tf.GEOMETRIC_ERROR,lodMetricValue:((r=s.root)===null||r===void 0?void 0:r.geometricError)||0}}async function fQ(t,e,n){const r={content:{shape:"tile3d",featureIds:null}};return await WI(t,0,e,n,r.content),r.content}function dQ(t){return T5(t)}const gQ="modulepreload",mQ=function(t){return"/vite-react-map-gl-deck-gl-template/"+t},Mv={},pQ=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){const i=document.getElementsByTagName("link");s=Promise.all(n.map(o=>{if(o=mQ(o),o in Mv)return;Mv[o]=!0;const a=o.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(!!r)for(let h=i.length-1;h>=0;h--){const f=i[h];if(f.href===o&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":gQ,a||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),a)return new Promise((h,f)=>{u.addEventListener("load",h),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}return s.then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},AQ=$.createContext(null);function _Q(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,s=Array.isArray(e)?e[0]:e?e.x:0,i=Array.isArray(e)?e[1]:e?e.y:0;return n===s&&r===i}function Er(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Er(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const s of n)if(!e.hasOwnProperty(s)||!Er(t[s],e[s]))return!1;return!0}return!1}function yQ(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function Rv(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();Er(n,r)||e.setProjection(n)}function xv(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function Ov(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const s=t.center;t.center=new s.constructor(n.longitude,n.latitude),r=r||s!==t.center}if("zoom"in n){const s=t.zoom;t.zoom=n.zoom,r=r||s!==t.zoom}if("bearing"in n){const s=t.bearing;t.bearing=n.bearing,r=r||s!==t.bearing}if("pitch"in n){const s=t.pitch;t.pitch=n.pitch,r=r||s!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const EQ=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Lv(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let s=null;"interactive"in r&&(s=Object.assign({},r),delete s.interactive);const i=e[r.ref];if(i){s=s||Object.assign({},r),delete s.ref;for(const o of EQ)o in i&&(s[o]=i[o])}return s||r});return{...t,layers:n}}var Pv={};const Fv={version:8,sources:{},layers:[]},Dv={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},ag={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Nv={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},TQ=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],vQ=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Bo{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=s=>{const i=this.props[Nv[s.type]];i?i(s):s.type==="error"&&console.error(s.error)},this._onPointerEvent=s=>{(s.type==="mousemove"||s.type==="mouseout")&&this._updateHover(s);const i=this.props[Dv[s.type]];i&&(this.props.interactiveLayerIds&&s.type!=="mouseover"&&s.type!=="mouseout"&&(s.features=this._hoveredFeatures||this._queryRenderedFeatures(s.point)),i(s),delete s.features)},this._onCameraEvent=s=>{if(!this._internalUpdate){const i=this.props[ag[s.type]];i&&i(s)}s.type in this._deferredEvents&&(this._deferredEvents[s.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const s=this._updateSize(e),i=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||s||i&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Bo.savedMaps.pop();if(!r)return null;const s=r.map,i=s.getContainer();for(n.className=i.className;i.childNodes.length>0;)n.appendChild(i.childNodes[0]);s._container=n;const o=s._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),s.resize();const{initialViewState:a}=e;return a&&(a.bounds?s.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),s.isStyleLoaded()?s.fire("load"):s.once("styledata",()=>s.fire("load")),s._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=Fv}=n,s={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||CQ()||null,container:e,style:Lv(r)},i=s.initialViewState||s.viewState||s;if(Object.assign(s,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),n.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,n.gl)}const o=new this._MapClass(s);i.padding&&o.setPadding(i.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const a=o._render;o._render=u=>{this._inRender=!0,a.call(o,u),this._inRender=!1};const c=o._renderTaskQueue.run;o._renderTaskQueue.run=u=>{c.call(o._renderTaskQueue,u),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const l=o.fire;o.fire=this._fireEvent.bind(this,l),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),Rv(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const u in Dv)o.on(u,this._onPointerEvent);for(const u in ag)o.on(u,this._onCameraEvent);for(const u in Nv)o.on(u,this._onEvent);this._map=o}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),Bo.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=yQ(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,s=this._renderTransform,{zoom:i,pitch:o,bearing:a}=s,c=r.isMoving();c&&(s.cameraElevationReference="sea");const l=Ov(s,{...xv(r.transform),...e});if(c&&(s.cameraElevationReference="ground"),l&&n){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=i!==s.zoom),u.rotate||(u.rotate=a!==s.bearing),u.pitch||(u.pitch=o!==s.pitch)}return c||Ov(r.transform,e),l}_updateSettings(e,n){const r=this._map;let s=!1;for(const i of TQ)if(i in e&&!Er(e[i],n[i])){s=!0;const o=r[`set${i[0].toUpperCase()}${i.slice(1)}`];o==null||o.call(r,e[i])}return s}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=Fv,styleDiffing:s=!0}=e,i={diff:s};return"localIdeographFontFamily"in e&&(i.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(Lv(r),i),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let s=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!Er(e.light,n.light)&&(s=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!Er(e.fog,n.fog)&&(s=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!Er(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(s=!0,r.setTerrain(e.terrain))),s}_updateHandlers(e,n){var r,s;const i=this._map;let o=!1;for(const a of vQ){const c=(r=e[a])!==null&&r!==void 0?r:!0,l=(s=n[a])!==null&&s!==void 0?s:!0;Er(c,l)||(o=!0,c?i[a].enable(c):i[a].disable())}return o}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:s=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:s.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const i=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),c=a.length>0;!c&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,c&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=i}else this._hoveredFeatures=null}_fireEvent(e,n,r){const s=this._map,i=s.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in ag&&(typeof n=="object"&&(n.viewState=xv(i)),this._map.isMoving())?(s.transform=this._renderTransform,e.call(s,n,r),s.transform=i,s):(e.call(s,n,r),s)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{Rv(this._renderTransform,n),e.transform=n}}}Bo.savedMaps=[];function CQ(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||Pv.MapboxAccessToken}catch{}try{t=t||Pv.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const BQ=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function bQ(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const s=e.transform;e.transform=t.transform;const i=e.project(r);return e.transform=s,i},unproject:r=>{const s=e.transform;e.transform=t.transform;const i=e.unproject(r);return e.transform=s,i},queryTerrainElevation:(r,s)=>{const i=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(r,s);return e.transform=i,o},queryRenderedFeatures:(r,s)=>{const i=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(r,s);return e.transform=i,o}};for(const r of SQ(e))!(r in n)&&!BQ.includes(r)&&(n[r]=e[r].bind(e));return n}function SQ(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const wQ=typeof document<"u"?$.useLayoutEffect:$.useEffect,IQ=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function MQ(t,e){for(const r of IQ)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const of=$.createContext(null);function RQ(t,e,n){const r=$.useContext(AQ),[s,i]=$.useState(null),o=$.useRef(),{current:a}=$.useRef({mapLib:null,map:null});$.useEffect(()=>{const u=t.mapLib;let h=!0,f;return Promise.resolve(u||n).then(d=>{if(!h)return;if(!d)throw new Error("Invalid mapLib");const m="Map"in d?d:d.default;if(!m.Map)throw new Error("Invalid mapLib");if(MQ(m,t),!m.supported||m.supported(t))t.reuseMaps&&(f=Bo.reuse(t,o.current)),f||(f=new Bo(m.Map,t,o.current)),a.map=bQ(f),a.mapLib=m,i(f),r==null||r.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(d=>{const{onError:m}=t;m?m({type:"error",target:null,originalEvent:null,error:d}):console.error(d)}),()=>{h=!1,f&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?f.recycle():f.destroy())}},[]),wQ(()=>{s&&s.setProps(t)}),$.useImperativeHandle(e,()=>a.map,[s]);const c=$.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),l={height:"100%"};return $.createElement("div",{id:t.id,ref:o,style:c},s&&$.createElement(of.Provider,{value:a},$.createElement("div",{"mapboxgl-children":"",style:l},t.children)))}const xQ=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ci(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const s=e[r];Number.isFinite(s)&&!xQ.test(r)?n[r]=`${s}px`:n[r]=s}}function OQ(t,e){const{map:n,mapLib:r}=$.useContext(of),s=$.useRef({props:t});s.current.props=t;const i=$.useMemo(()=>{let _=!1;$.Children.forEach(t.children,A=>{A&&(_=!0)});const T={...t,element:_?document.createElement("div"):null},p=new r.Marker(T);return p.setLngLat([t.longitude,t.latitude]),p.getElement().addEventListener("click",A=>{var y,C;(C=(y=s.current.props).onClick)===null||C===void 0||C.call(y,{type:"click",target:p,originalEvent:A})}),p.on("dragstart",A=>{var y,C;const b=A;b.lngLat=i.getLngLat(),(C=(y=s.current.props).onDragStart)===null||C===void 0||C.call(y,b)}),p.on("drag",A=>{var y,C;const b=A;b.lngLat=i.getLngLat(),(C=(y=s.current.props).onDrag)===null||C===void 0||C.call(y,b)}),p.on("dragend",A=>{var y,C;const b=A;b.lngLat=i.getLngLat(),(C=(y=s.current.props).onDragEnd)===null||C===void 0||C.call(y,b)}),p},[]);$.useEffect(()=>(i.addTo(n.getMap()),()=>{i.remove()}),[]);const{longitude:o,latitude:a,offset:c,style:l,draggable:u=!1,popup:h=null,rotation:f=0,rotationAlignment:d="auto",pitchAlignment:m="auto"}=t;return $.useEffect(()=>{ci(i.getElement(),l)},[l]),$.useImperativeHandle(e,()=>i,[]),(i.getLngLat().lng!==o||i.getLngLat().lat!==a)&&i.setLngLat([o,a]),c&&!_Q(i.getOffset(),c)&&i.setOffset(c),i.isDraggable()!==u&&i.setDraggable(u),i.getRotation()!==f&&i.setRotation(f),i.getRotationAlignment()!==d&&i.setRotationAlignment(d),i.getPitchAlignment()!==m&&i.setPitchAlignment(m),i.getPopup()!==h&&i.setPopup(h),qp.createPortal(t.children,i.getElement())}$.memo($.forwardRef(OQ));function Uv(t){return new Set(t?t.trim().split(/\s+/):[])}function LQ(t,e){const{map:n,mapLib:r}=$.useContext(of),s=$.useMemo(()=>document.createElement("div"),[]),i=$.useRef({props:t});i.current.props=t;const o=$.useMemo(()=>{const a={...t},c=new r.Popup(a);return c.setLngLat([t.longitude,t.latitude]),c.once("open",l=>{var u,h;(h=(u=i.current.props).onOpen)===null||h===void 0||h.call(u,l)}),c},[]);if($.useEffect(()=>{const a=c=>{var l,u;(u=(l=i.current.props).onClose)===null||u===void 0||u.call(l,c)};return o.on("close",a),o.setDOMContent(s).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),$.useEffect(()=>{ci(o.getElement(),t.style)},[t.style]),$.useImperativeHandle(e,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!Er(o.options.offset,t.offset)&&o.setOffset(t.offset),(o.options.anchor!==t.anchor||o.options.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth)),o.options.className!==t.className)){const a=Uv(o.options.className),c=Uv(t.className);for(const l of a)c.has(l)||o.removeClassName(l);for(const l of c)a.has(l)||o.addClassName(l);o.options.className=t.className}return qp.createPortal(t.children,s)}$.memo($.forwardRef(LQ));function xo(t,e,n,r){const s=$.useContext(of),i=$.useMemo(()=>t(s),[]);return $.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,c=typeof n=="function"?n:typeof e=="function"?e:null,{map:l}=s;return l.hasControl(i)||(l.addControl(i,o==null?void 0:o.position),a&&a(s)),()=>{c&&c(s),l.hasControl(i)&&l.removeControl(i)}},[]),i}function PQ(t){const e=xo(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return $.useEffect(()=>{ci(e._container,t.style)},[t.style]),null}$.memo(PQ);function FQ(t){const e=xo(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return $.useEffect(()=>{ci(e._controlContainer,t.style)},[t.style]),null}$.memo(FQ);function DQ(t,e){const n=$.useRef({props:t}),r=xo(({mapLib:s})=>{const i=new s.GeolocateControl(t),o=i._setupUI;return i._setupUI=a=>{i._container.hasChildNodes()||o(a)},i.on("geolocate",a=>{var c,l;(l=(c=n.current.props).onGeolocate)===null||l===void 0||l.call(c,a)}),i.on("error",a=>{var c,l;(l=(c=n.current.props).onError)===null||l===void 0||l.call(c,a)}),i.on("outofmaxbounds",a=>{var c,l;(l=(c=n.current.props).onOutOfMaxBounds)===null||l===void 0||l.call(c,a)}),i.on("trackuserlocationstart",a=>{var c,l;(l=(c=n.current.props).onTrackUserLocationStart)===null||l===void 0||l.call(c,a)}),i.on("trackuserlocationend",a=>{var c,l;(l=(c=n.current.props).onTrackUserLocationEnd)===null||l===void 0||l.call(c,a)}),i},{position:t.position});return n.current.props=t,$.useImperativeHandle(e,()=>r,[]),$.useEffect(()=>{ci(r._container,t.style)},[t.style]),null}$.memo($.forwardRef(DQ));function NQ(t){const e=xo(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return $.useEffect(()=>{ci(e._container,t.style)},[t.style]),null}const UQ=$.memo(NQ);function GQ(t){const e=xo(({mapLib:i})=>new i.ScaleControl(t),{position:t.position}),n=$.useRef(t),r=n.current;n.current=t;const{style:s}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),$.useEffect(()=>{ci(e._container,s)},[s]),null}$.memo(GQ);const kQ=pQ(()=>import("./maplibre-gl-Fc0Mrv87.js").then(t=>t.m),__vite__mapDeps([])),HQ=$.forwardRef(function(e,n){return RQ(e,n,kQ)}),VQ=UQ,cg=512,jQ=Math.PI/180;function fM({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n==null?void 0:n.props._customRender,s=n==null?void 0:n.props.onLoad,i=gM({...n==null?void 0:n.props,_customRender:()=>{t.triggerRepaint(),r==null||r("")}});let o;return(!n||n.props.gl===e)&&(Object.assign(i,{gl:e,width:null,height:null,touchAction:"unset",viewState:yc(t)}),n!=null&&n.isInitialized?Gv(n,t):i.onLoad=()=>{s==null||s(),Gv(o,t)}),n?(o=n,n.setProps(i),n.userData.isExternal=!0):(o=new mc(i),t.on("remove",()=>{dM(t)})),o.userData.mapboxLayers=new Set,t.__deck=o,t.on("render",()=>{o.isInitialized&&KQ(o,t)}),o}function Gv(t,e){const n=()=>{t.isInitialized?YQ(t,e):e.off("move",n)};e.on("move",n)}function dM(t){var e;(e=t.__deck)===null||e===void 0||e.finalize(),t.__deck=null}function gM(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new N0({id:"mapbox"})]}}function zQ(t,e){t.userData.mapboxLayers.add(e),DA(t)}function JQ(t,e){t.userData.mapboxLayers.delete(e),DA(t)}function XQ(t,e){DA(t)}function $Q(t,e,n){let{currentViewport:r}=t.userData,s=!1;r||(r=mM(t,e,!0),t.userData.currentViewport=r,s=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:i})=>n.id===i.id||i.props.operation.includes("terrain"),clearStack:s,clearCanvas:!1})}function yc(t){var e;const{lng:n,lat:r}=t.getCenter(),s={longitude:(n+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(e=t.getTerrain)!==null&&e!==void 0&&e.call(t)&&WQ(t,s),s}function WQ(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:s,latitude:i,pitch:o}=e,a=n.x*cg,c=(1-n.y)*cg,l=n.z*cg,u=dc([s,i]),h=a-u[0],f=c-u[1],d=Math.sqrt(h*h+f*f),m=o*jQ,_=1.5*r,T=m<.001?_*Math.cos(m)/l:_*Math.sin(m)/d;e.zoom=Math.log2(T);const p=_*Math.cos(m)/T,A=l-p;e.position=[0,0,A/vu(i)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function mM(t,e,n=!0){return new Qs({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...yc(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function KQ(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const s=Array.from(n,u=>u.id),o=_o(t.props.layers,Boolean).some(u=>u&&!s.includes(u.id));let a=t.getViewports();const c=a.findIndex(u=>u.id==="mapbox"),l=a.length>1||c<0;(o||l)&&(c>=0&&(a=a.slice(),a[c]=mM(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:a,layerFilter:u=>(!t.props.layerFilter||t.props.layerFilter(u))&&(u.viewport.id!=="mapbox"||!s.includes(u.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function YQ(t,e){t.setProps({viewState:yc(e)}),t.needsRedraw({clearRedrawFlags:!0})}function DA(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,s=new r(n.props);e.push(s)}),t.setProps({layers:e})}class QQ{constructor(e){if(g(this,"id",void 0),g(this,"type",void 0),g(this,"renderingMode",void 0),g(this,"map",void 0),g(this,"deck",void 0),g(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=fM({map:e,gl:n,deck:this.props.deck}),zQ(this.deck,this)}onRemove(){this.deck&&JQ(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&XQ(this.deck)}render(){$Q(this.deck,this.map,this)}}const lg="__UNDEFINED__";function su(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const s=_o(r,Boolean);if(n!==r){const a=_o(n,Boolean),c=new Set(a.map(l=>l.id));for(const l of s)c.delete(l.id);for(const l of c)t.getLayer(l)&&t.removeLayer(l)}for(const a of s){const c=t.getLayer(a.id);c?c.implementation.setProps(a.props):t.addLayer(new QQ({id:a.id,deck:e}),a.props.beforeId)}const i=t.style._order,o={};for(const a of s){let{beforeId:c}=a.props;(!c||!i.includes(c))&&(c=lg),o[c]=o[c]||[],o[c].push(a.id)}for(const a in o){const c=o[a];let l=a===lg?i.length:i.indexOf(a),u=a===lg?void 0:a;for(let h=c.length-1;h>=0;h--){const f=c[h],d=i.indexOf(f);d!==l-1&&(t.moveLayer(f,u),d>l&&l++),l--,u=f}}}class qQ{constructor(e){g(this,"_props",void 0),g(this,"_deck",void 0),g(this,"_map",void 0),g(this,"_container",void 0),g(this,"_interleaved",void 0),g(this,"_lastMouseDownPoint",void 0),g(this,"_handleStyleChange",()=>{su(this._map,this._deck,this._props.layers,this._props.layers)}),g(this,"_updateContainerSize",()=>{if(this._map&&this._container){const{clientWidth:s,clientHeight:i}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(s,"px"),height:"".concat(i,"px")})}}),g(this,"_updateViewState",()=>{const s=this._deck;s&&(s.setProps({viewState:yc(this._map)}),s.isInitialized&&s.redraw())}),g(this,"_handleMouseEvent",s=>{const i=this._deck;if(!i||!i.isInitialized)return;const o={type:s.type,offsetCenter:s.point,srcEvent:s},a=this._lastMouseDownPoint;switch(!s.point&&a&&(o.deltaX=s.originalEvent.clientX-a.clientX,o.deltaY=s.originalEvent.clientY-a.clientY,o.offsetCenter={x:a.x+o.deltaX,y:a.y+o.deltaY}),o.type){case"mousedown":i._onPointerDown(o),this._lastMouseDownPoint={...s.point,clientX:s.originalEvent.clientX,clientY:s.originalEvent.clientY};break;case"dragstart":o.type="panstart",i._onEvent(o);break;case"drag":o.type="panmove",i._onEvent(o);break;case"dragend":o.type="panend",i._onEvent(o);break;case"click":o.tapCount=1,i._onEvent(o);break;case"dblclick":o.type="click",o.tapCount=2,i._onEvent(o);break;case"mousemove":o.type="pointermove",i._onPointerMove(o);break;case"mouseout":o.type="pointerleave",i._onPointerMove(o);break;default:return}});const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&su(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?gM(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,pointerEvents:"none"}),this._container=n,this._deck=new mc({...this._props,parent:n,viewState:yc(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){return this._deck=fM({map:e,gl:e.painter.context.gl,deck:new mc({...this._props,gl:e.painter.context.gl})}),e.on("styledata",this._handleStyleChange),su(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)===null||n===void 0||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),su(e,this._deck,this._props.layers,[]),dM(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Ue(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Ue(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Ue(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}function ZQ(){const t=s=>(xo(()=>new qQ(s)).setProps(s),null),n=[new _h({id:"nagasaki-point-cloud-layer",type:typeof _h,pointSize:1.6,data:"https://smb.optgeo.org/ipfs/QmdAr2FWQKCVv7CAcLRuTBt1583Qi7DA4gaA92g3ujeL1v/tileset.json",loaders:[hM]})],r={longitude:129.339,latitude:33.0124,zoom:9,pitch:60,bearing:0};return mr.jsx(mr.Fragment,{children:mr.jsxs("main",{children:[mr.jsx("h1",{children:'"Nagasaki Point Cloud" by deck.gl + react-map-gl'}),mr.jsxs(HQ,{mapStyle:"https://tile.openstreetmap.jp/styles/osm-bright-en/style.json",attributionControl:!0,maxZoom:22,maxPitch:85,scrollZoom:!0,dragPan:!0,dragRotate:!0,hash:!0,initialViewState:r,children:[mr.jsx(t,{layers:n}),mr.jsx(VQ,{position:"top-right",visualizePitch:!0,showZoom:!0,showCompass:!0})]})]})})}ug.createRoot(document.getElementById("root")).render(mr.jsx(iR.StrictMode,{children:mr.jsx(ZQ,{})}));export{eq as c,kv as g};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
